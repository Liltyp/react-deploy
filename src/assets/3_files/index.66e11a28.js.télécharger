var e=Object.defineProperty,t=(t,a,o)=>(((t,a,o)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o})(t,"symbol"!=typeof a?a+"":a,o),o);import{_ as a,R as o,r as n,c as r,a as i,b as s,u as l,d as c,e as d,l as u,f as m,M as p,g as h,h as g,i as f,v as y,j as E,C as _,k as v,m as w,n as b,o as S,p as T,s as I,q as k,t as C,w as N,x as A,y as x,z as P,D as R,A as O,B as D,E as L,F as U,G as M,H as F,I as B,J as W,K as V,L as j,N as H,O as G,P as $,Q as K,S as Y,T as z,U as q,V as J,W as X,X as Q,Y as Z,Z as ee,$ as te,a0 as ae,a1 as oe,a2 as ne,a3 as re,a4 as ie,a5 as se,a6 as le,a7 as ce,a8 as de,a9 as ue,aa as me,ab as pe,ac as he,ad as ge,ae as fe,af as ye,ag as Ee,ah as _e,ai as ve,aj as we,ak as be,al as Se,am as Te,an as Ie,ao as ke,ap as Ce,aq as Ne,ar as Ae,as as xe,at as Pe,au as Re,av as Oe,aw as De,ax as Le,ay as Ue,az as Me,aA as Fe,aB as Be,aC as We,aD as Ve,aE as je,aF as He,aG as Ge,aH as $e,aI as Ke,aJ as Ye,aK as ze,aL as qe,aM as Je,aN as Xe,aO as Qe,aP as Ze,aQ as et,aR as tt,aS as at,aT as ot,aU as nt,aV as rt,aW as it,aX as st,aY as lt,aZ as ct,a_ as dt,a$ as ut,b0 as mt,b1 as pt,b2 as ht,b3 as gt,b4 as ft,b5 as yt,b6 as Et,b7 as _t,b8 as vt,b9 as wt,ba as bt,bb as St,bc as Tt,bd as It,be as kt,bf as Ct,bg as Nt,bh as At,bi as xt,bj as Pt,bk as Rt,bl as Ot,bm as Dt,bn as Lt,bo as Ut,bp as Mt,bq as Ft,br as Bt,bs as Wt,bt as Vt,bu as jt,bv as Ht,bw as Gt,bx as $t,by as Kt,bz as Yt,bA as zt,bB as qt,bC as Jt,bD as Xt,bE as Qt,bF as Zt,bG as ea,bH as ta,bI as aa,bJ as oa,bK as na,bL as ra,bM as ia,bN as sa,bO as la,bP as ca,bQ as da,bR as ua,bS as ma,bT as pa,bU as ha,bV as ga,bW as fa,bX as ya,bY as Ea,bZ as _a,b_ as va,b$ as wa,c0 as ba,c1 as Sa,c2 as Ta,c3 as Ia,c4 as ka,c5 as Ca,c6 as Na,c7 as Aa,c8 as xa,c9 as Pa,ca as Ra,cb as Oa,cc as Da,cd as La,ce as Ua,cf as Ma,cg as Fa,ch as Ba,ci as Wa,cj as Va,ck as ja,cl as Ha,cm as Ga,cn as $a,co as Ka,cp as Ya,cq as za,cr as qa,cs as Ja,ct as Xa}from"./vendor.6b80416b.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Qa={COMMIT:"87bc34b7",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.02.22.2"}.JEST_WORKER_ID,Za={COMMIT:"87bc34b7",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.02.22.2"}.KAPWING_NOTIFICATION_URL,eo=Qa||document.domain.startsWith("localhost");function to(){return"v2023.02.22.2"}function ao(){let e="local";return e="87bc34b7","87bc34b7"}let oo=null;try{oo="undefined"!=typeof window?a():null}catch($ae){console.error($ae)}oo&&oo.listen((e=>{o.pageview(e.pathname)}));const no=oo,ro={plugins:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":{const a=e.map((e=>e.id));return t.pluginName&&!a.includes(t.pluginName)?[...e,{id:t.pluginName,isMediaLibraryUpload:t.isMediaLibraryUpload,idOfLayerToReplace:t.idOfLayerToReplace}]:[...e]}case"CLOSE_PLUGIN":{const a=e.map((e=>e.id));if(t.pluginName&&a.includes(t.pluginName)){const o=a.indexOf(t.pluginName);if(o>-1)return e.splice(o,1),[...e]}return[...e]}case"RESET_EDITOR":return[];default:return e}},pluginOrder:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":return t.pluginName&&!e.includes(t.pluginName)?[...e,t.pluginName]:[...e];case"CLOSE_PLUGIN":if(t.pluginName&&e.includes(t.pluginName)){const a=e.indexOf(t.pluginName);if(a>-1)return e.splice(a,1),[...e]}return[...e];case"PLUGIN_TO_TOP":if(e.includes(t.pluginName)){const a=e.indexOf(t.pluginName);if(a>-1&&a!==e.length-1){const[t]=e.splice(a,1);return[...e,t]}}return[...e];case"RESET_EDITOR":return[];default:return e}}};function io(){if(!globalThis.globalStore)throw new Error("No Global Store Available");const e=globalThis.globalStore,t=e.dispatch,a=e.getState();return{dispatch:t,history:no,get layers(){return function(e){let t=[];const{scenes:a}=e||{};if(a)for(const o of a)t=[...t,...o.layers];return t}(a.studio)},state:a,store:e,subscribe:e.subscribe}}function so(e){const[t,a]=n.exports.useState(1);return n.exports.useEffect((()=>{const t=setInterval((()=>{a((e=>e+1))}),e);return()=>clearInterval(t)}),[e]),t}const lo=[{en:"Afrikaans",label:"Afrikaans (Suid-Afrika)",translateCode:"af",transcriptionVariants:[{en:"Afrikaans",code:"af-ZA",label:"Afrikaans (Suid-Afrika)"}]},{en:"Albanian",label:"shqip (Shqipëri)",translateCode:"sq",transcriptionVariants:[{en:"Albanian",code:"sq-AL",label:"shqip (Shqipëri)"}]},{en:"Amharic",label:"አማርኛ (ኢትዮጵያ)",translateCode:"am",transcriptionVariants:[{en:"Amharic",code:"am-ET",label:"አማርኛ (ኢትዮጵያ)"}]},{en:"Arabic",label:"العربية",translateCode:"ar",transcriptionVariants:[{en:"Arabic",code:"ar-SA",label:"العربية"}]},{en:"Armenian",label:"Հայ (Հայաստան)",translateCode:"hy",transcriptionVariants:[{en:"Armenian",code:"hy-AM",label:"Հայ (Հայաստան)"}]},{en:"Azerbaijani",label:"Azərbaycan (Azərbaycan)",translateCode:"az",transcriptionVariants:[{en:"Azerbaijani",code:"az-AZ",label:"Azərbaycan (Azərbaycan)"}]},{en:"Basque",label:"Euskara (Espainia)",translateCode:"eu",transcriptionVariants:[{en:"Basque",code:"eu-ES",label:"Euskara (Espainia)"}]},{en:"Bengali",label:"বাংলা",translateCode:"bn",transcriptionVariants:[{en:"Bangla",code:"bn-BD",label:"বাংলা (বাংলাদেশ)"},{en:"Bangla",code:"bn-IN",label:"বাংলা (ভারত)"}]},{en:"Bulgarian",label:"Български (България)",translateCode:"bg",transcriptionVariants:[{en:"Bulgarian",code:"bg-BG",label:"Български (България)"}]},{en:"Burmese",label:"ဗမာ (မြန်မာ)",translateCode:"my",transcriptionVariants:[{en:"Burmese",code:"my-MM",label:"ဗမာ (မြန်မာ)"}]},{en:"Catalan",label:"Català (Espanya)",translateCode:"ca",transcriptionVariants:[{en:"Catalan",code:"ca-ES",label:"Català (Espanya)"}]},{en:"Chinese (Simplified)",label:"普通話",translateCode:"zh",transcriptionVariants:[{en:"Chinese, Cantonese ",code:"yue-Hant-HK",label:"粵語"},{en:"Chinese, Mandarin (Simplified)",code:"cmn-Hans-CN",label:"普通话 简体"}]},{en:"Chinese (Traditional)",label:"國語 (台灣)",translateCode:"zh-TW",transcriptionVariants:[]},{en:"Croatian",label:"Hrvatski (Hrvatska)",translateCode:"hr",transcriptionVariants:[{en:"Croatian",code:"hr-HR",label:"Hrvatski (Hrvatska)"}]},{en:"Czech",label:"Čeština (Česká republika)",translateCode:"cs",transcriptionVariants:[{en:"Czech",code:"cs-CZ",label:"Čeština (Česká republika)"}]},{en:"Danish",label:"Dansk (Danmark)",translateCode:"da",transcriptionVariants:[{en:"Danish",code:"da-DK",label:"Dansk (Danmark)"}]},{en:"Dutch",label:"Nederlands (Nederland)",translateCode:"nl",transcriptionVariants:[{en:"Dutch",code:"nl-NL",label:"Nederlands (Nederland)"}]},{en:"English",label:"English",translateCode:"en",transcriptionVariants:[{en:"English",code:"en-AU",label:"English (Australia)"},{en:"English",code:"en",label:"English (Global)"},{en:"English",code:"en-GB",label:"English (United Kingdom)"},{en:"English",code:"en-US",label:"English (United States)"}]},{en:"Estonian",label:"eesti keel (Eesti)",translateCode:"et",transcriptionVariants:[{en:"Estonian",code:"et-EE",label:"eesti keel (Eesti)"}]},{en:"Finnish",label:"Suomi (Suomi)",translateCode:"fi",transcriptionVariants:[{en:"Finnish",code:"fi-FI",label:"Suomi (Suomi)"}]},{en:"French",label:"Français",translateCode:"fr",transcriptionVariants:[{en:"French",code:"fr-FR",label:"Français"}]},{en:"Galician",label:"Galego (España)",translateCode:"gl",transcriptionVariants:[{en:"Galician",code:"gl-ES",label:"Galego (España)"}]},{en:"Georgian",label:"ქართული (საქართველო)",translateCode:"ka",transcriptionVariants:[{en:"Georgian",code:"ka-GE",label:"ქართული (საქართველო)"}]},{en:"German",label:"Deutsch (Deutschland)",translateCode:"de",transcriptionVariants:[{en:"German",code:"de-DE",label:"Deutsch (Deutschland)"}]},{en:"Greek",label:"Ελληνικά (Ελλάδα)",translateCode:"el",transcriptionVariants:[{en:"Greek",code:"el-GR",label:"Ελληνικά (Ελλάδα)"}]},{en:"Gujarati",label:"ગુજરાતી (ભારત)",translateCode:"gu",transcriptionVariants:[{en:"Gujarati",code:"gu-IN",label:"ગુજરાતી (ભારત)"}]},{en:"Hebrew",label:"עברית (ישראל)",translateCode:"he",transcriptionVariants:[{en:"Hebrew",code:"he-IL",label:"עברית (ישראל)"}]},{en:"Hindi",label:"हिन्दी (भारत)",translateCode:"hi",transcriptionVariants:[{en:"Hindi",code:"hi-IN",label:"हिन्दी (भारत)"}]},{en:"Hungarian",label:"Magyar (Magyarország)",translateCode:"hu",transcriptionVariants:[{en:"Hungarian",code:"hu-HU",label:"Magyar (Magyarország)"}]},{en:"Icelandic",label:"Íslenska (Ísland)",translateCode:"is",transcriptionVariants:[{en:"Icelandic",code:"is-IS",label:"Íslenska (Ísland)"}]},{en:"Indonesian",label:"Bahasa Indonesia",translateCode:"id",transcriptionVariants:[{en:"Indonesian",code:"id-ID",label:"Bahasa Indonesia (Indonesia)"}]},{en:"Italian",label:"Italiano (Italia)",translateCode:"it",transcriptionVariants:[{en:"Italian",code:"it-IT",label:"Italiano (Italia)"}]},{en:"Japanese",label:"日本語（日本）",translateCode:"ja",transcriptionVariants:[{en:"Japanese",code:"ja-JP",label:"日本語（日本）"}]},{en:"Javanese",label:"Jawa (Indonesia)",translateCode:"jv",transcriptionVariants:[{en:"Javanese",code:"jv-ID",label:"Jawa (Indonesia)"}]},{en:"Kannada",label:"ಕನ್ನಡ (ಭಾರತ)",translateCode:"kn",transcriptionVariants:[{en:"Kannada",code:"kn-IN",label:"ಕನ್ನಡ (ಭಾರತ)"}]},{en:"Kazakh",label:"қазақ (Қазақстан)",translateCode:"kk",transcriptionVariants:[{en:"Kazakh",code:"kk-KZ",label:"қазақ (Қазақстан)"}]},{en:"Khmer",label:"ភាសាខ្មែរ (កម្ពុជា)",translateCode:"km",transcriptionVariants:[{en:"Khmer",code:"km-KH",label:"ភាសាខ្មែរ (កម្ពុជា)"}]},{en:"Kinyarwanda",label:"Kinyarwanda (Rwanda)",translateCode:"rw",transcriptionVariants:[{en:"Kinyarwanda",code:"rw-RW",label:"Kinyarwanda (Rwanda)"}]},{en:"Korean",label:"한국어 (대한민국)",translateCode:"ko",transcriptionVariants:[{en:"Korean",code:"ko-KR",label:"한국어 (대한민국)"}]},{en:"Lao",label:"ລາວ (ລາວ)",translateCode:"lo",transcriptionVariants:[{en:"Lao",code:"lo-LA",label:"ລາວ (ລາວ)"}]},{en:"Latvian",label:"Latviešu (latviešu)",translateCode:"lv",transcriptionVariants:[{en:"Latvian",code:"lv-LV",label:"Latviešu (latviešu)"}]},{en:"Lithuanian",label:"Lietuvių (Lietuva)",translateCode:"lt",transcriptionVariants:[{en:"Lithuanian",code:"lt-LT",label:"Lietuvių (Lietuva)"}]},{en:"Macedonian",label:"македонски (Северна Македонија)",translateCode:"mk",transcriptionVariants:[{en:"Macedonian",code:"mk-MK",label:"македонски (Северна Македонија)"}]},{en:"Malay",label:"Bahasa Melayu (Malaysia)",translateCode:"ms",transcriptionVariants:[{en:"Malay",code:"ms-MY",label:"Bahasa Melayu (Malaysia)"}]},{en:"Malayalam",label:"മലയാളം (ഇന്ത്യ)",translateCode:"ml",transcriptionVariants:[{en:"Malayalam",code:"ml-IN",label:"മലയാളം (ഇന്ത്യ)"}]},{en:"Marathi",label:"मराठी (भारत)",translateCode:"mr",transcriptionVariants:[{en:"Marathi",code:"mr-IN",label:"मराठी (भारत)"}]},{en:"Mongolian",label:"Монгол (Монгол)",translateCode:"mn",transcriptionVariants:[{en:"Mongolian",code:"mn-MN",label:"Монгол (Монгол)"}]},{en:"Nepali",label:"नेपाली (नेपाल)",translateCode:"ne",transcriptionVariants:[{en:"Nepali",code:"ne-NP",label:"नेपाली (नेपाल)"}]},{en:"Norwegian",label:"Norsk",translateCode:"no",transcriptionVariants:[{en:"Norwegian",code:"no-NO",label:"Norsk bokmål (Norge)"}]},{en:"Persian",label:"فارسی",translateCode:"fa",transcriptionVariants:[{en:"Persian",code:"fa-IR",label:"فارسی (ایران)"}]},{en:"Polish",label:"Polski (Polska)",translateCode:"pl",transcriptionVariants:[{en:"Polish",code:"pl-PL",label:"Polski (Polska)"}]},{en:"Portuguese",label:"Português",translateCode:"pt",transcriptionVariants:[{en:"Portuguese",code:"pt-BR",label:"Português (Brasil)"},{en:"Portuguese",code:"pt-PT",label:"Português (Portugal)"}]},{en:"Punjabi",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)",translateCode:"pa",transcriptionVariants:[{en:"Punjabi",code:"pa-Guru-IN",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)"}]},{en:"Romanian",label:"Română (România)",translateCode:"ro",transcriptionVariants:[{en:"Romanian",code:"ro-RO",label:"Română (România)"}]},{en:"Russian",label:"Русский (Россия)",translateCode:"ru",transcriptionVariants:[{en:"Russian",code:"ru-RU",label:"Русский"}]},{en:"Serbian",label:"Српски (Србија)",translateCode:"sr",transcriptionVariants:[{en:"Serbian",code:"sr-RS",label:"Српски (Србија)"}]},{en:"Sesotho",label:"Sesotho (Afrika Borwa)",translateCode:"st",transcriptionVariants:[{en:"Sesotho",code:"st-ZA",label:"Sesotho (Afrika Borwa)"}]},{en:"Sinhala (Sinhalese)",label:"සිංහල (ශ්රී ලංකාව)",translateCode:"si",transcriptionVariants:[{en:"Sinhala",code:"si-LK",label:"සිංහල (ශ්රී ලංකාව)"}]},{en:"Slovak",label:"Slovenčina (Slovensko)",translateCode:"sk",transcriptionVariants:[{en:"Slovak",code:"sk-SK",label:"Slovenčina (Slovensko)"}]},{en:"Slovenian",label:"Slovenščina (Slovenija)",translateCode:"sl",transcriptionVariants:[{en:"Slovenian",code:"sl-SI",label:"Slovenščina (Slovenija)"}]},{en:"Spanish",label:"Español",translateCode:"es",transcriptionVariants:[{en:"Spanish",code:"es-MX",label:"Español"}]},{en:"Sundanese",label:"Urang (Indonesia)",translateCode:"su",transcriptionVariants:[{en:"Urang",code:"su-ID",label:"Urang (Indonesia)"}]},{en:"Swahili",label:"Swahili",translateCode:"sw",transcriptionVariants:[{en:"Swahili",code:"sw-KE",label:"Swahili (Kenya)"},{en:"Swahili",code:"sw-TZ",label:"Swahili (Tanzania)"}]},{en:"Swedish",label:"Svenska (Sverige)",translateCode:"sv",transcriptionVariants:[{en:"Swedish",code:"sv-SE",label:"Svenska (Sverige)"}]},{en:"Tagalog",label:"Filipino (Pilipinas)",translateCode:"tl",transcriptionVariants:[{en:"Filipino",code:"fil-PH",label:"Filipino (Pilipinas)"}]},{en:"Tamil",label:"தமிழ்",translateCode:"ta",transcriptionVariants:[{en:"Tamil",code:"ta-IN",label:"தமிழ் (இந்தியா)"},{en:"Tamil",code:"ta-MY",label:"தமிழ் (மலேசியா)"},{en:"Tamil",code:"ta-SG",label:"தமிழ் (சிங்கப்பூர்)"},{en:"Tamil",code:"ta-LK",label:"தமிழ் (இலங்கை)"}]},{en:"Telugu",label:"తెలుగు (భారతదేశం)",translateCode:"te",transcriptionVariants:[{en:"Telugu",code:"te-IN",label:"తెలుగు (భారతదేశం)"}]},{en:"Thai",label:"ไทย (ประเทศไทย)",translateCode:"th",transcriptionVariants:[{en:"Thai",code:"th-TH",label:"ไทย (ประเทศไทย)"}]},{en:"Turkish",label:"Türkçe (Türkiye)",translateCode:"tr",transcriptionVariants:[{en:"Turkish",code:"tr-TR",label:"Türkçe (Türkiye)"}]},{en:"Ukrainian",label:"Українська (Україна)",translateCode:"uk",transcriptionVariants:[{en:"Ukrainian",code:"uk-UA",label:"Українська (Україна)"}]},{en:"Urdu",label:"اردو",translateCode:"ur",transcriptionVariants:[{en:"Urdu",code:"ur-IN",label:"اردو (بھارت)"},{en:"Urdu",code:"ur-PK",label:"اردو (پاکستان)"}]},{en:"Uzbek",label:"O'zbek (O'zbekiston)",translateCode:"uz",transcriptionVariants:[{en:"Uzbek",code:"uz-UZ",label:"O'zbek (O'zbekiston)"}]},{en:"Vietnamese",label:"Tiếng Việt (Việt Nam)",translateCode:"vi",transcriptionVariants:[{en:"Vietnamese",code:"vi-VN",label:"Tiếng Việt (Việt Nam)"}]},{en:"Xhosa",label:"IsiXhosa (eMzantsi Afrika)",translateCode:"xh",transcriptionVariants:[{en:"Xhosa",code:"xh-ZA",label:"IsiXhosa (eMzantsi Afrika)"}]},{en:"Zulu",label:"IsiZulu (Ningizimu Afrika)",translateCode:"zu",transcriptionVariants:[{en:"Zulu",code:"zu-ZA",label:"IsiZulu (Ningizimu Afrika)"}]}],co="kapwing-useast1",uo="https://storage.googleapis.com",mo="https://cdn.kapwing.com",po="https://cdn-useast1.kapwing.com",ho=1048576,go=1024*ho,fo=1e3,yo=6e4,Eo=864e5,_o={justForYou20:{discountPercentage:20,activeOnDay:7,expiresOnDay:10},justForYou25:{discountPercentage:25,activeOnDay:10,expiresOnDay:14},justForYou30:{discountPercentage:30,activeOnDay:14,expiresOnDay:21}},vo=Object.keys(_o),wo=200,bo="639a7747d4a7387dad8ae8ff",So="0.6",To="0.6".split(".").map((e=>parseInt(e)));var Io=(e=>(e[e.personal=0]="personal",e[e.team=1]="team",e))(Io||{});const ko="62962eab0af119277ab7c9c3",Co="62d61954f85729d3ec1db3f4",No=["#53E4DC","#F35D93","#FFD53F"],Ao=Object.freeze({failed:-1,pending:0,uploading:1,uploaded:2});Object.freeze({teamImage:0,brandkitMedia:1,brandkitFont:2}),Object.freeze({live:0,videoArchived:1,blobArchived:2});const xo=Object.freeze({public_write:-1,public:0,private:1});var Po=(e=>(e[e.public_write=-1]="public_write",e[e.unlisted=0]="unlisted",e[e.private=1]="private",e))(Po||{});const Ro=Object.freeze({editor:0,admin:1});Object.freeze({public:0,restricted:1});const Oo=Object.freeze({admin:100,free:0,student:"student",teacher:"teacher",googleAppLicenseUser:"googleAppLicenseUser"}),Do=Object.freeze({creator:0,workspaceMember:1,invited:2,pending:3}),Lo=Object.freeze({member:0,owner:1}),Uo="shared-with-me",Mo=100,Fo=100,Bo=100,Wo=100,Vo=0,jo={contrast:100,brightness:100,saturate:100,opacity:100,blurPercent:0};var Ho=(e=>(e.ScheduledMarketingEmail="SME",e))(Ho||{});const Go=10;Object.freeze({write:0,read_only:1}),Object.freeze({stripe:0,paypal:1}),Object.freeze({individual:"individual"}),Object.freeze({stripe:"stripe",paypal:"paypal"});const $o={failed:-1,started:0,completed:1},Ko=0,Yo=1,zo=lo.flatMap((({translateCode:e,transcriptionVariants:t})=>t.map((t=>({en:t.en,code:t.code,label:t.label,translateCode:e}))))).sort(((e,t)=>e.en.localeCompare(t.en))),qo=lo.map((e=>({en:e.en,label:e.label,code:e.translateCode}))),Jo=3,Xo="Untitled Folder",Qo="Studio Draft",Zo=6e4,en=6e4,tn="Trending Now";function an(e,t,a,o){return e<o&&a<t}function on(e){return null!==e}function nn(e){return null!=e}function rn(e){return new Promise((t=>setTimeout(t,e)))}function sn(){return void 0!==Qa}const ln="You might want to add { supportsPortals: true } to your render.",cn=i.exports.useSelector,dn=i.exports.shallowEqual,un=r((e=>e.studio.scenes),(e=>e.some((({layers:e})=>e.some((({type:e})=>"audio"===e||"video"===e)))))),mn=(e,t)=>{let a=0;for(let o=0;o<t;o+=1){const t=e[o];if(!t)break;a+=t.duration}return a};let pn=!1;const hn=e=>{var t,a,o;const n=e.playbackRate||1;let r=0;if(e.isTrimmed){const{endTime:a,startTime:o=0}=e;r=Math.min(a,(null==(t=e.preview)?void 0:t.duration)||a)-o}else e.duration&&(r=(null==(a=e.preview)?void 0:a.duration)||e.duration,(null==(o=e.preview)?void 0:o.duration)&&Math.abs(e.duration-e.preview.duration)>.5&&!pn&&(s("Preview duration very different from original",{extra:{layerId:e.id}}),pn=!0));return r/n};function gn(e){for(const t in e)delete e[t]}function fn(e,t){var a;return null!=(a=e.studioLocal.layerTempValues[t])?a:{}}function yn(e,t){var a;return null!=(a=fn(e,t).isEditing)&&a}function En(e,t){const{idbAssetIds:a}=e.studioLocal;return null!==a&&a.includes(t)}function _n(e){var t;return null==(t=e.studioLocal.layerTempValues.ghost)?void 0:t.mIGhostLayerAbsolutePosition}function vn(e,t){const{draggedTracksOverrides:a}=e.studioLocal;return!!(a||{})[t]}const wn=e=>{const{studioLocal:{lastSyncedWithServer:{attempted:t,firstAttemptSinceLastSuccess:a,succeeded:o},isProjectFetched:n},projectSessionSettings:{viewOnlyMode:r}}=e;if(r)return!1;if(!n)return!1;if(!(t.websocket||t.http))return!1;const i=[o.websocket,o.http].filter(on),s=[a.websocket,a.http].filter(on);if(0===s.length)return!1;if(1===s.length){if(a.websocket&&a.websocket<=(o.http||0))return!1;if(a.http&&a.http<=(o.websocket||0))return!1}const l=i.length>0?Math.max(...i):0;if(Date.now()-l<122e3)return!1;const c=s.length>0?Math.max(...s):0;return Date.now()-c>122e3},bn="media-sidebar",Sn={audio:"Audio",elements:"Elements",emojis:"Emojis",help:"Help",images:"Images",layers:"Layers",media:"Media",more:"More",plugins:"Plugins",record:"Record",scenes:"Scenes",shapes:"Shapes",soundEffects:"Sound Effects",subtitles:"Subtitles",templates:"Templates",text:"Text",transitions:"Transitions",videos:"Videos"},Tn=6,In=12,kn=6,Cn=12,Nn=4,An=8;function xn(){return"chrome"in window}function Pn(){const e=(new l.exports.UAParser).getBrowser().name;return"Chromium"===e||(null==e?void 0:e.startsWith("Chrome"))||!1}function Rn(){return"mobile"===(new l.exports.UAParser).getDevice().type}function On(){return"iOS"===(new l.exports.UAParser).getOS().name}function Dn(){var e;return null==(e=(new l.exports.UAParser).getBrowser().name)?void 0:e.includes("Mobile Safari")}function Ln(){var e;return null==(e=(new l.exports.UAParser).getBrowser().name)?void 0:e.includes("Safari")}function Un(){var e;return null==(e=(new l.exports.UAParser).getBrowser().name)?void 0:e.includes("Firefox")}function Mn(){return["fullscreen","standalone","minimal-ui"].some((e=>window.matchMedia(`(display-mode: ${e})`).matches))}class Fn{static getOS(){return(new l.exports.UAParser).getOS()}static isMac(){var e;return null==(e=(new l.exports.UAParser).getOS().name)?void 0:e.includes("Mac OS")}static isWindows(){var e;return null==(e=(new l.exports.UAParser).getOS().name)?void 0:e.includes("Windows")}static isLinux(){var e;return null==(e=(new l.exports.UAParser).getOS().name)?void 0:e.includes("Linux")}static isChromium(){var e;return null==(e=(new l.exports.UAParser).getOS().name)?void 0:e.includes("Chromium OS")}}const Bn=e=>{var t;return null!=(t=e.projectSessionSettings.hideTimeline)&&t},Wn=e=>{var t;return null==(t=Gn(e,"snapInTimeline"))||t},Vn=e=>{var t,a;const o=Rn();if(e.projectSessionSettings.viewOnlyMode){return(null==(t=e.selectedTabs)?void 0:t["media-sidebar"])===Sn.help}return null!=(a=e.projectSessionSettings.mediaSidebar)?a:!o},jn=e=>{var t;return null!=(t=Gn(e,"rippleMode"))&&t},Hn=e=>{var t;return null!=(t=e.projectSessionSettings.pxInSecond)?t:null};function Gn(e,t){var a,o,n;return e.currentUser.user._id?null==(o=null==(a=e.studio.userSpecificSettings)?void 0:a[e.currentUser.user._id])?void 0:o[t]:null==(n=e.studio.userSpecificSettingsAnonymous)?void 0:n[t]}function $n(e){const{selectedItem:t,groups:a,timelineGap:o,allLayers:n}=e.studio,r=(null==t?void 0:t.id)||"";return a&&a[r]?{type:"group"}:o&&o.gapId===r?{type:"gap"}:n.byId[r]}const Kn=r((e=>e.studio.showCanvas),(e=>e.studio.scenes),((e,t)=>!e&&!t.some((e=>e.layers.length)))),Yn=e=>e.studio.readonly||!!e.projectSessionSettings.viewOnlyMode;function zn(e,t=!1){return{type:"SET_EDIT_HISTORY_INDEX",historyIndex:e,usedUndo:t}}function qn(e){return{type:"SET_EDIT_HISTORY_INDEX_MINIMUM",historyIndexMinimum:e}}const Jn={index:-1,actions:[],batches:[]},Xn={...Jn};function Qn(e){return!!e.func}function Zn(e,t){const{dispatch:a}=io();e&&(t?Qn(e.undo)?e.undo.func(e.undo):a(e.undo):Qn(e.redo)?e.redo.func(e.redo):a(e.redo))}const er=(e,t)=>{tr.add({undo:{func:()=>{t()}},redo:{func:()=>{e()}}})},tr={getState:()=>Xn,setMinimumIndex(e=!0){const{dispatch:t}=io();t(qn(e?Xn.index:-1))},beginBatch(){const{batches:e}=Xn;e.push([])},endBatch(){const{batches:e}=Xn,t=e.pop();null!=t?0!==t.length&&tr.add({undo:{func(){i.exports.batch((()=>{for(let e=t.length-1;e>=0;e-=1){Zn(t[e],!0)}}))},batch:t},redo:{func(){i.exports.batch((()=>{for(let e=0;e<t.length;e+=1){Zn(t[e],!1)}}))},batch:t}}):console.error("Tried to endBatch while no batch is active.")},execInUndoBatch(e){try{this.beginBatch(),e()}catch($ae){console.error($ae)}finally{this.endBatch()}},withUndoBatch(e){return(...t)=>{try{return this.beginBatch(),e(...t)}finally{this.endBatch()}}},withUndoBatchAsync(e){return async(...t)=>{try{return this.beginBatch(),await e(...t)}finally{this.endBatch()}}},add(e){var t;const{actions:a,batches:o,index:n}=Xn,r=o.pop(),i=r||a;let s=null!=(t=null==r?void 0:r.length)?t:n,l=[...i];r||(n!==i.length-1&&(l=i.slice(0,n+1)),i.length>=1e3&&(l=l.slice(1),s-=1),i.length>-1&&(s+=1)),l.push(c(e)),r?o.push(l):(Xn.actions=l,Xn.index=s,or())},canUndo(){const{state:e}=io(),{index:t}=Xn,a=ar();return!(e.studio.overlayMounted||e.studio.disableUndo||e.studio.historyIndexMinimum===t||a&&yn(e,a.id)||"isStudio"in e&&!0!==e.isStudio||t<0||e.projectSessionSettings.viewOnlyMode)},undo(){const{dispatch:e}=io(),{index:t,batches:a}=Xn;if(a.length>0)throw Error("Tried to undo while batch exists.");if(!tr.canUndo())return;const o=t-1;Xn.index=o,Zn(Xn.actions[t],!0),e(zn(o,!0)),or()},canRedo(){const{state:e}=io(),{index:t,actions:a}=Xn,o=ar();return!(e.studio.overlayMounted||e.studio.disableUndo||o&&yn(e,o.id)||"isStudio"in e&&!0!==e.isStudio||t===a.length-1||e.projectSessionSettings.viewOnlyMode)},redo(){const{dispatch:e}=io(),{index:t,batches:a}=Xn;if(a.length>0)throw Error("Tried to redo while batch exists.");const o=t+1;tr.canRedo()&&(Xn.index=o,Zn(Xn.actions[o],!1),e(zn(o,!0)),or())},reset(){const{dispatch:e}=io();Object.assign(Xn,Jn),e(zn(-1)),or()}},ar=()=>{const{state:e}=io(),t=$n(e);return t?"group"===t.type||"gap"===t.type?null:t:null};let or=()=>{setTimeout((()=>{nr.forEach((e=>e()))}),0)};const nr=new Set,rr=()=>{const[e,t]=n.exports.useState(0);n.exports.useEffect((()=>{const e=()=>t((e=>e+1));return nr.add(e),()=>{nr.delete(e)}}),[])},ir=()=>(rr(),tr.canUndo()),sr=()=>(rr(),tr.canRedo());var lr=(e=>(e.PREDELETE_ACCOUNT="PREDELETE_ACCOUNT",e.DELETE_ACCOUNT="DELETE_ACCOUNT",e.CANCEL_PLAN="CANCEL_PLAN",e))(lr||{});const cr=d({name:"hubModal",initialState:{showModal:!1},reducers:{showModal:(e,t)=>{e.showModal=t.payload.hubModalType,e.teamId=t.payload.teamId,e.stripeId=t.payload.stripeId},hideModal:e=>{e.showModal=!1,e.title=void 0,e.subtitle=void 0},setModalTitle:(e,t)=>{e.title=t.payload.title,e.subtitle=t.payload.subtitle}}}),dr=cr.actions,ur=()=>{const{dispatch:e}=io();return e({type:dr.hideModal.type})},mr=(e,t={})=>{var a,o;const{dispatch:n,state:r}=io();if(!t.stripeId){const e=Object.values(r.checkoutStore).filter((e=>e.subscription&&!e.subscription.cancel_at_period_end));1===e.length&&(t.stripeId=null==(o=null==(a=e[0])?void 0:a.subscription)?void 0:o.customer)}return n({type:dr.showModal.type,payload:{hubModalType:e,teamId:t.teamId,stripeId:t.stripeId}})},pr=(e,t)=>{const{dispatch:a}=io();return a({type:dr.setModalTitle.type,payload:{title:e,subtitle:t}})},hr=d({initialState:{},name:"sessionValues",reducers:{setOnboarding:(e,t)=>{e.onboarding=t.payload}},extraReducers:e=>e.addCase("SIGN_OUT",(e=>{gn(e)}))}),{setOnboarding:gr}=hr.actions,fr=["ABeeZee","Abel","Abhaya Libre","Abril Fatface","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akronim","Aladin","Alata","Alatsi","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Aleo","Alex Brush","Alfa Slab One","Alice","Alike","Alike Angular","Allan","Allerta","Allerta Stencil","Allura","Almarai","Almendra","Almendra Display","Almendra SC","Amarante","Amaranth","Amatic SC","Amethysta","Amiko","Amiri","Amita","Anaheim","Andada","Andika","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Arapey","Arbutus","Arbutus Slab","Architects Daughter","Archivo","Archivo Black","Archivo Narrow","Aref Ruqaa","Arima Madurai","Arimo","Arizonia","Armata","Arsenal","Artifika","Arvo","Arya","Asap","Asap Condensed","Asar","Asset","Assistant","Astloch","Asul","Athiti","Atma","Atomic Age","Aubrey","Audiowide","Autour One","Average","Average Sans","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","B612","B612 Mono","Bad Script","Bahiana","Bahianita","Bai Jamjuree","Baloo 2","Baloo Bhai 2","Baloo Bhaina 2","Baloo Chettan 2","Baloo Da 2","Baloo Paaji 2","Baloo Tamma 2","Baloo Tammudu 2","Baloo Thambi 2","Balsamiq Sans","Balthazar","Bangers","Barlow","Barlow Condensed","Barlow Semi Condensed","Barriecito","Barrio","Basic","Baskervville","Battambang","Baumans","Bayon","Be Vietnam","Bebas Neue","Belgrano","Bellefair","Belleza","Bellota","Bellota Text","BenchNine","Bentham","Berkshire Swash","Beth Ellen","Bevan","Big Shoulders Display","Big Shoulders Text","Bigelow Rules","Bigshot One","Bilbo","Bilbo Swash Caps","BioRhyme","BioRhyme Expanded","Biryani","Bitter","Black And White Picture","Black Han Sans","Black Ops One","Blinker","Bokor","Bonbon","Boogaloo","Bowlby One","Bowlby One SC","Brawler","Bree Serif","Bubblegum Sans","Bubbler One","Buda","Buenard","Bungee","Bungee Hairline","Bungee Inline","Bungee Outline","Bungee Shade","Butcherman","Butterfly Kids","Cabin","Cabin Condensed","Cabin Sketch","Caesar Dressing","Cagliostro","Cairo","Caladea","Calistoga","Calligraffitti","Cambay","Cambo","Candal","Cantarell","Cantata One","Cantora One","Capriola","Cardo","Carme","Carrois Gothic","Carrois Gothic SC","Carter One","Catamaran","Caudex","Caveat","Caveat Brush","Cedarville Cursive","Ceviche One","Chakra Petch","Changa","Changa One","Chango","Charm","Charmonman","Chathura","Chau Philomene One","Chela One","Chelsea Market","Chenla","Cherry Cream Soda","Cherry Swash","Chewy","Chicle","Chilanka","Chivo","Chonburi","Cinzel","Cinzel Decorative","Clicker Script","Coda","Coda Caption","Codystar","Coiny","Combo","Comfortaa","Comic Neue","Coming Soon","Concert One","Condiment","Content","Contrail One","Convergence","Cookie","Copse","Corben","Cormorant","Cormorant Garamond","Cormorant Infant","Cormorant SC","Cormorant Unicase","Cormorant Upright","Courgette","Courier Prime","Cousine","Coustard","Covered By Your Grace","Crafty Girls","Creepster","Crete Round","Crimson Pro","Crimson Text","Croissant One","Crushed","Cuprum","Cute Font","Cutive","Cutive Mono","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Damion","Dancing Script","Dangrek","Darker Grotesque","David Libre","Dawning of a New Day","Days One","Dekko","Delius","Delius Swash Caps","Delius Unicase","Della Respira","Denk One","Devonshire","Dhurjati","Didact Gothic","Diplomata","Diplomata SC","Do Hyeon","Dokdo","Domine","Donegal One","Doppio One","Dorsa","Dosis","Dr Sugiyama","Duru Sans","Dynalight","EB Garamond","Eagle Lake","East Sea Dokdo","Eater","Economica","Eczar","El Messiri","Electrolize","Elsie","Elsie Swash Caps","Emblema One","Emilys Candy","Encode Sans","Encode Sans Condensed","Encode Sans Expanded","Encode Sans Semi Condensed","Encode Sans Semi Expanded","Engagement","Englebert","Enriqueta","Epilogue","Erica One","Esteban","Euphoria Script","Ewert","Exo","Exo 2","Expletus Sans","Fahkwang","Fanwood Text","Farro","Farsan","Fascinate","Fascinate Inline","Faster One","Fasthand","Fauna One","Faustina","Federant","Federo","Felipa","Fenix","Finger Paint","Fira Code","Fira Mono","Fira Sans","Fira Sans Condensed","Fira Sans Extra Condensed","Fjalla One","Fjord One","Flamenco","Flavors","Fondamento","Fontdiner Swanky","Forum","Francois One","Frank Ruhl Libre","Freckle Face","Fredericka the Great","Fredoka One","Freehand","Fresca","Frijole","Fruktur","Fugaz One","GFS Didot","GFS Neohellenic","Gabriela","Gaegu","Gafata","Galada","Galdeano","Galindo","Gamja Flower","Gayathri","Gelasio","Gentium Basic","Gentium Book Basic","Geo","Geostar","Geostar Fill","Germania One","Gidugu","Gilda Display","Girassol","Give You Glory","Glass Antiqua","Glegoo","Gloria Hallelujah","Goblin One","Gochi Hand","Gorditas","Gothic A1","Gotu","Goudy Bookletter 1911","Graduate","Grand Hotel","Grandstander","Gravitas One","Great Vibes","Grenze","Grenze Gotisch","Griffy","Gruppo","Gudea","Gugi","Gupter","Gurajada","Habibi","Halant","Hammersmith One","Hanalei","Hanalei Fill","Handlee","Hanuman","Happy Monkey","Harmattan","Headland One","Heebo","Henny Penny","Hepta Slab","Herr Von Muellerhoff","Hi Melody","Hind","Hind Guntur","Hind Madurai","Hind Siliguri","Hind Vadodara","Holtwood One SC","Homemade Apple","Homenaje","IBM Plex Mono","IBM Plex Sans","IBM Plex Sans Condensed","IBM Plex Serif","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Ibarra Real Nova","Iceberg","Iceland","Imprima","Inconsolata","Inder","Indie Flower","Inika","Inknut Antiqua","Inria Sans","Inria Serif","Inter","Irish Grover","Istok Web","Italiana","Italianno","Itim","Jacques Francois","Jacques Francois Shadow","Jaldi","Jim Nightshade","Jockey One","Jolly Lodger","Jomhuria","Jomolhari","Josefin Sans","Josefin Slab","Jost","Joti One","Jua","Judson","Julee","Julius Sans One","Junge","Jura","Just Another Hand","Just Me Again Down Here","K2D","Kadwa","Kalam","Kameron","Kanit","Kantumruy","Karla","Karma","Katibeh","Kaushan Script","Kavivanar","Kavoon","Kdam Thmor","Keania One","Kelly Slab","Kenia","Khand","Khmer","Khula","Kirang Haerang","Kite One","Knewave","KoHo","Kodchasan","Kosugi","Kosugi Maru","Kotta One","Koulen","Kranky","Kreon","Kristi","Krona One","Krub","Kufam","Kulim Park","Kumar One","Kumar One Outline","Kumbh Sans","Kurale","La Belle Aurore","Lacquer","Laila","Lakki Reddy","Lalezar","Lancelot","Lateef","Lato","League Script","Leckerli One","Ledger","Lekton","Lemon","Lemonada","Lexend Deca","Lexend Exa","Lexend Giga","Lexend Mega","Lexend Peta","Lexend Tera","Lexend Zetta","Libre Barcode 128","Libre Barcode 128 Text","Libre Barcode 39","Libre Barcode 39 Extended","Libre Barcode 39 Extended Text","Libre Barcode 39 Text","Libre Baskerville","Libre Caslon Display","Libre Caslon Text","Libre Franklin","Life Savers","Lilita One","Lily Script One","Limelight","Linden Hill","Literata","Liu Jian Mao Cao","Livvic","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Long Cang","Lora","Love Ya Like A Sister","Loved by the King","Lovers Quarrel","Luckiest Guy","Lusitana","Lustria","M PLUS 1p","M PLUS Rounded 1c","Ma Shan Zheng","Macondo","Macondo Swash Caps","Mada","Magra","Maiden Orange","Maitree","Major Mono Display","Mako","Mali","Mallanna","Mandali","Manjari","Manrope","Mansalva","Manuale","Marcellus","Marcellus SC","Marck Script","Margarine","Markazi Text","Marko One","Marmelad","Martel","Martel Sans","Marvel","Mate","Mate SC","Maven Pro","McLaren","Meddon","MedievalSharp","Medula One","Meera Inimai","Megrim","Meie Script","Merienda","Merienda One","Merriweather","Merriweather Sans","Metal","Metal Mania","Metamorphous","Metrophobic","Michroma","Milonga","Miltonian","Miltonian Tattoo","Mina","Miniver","Miriam Libre","Mirza","Miss Fajardose","Mitr","Modak","Modern Antiqua","Mogra","Molengo","Molle","Monda","Monofett","Monoton","Monsieur La Doulaise","Montaga","Montez","Montserrat","Montserrat Alternates","Montserrat Subrayada","Moul","Moulpali","Mountains of Christmas","Mouse Memoirs","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Mukta","Mukta Mahee","Mukta Malar","Mukta Vaani","Mulish","MuseoModerno","Mystery Quest","NTR","Nanum Brush Script","Nanum Gothic","Nanum Gothic Coding","Nanum Myeongjo","Nanum Pen Script","Neucha","Neuton","New Rocker","News Cycle","Niconne","Niramit","Nixie One","Nobile","Nokora","Norican","Nosifer","Notable","Nothing You Could Do","Noticia Text","Noto Sans","Noto Sans HK","Noto Sans JP","Noto Sans KR","Noto Sans SC","Noto Sans TC","Noto Serif","Noto Serif JP","Noto Serif KR","Noto Serif SC","Noto Serif TC","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Numans","Nunito","Nunito Sans","Odibee Sans","Odor Mean Chey","Offside","Old Standard TT","Oldenburg","Oleo Script","Oleo Script Swash Caps","Open Sans","Open Sans Condensed","Oranienbaum","Orbitron","Oregano","Orienta","Original Surfer","Oswald","Over the Rainbow","Overlock","Overlock SC","Overpass","Overpass Mono","Ovo","Oxanium","Oxygen","Oxygen Mono","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Pacifico","Padauk","Palanquin","Palanquin Dark","Pangolin","Paprika","Parisienne","Passero One","Passion One","Pathway Gothic One","Patrick Hand","Patrick Hand SC","Pattaya","Patua One","Pavanam","Paytone One","Peddana","Peralta","Permanent Marker","Petit Formal Script","Petrona","Philosopher","Piazzolla","Piedra","Pinyon Script","Pirata One","Plaster","Play","Playball","Playfair Display","Playfair Display SC","Podkova","Poiret One","Poller One","Poly","Pompiere","Pontano Sans","Poor Story","Poppins","Port Lligat Sans","Port Lligat Slab","Pragati Narrow","Prata","Preahvihear","Press Start 2P","Pridi","Princess Sofia","Prociono","Prompt","Prosto One","Proza Libre","Public Sans","Puritan","Purple Purse","Quando","Quantico","Quattrocento","Quattrocento Sans","Questrial","Quicksand","Quintessential","Qwigley","Racing Sans One","Radley","Rajdhani","Rakkas","Raleway","Raleway Dots","Ramabhadra","Ramaraja","Rambla","Rammetto One","Ranchers","Rancho","Ranga","Rasa","Rationale","Ravi Prakash","Recursive","Red Hat Display","Red Hat Text","Red Rose","Redressed","Reem Kufi","Reenie Beanie","Revalia","Rhodium Libre","Ribeye","Ribeye Marrow","Righteous","Risque","Roboto","Roboto Condensed","Roboto Mono","Roboto Slab","Rochester","Rock Salt","Rokkitt","Romanesco","Ropa Sans","Rosario","Rosarivo","Rouge Script","Rowdies","Rozha One","Rubik","Rubik Mono One","Ruda","Rufina","Ruge Boogie","Ruluko","Rum Raisin","Ruslan Display","Russo One","Ruthie","Rye","Sacramento","Sahitya","Sail","Saira","Saira Condensed","Saira Extra Condensed","Saira Semi Condensed","Saira Stencil One","Salsa","Sanchez","Sancreek","Sansita","Sansita Swashed","Sarabun","Sarala","Sarina","Sarpanch","Satisfy","Sawarabi Gothic","Sawarabi Mincho","Scada","Scheherazade","Schoolbell","Scope One","Seaweed Script","Secular One","Sedgwick Ave","Sedgwick Ave Display","Sen","Sevillana","Seymour One","Shadows Into Light","Shadows Into Light Two","Shanti","Share","Share Tech","Share Tech Mono","Shojumaru","Short Stack","Shrikhand","Siemreap","Sigmar One","Signika","Signika Negative","Simonetta","Single Day","Sintony","Sirin Stencil","Six Caps","Skranji","Slabo 13px","Slabo 27px","Slackey","Smokum","Smythe","Sniglet","Snippet","Snowburst One","Sofadi One","Sofia","Solway","Song Myung","Sonsie One","Sora","Sorts Mill Goudy","Source Code Pro","Source Sans Pro","Source Serif Pro","Space Mono","Spartan","Special Elite","Spectral","Spectral SC","Spicy Rice","Spinnaker","Spirax","Squada One","Sree Krushnadevaraya","Sriracha","Srisakdi","Staatliches","Stalemate","Stalinist One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Stoke","Strait","Stylish","Sue Ellen Francisco","Suez One","Sulphur Point","Sumana","Sunflower","Sunshiney","Supermercado One","Sura","Suranna","Suravaram","Suwannaphum","Swanky and Moo Moo","Syncopate","Syne","Tajawal","Tangerine","Taprom","Tauri","Taviraj","Teko","Telex","Tenali Ramakrishna","Tenor Sans","Text Me One","Thasadith","The Girl Next Door","Tienne","Tillana","Timmana","Tinos","Titan One","Titillium Web","Tomorrow","Trade Winds","Trirong","Trocchi","Trochut","Trykker","Tulpen One","Turret Road","Ubuntu","Ubuntu Condensed","Ubuntu Mono","Ultra","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unkempt","Unlock","Unna","VT323","Vampiro One","Varela","Varela Round","Varta","Vast Shadow","Vesper Libre","Viaoda Libre","Vibes","Vibur","Vidaloka","Viga","Voces","Volkhov","Vollkorn","Vollkorn SC","Voltaire","Waiting for the Sunrise","Wallpoet","Walter Turncoat","Warnes","Wellfleet","Wendy One","Wire One","Work Sans","Yanone Kaffeesatz","Yantramanav","Yatra One","Yellowtail","Yeon Sung","Yeseva One","Yesteryear","Yrsa","ZCOOL KuaiLe","ZCOOL QingKe HuangYou","ZCOOL XiaoWei","Zeyada","Zhi Mang Xing","Zilla Slab","Zilla Slab Highlight"],yr=["Arial","Impact","Comic Sans MS","Bebas Neue","Georgia","Raleway","Nunito","Times New Roman","Lato","Roboto Mono","Roboto Slab","Libre Baskerville","Dancing Script","Fredoka One","Sacramento","Luckiest Guy","Orbitron","Satisfy","Permanent Marker","Playfair Display","Noto Sans","Amatic SC","Days One","Rock Salt","New Rocker","Passion One","Indie Flower","Quicksand","Shadows Into Light","Source Code Pro","Aladin","Calligraffitti","Trebuchet MS","Courier New","Montserrat"],Er=new Set;yr.forEach((e=>{fr.includes(e)||Er.add(e)}));const _r={"B Koodak":"BKoodak.ttf","B Titr":"BTitr.ttf",Nazanin:"Nazanin.ttf","Noto Kufi Arabic":"NotoKufiArabic-Regular.ttf","Noto Naskh Arabic":"NotoNaskhArabicUI-Regular.ttf","Noto Sans Arabic":"NotoSansArabic-Regular.ttf",Yekan:"Yekan.ttf"},vr=[...new Set([...yr,...fr,...Object.keys(_r)])].sort(),wr=new Set(fr),br={};Er.forEach((e=>{br[e]="success"}));const Sr=d({initialState:br,name:"loadedFonts",reducers:{updateFontLoadStatus:(e,t)=>{e[t.payload.font]=t.payload.status}}}),{updateFontLoadStatus:Tr}=Sr.actions;function Ir(e){o.event({category:e,action:e,label:e})}var kr=(e=>(e.Email="email",e.InApp="inApp",e))(kr||{}),Cr=(e=>(e.Export="export",e.Invite="invite",e.Comment="comment",e.Request="request",e.Scheduled="scheduled",e.Joined="joined",e.Welcome="welcome",e))(Cr||{}),Nr=(e=>(e.unsent="unsent",e.sent="sent",e.read="read",e))(Nr||{}),Ar=(e=>(e.project="project",e.folder="folder",e.team="team",e))(Ar||{}),xr=(e=>(e.Audio="audio",e.Image="image",e.Shape="shape",e.Subtitle="subtitle",e.Text="text",e.Video="video",e.Placeholder="placeholder",e.project="project",e))(xr||{}),Pr=(e=>(e.None="none",e.Drop="drop",e.FlickerInGlow="flicker-in-glow",e.FocusIn="focus-in",e.HueRotate="hue-rotate",e.PopInBounce="pop-in-bounce",e.ProgressBar="progress-bar",e.Reveal="reveal",e.SlideUp="slide-up",e.Vibrate="vibrate",e.WipeRectangle="wipe-rectangle",e.BlurIn="blur-in",e.BlurOut="blur-out",e.FadeIn="fade-in",e.FadeOut="fade-out",e.HideIn="hide-in",e.HideOut="hide-out",e.MagicFade="magic-fade",e.MagicFlip="magic-flip",e.MagicWBW="magic-wbw",e))(Pr||{}),Rr=(e=>(e.CrossDissolve="cross-dissolve",e.CrossBlur="cross-blur",e))(Rr||{});function Or(e){return"audio"===e.type}function Dr(e){return"image"===e.type}function Lr(e){return"text"===e.type}function Ur(e){return!!e&&("type"in e&&"video"===e.type)}var Mr=(e=>(e.ACTIVE="active",e.PAST_DUE="past_due",e.PENDING_DOWNGRADE="pending_downgrade",e.CANCELED="canceled",e))(Mr||{});function Fr(e){return"start"in e}function Br(e){const[t]=e;return!!t&&Fr(t)}function Wr(e){const[t]=e.words;return!!t&&Fr(t)}var Vr=(e=>(e[e.AlwaysInvitationOnly=-1]="AlwaysInvitationOnly",e[e.InvitationOnly=0]="InvitationOnly",e[e.RequestToJoin=1]="RequestToJoin",e[e.AnyoneCanJoin=2]="AnyoneCanJoin",e))(Vr||{});function jr(e){return e.type===xr.Audio}function Hr(e){return e.type===xr.Image}function Gr(e){return e.type===xr.Shape&&"progressBar"===e.shapeType}function $r(e){return e.type===xr.Video}function Kr(e){return e.type===xr.Text&&"ttsAudio"in e&&void 0!==e.ttsAudio}function Yr(e){return e.type===xr.Text}function zr(e){return e.type===xr.Shape}function qr(e){return Hr(e)||jr(e)||$r(e)}function Jr(e){return Hr(e)||zr(e)||Yr(e)||$r(e)}function Xr(e){return e.type===xr.Subtitle}function Qr(e){const t=[];return e.forEach((e=>{($r(e)||jr(e)||Kr(e))&&t.push(e)})),t}function Zr(e,t){if(e){const a=e[t];null!=a&&"number"!=typeof a&&(e[t]=Number(a))}}const ei=(e,t=0,a=!1)=>{if(!e||0===Object.keys(e).length)return{start:0,end:0};Zr(e,"startTime"),Zr(e,"endTime"),Zr(e,"duration"),Zr(e,"videoDelay");const o=e.type===xr.Video||e.type===xr.Audio?e.videoDelay||0:e.startTime||0;let n=ti(e)||t;e.loopMode&&"duration"===e.loopMode&&t&&!a&&(n=t);return{start:o,end:n+o}},ti=e=>{const t=e.playbackRate||1;let a=0;return e.isTrimmed?a=e.endTime-e.startTime:e.duration&&(a=e.duration),a/t},ai=e=>e&&0!==Object.keys(e).length?(Zr(e,"globalAlpha"),e.globalAlpha):0,oi=(e,t,a)=>{const{crop:o}=a;let n=e,r=t;if(a.width&&a.height){let e=a.width/a.height;o&&(e*=o.width/o.height),n/r>e?r=n/e:n=r*e,o&&(n*=100/o.width,r*=100/o.height)}return{width:n,height:r}};function ni(e,t){return Math.floor(Math.ceil(100*e*t.maxFramerate)/100)}function ri(e,t,a){const{start:o,end:n}=ei(e,a.duration),r=ni(o,a),i=ni(n,a);return 0===o&&0===n&&0===a.duration||r<=t&&t<i}function ii(e,t,a){const{start:o,end:n}=ei(e,a.duration);return o<=t&&t<n}const si={home:"common-module_home_dwxJm",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_vmec3",largeButton:"common-module_largeButton_ZMjCV",sectionContent:"common-module_sectionContent_RXf2a",sectionHeader:"common-module_sectionHeader_Wp-GR",spacer:"common-module_spacer_dKAl-",chevron:"common-module_chevron_kc7ia",splashText:"common-module_splashText_si5Bf",splashSubtext:"common-module_splashSubtext_hi-6Y",aboutSection:"common-module_aboutSection_gbps9",mobile:"common-module_mobile_zBvYh",desktop:"common-module_desktop_TC-Uw",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_K9b41",disabled:"common-module_disabled_UJAXz",noScrollBar:"common-module_noScrollBar_fcjeZ",textOverflowEllipsis:"common-module_textOverflowEllipsis_XXKqM",genericButtonBlue:"common-module_genericButtonBlue_AEzLO",button:"common-module_button_xffcT",buttonDisabled:"common-module_buttonDisabled_IFyWt",buttonSelected:"common-module_buttonSelected_Ynozr",buttonOk:"common-module_buttonOk_Mxmkv",buttonStacked:"common-module_buttonStacked_J-0Fc",doneButton:"common-module_doneButton_rJmqx",desktopNoWrap:"common-module_desktopNoWrap_RFpGQ",mobileNoWrap:"common-module_mobileNoWrap_Yzb8i",controlSectionContainer:"common-module_controlSectionContainer_7gwIs",section:"common-module_section_tLwa-",input:"common-module_input_YbU5B",cyanDoneButton:"common-module_cyanDoneButton_pVp-o",cyanDoneButton__disabled:"common-module_cyanDoneButton__disabled_dV8Rs",cyanDoneButtonContainer:"common-module_cyanDoneButtonContainer_gG-ju",genericButton:"common-module_genericButton_bMQdF",genericButtonSelected:"common-module_genericButtonSelected_neH99",controlContainer:"common-module_controlContainer_eCKXo",groupControlContainer:"common-module_groupControlContainer_Ey5GV",controlSectionRows:"common-module_controlSectionRows_JRA98",controlSectionRowsTimeline:"common-module_controlSectionRowsTimeline_IfCRi",controlSectionRowsTwoPerRow:"common-module_controlSectionRowsTwoPerRow_uBMyX",controlSectionRowsExpandChildren:"common-module_controlSectionRowsExpandChildren_3U8le",controlSectionRowsFullWidth:"common-module_controlSectionRowsFullWidth_eQl5U",controlSectionRowsNoWrap:"common-module_controlSectionRowsNoWrap_qtGru",controlSectionRowsNoPadding:"common-module_controlSectionRowsNoPadding_eyQne",controlSectionRowsIconAndControl:"common-module_controlSectionRowsIconAndControl_WfBUs",controlSectionWrapColumns:"common-module_controlSectionWrapColumns_RbiTX",controlSectionScrollableColumn:"common-module_controlSectionScrollableColumn_Ggc8c",controlSectionTitle:"common-module_controlSectionTitle_eK-7P",controlSectionTitleNoPadding:"common-module_controlSectionTitleNoPadding_wYK6s",controlSectionDescription:"common-module_controlSectionDescription_g3zFo",smallControlButton:"common-module_smallControlButton_66vuT",smallControlButtonDisabled:"common-module_smallControlButtonDisabled_y37ZO",smallControlButtonSelected:"common-module_smallControlButtonSelected_Ljg8h",smallControlButtonLabel:"common-module_smallControlButtonLabel_snP0-",controlSectionRow:"common-module_controlSectionRow_u6iL8",controlButtonIcon:"common-module_controlButtonIcon_M-TfZ",controlButtonOnlyIcon:"common-module_controlButtonOnlyIcon_fPWdJ",controlButtonOnlyIconRoundedSmallTheme:"common-module_controlButtonOnlyIconRoundedSmallTheme_CWvZU",bigOverlayButton:"common-module_bigOverlayButton_xX5iR",bigOverlayButtonSelected:"common-module_bigOverlayButtonSelected_-Wj3h",bigOverlayButtonDisabled:"common-module_bigOverlayButtonDisabled_l7MKa",bigOverlayButtonIcon:"common-module_bigOverlayButtonIcon_eIKka",incrementDecrementControl:"common-module_incrementDecrementControl_2Gekm",incrementDecrementControlLightTheme:"common-module_incrementDecrementControlLightTheme_jDQCZ",incrementDecrementControlSmallTheme:"common-module_incrementDecrementControlSmallTheme_J08Hq",incrementDecrementControlExtraSmallTheme:"common-module_incrementDecrementControlExtraSmallTheme_y-tuh",incrementDecrementButton:"common-module_incrementDecrementButton_gr5Cg",incrementDecrementButtonLightTheme:"common-module_incrementDecrementButtonLightTheme_4A7Ux",incrementDecrementButtonSmallTheme:"common-module_incrementDecrementButtonSmallTheme_o--rH",incrementDecrementControlValue:"common-module_incrementDecrementControlValue_GbQCR",incrementDecrementControlValueSmallTheme:"common-module_incrementDecrementControlValueSmallTheme_vk7eF",incrementControl:"common-module_incrementControl_nJorQ",decrementControl:"common-module_decrementControl_m0KqN",disabledIncrementDecrementButton:"common-module_disabledIncrementDecrementButton_R3Vsm",controlSliderContainer:"common-module_controlSliderContainer_h9KiM",controlSlider:"common-module_controlSlider_d0JZw",controlSliderTicks:"common-module_controlSliderTicks_N1o6z",controlSliderTick:"common-module_controlSliderTick_xg-CY",tooltip:"common-module_tooltip_IEcJR",selectDropDownContainer:"common-module_selectDropDownContainer_NlKZJ",selectDropDownDisplay:"common-module_selectDropDownDisplay_HFrQe",selectDropDownLabel:"common-module_selectDropDownLabel_gFBNq",selectDropDownLink:"common-module_selectDropDownLink_Yjwua",selectDropDownList:"common-module_selectDropDownList_7W4-g",selectDropDownItem:"common-module_selectDropDownItem_KByJA",bottomDivider:"common-module_bottomDivider_mOCEg",selectDropDownItemSelected:"common-module_selectDropDownItemSelected_77MOH",selectDropDownShowing:"common-module_selectDropDownShowing_5vpeC",dropDownButtonIcon:"common-module_dropDownButtonIcon_9RNVn",selectOptionIcon:"common-module_selectOptionIcon_XBQgr",transparentSelectInput:"common-module_transparentSelectInput_KUrCa",selectOptionContainer:"common-module_selectOptionContainer_6qHq3",dropDownHeader:"common-module_dropDownHeader_Gmc9r",noMargin:"common-module_noMargin_JdSFY",halfWidth:"common-module_halfWidth_y05xy",fullWidth:"common-module_fullWidth_X1atg",selectDropDownIcon:"common-module_selectDropDownIcon_TQcn4",controlButtonsContainer:"common-module_controlButtonsContainer_6EXgl",loadingIcon:"common-module_loadingIcon_Rj4Hi",spin:"common-module_spin_YSTXy",iconAndLabelRow:"common-module_iconAndLabelRow_tMdJT",dropdownDirectInput:"common-module_dropdownDirectInput_m4-FD"},li=.7,ci=600.5,di=[.7,1.3,2.8,5.3,10,20,40,85,150,600.5];function ui(e){let t=0,a=Number.MAX_SAFE_INTEGER;return di.forEach(((o,n)=>{const r=Math.abs(o-e);r<a&&(t=n,a=r)})),t}const mi=({isMobile:e,pxInSecond:t,setPxInSecond:a})=>{const o=null!=t?t:di[0],[r,i]=n.exports.useState(ui(o));n.exports.useEffect((function(){i(ui(o))}),[o]);const s=e=>{const t=[.2,.4,.5,1,1,10,10,10,100,100];let n=null!=o?o:.7;if(o)if(o<.7&&1===e)a(.7);else if(.7!==o||-1!==e)if(o>600.5&&-1===e)a(600.5);else if(600.5!==o||1!==e){for(let a=0;a<di.length-1;a+=1){const r=di[a],i=di[a+1];if(r<o&&o<i||o===r||o===i){n+=t[a]*e;break}}a(n)}},l=n.exports.useMemo((()=>u((e=>a(e)),30)),[a]);return m.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},m.createElement(p,{"data-cy":"zoom-out",size:24,onClick:()=>s(-1),style:{marginLeft:8,cursor:"pointer"}}),!e&&m.createElement("div",null,m.createElement("input",{className:si.controlSlider,"data-cy":"zoom-slider",max:di.length-1,min:0,onChange:e=>{const t=parseFloat(e.target.value);i(t),l(di[t])},step:1,type:"range",value:r})),m.createElement(h,{"data-cy":"zoom-in",size:24,onClick:()=>s(1),style:{marginLeft:4,marginRight:5,cursor:"pointer"}}))};const pi=new class{constructor(){t(this,"_queued",[]),t(this,"_pending",{})}clear(){this._pending={},this._queued=[]}getAllPendingOps(){return Object.values(this._pending)}push(e){this._queued.push(e),"presence"!==e.p[0]&&(this._pending[e.__localMd.id]=e)}dequeueAll(){return this._queued.splice(0)}removePending(e){delete this._pending[e.__localMd.id]}toJSON(){}},hi={pendingOps:pi},gi=d({initialState:hi,name:"projectSessionSettings",reducers:{showOverlayWithKey:(e,t)=>{e.overlay=t.payload},hideOverlay:e=>{e.overlay=null},setMediaSidebar:(e,t)=>{e.mediaSidebar=t.payload},setHideTimeline:(e,t)=>{e.hideTimeline=t.payload},setViewOnlyMode:(e,t)=>{e.viewOnlyMode=t.payload},updateTimelinePosition:(e,t)=>{e.timelinePosition=t.payload},setPxInSecond:(e,t)=>{t.payload<=600.5?e.pxInSecond=t.payload:e.pxInSecond=600.5},setCopiedModifications:(e,t)=>{e.copiedModifications=t.payload},setPreservedTextOptions:(e,t)=>{e.preservedTextOptions=t.payload},setSessionSettings:(e,t)=>{var a;gn(e),Object.assign(e,t.payload),pi.clear();for(const o of null!=(a=t.payload.offlineOps)?a:[])pi.push(o);e.pendingOps=pi},logAddLayer:e=>{e.addLayerLogged?e.addLayerLogged+=1:e.addLayerLogged=1},logSplitVideo:e=>{e.splitsLogged?e.splitsLogged+=1:e.splitsLogged=1},logUsedTrimmer:(e,t)=>{const a=t.payload;if(e.trimsLogged){const t=e.trimsLogged[a]||0;e.trimsLogged={...e.trimsLogged,[a]:t+1}}else e.trimsLogged={[a]:1}},addPendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds||(e.pendingUploadMediaCacheIds=[]),e.pendingUploadMediaCacheIds.includes(t.payload)||e.pendingUploadMediaCacheIds.push(t.payload)},removePendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds&&(e.pendingUploadMediaCacheIds=e.pendingUploadMediaCacheIds.filter((e=>e!==t.payload)))},setDraftEmailRef:(e,t)=>{e.draftEmailRef=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":case"JEST_CLEAR_STORE":return pi.clear(),{...hi};case"SET_STUDIO":return t.projectIdChanged?(pi.clear(),{...hi}):e;default:return e}}))}),{addPendingUpload:fi,hideOverlay:yi,logAddLayer:Ei,logSplitVideo:_i,logUsedTrimmer:vi,removePendingUpload:wi,setCopiedModifications:bi,setDraftEmailRef:Si,setHideTimeline:Ti,setMediaSidebar:Ii,setPxInSecond:ki,setPreservedTextOptions:Ci,setSessionSettings:Ni,setViewOnlyMode:Ai,showOverlayWithKey:xi,updateTimelinePosition:Pi}=gi.actions,Ri=.05625,Oi=.6,Di="#0083e2",Li="bar",Ui="40%",Mi="100%",Fi="30%",Bi=1920,Wi=1280,Vi=3e3,ji=10,Hi=325,Gi=280,$i=854,Ki=100,Yi=["#0083e2","#a15164","#11dabf","#79d304","#0936b1","#034748","#74be2f","#886F68","#E34A6F","#FFBA08","#D00000","#75DDDD","#4B2E39","#6E9075","#f7c306","#d4ae12","#074c5a","#07d86f","#d1680c","#04248b","#7d8aee"];function zi(e,t){return{type:"ADD_ANIMATION",animationInstance:e,undoable:t}}function qi(e,t){return{type:"UPDATE_ANIMATION",animationId:e,layerAnim:t,undoable:!0}}function Ji(e,t){return{type:"DELETE_ANIMATION",animationId:e,undoable:t}}function Xi({layers:e,layerIndex:t,isUndoable:a=!1,fromUndo:o=!1}){return{type:"ADD_LAYERS",layers:e,layerIndex:t,isUndoable:a,fromUndo:o}}function Qi(e,t){return{type:"ADD_SUBTITLE_LAYERS",subtitles:e,sceneIndex:t}}function Zi(e,t,a){return{type:"REMOVE_LAYER",layer:e,source:t,undoable:a}}function es(e,t,a,o,n,r){return{type:"RESIZE_LAYER",layer:e,x:t,y:a,width:o,height:n,undoable:r}}function ts(e,t,a,o,n,r,i,s){return{type:"RESIZE_LINE_LAYER",layer:e,x:t,y:a,width:o,height:n,linePointStartCorner:r,lineRightAngle:i,undoable:s}}function as(e,t,a){return{type:"SET_SCALE",layer:e,scaleX:t,scaleY:a}}function os(e,t,a){return{type:"SET_STUDIO_ROTATION",layer:e,rotation:t,undoable:a}}function ns(e,t,a){return{type:`SET_STUDIO_FLIP_${{x:"HORIZONTAL",y:"VERTICAL"}[t]}`,layer:e,axis:t,undoable:a}}function rs(e,t,a,o){return{type:"REPOSITION_LAYER",layer:e,x:t,y:a,undoable:o}}function is(e,t){return{type:"BRING_LAYER_FORWARD",layer:e,undoable:t}}function ss(e,t){return{type:"SEND_LAYER_BACK",layer:e,undoable:t}}function ls(e,t,a){return{type:"MOVE_LAYER_TO_INDEX",layer:e,targetIndex:t,undoable:a}}function cs(e,t){return{type:"ENHANCE_LAYER",assetId:e,enhanceJobId:t}}function ds(e,t,a,o){return setTimeout((()=>{(()=>{var e,t,a,o;const{dispatch:n,state:r}=io(),i=r.studio.allLayers.byId[null!=(t=null==(e=r.studio.selectedItem)?void 0:e.id)?t:""];if(!(null==i?void 0:i.fromTextDefaults)&&i&&"text"===i.type){const e={backgroundColor:i.backgroundColor,borderRadius:i.borderRadius,color:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,baseWidth:i.baseWidth,baseHeight:i.baseHeight,fontWeight:i.fontWeight,globalAlpha:i.globalAlpha,lineHeight:i.lineHeight,lockAspectRatio:i.lockAspectRatio,italic:i.italic,textAlign:i.textAlign,textShadow:i.textShadow,width:null==(a=i.position)?void 0:a.width,height:null==(o=i.position)?void 0:o.height,underline:i.underline,wrapOrFill:i.wrapOrFill,textPadding:i.textPadding};n(Ci(e))}})()}),0),{type:"UPDATE_LAYER",layer:e,properties:t,initialProperties:o,undoable:a}}function us(e,t,a){return{type:"UPDATE_LAYERS",layers:e,sceneIndex:t,undoable:a}}function ms(e){return{type:"SELECT_TRANSITION",payload:e,undoable:!1}}function ps(e,t=null){return{type:"UPDATE_CLIPBOARD",clipboard:e,clipboardCopyId:t}}function hs(e){return{type:"SHOW_SNAP_LINES",lines:e}}function gs(e,t,a,o){return fs([e],t,a,o)}function fs(e,t,a,o){return{type:"ADD_LAYERS_TO_GROUP",layerIds:e,groupId:t,isTimelineGroup:a,undoable:o}}function ys(e,t,a){return function(e,t,a){return{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:e,groupId:t,undoable:a}}([e],t,a)}function Es(e,t,a){return{type:"SAVE_LAYER_GROUP",groupId:e,saved:t,undoable:a}}function _s(e,t,a,o,n){return{type:"SET_TIMELINE_GAP",gapId:e,startTime:t,duration:a,timelineRow:o,undoable:n}}function vs(e){return{type:"SET_SELECTED_TIMELINE_ROWS",timelineRows:e}}function ws(e){return{type:"ADD_SELECTED_TIMELINE_ROWS",timelineRows:e}}function bs(){return{type:"UPDATE_SELECTED_TIMELINE_ROWS"}}function Ss(e){return{type:"SET_LAYER_DUPLICATED",layerDuplicated:e}}function Ts(){return{type:"SORT_SUBTITLE_LAYERS"}}function Is(e,t=!1){return{type:"SELECT_ITEM",item:e,undoable:t}}function ks(e){return e.type===xr.Video}var Cs=(e=>(e[e.unstarted=0]="unstarted",e[e.errored=1]="errored",e[e.inProgress=2]="inProgress",e[e.onGCSUploadFinish=3]="onGCSUploadFinish",e[e.createAsset=4]="createAsset",e[e.assetCreated=5]="assetCreated",e[e.runConversion=6]="runConversion",e[e.addPendingConversion=7]="addPendingConversion",e[e.updateCompletedUploadInIDB=8]="updateCompletedUploadInIDB",e[e.handleFinish=9]="handleFinish",e[e.done=10]="done",e))(Cs||{}),Ns=(e=>(e.PreExtractValidation="Pre-Extraction Validation",e.Extraction="Extraction",e.ExtractionValidation="Extraction Validation",e.AssetCreation="Asset Creation",e.LayerCreation="Layer Creation",e.HandleFinish="Handle Finish",e.Finish="Finish",e))(Ns||{}),As=(e=>(e.trim="trim",e.smartCut="smart_cut",e.sceneSplit="scene_split",e))(As||{}),xs=(e=>(e.Studio="studio",e.Export="export",e))(xs||{}),Ps=(e=>(e.Command="command",e.Shift="shift",e.Control="control",e.Option="option",e.Alt="alt",e))(Ps||{}),Rs=(e=>(e.background="background",e.gap="gap",e.layer="layer",e.row="row",e.track="track",e.trackpad="trackpad",e))(Rs||{}),Os=(e=>(e.CML_FILE="CML_FILE",e.SIDEBAR_IMAGE="SIDEBAR_IMAGE",e.SIDEBAR_VIDEO="SIDEBAR_VIDEO",e.TRANSITION_TILE="TRANSITION_TILE",e.UPLOADING_LAYER="UPLOADING_LAYER",e))(Os||{}),Ds=(e=>(e.EyedropperMode="eyedropperMode",e.ImageExport="imageExport",e.Thumbnail="thumbnail",e.None="none",e))(Ds||{});const Ls=g("setElementPoolContainerMounted");var Us=(e=>(e.ADD_IDB_ASSET_IDS="ADD_IDB_ASSET_IDS",e.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION="ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",e.ALT_IS_BEING_PRESSED="ALT_IS_BEING_PRESSED",e.CLEAR_DRAG_PREVIEW_DISPLACEMENTS="CLEAR_DRAG_PREVIEW_DISPLACEMENTS",e.CLEAR_IDB_ASSET_IDS="CLEAR_IDB_ASSET_IDS",e.COMMAND_IS_BEING_PRESSED="COMMAND_IS_BEING_PRESSED",e.CONTROL_IS_BEING_PRESSED="CONTROL_IS_BEING_PRESSED",e.REMOVE_IDB_ASSET_ID="REMOVE_IDB_ASSET_ID",e.SET_BOX_SELECTED_IDS="SET_BOX_SELECTED_IDS",e.SET_DRAG_PREVIEW_DISPLACEMENTS="SET_DRAG_PREVIEW_DISPLACEMENTS",e.SET_DRAGGED_TRACKS_OVERRIDES="SET_DRAGGED_TRACKS_OVERRIDES",e.SET_IDB_ASSET_IDS="SET_IDB_ASSET_IDS",e.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE="SET_INITIAL_IDB_ASSET_ID_LOAD_DONE",e.SET_IS_NEW_PROJECT="SET_IS_FIRST_EDIT",e.SET_LOCAL_LAYER_VALUES="SET_LOCAL_LAYER_VALUE",e.BATCHED_SET_LOCAL_LAYER_VALUES="BATCHED_SET_LOCAL_LAYER_VALUES",e.SET_IS_INLINE_CROPPING="SET_IS_INLINE_CROPPING",e.SET_MEDIA_ITEM_DRAG_OFFSET="SET_MEDIA_ITEM_DRAG_OFFSET",e.SET_MEDIA_ITEM_GHOST_TRACK="SET_MEDIA_ITEM_GHOST_TRACK",e.SET_MEDIA_ITEM_LOCATION="SET_MEDIA_ITEM_LOCATION",e.SET_MEDIA_LIBRARY_SELECTED_TAB="SET_MEDIA_LIBRARY_SELECTED_TAB",e.SET_MOUSE_DOWN="SET_MOUSE_DOWN",e.SET_PROJECT_FETCHED="SET_PROJECT_FETCHED",e.SET_SELECTED_EDITOR_PANE="SET_SELECTED_EDITOR_PANE",e.SET_SHADOW_INFOS="SET_SHADOW_INFOS",e.SET_SHOW_TRANSCRIBE="SET_SHOW_TRANSCRIBE",e.SET_SNAP_TIMELINE_TO_SEEKER="SET_SNAP_TIMELINE_TO_SEEKER",e.SET_STUDIO_DRAG_DROP_ACTIVE="SET_STUDIO_DRAG_DROP_ACTIVE",e.SET_TIMELINE_CONTAINER_HEIGHT="SET_TIMELINE_CONTAINER_HEIGHT",e.SET_TIMELINE_CONTAINER_WIDTH="SET_TIMELINE_CONTAINER_WIDTH",e.SET_TRACK_THUMBNAIL_FALLBACK="SET_TRACK_THUMBNAIL_FALLBACK",e.SET_VOLUME_SLIDER_IS_DRAGGING="SET_VOLUME_SLIDER_IS_DRAGGING",e.SHIFT_IS_BEING_PRESSED="SHIFT_IS_BEING_PRESSED",e.START_EDITING_TEXT_LAYER="START_EDITING_TEXT_LAYER",e.UPDATE_SHADOW_INFOS="UPDATE_SHADOW_INFOS",e.SET_INFO_TOAST_SHOWN_THIS_SESSION="SET_INFO_TOAST_SHOWN_THIS_SESSION",e.SET_PREVIEW_PLAYING="SET_PREVIEW_PLAYING",e.SET_MEDIA_SIDEBAR_SELECTED_TAB="SET_MEDIA_SIDEBAR_SELECTED_TAB",e.SHOW_SIGN_IN="SHOW_SIGN_IN",e.HIDE_SIGN_IN="HIDE_SIGN_IN",e.SET_AWAITING_RECORDINGS="SET_AWAITING_RECORDINGS",e.SET_MORE_OVERLAY_OFFSET="SET_MORE_OVERLAY_OFFSET",e.SET_PREVIEW_TRACK="SET_PREVIEW_TRACK",e.SET_PREVIEW_TIMELINE_STATE="SET_PREVIEW_TIMELINE_STATE",e.SET_ROW_UPLOAD_IN_PROGRESS="SET_ROW_UPLOAD_IN_PROGRESS",e.CLEAR_PROJECT_FETCHED="CLEAR_PROJECT_FETCHED",e.SET_GHOST_SEEKER_OFFSET="SET_GHOST_SEEKER_OFFSET",e.SET_STATIC_UPLOAD_IDS="SET_STATIC_UPLOAD_IDS",e.SET_MOBILE_TRAY_CONTENT="SET_MOBILE_TRAY_CONTENT",e.SET_GROUP_DRAG_OVERRIDES="SET_GROUP_DRAG_OVERRIDES",e.CLEAR_GROUP_DRAG_OVERRIDES="CLEAR_GROUP_DRAG_OVERRIDES",e.SYNC_ATTEMPTED="SYNC_ATTEMPTED",e.SYNC_SUCCEEDED="SYNC_SUCCEEDED",e.SET_IS_ADDING="SET_IS_ADDING",e.PLAYBACK_RATE="PLAYBACK_RATE",e.UPDATE_MAGIC_SUBTITLE_LOCAL="UPDATE_MAGIC_SUBTITLE_LOCAL",e.RESIZE_MEDIABAR="RESIZE_MEDIABAR",e.RESIZING_MEDIABAR="RESIZING_MEDIABAR",e.UPDATE_LAST_GENERATED_THUMBNAIL="UPDATE_LAST_GENERATED_THUMBNAIL",e.SET_SHOW_REPORT_ISSUE_MODAL="SET_SHOW_REPORT_ISSUE_MODAL",e.SET_LOCAL_MAGIC_SUBTITLE_FRAMES="SET_LOCAL_MAGIC_SUBTITLE_FRAMES",e.SET_LAYER_MOUNTED_STATE="SET_LAYER_MOUNTED_STATE",e.SET_ASSET_MONITOR_ID="SET_ASSET_MONITOR_ID",e))(Us||{});function Ms(e,t){return{type:"SET_LOCAL_LAYER_VALUE",layerId:e,properties:t}}const Fs=(e,t)=>({type:"SET_IS_INLINE_CROPPING",layerId:e,isInlineCropping:t});function Bs(){return{type:"SET_PROJECT_FETCHED"}}function Ws(){return{type:"CLEAR_PROJECT_FETCHED"}}function Vs(e){const{dispatch:t}=io();return t(ms(null)),{type:"SET_SELECTED_EDITOR_PANE",selectedEditorPane:e}}function js(e){return{showTranscribe:e,type:"SET_SHOW_TRANSCRIBE"}}function Hs(e){return{type:"SET_SNAP_TIMELINE_TO_SEEKER",snapTimelineToSeeker:e}}function Gs(e){return{studioDragDropActive:e,type:"SET_STUDIO_DRAG_DROP_ACTIVE"}}function $s(e){return{type:"SET_SHADOW_INFOS",shadowInfos:e}}function Ks(e){return{type:"UPDATE_SHADOW_INFOS",shadowInfos:e}}function Ys(e){return{type:"SET_DRAGGED_TRACKS_OVERRIDES",overrides:e}}function zs(e,t){let a;switch(e){case Ps.Command:a="COMMAND_IS_BEING_PRESSED";break;case Ps.Shift:a="SHIFT_IS_BEING_PRESSED";break;case Ps.Control:a="CONTROL_IS_BEING_PRESSED";break;case Ps.Option:default:a="ALT_IS_BEING_PRESSED"}return{type:a,isPressed:t}}function qs(e){return{type:"ADD_IDB_ASSET_IDS",idbAssetIds:e}}function Js(e){return{type:"SET_VOLUME_SLIDER_IS_DRAGGING",isDragging:e}}function Xs(e){return{type:"SET_TIMELINE_CONTAINER_HEIGHT",height:e}}function Qs(e){return{type:"SET_TIMELINE_CONTAINER_WIDTH",width:e}}function Zs(e){return{type:"SET_MEDIA_ITEM_GHOST_TRACK",track:e}}function el(e){return{type:"SET_MEDIA_ITEM_LOCATION",location:e}}function tl(e){return{type:"SET_TRACK_THUMBNAIL_FALLBACK",mediaCacheId:e}}const al=g("SET_INITIAL_IDB_ASSET_ID_LOAD_DONE"),ol=g("SET_IS_FIRST_EDIT"),nl=g("START_EDITING_TEXT_LAYER"),rl=g("SET_MEDIA_SIDEBAR_SELECTED_TAB");const il=g("SET_MOUSE_DOWN"),sl=g("CLEAR_DRAG_PREVIEW_DISPLACEMENTS"),ll=g("SET_DRAG_PREVIEW_DISPLACEMENTS"),cl=g("SET_INFO_TOAST_SHOWN_THIS_SESSION"),dl=g("SET_PREVIEW_PLAYING");function ul(){return{type:"SHOW_SIGN_IN"}}const ml=g("SET_AWAITING_RECORDINGS"),pl=g("SET_MORE_OVERLAY_OFFSET");function hl(e){return{type:"SET_PREVIEW_TIMELINE_STATE",timelineState:e}}const gl=g("SET_PREVIEW_TRACK"),fl=g("SET_ROW_UPLOAD_IN_PROGRESS"),yl=g("SET_GHOST_SEEKER_OFFSET"),El=g("SET_STATIC_UPLOAD_IDS"),_l=g("SET_MOBILE_TRAY_CONTENT"),vl=g("SET_BOX_SELECTED_IDS"),wl=g("SET_GROUP_DRAG_OVERRIDES"),bl=g("CLEAR_GROUP_DRAG_OVERRIDES"),Sl=g("SYNC_ATTEMPTED"),Tl=g("SYNC_SUCCEEDED"),Il=g("SET_IS_ADDING"),kl=g("PLAYBACK_RATE"),Cl=g("UPDATE_MAGIC_SUBTITLE_LOCAL"),Nl=g("RESIZE_MEDIABAR"),Al=g("RESIZING_MEDIABAR");function xl(){return{type:"UPDATE_LAST_GENERATED_THUMBNAIL"}}const Pl=g("SET_SHOW_REPORT_ISSUE_MODAL"),Rl=g("SET_LOCAL_MAGIC_SUBTITLE_FRAMES"),Ol=g("SET_LAYER_MOUNTED_STATE"),Dl=g("SET_ASSET_MONITOR_ID"),Ll=e=>e&&e.replace(/.*\/studio/,"/studio"),Ul=e=>{const{state:t}=io();let a="";t&&t.isStudio&&t.studio&&t.studio._id&&jl()&&(a=t.studio._id);const o=Ll(e);return a?`/${a}${o}`:o},Ml=(e,t={})=>{const a=Ul(e);a!==no.location.pathname&&no.push(a,{properties:t})},Fl=()=>{no.goBack()},Bl=e=>{const t=Ul(e);t!==no.location.pathname&&no.replace(t)},Wl=()=>-1!==window.location.pathname.indexOf("/studio/editor/subtitle-overlay"),Vl=()=>-1!==window.location.pathname.indexOf("/studio/editor/export-as-image"),jl=()=>-1!==window.location.pathname.indexOf("/studio/editor"),Hl=()=>jl()&&!Wl()&&!Vl(),Gl=()=>-1!==window.location.pathname.indexOf("/studio");function $l(){Ml("/studio/editor")}function Kl(){Bl("/studio/editor")}function Yl(){const{dispatch:e}=io();$l(),e(Ii(!1)),e(pl(null))}function zl(e,t){const{dispatch:a,state:o}=io(),n=o.studioLocal.layerTempValues[e];if(n){for(const[r,i]of Object.entries(t))if(i!==n[r]){a(Ms(e,t));break}}else a(Ms(e,t))}function ql(e){const{dispatch:t}=io();t(function(e){return{type:"BATCHED_SET_LOCAL_LAYER_VALUES",updates:e}}(e))}function Jl(e,t,a=[0,0]){const[o,n]=e,[r,i]=a,s=t*Math.PI/180,l=Math.cos(s),c=Math.sin(s);return[r+(o-r)*l-(n-i)*c,i+(o-r)*c+(n-i)*l]}function Xl(e,t){const{state:a,dispatch:o}=io();!!a.studioLocal.isLayerMountedByLayerId[e]!==t&&o(Ol({layerId:e,mounted:t}))}class Ql{constructor(){t(this,"_cancelled",!1),t(this,"cancelledPromise"),t(this,"resolveCancelled"),this.cancelledPromise=new Promise((e=>{this.resolveCancelled=e}))}cancel(){var e;this._cancelled||(this._cancelled=!0,null==(e=this.resolveCancelled)||e.call(this))}waitForCancelled(){return this.cancelledPromise}get cancelled(){return this._cancelled}createChild(){const e=new Ql;return this.waitForCancelled().then((()=>{e.cancel()})),e}}const Zl=m.createContext(0);let ec=0;function tc(e){ec=e,window.studioTime=e}let ac=tc;const oc=({children:e})=>{const[t,a]=n.exports.useState(ec),o=e=>{tc(e),a(e)};ac=o;const r=cn((e=>e.studio.duration>0));return n.exports.useEffect((function(){r||o(0)}),[r]),n.exports.useEffect((function(){return()=>{ac=tc}}),[]),m.createElement(Zl.Provider,{value:t},e)},nc=()=>{const e=n.exports.useContext(Zl);if(void 0===e)throw new Error("useStudioTime must be used within an StudioTimeContextProvider");return e};function rc(e){return t=>m.createElement(Zl.Consumer,null,(a=>m.createElement(e,{...t,studioTime:a})))}const ic=()=>ec,sc=e=>{ac(e)};class lc{constructor(e){t(this,"elementPool"),t(this,"setVolumeByDomId",new Map),t(this,"playOrSeekCancellationSource",null),t(this,"isPlayOrSeekingStatus","Idle"),t(this,"setEPLayerAsMounted",((e,t)=>{Xl(e,!0);const a=this.elementPool.layerIdsByElementId.get(t);null==a||a.forEach((t=>{t!==e&&Xl(t,!1)}))})),t(this,"setAllElementLayersAsUnmounted",(e=>{var t;null==(t=this.elementPool.layerIdsByElementId.get(e))||t.forEach((e=>{Xl(e,!1)}))})),this.elementPool=e}pause(){this.cancelPreviousPlayOrSeek();for(const[e,t]of this.elementPool.domElementByLayerId)t.pause()}async seek(e,t=!1){this.cancelPreviousPlayOrSeek();const a=new Ql;this.playOrSeekCancellationSource=a,this.isPlayOrSeekingStatus="Seeking";try{if(t){const{state:t}=io(),o=1,n=t.studioLocal.playbackRate;await this.seekElementsIfStudioIsPlaying(e,a,o,n)}else await this.seekElementsIfStudioIsPaused(e,a)}finally{this.isPlayOrSeekingStatus="Idle"}}async seekElementsIfStudioIsPaused(e,t){const a=[],o=[];for(const[r,i]of this.elementPool.layerIdsByElementId){const t=this.elementPool.domElementByDomId.get(r),n=this.findLayerThatShouldBePlaying(i,e);n?a.push([n,t]):o.push(t)}const n=[];await Promise.race([Promise.all(a.map((([a,o])=>new Promise((r=>{const i=mc(e,a.startEndTimes[0],a.relativeStartEndTimes[0],a.playbackRate),s=document.getElementById(`EPContainer_${a.layerId}`),l=()=>{if(s&&!s.contains(o)){for(const e of s.children)"VIDEO"===e.tagName&&s.removeChild(e);s.appendChild(o),n.push([a.layerId,o.id])}};dc(o.currentTime,i,1/30)?(l(),hc(o,o.currentTime),r()):(o.addEventListener("seeked",(function e(){t.cancelled||l(),r(),o.removeEventListener("seeked",e)})),hc(o,i))}))))),t.waitForCancelled()]),n.forEach((([e,t])=>{this.setEPLayerAsMounted(e,t)})),t.cancelled||o.forEach((e=>{e.remove(),this.setAllElementLayersAsUnmounted(e.id)}))}async seekElementsIfStudioIsPlaying(e,t,a,o){const n=[],r=[];for(const[s,l]of this.elementPool.layerIdsByElementId){const t=this.findLayerThatShouldBePlaying(l,e);t?n.push(t):r.push(s)}for(const s of r){const e=this.elementPool.domElementByDomId.get(s);e.paused||e.pause()}try{await Promise.race([Promise.all(n.map((async n=>{const r=this.elementPool.domElementByLayerId.get(n.layerId),i=mc(e,n.startEndTimes[0],n.relativeStartEndTimes[0],n.playbackRate),s=lc.trackSeekAsPromise(r);hc(r,i),await s,t.cancelled||await this.playElementAtStudioTime(r,n,e,a,o,t)}))),t.waitForCancelled()])}catch(i){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",i)}if(!t.cancelled)for(const s of r){const e=this.elementPool.domElementByDomId.get(s);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(s));const t=this.elementPool.layerIdsByElementId.get(s);this.seekAhead(e,t,ic())}}cancelPreviousPlayOrSeek(){var e;null==(e=this.playOrSeekCancellationSource)||e.cancel(),this.playOrSeekCancellationSource=null,this.isPlayOrSeekingStatus="Idle"}async _playOrPreseekElementsWhileStudioIsPlaying(e,t,a){const o=ic();this.cancelPreviousPlayOrSeek();const n=new Ql;this.playOrSeekCancellationSource=n;const r=[],i=[];for(const[d,u]of this.elementPool.layerIdsByElementId){const e=this.findLayerThatShouldBePlaying(u,o);e?r.push(e):i.push(d)}for(const d of i){const e=this.elementPool.domElementByDomId.get(d);e.paused||e.pause()}const s=r.find((t=>cc(t.startEndTimes,o,e))),l=(null==s?void 0:s.layerId)||"";try{await Promise.race([Promise.all(r.map((async e=>{let r=o;const i=this.elementPool.domElementByLayerId.get(e.layerId);if(l===e.layerId&&!i.paused){let t=i.currentTime;uc(e.relativeStartEndTimes[0],i.currentTime,e.relativeStartEndTimes[1])||(t=mc(o,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate),hc(i,t)),r=pc(t,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate),sc(r)}return this.playElementAtStudioTime(i,e,r,t,a,n)}))),n.waitForCancelled()])}catch(c){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",c)}if(!n.cancelled)for(const d of i){const e=this.elementPool.domElementByDomId.get(d);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(d));const t=this.elementPool.layerIdsByElementId.get(d);this.seekAhead(e,t,ic())}}async playOrPreseekElementsWhileStudioIsPlaying(e,t,a){if("Idle"===this.isPlayOrSeekingStatus){this.isPlayOrSeekingStatus="Playing";try{await this._playOrPreseekElementsWhileStudioIsPlaying(e,t,a)}finally{this.isPlayOrSeekingStatus="Idle"}}}seekAhead(e,t,a){const o=this.findLayerClosestToStudioTime(t,a);dc(e.currentTime,o.relativeStartEndTimes[0],.15)||hc(e,o.relativeStartEndTimes[0])}shouldBindNonReferenceLayer(e,t,a){const o=e.getAttribute("data-lastBindTimestamp");o||e.setAttribute("data-lastBindTimestamp",String(Date.now()));const n=Date.now()-Number(o);return!dc(e.currentTime,t,.15*a)&&n>5e3}static trackSeekAsPromise(e){return new Promise((t=>{e.addEventListener("seeked",(function a(){t(),e.removeEventListener("seeked",a)}))}))}async playElementAtStudioTime(e,t,a,o,n,r){const i=n*t.playbackRate;e.playbackRate!==i&&(e.playbackRate=i),this.setElementVolume(e,t.volume*o);const s=mc(a,t.startEndTimes[0],t.relativeStartEndTimes[0],t.playbackRate),l=document.getElementById(`EPContainer_${t.layerId}`);let c;const d=()=>{if(l){if(!l.contains(e)){for(const e of l.children)"VIDEO"===e.tagName&&l.removeChild(e);l.appendChild(e),c=!0}}else console.error("playElementAtStudioTime() - not mounted yet")};if(this.shouldBindNonReferenceLayer(e,s,t.playbackRate)){e.setAttribute("data-lastBindTimestamp",String(Date.now()));const t=lc.trackSeekAsPromise(e);hc(e,s),await t,r.cancelled||d()}else d();r.cancelled||(e.paused&&await e.play(),c&&this.setEPLayerAsMounted(t.layerId,e.id))}findLayerClosestToStudioTime(e,t){for(const a of e){const e=this.elementPool.layerByLayerId.get(a);if(e.startEndTimes[0]-t>0)return e}return this.elementPool.layerByLayerId.get(e[0])}findLayerThatShouldBePlaying(e,t){for(const a of e){const e=this.elementPool.layerByLayerId.get(a);if(uc(e.startEndTimes[0],t,e.startEndTimes[1],e.isAtEnd)||e.shouldBePlayingOverride)return e}}setElementVolume(e,t){let a;if(this.setVolumeByDomId.has(e.id))a=this.setVolumeByDomId.get(e.id),this.setVolumeByDomId.set(e.id,a);else{if(Ln())return a=t=>{e.volume=Math.min(Math.max(t,0),1)},void this.setVolumeByDomId.set(e.id,a);const t=new window.AudioContext,o=t.createMediaElementSource(e),n=t.createGain();o.connect(n),n.connect(t.destination),a=t=>{dc(n.gain.value,t,.01)||(console.info("Setting volume: ",e.id,t),n.gain.value=t)},this.setVolumeByDomId.set(e.id,a)}a(t)}}function cc(e,t,a){const o=e[1]-e[0];for(const n of a)if(uc(n.startEndTimes[0],t,n.startEndTimes[1])){const t=n.startEndTimes[1]-n.startEndTimes[0];if(t>o)return!1;if(t===o&&n.startEndTimes[0]<e[0])return!1}return!0}function dc(e,t,a){return Math.abs(t-e)<a}function uc(e,t,a,o=!1){return o?e<=t&&t<=a:e<=t&&t<a}function mc(e,t,a,o){return a+(e-t)*o}function pc(e,t,a,o){return(e-a)/o+t}function hc(e,t){e.currentTime=t,On()&&(e.readyState>2||e.load())}function gc(e,t=8){return+`${Math.round(`${parseFloat(e).toFixed(t)}e+${t}`)}e-${t}`}function fc(){const{state:e}=io();return{height:e.studio.height,width:e.studio.width,x:e.studio.canvasX,y:e.studio.canvasY}}function yc(e,t,a){return{x:parseFloat(e)/100*a.width+a.x,y:parseFloat(t)/100*a.height+a.y}}function Ec(e,t,a=fc()){return yc(e,t,{x:a.x,y:a.y,width:a.width||0,height:a.height||0})}function _c(e,t,a){return{width:parseFloat(e)/100*a.width,height:parseFloat(t)/100*a.height}}function vc(e,t,a=fc()){return _c(e,t,{width:a.width,height:a.height})}function wc(e,t,a){let o=50,n=50;return a.width&&a.height?(o=e/a.width*100,n=t/a.height*100,{widthPercent:o,heightPercent:n}):{widthPercent:o,heightPercent:n}}function bc(e,t,a){const{heightPercent:o,widthPercent:n}=wc(e,t,a);return{heightPercent:`${o}%`,widthPercent:`${n}%`}}function Sc(e,t){const{state:a}=io();return wc(e,t,{width:a.studio.width,height:a.studio.height})}function Tc(e,t){const{state:a}=io();return bc(e,t,{width:a.studio.width,height:a.studio.height})}function Ic(e,t,a){let o=0,n=0;return void 0!==a.x&&void 0!==a.y&&a.width&&a.height?(o=(e-a.x)/a.width*100,n=(t-a.y)/a.height*100,{xPercent:o,yPercent:n}):{xPercent:o,yPercent:n}}function kc(e,t,a){const{xPercent:o,yPercent:n}=Ic(e,t,a);return{xPercent:`${o}%`,yPercent:`${n}%`}}function Cc(e,t){const{state:a}=io(),{canvasX:o,canvasY:n}=a.studio;return Ic(e,t,{x:o,y:n,width:a.studio.width,height:a.studio.height})}function Nc(e,t){const{state:a}=io(),{canvasX:o,canvasY:n}=a.studio;return kc(e,t,{x:o,y:n,width:a.studio.width,height:a.studio.height})}const Ac=(e,t,a,o)=>{const{dispatch:n}=io(),r=Nc(t.x,t.y),i=Tc(t.width,t.height);a?zl(e.id,{positionTemp:{x:r.xPercent,y:r.yPercent,width:i.widthPercent,height:i.heightPercent,rotation:t.rotation}}):(zl(e.id,{positionTemp:null}),n(es(e,r.xPercent,r.yPercent,i.widthPercent,i.heightPercent,o)),n(os(e,t.rotation,o)))},xc=e=>{const{state:t}=io();let{canvasX:a,canvasY:o}=t.studio;const n=t.studio.width,r=t.studio.height;if(void 0===a||void 0===o||void 0===n||void 0===r)return null;(Wl()||Vl())&&(a=0,o=0);const i=Rc(e,{x:a,y:o,width:n,height:r});return e.position||Ac(e,i),i},Pc=e=>{var t,a;const{state:o}=io(),{canvasX:n,canvasY:r}=o.studio,i=o.studio.width,s=o.studio.height;if(void 0===n||void 0===r||void 0===i||void 0===s)return null;const l=Rc(e,{x:n,y:r,width:i,height:s}),c=Nc(l.x,l.y),d=Tc(l.width,l.height);return{x:c.xPercent,y:c.yPercent,rotation:null==(t=null==e?void 0:e.position)?void 0:t.rotation,width:d.widthPercent,height:d.heightPercent,flip:null==(a=null==e?void 0:e.position)?void 0:a.flip}},Rc=(e,t)=>{var a;const{state:{studioLocal:{layerTempValues:o}}}=io();let{x:n,y:r,width:i,height:s}=t;const l=s,{lineWidth:c}=e,d=(null==(a=o[e.id])?void 0:a.positionTemp)||e.position,u=parseFloat(String(c))/100*l;if(d){const e=yc(d.x,d.y,t);n=e.x,r=e.y;const a=_c(d.width,d.height,t);i=a.width,s=a.height}else if(e.width&&e.height){const a=t.width/t.height,o=e.width/e.height;let l=t.width,c=t.height;o>=a?(c=e.height*t.width/e.width,r=(t.height-c)/2+t.y):(l=e.width*t.height/e.height,n=(t.width-l)/2+t.x),i=l,s=c}let m=0;if(e.position&&e.position.rotation&&(m=e.position.rotation),l)switch(e.lineRightAngle){case"horizontal":s=u;break;case"vertical":i=u}return{x:n,y:r,width:i,height:s,rotation:m}};function Oc(e){const{state:t}=io(),a=t.studio.width||0,o=t.studio.height||0;if(a>o){const t=Tc(vc(e.width,e.height).height,0);e.width=t.widthPercent}else if(a<o){const t=Tc(0,vc(e.width,e.height).width);e.height=t.heightPercent}return e}function Dc(e,t,a){const{width:o,height:n,prevWidth:r,prevHeight:i}=a;let s,l;const c=_c(e.width,e.height,a),d=o/n,u=r/i,m=Math.max(parseFloat(e.height)/100,parseFloat(e.width)/100);return t<=1?(l=c.height,s=l*t,s>o?(s=m*o,l=s/t):d>u&&(l=m*n,s=l*t)):(s=c.width,l=s/t,l>n?(l=m*n,s=l*t):d<u&&(s=m*o,l=s/t)),{layerWidth:s,layerHeight:l}}function Lc(e,t,a,o){const{x:n,y:r,width:i,height:s}=o,l=yc(e.x,e.y,o);let c=l.x,d=l.y;if(function({x:e,y:t,width:a,height:o}){return 50===Math.round(parseFloat(e)+parseFloat(a)/2)||50===Math.round(parseFloat(t)+parseFloat(o)/2)}(e)){const{x:o,y:l,width:u,height:m}=e,p=c+t/2,h=d+a/2,g=n+i/2,f=r+s/2;50===Math.round(parseFloat(o)+parseFloat(u)/2)&&p!==g&&(c+=g-p),50===Math.round(parseFloat(l)+parseFloat(m)/2)&&h!==f&&(d+=f-h)}return{layerX:c,layerY:d}}function Uc(e,t,a){var o,n;const{state:r}=io(),{canvasX:i,canvasY:s}=r.studio,l={x:i,y:s,width:r.studio.width,height:r.studio.height,prevWidth:t,prevHeight:a};let c;if(!e.position)throw Error("Layer position missing");if(e.isAudiogram)c=(parseFloat(e.position.width)||parseFloat("100%"))/(parseFloat(e.position.height)||parseFloat("40%"));else if((null==(o=null==e?void 0:e.crop)?void 0:o.width)&&(null==(n=null==e?void 0:e.crop)?void 0:n.height)){c=e.width*e.crop.width/(e.height*e.crop.height)}else c=e.width/e.height;const{layerWidth:d,layerHeight:u}=Dc(e.position,c,l),{layerX:m,layerY:p}=Lc(e.position,d,u,l);return{x:m,y:p,width:d,height:u}}function Mc(e,t,a,o,n,r){const i=Dc({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},t/a,{x:0,y:0,width:o,height:n,prevWidth:t,prevHeight:a}),s=i.layerWidth/o,l=i.layerHeight/n,c=(1-s)/2,d=(1-l)/2;if(e.position){let t=c*o+parseFloat(e.position.x)/100*s*o;let a=d*n+parseFloat(e.position.y)/100*l*n;const u=parseFloat(e.position.width)/100*i.layerWidth,m=parseFloat(e.position.height)/100*i.layerHeight;return r&&"shape"===e.type&&"ellipse"===e.shapeType&&(t-=u/2,a-=m/2),{x:t,y:a,width:u,height:m}}return{x:0,y:0,width:100,height:100}}function Fc(e,t,a,o,n){const r=Dc({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},o/n,{x:0,y:0,width:t,height:a,prevWidth:o,prevHeight:n}),i=r.layerWidth/t,s=r.layerHeight/a,l=(1-i)/2,c=(1-s)/2;return!!e.every((e=>{if(e.position&&"subtitle"!==e.type){const{x:t,y:a,width:o,height:n}=e.position;if(parseFloat(t)<100*l)return!1;if(parseFloat(a)<100*c)return!1;if(parseFloat(t)+parseFloat(o)>100*(l+i))return!1;if(parseFloat(a)+parseFloat(n)>100*(c+s))return!1}return!0}))}function Bc(e,t,a,o,n){let r=0;if(e.position&&e.position.rotation&&(r=e.position.rotation),t&&a&&o&&n){const i=Dc({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},o/n,{x:0,y:0,width:t,height:a,prevWidth:o,prevHeight:n}),s=i.layerWidth/t,l=i.layerHeight/a,c=(1-s)/2,d=(1-l)/2;if(e.position){const{x:i,y:u,width:m,height:p}=e.position,h=(parseFloat(i)/100-c)*o;let g=(parseFloat(u)/100-d)*n;const f=(1-(s-parseFloat(m)/100))*o;let y=(1-(l-parseFloat(p)/100))*n;const E=t*parseFloat(m)/100,_=f*(a*parseFloat(p)/100)/E,v=g-(_-y)/2;return y=_,g=v,{x:h,y:g,width:f,height:y,rotation:r}}}return{x:0,y:0,width:100,height:100,rotation:r}}function Wc(e,t,a,o,n){const r=parseFloat(e.width)/100*o,i=parseFloat(e.height)/100*n,s=r/i;return r<i?{x:parseFloat(e.x)/100*t,y:parseFloat(e.y)/100*a,width:r,height:r/s,rotation:e.rotation}:{x:parseFloat(e.x)/100*t,y:parseFloat(e.y)/100*a,width:i*s,height:i,rotation:e.rotation}}function Vc(e){var t;const{state:a}=io(),o=(null==(t=a.studioLocal.layerTempValues[e.id])?void 0:t.positionTemp)||e.position;if(!o)return null;const{canvasX:n,canvasY:r}=a.studio,i=a.studio.width,s=a.studio.height;if(void 0===n||void 0===r||void 0===i||void 0===s)return null;const{x:l,y:c,width:d,height:u,rotation:m=0}=o;let p=parseFloat(l),h=parseFloat(c),g=parseFloat(d),f=parseFloat(u);if(e.crop){const t=Math.sin(m*Math.PI/180),a=Math.cos(m*Math.PI/180),{width:o,height:n,x:r,y:l}=e.crop,c=100-r-o,d=100-l-n;g/=o/100,f/=n/100;const u=g*i/100,y=f*s/100,E=r*u/100,_=c*u/100,v=l*y/100,w=d*y/100,b={topLeft:{x:p*i/100,y:h*s/100},topRight:{x:p*i/100+u*o/100,y:h*s/100},bottomLeft:{x:p*i/100,y:h*s/100+y*n/100},bottomRight:{x:p*i/100+u*o/100,y:h*s/100+y*n/100},center:{x:p*i/100+u*o/200,y:h*s/100+y*n/200}};if(Object.keys(b).forEach((e=>{const t=e;if("center"===t)return;const[a,o]=Jl(Object.values(b[t]),m,[b.center.x,b.center.y]);b[t].x=a,b[t].y=o})),0===m)p-=u*r/i,h-=y*l/s;else if(m<90){b.topLeft.y-=E*t+v*a,b.topLeft.x+=v*t-E*a,b.topRight.y+=_*t-v*a,b.topRight.x+=v*t+_*a,b.bottomLeft.y-=E*t-w*a,b.bottomLeft.x-=w*t+E*a,b.bottomRight.y+=_*t+w*a,b.bottomRight.x-=w*t-_*a,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],o=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*o[0]/i,h=100*o[1]/s}else if(90===m){b.topLeft.y-=r*u/100,b.topLeft.x+=l*y/100,b.topRight.y+=c*u/100,b.topRight.x+=l*y/100,b.bottomLeft.y-=r*u/100,b.bottomLeft.x-=d*y/100,b.bottomRight.y+=c*u/100,b.bottomRight.x-=d*y/100,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],t=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*t[0]/i,h=100*t[1]/s}else if(m<180){b.topLeft.y+=-E*t-v*a,b.topLeft.x+=v*t-E*a,b.topRight.y+=_*t-v*a,b.topRight.x+=v*t+_*a,b.bottomLeft.y+=-E*t+w*a,b.bottomLeft.x+=-w*t-E*a,b.bottomRight.y+=_*t+w*a,b.bottomRight.x+=-w*t+_*a,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],o=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*o[0]/i,h=100*o[1]/s}else if(180===m)p-=u*c/i,h-=y*d/s;else if(m<270){b.topLeft.y-=E*t+v*a,b.topLeft.x+=v*t-E*a,b.topRight.y+=_*t-v*a,b.topRight.x+=v*t+_*a,b.bottomLeft.y-=E*t-w*a,b.bottomLeft.x-=w*t+E*a,b.bottomRight.y+=_*t+w*a,b.bottomRight.x-=w*t-_*a,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],o=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*o[0]/i,h=100*o[1]/s}else if(270===m){b.topLeft.y+=r*u/100,b.topLeft.x-=l*y/100,b.topRight.y-=c*u/100,b.topRight.x-=l*y/100,b.bottomLeft.y+=r*u/100,b.bottomLeft.x+=d*y/100,b.bottomRight.y-=c*u/100,b.bottomRight.x+=d*y/100,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],t=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*t[0]/i,h=100*t[1]/s}else{b.topLeft.y+=-E*t-v*a,b.topLeft.x+=v*t-E*a,b.topRight.y+=_*t-v*a,b.topRight.x+=v*t+_*a,b.bottomLeft.y+=-E*t+w*a,b.bottomLeft.x+=-w*t-E*a,b.bottomRight.y+=_*t+w*a,b.bottomRight.x+=-w*t+_*a,b.center.x=(b.topLeft.x+b.bottomLeft.x+b.bottomRight.x+b.topRight.x)/4,b.center.y=(b.topLeft.y+b.bottomLeft.y+b.bottomRight.y+b.topRight.y)/4;const e=[b.center.x,b.center.y],o=Jl([b.topLeft.x,b.topLeft.y],-m,e);p=100*o[0]/i,h=100*o[1]/s}}const{x:y,y:E}=yc(p,h,{height:s,width:i,x:n,y:r}),{width:_,height:v}=_c(g.toString(),f.toString(),{height:s,width:i,x:n,y:r});return{x:y,y:E,width:_,height:v}}function jc(e){const{state:{studio:{width:t=100,height:a=100}}}=io(),{crop:o,position:n,lockAspectRatio:r,width:i=100,height:s=100}=e,l=i/s/(t/a);if(r)return!1;const{width:c,height:d}=n||{x:"0%",y:"0%",height:"100%",width:"100%",rotation:0},u=parseFloat(c),m=parseFloat(d);if(!o){if(!dc(u/m,l,.01))return!0}const{width:p,height:h}=o||{height:100,width:100,x:0,y:0,presetIndex:0};return!dc(u/(p/100)/(m/(h/100)),l,.01)}function Hc(e){let t={width:100,height:100,x:0,y:0};const{crop:a,position:o,width:n=100,height:r=100}=e;a&&(t=a);const i={...t};if(!o)return;const s=xc(e),l=Vc(e);if(!s)return;if(!l)return;const{width:c,height:d}=s,{width:u,height:m}=l,p=n/r;if(c/d<n*t.width/(r*t.height)){const e=m*p,t=i.width;i.width*=u/e;const a=t-i.width;i.x+=a/2}else{const e=u/p,t=i.height;i.height*=m/e;const a=t-i.height;i.y+=a/2}const{dispatch:h}=io();h(ds(e,{crop:i},!0))}const Gc=e=>{var t;const{xPercent:a,yPercent:o}=Nc(e.x,e.y),{widthPercent:n,heightPercent:r}=Tc(e.width,e.height);return{x:a,y:o,width:n,height:r,rotation:null!=(t=e.rotation)?t:0}},$c=e=>{if(!e.position)return{x:"0%",y:"0%"};const t=(e=>{if(!e.position)return{x:"0%",y:"0%"};if("shape"===e.type)return f(e.position,["x","y"]);const{width:t=0,height:a=0}=fc(),o=parseFloat(e.position.x)/100*t,n=parseFloat(e.position.y)/100*a;return{x:(o+parseFloat(e.position.width)/100*t/2)/t*100+"%",y:(n+parseFloat(e.position.height)/100*a/2)/a*100+"%"}})(e),a=2*(parseFloat(t.x)-50),o=2*-(parseFloat(t.y)-50);return{x:`${+a.toFixed(2)}%`,y:`${+o.toFixed(2)}%`}},Kc=d({initialState:{assetIdToMediaCacheId:{},mediaCacheIdToAssetId:{},mediaCacheIdToUploadId:{},uploadIdToMediaCacheId:{}},name:"mediaCache",reducers:{linkAssetToMediaCache:(e,t)=>{e.assetIdToMediaCacheId[t.payload.assetId]=t.payload.mediaCacheId,e.mediaCacheIdToAssetId[t.payload.mediaCacheId]=t.payload.assetId},linkUploadToMediaCache:(e,t)=>{e.uploadIdToMediaCacheId[t.payload.uploadId]=t.payload.mediaCacheId,e.mediaCacheIdToUploadId[t.payload.mediaCacheId]=t.payload.uploadId}}}),{linkAssetToMediaCache:Yc,linkUploadToMediaCache:zc}=Kc.actions,qc=e=>{var t;if(void 0!==window.TouchEvent&&e instanceof window.TouchEvent)return!0;return!!(null==(t=null==e?void 0:e.touches)?void 0:t.length)},Jc=e=>{var t,a,o,n;if(qc(e)){const r=e;return[(null==(a=null==(t=null==r?void 0:r.touches)?void 0:t[0])?void 0:a.clientX)||0,(null==(n=null==(o=null==r?void 0:r.touches)?void 0:o[0])?void 0:n.clientY)||0]}const r=e;return[r.clientX,r.clientY]};async function Xc(e,t){let a;const o=new Promise((t=>{a=setTimeout((()=>{t({winner:"timeout"})}),e)})),n=new Promise((e=>{t.then((()=>{e({winner:"result"})})).catch((()=>{e({winner:"result"})}))})),{winner:r}=await Promise.race([o,n]);if("result"===r)return clearTimeout(a),t;throw new Error(`Timed out in ${e} ms.`)}const Qc=(e,t=(e=>e))=>{if(e.length<=1)return!0;const[a,...o]=e;if(!a)return!1;const n=t(a);return o.every((e=>Object.is(t(e),n)))},Zc=e=>{if("undefined"!=typeof window&&window.matchMedia){const[t,a]=n.exports.useState(window.matchMedia(e).matches);return n.exports.useEffect((()=>{const o=window.matchMedia(e);o.matches!==t&&a(o.matches);const n=()=>a(o.matches);return o.addListener(n),()=>o.removeListener(n)}),[t,e]),t}return!1},ed=()=>Zc("(max-width: 768px)"),td=()=>{const e=window,t=document,a=t.documentElement,o=t.body;return(e.innerWidth||a.clientWidth||o.clientWidth)<=768},ad=e=>{if(e.dataTransfer.types)for(let t=0;t<e.dataTransfer.types.length;t+=1)if("Files"===e.dataTransfer.types[t])return!0;return!1},od=()=>{const e=ed(),t=Zc("(orientation: landscape)");return!(!e||!t)},nd=(e,t,a)=>Math.min(Math.max(parseFloat(e),t),a),rd=(e,t)=>e?e.length<=t?e:`${e.substring(0,t-3)}...`:"";function id(e){return Object.keys(e).filter((t=>e[t])).join(" ").trim()}const sd=(e,t=3)=>{const a=10**t;return Math.round(e*a)/a};function ld(e){return null!=io().state.studio.allLayers.byId[e]}function cd(e){return`${e}%`}function dd(e){return parseInt(e,10)}function ud(e="30%",t="30%"){const a=dd(e),o=dd(t),n=10*Math.random()-5,r=(100-o)/2;return{x:cd((100-a)/2+n),y:cd(r+n),width:e,height:t,rotation:0}}function md(e,t){return function(e,t){let a=0;for(const o of e){if(o.id===t)break;if(!o.duration)return null;a+=o.duration}return a}(e,t.id)}function pd(e,t,a){return(e.x-t.x)*Math.sin(a)+(e.y-t.y)*Math.cos(a)+t.y}function hd(e,t,a){return(e.x-t.x)*Math.cos(a)-(e.y-t.y)*Math.sin(a)+t.x}function gd(e,t,a){return{x:hd(e,t,a),y:pd(e,t,a)}}const fd=e=>e*Math.PI/180;function yd(e){let t,a,o,n;if("percent"===e.positionType){const{position:r}=e,i=r.x,s=r.y,l=r.width,c=r.height;({width:t,height:a}=vc(l,c)),({x:o,y:n}=Ec(i,s))}else{const{position:r}=e;({width:t,height:a,x:o,y:n}=r)}const r=e.position.rotation||0;"ellipse"===e.shapeType&&(o-=t/2,n-=a/2);const i={x:o+t/2,y:n+a/2},s=gd({x:o,y:n},i,fd(r)),l=gd({x:o+t,y:n},i,fd(r)),c=gd({x:o,y:n+a},i,fd(r));return{tl:s,tr:l,br:gd({x:o+t,y:n+a},i,fd(r)),bl:c}}function Ed(e){let t={top:window.screen.height,right:0,bottom:0,left:window.screen.width};for(const n of e){if("subtitle"===n.type||"audio"===n.type)continue;if(!n.position)continue;const{tl:e,tr:a,bl:o,br:r}=yd({position:n.position,shapeType:n.shapeType,positionType:"percent"}),i=[e,a,o,r];t={top:Math.min(t.top,...i.map((e=>e.y))),right:Math.max(t.right,...i.map((e=>e.x))),bottom:Math.max(t.bottom,...i.map((e=>e.y))),left:Math.min(t.left,...i.map((e=>e.x)))}}const a=t.right-t.left,o=t.bottom-t.top;return{x:t.left+a/2,y:t.top+o/2}}const _d=(e,t=0,a)=>{let o={top:window.screen.height,right:0,bottom:0,left:window.screen.width,rotation:t};const n=a?Ec(a.xPercent,a.yPercent):Ed(e);for(const r of e){if("subtitle"===r.type||"audio"===r.type&&!r.isAudiogram||!r.position)continue;const{position:e}=r;let{x:a,y:i}=Ec(e.x,e.y);const{width:s,height:l}=vc(e.width,e.height);"ellipse"===r.shapeType&&(a-=s/2,i-=l/2);const c=[{x:a,y:i},{x:a+s,y:i},{x:a,y:i+l},{x:a+s,y:i+l}],d=Ed([r]),u=c.map((t=>gd(t,d,fd(e.rotation||0)))).map((e=>gd(e,n,fd(-1*t))));o={top:Math.min(o.top,...u.map((e=>e.y))),right:Math.max(o.right,...u.map((e=>e.x))),bottom:Math.max(o.bottom,...u.map((e=>e.y))),left:Math.min(o.left,...u.map((e=>e.x))),rotation:o.rotation}}return o},vd=(e,t,a)=>{const o=_d(e,t,a);return{x:o.left,y:o.top,width:o.right-o.left,height:o.bottom-o.top,rotation:o.rotation}},wd=e=>{const t=_d(e),a=Nc(t.left,t.top),o=Nc(t.right,t.bottom);return{top:nd(parseFloat(a.yPercent),0,100),right:nd(parseFloat(o.xPercent),0,100),bottom:nd(parseFloat(o.yPercent),0,100),left:nd(parseFloat(a.xPercent),0,100)}},bd=e=>{let t=!1;for(const a of e)if("video"===a.type||a.mime&&"gif"===a.mime.split("/")[1]){t=!0;break}return t},Sd=(e,t,a=!1)=>{const o=e[t];let n=o.layers;if(a&&e.length>1)for(const r of e){if(r.id===o.id)continue;const{layers:e}=r;n=[...e,...n]}return n};function Td(e){return!(e.filters&&0!==Object.keys(e.filters).length||e.presetFilter&&0!==Object.keys(e.presetFilter).length)}function Id(e){return!e.chromaKey&&!e.removeBg&&!e.blurBg}function kd(e,t){if(!e.height||!e.width||!e.position)return!1;const{position:a}=e,o=.01,n=e.width/e.height,r=Math.abs(t-n)<=o,i=Math.abs(100-parseFloat(a.width))<=o,s=Math.abs(100-parseFloat(a.height))<=o,l=Math.abs(0-parseFloat(a.x))<=o,c=Math.abs(0-parseFloat(a.y))<=o,d=a.flip&&(a.flip.x||a.flip.y);return i&&s&&l&&c&&!d&&0===a.rotation&&r}function Cd(e,t){const a=[];for(const o of e)for(const e of o.layers)t.includes(e.id)&&a.push(e);return a}function Nd(e){return"image/webp"===e.mime?"static"===e.webpType:"audio"!==e.type&&"video"!==e.type}const Ad={startTime:0,endTime:Number.MAX_VALUE};function xd(e,t){if(!t)return e;const{diff:a,type:o,leftMost:n}=t,{startTime:r=0,endTime:i=0,videoDelay:s=0}=e,l=Nd(e);let c;return c="drag"===o?l?n?Ad:{startTime:r+a,endTime:i+a}:{videoDelay:s+a}:"trim-start"===o?l?Ad:{videoDelay:s+a,startTime:r+a}:l?Ad:{endTime:i+a},{...e,...c}}function Pd(e,t){const a=io().state.studio.scenes[0].duration,o={...e,isTrimmed:!0},n=!Nd(e),r=!Nd(t),{endTime:i=0,startTime:s=0,videoDelay:l=0}=t;if(r){const{duration:a=0}=t;if(n){const a=Math.min(t.duration||0,e.duration||0);o.videoDelay=l,o.startTime=0,o.endTime=a}else{const{videoDelay:e=0}=t;o.startTime=e,o.endTime=e+(i||a)-s}}else n?0===s&&0===i?(o.videoDelay=0,o.startTime=0,o.endTime=Math.max(a,e.duration||0)):(o.videoDelay=s,o.startTime=0,o.endTime=Math.min(i-s,e.duration||0)):(o.startTime=t.startTime,o.endTime=t.endTime);return t.position&&(o.position=t.position),t.filters&&(o.filters=t.filters),t.presetFilter&&(o.presetFilter=t.presetFilter),o.converted_type=void 0,o}const Rd=(e,t=io().state.mediaCache)=>{const{dispatch:a}=io(),o=Od(e,t);if(o)return o;const n=y();let r=!1;const i=e.ttsAudio?e.ttsAudio.assetId:e.asset_id;return i&&(a(Yc({assetId:i,mediaCacheId:n})),r=!0),e.uploadId&&(a(zc({mediaCacheId:n,uploadId:e.uploadId})),r=!0),r||console.error("Could not link media cache id to anything",e),n};function Od(e,t=io().state.mediaCache){const{assetIdToMediaCacheId:a,uploadIdToMediaCacheId:o}=t;if(e.mediaLibraryID)return e.mediaLibraryID;if(e.ttsAudio){const t=a[e.ttsAudio.assetId];if(t)return t}if(e.asset_id){const t=a[e.asset_id];if(t)return t}if(e.uploadId){const t=o[e.uploadId];if(t)return t}return null}const Dd={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontSizeRaw:18,fontSizeRatio:.05625,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textShadow:"#000000",textVerticalAlign:"bottom",updateSubtitlePosition:y()},Ld=-1,Ud=Math.random().toString(36).substring(2),Md=()=>{try{if("undefined"!=typeof window&&"undefined"!=typeof document){const e=document.domain||"",t=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||e.startsWith("localhost")&&["3000","4000","5000","3030"].includes(window.location.port),a=t?"461b8b8947f81e4f070013ded04799df":"e3eca64f2da6246ee6a22cd63f455a07",o={includeUtm:!0,includeReferrer:!0,includeGclid:!0,includeFbclid:!0,useDynamicConfig:!0,onExitPage:()=>{window.amplitudeOnExit&&window.amplitudeOnExit()}};amplitude.getInstance().init(a,null,o);const n="v2023.02.22.2",r=ao(),i=t?r:`0.0.${n}`;return amplitude.setVersionName(i),amplitude}}catch($ae){}return null},Fd={basicTier:{control:.9,test:.1},canvasWatermark:{control:.9,test:.1}};function Bd(){const e=localStorage.getItem("EXPERIMENTS_LOCAL_STORAGE_KEY")||"{}";return JSON.parse(e)||{}}const Wd=()=>{const e=Bd(),t=(e=>{const t=Object.keys(e);return Object.keys(Fd).filter((e=>!t.includes(e)))})(e);if(t.length){const a=(()=>{const e={};return Object.keys(Fd).forEach((t=>{const a=Math.random();let o=0;const n=Fd[t];for(const[r,i]of Object.entries(n))if(o+=i,a<o){e[t]=r;break}})),e})();t.forEach((t=>{e[t]=a[t]})),function(e){localStorage.setItem("EXPERIMENTS_LOCAL_STORAGE_KEY",JSON.stringify(e))}(e)}};var Vd=(e=>(e.NO_TERM="no_term",e.MONTHLY="monthly",e.ANNUALLY="annually",e))(Vd||{}),jd=(e=>(e.FREE="free",e.BASIC="basic",e.PRO="pro",e.TEAM="team",e))(jd||{});const Hd={_id:"anon_team",name:"My Team",licensesAvailable:0,licensesTotal:0,users:[],creatorId:"",planTier:"free",paymentTerm:"no_term",createdAt:new Date,emailDomain:"",settings:{defaultPrivacy:Po.unlisted},limits:{cumulativeExportDuration:0,lastUpdatedCumulativeDuration:new Date,transcribeUsage:0,lastUpdatedTranscribe:new Date}},Gd=["pro","team"],$d=250,Kd=6,Yd=420,zd=7,qd=7200,Jd=2,Xd=10,Qd=3600,Zd=3,eu=10800,tu=3;var au=(e=>(e.NO_UPSELLS="NO_UPSELLS",e.REPORT_ISSUE="REPORT_ISSUE",e.ALLOW_STOCK_CONTENT="ALLOW_STOCK_CONTENT",e.CHANGE_PRIVACY="CHANGE_PRIVACY",e.CLEAN_AUDIO="CLEAN_AUDIO",e.CREATE_NEW_FOLDER="CREATE_NEW_FOLDER",e.EXPORT_ALL_WITHOUT_WATERMARK="EXPORT_ALL_WITHOUT_WATERMARK",e.EXPORT_30_SEC_WITHOUT_WATERMARK="EXPORT_30_SEC_WITHOUT_WATERMARK",e.HIGH_QUALITY="HIGH_QUALITY",e.UNLIMITED_EXPORT_DURATION_LIMIT="UNLIMITED_EXPORT_DURATION_LIMIT",e.UNLIMITED_UPLOAD_SIZE_LIMIT="UNLIMITED_UPLOAD_SIZE_LIMIT",e.REMOVE_BACKGROUND="REMOVE_BACKGROUND",e.SMART_CUT="SMART_CUT",e.AUDIOGRAM="AUDIOGRAM",e.UNLIMITED_STORAGE="UNLIMITED_STORAGE",e.NO_CUMULATIVE_DURATION_LIMIT="NO_CUMULATIVE_DURATION_LIMIT",e.SUBTITLER="SUBTITLER",e.TRANSCRIBE="TRANSCRIBE",e.TEXT_TO_SPEECH="TEXT_TO_SPEECH",e.BRANDKIT="BRANDKIT",e.FAST_EXPORT="FAST_EXPORT",e.MULTI_USER="MULTI_USER",e.ROYALTY_FREE="ROYALTY_FREE",e))(au||{}),ou=(e=>(e.AUDIOGRAM_BAR="audiogram-bar",e.AUDIOGRAM_WAVE="audiogram-wave",e.BACKGROUND_IMAGE_ERASE="background-image-erase",e.BRAND_TEMPLATES="brand-templates",e.BRANDKIT="brandkit",e.CLEAN_AUDIO="clean-audio",e.CREATE_NEW_FOLDER="create-new-folder",e.CUMULATIVE_EXPORT_DURATION="cumulative-export-duration",e.DEFAULT="default",e.DEFAULT_PRIVACY="default-privacy",e.DELETION_WARNING="deletion-warning",e.FULL_HD="full-hd",e.HEADER="header",e.HIGH_QUALITY="high-quality",e.INVITE_MEMBERS="invite-members",e.LINK="link",e.MAGIC_SUBTITLE_FILE_DL="magic-subtitle-file-download",e.MAGIC_TRANSCRIBE="magic-transcribe",e.ONBOARDING_SURVEY="onboarding-survey",e.PRICING="pricing",e.PRICING_PAGE="pricing-page",e.PRIVACY="privacy",e.REACTIVATE_LICENSE="reactivate-license",e.REMOVE_30_SEC_WATERMARK="remove-30-sec-watermark",e.REMOVE_VIDEO_BACKGROUND="remove-video-background",e.REMOVE_WATERMARK="remove-watermark",e.ROYALTY_FREE="royalty-free",e.SETTINGS="settings",e.SIDEBAR="sidebar",e.SINGLE_VIDEO_DURATION_LIMIT="single-video-duration-limit",e.SMART_CUT_AUDIO="smart-cut-audio",e.SMART_CUT_VIDEO="smart-cut-video",e.STOCK_ASSETS_IMAGE="stock-assets-image",e.STOCK_ASSETS_MUSIC="stock-assets-music",e.STOCK_ASSETS_SFX="stock-assets-sfx",e.STOCK_ASSETS_VIDEO="stock-assets-video",e.STORAGE_LIMIT="storage-limit",e.STUDIO="studio",e.STUDIO_MEDIA_SIDEBAR="studio-media-sidebar",e.SUBTITLER="subtitler",e.TEXT_TO_SPEECH="text-to-speech",e.TRANSCRIBE="transcribe",e.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL="two-week-post-onboarding-multi-account-upsell",e.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL="two-week-post-onboarding-single-account-upsell",e.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL="two-week-recurring-multi-account-upsell",e.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL="two-week-recurring-single-account-upsell",e.UNLIMITED_CONTENT="unlimited-content",e.UPLOAD_FONTS="upload-fonts",e.UPLOAD_LIMIT="upload-limit",e.WORKSPACE_SETTINGS="workspace-settings",e))(ou||{});const nu={free:{isFree:!0,planTier:"free",basePrice:{monthly:0,annually:0},modalReasons:[],cancelReasons:["All projects export with Kapwing watermark","Auto subtitler limited to 10 mins/month","Videos limited to 7 minutes","Files limited to 250 MB","Video quality limited to 720p resolution"]},basic:{isFree:!1,planTier:"basic",basePrice:{monthly:10,annually:72},everythingIn:["free"],modalReasons:["Remove watermarks on images or videos shorter than 30 seconds."],cancelReasons:["Remove watermarks on images or videos shorter than 30 seconds."]},pro:{isFree:!1,planTier:"pro",basePrice:{monthly:24,annually:192},everythingIn:["free","basic"],modalReasons:["Remove all watermarks","Upload files up to 6 GB","Store and edit unlimited projects","Increased transcription limits and SRT downloads","Export projects up to 2 hours long","Export content in 1080p+ resolution","Premium support, faster processing"],andMuchMore:!0,cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 1080p+ resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Premium support"]},team:{isFree:!1,planTier:"team",basePrice:{monthly:24,annually:192},everythingIn:["pro"],chooseModalReasons:["Collaborative workspace","Brand controls for your whole team","Pay as you grow"],modalReasons:["Remove all watermarks","Ensure consistency with Brand Kit templates and other assets","Upload files up to 6 GB","Export content up to 1 hour long","Export content in 1080p resolution","Unlimited transcription and SRT / VTT downloads","Consolidated billing"],cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 1080p+ resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Premium support"]}};var ru=(e=>(e.REGULAR="Regular",e.APPLE_PAY="Apple Pay",e.GOOGLE_PAY="Google Pay",e.SAVED_CARD="Saved Card",e))(ru||{});const iu=au.NO_UPSELLS,su={[au.NO_UPSELLS]:{planTiers:[jd.PRO,jd.TEAM]},[au.MULTI_USER]:{planTiers:[jd.FREE,jd.TEAM],requiresPaymentMethod:!0},[au.REPORT_ISSUE]:{planTiers:[jd.BASIC,jd.PRO,jd.TEAM]},[au.FAST_EXPORT]:{planTiers:[jd.PRO,jd.TEAM]},[au.BRANDKIT]:{planTiers:[jd.PRO,jd.TEAM],heroHeader:"Staying on brand has never been easier",heroBody:"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",heroImg:"https://cdn-useast1.kapwing.com/static/51e-brandkit-upgrade-banner-spot.webp",upgradeReason:"to set up your own Brand Kit with templates, logos, and more"},[au.UNLIMITED_UPLOAD_SIZE_LIMIT]:{planTiers:[jd.PRO,jd.TEAM]},[au.NO_CUMULATIVE_DURATION_LIMIT]:{planTiers:[jd.PRO,jd.TEAM]},[au.TRANSCRIBE]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to get unlimited use of auto-generate subtitles"},[au.SUBTITLER]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to download .SRT and .VTT files",upgradeSubmitText:"Submit payment and download this file"},[au.TEXT_TO_SPEECH]:{planTiers:[jd.PRO,jd.TEAM],upsellHeading:"Text to Speech",upsellBody:"Upgrade to export with Text to Speech layers",upgradeReason:"to export with Text to Speech",imgSrc:"https://cdn-useast1.kapwing.com/static/text-to-speech-upsell-block-image.webp"},[au.REMOVE_BACKGROUND]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to export with Remove Background",upsellHeading:"Background remover",upsellBody:"Upgrade to export with Remove Background",imgSrc:"https://cdn-useast1.kapwing.com/static/tB5-remove-video-background-cta-image.webp"},[au.CLEAN_AUDIO]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to export with Clean Audio",upsellHeading:"Clearer audio",upsellBody:"Upgrade to export projects with Clean Audio applied",imgSrc:"https://cdn-useast1.kapwing.com/static/LII-clean-audio-upsell-banner-image.webp"},[au.SMART_CUT]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to export projects edited with Smart Cut",upsellHeading:"Remove silences automatically with Smart Cut",upsellBody:"Upgrade to export projects edited with Smart Cut",imgSrc:"https://cdn-useast1.kapwing.com/static/EwQ-smart-cut-upsell-block-image.webp"},[au.AUDIOGRAM]:{planTiers:[jd.PRO,jd.TEAM],upsellHeading:"Use a dynamic waveform layer to visualize audio",upsellBody:"Upgrade to export projects with waveform layers",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"},[au.UNLIMITED_EXPORT_DURATION_LIMIT]:{planTiers:[jd.PRO,jd.TEAM]},[au.CREATE_NEW_FOLDER]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to create new workspace folders"},[au.HIGH_QUALITY]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to export in 1080p resolution"},[au.ALLOW_STOCK_CONTENT]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to access all available stock assets",upsellHeading:"Thousands of stock assets",upsellBody:"Upgrade to load all available stock assets",imgSrc:"https://cdn-useast1.kapwing.com/static/XYa-Frame-307.webp"},[au.UNLIMITED_STORAGE]:{planTiers:[jd.PRO,jd.TEAM],upsellHeading:"Bigger, bolder assets",upsellBody:"Upgrade to upload and store assets over 250+ megabytes",imgSrc:"https://cdn-useast1.kapwing.com/static/C4x-img_upsell_media.webp"},[au.CHANGE_PRIVACY]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to set your content to private",upgradeSubmitText:"Submit payment and set to private"},[au.EXPORT_ALL_WITHOUT_WATERMARK]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to remove all watermarks"},[au.EXPORT_30_SEC_WITHOUT_WATERMARK]:{planTiers:[jd.BASIC,jd.PRO,jd.TEAM],upgradeReason:"to remove all watermarks"},[au.ROYALTY_FREE]:{planTiers:[jd.PRO,jd.TEAM],upgradeReason:"to enable royalty-free assets"}},lu={[ou.ROYALTY_FREE]:{permission:au.ROYALTY_FREE,metadata:{prettyUpgradeSource:"Filter Royalty Free"}},[ou.INVITE_MEMBERS]:{permission:au.MULTI_USER,metadata:{prettyUpgradeSource:"Invite Members"}},[ou.TEXT_TO_SPEECH]:{permission:au.TEXT_TO_SPEECH,metadata:{prettyUpgradeSource:"Text to Speech"}},[ou.DEFAULT_PRIVACY]:{permission:au.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Default Privacy",upgradeReason:"to change videos from unlisted to private"}},[ou.DELETION_WARNING]:{permission:au.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Deletion Warning",upgradeReason:"to store and edit unlimited projects"}},[ou.HEADER]:{metadata:{prettyUpgradeSource:"Link in Header"}},[ou.HIGH_QUALITY]:{permission:au.HIGH_QUALITY,metadata:{prettyUpgradeSource:"High Quality",upsellHeading:"Export in full HD quality",upsellBody:"Upgrade to export your projects in Full HD resolution"}},[ou.PRICING]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[ou.PRIVACY]:{permission:au.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Video Privacy"}},[ou.SETTINGS]:{metadata:{prettyUpgradeSource:"Account Settings"}},[ou.SIDEBAR]:{metadata:{prettyUpgradeSource:"Link in Sidebar"}},[ou.SINGLE_VIDEO_DURATION_LIMIT]:{permission:au.NO_CUMULATIVE_DURATION_LIMIT,metadata:{prettyUpgradeSource:"Single Video Duration Limit",upgradeReason:"to export videos longer than 7 minutes"}},[ou.STORAGE_LIMIT]:{permission:au.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Storage Limit",upgradeSubmitText:"Submit payment and unlock content",upgradeReason:"to view, edit, and manage locked projects"}},[ou.STUDIO]:{metadata:{prettyUpgradeSource:"Link in Studio",upgradeReason:"to unlock the full experience of Studio"}},[ou.SUBTITLER]:{permission:au.SUBTITLER,metadata:{prettyUpgradeSource:"Download SRT"}},[ou.CUMULATIVE_EXPORT_DURATION]:{permission:au.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Total Video Duration"}},[ou.UNLIMITED_CONTENT]:{permission:au.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Load More Button",upgradeSubmitText:"Submit payment and load all projects",upgradeReason:"to access older projects"}},[ou.UPLOAD_FONTS]:{permission:au.BRANDKIT,metadata:{prettyUpgradeSource:"Upload font",upgradeReason:"to use custom fonts"}},[ou.UPLOAD_LIMIT]:{permission:au.UNLIMITED_UPLOAD_SIZE_LIMIT,metadata:{prettyUpgradeSource:"Upload Limit",upgradeReason:"Your video uses files over 250MB, upgrade to use files up to 6GB"}},[ou.MAGIC_TRANSCRIBE]:{permission:au.TRANSCRIBE,metadata:{prettyUpgradeSource:"Magic Transcription Limit"}},[ou.TRANSCRIBE]:{permission:au.TRANSCRIBE,metadata:{prettyUpgradeSource:"Transcription Limit"}},[ou.REMOVE_30_SEC_WATERMARK]:{permission:au.EXPORT_30_SEC_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[ou.REMOVE_WATERMARK]:{permission:au.EXPORT_ALL_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[ou.FULL_HD]:{permission:au.HIGH_QUALITY,metadata:{prettyUpgradeSource:"Full HD"}},[ou.BACKGROUND_IMAGE_ERASE]:{permission:au.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Background Image Erase",upsellBody:"Upgrade to export projects with Remove Background applied to images",imgSrc:"https://cdn-useast1.kapwing.com/static/nOm-remove-background-banner-image.svg"}},[ou.BRAND_TEMPLATES]:{permission:au.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit",heroBody:"Stay on-brand all the time with Brand Kit, now including templates. Create your own templates and easily start from them to save time and stay consistent across projects and team members.",heroHeader:"Introducing Brand Templates"}},[ou.BRANDKIT]:{permission:au.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit"}},[ou.STUDIO_MEDIA_SIDEBAR]:{permission:au.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Media Sidebar",upgradeReason:"to upload files up to 6GB"}},[ou.CREATE_NEW_FOLDER]:{permission:au.CREATE_NEW_FOLDER,metadata:{prettyUpgradeSource:"New Folder"}},[ou.ONBOARDING_SURVEY]:{metadata:{prettyUpgradeSource:"Onboarding Survey"}},[ou.MAGIC_SUBTITLE_FILE_DL]:{permission:au.SUBTITLER,metadata:{prettyUpgradeSource:"Magic Subtitle File Dl"}},[ou.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Single Account Upsell"}},[ou.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Multi-Account Upsell"}},[ou.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Single Account Upsell"}},[ou.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Multi Account Upsell"}},[ou.WORKSPACE_SETTINGS]:{metadata:{prettyUpgradeSource:"Workspace Settings"}},[ou.DEFAULT]:{metadata:{prettyUpgradeSource:"Default"}},[ou.CLEAN_AUDIO]:{permission:au.CLEAN_AUDIO,metadata:{prettyUpgradeSource:"Clean Audio"}},[ou.SMART_CUT_VIDEO]:{permission:au.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Video"}},[ou.SMART_CUT_AUDIO]:{permission:au.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Audio"}},[ou.REMOVE_VIDEO_BACKGROUND]:{permission:au.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Remove Video Background"}},[ou.AUDIOGRAM_WAVE]:{permission:au.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/F-T-white_waveform.webp"}},[ou.AUDIOGRAM_BAR]:{permission:au.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"}},[ou.STOCK_ASSETS_MUSIC]:{permission:au.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Music"}},[ou.STOCK_ASSETS_SFX]:{permission:au.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets SFX"}},[ou.STOCK_ASSETS_VIDEO]:{permission:au.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Video"}},[ou.STOCK_ASSETS_IMAGE]:{permission:au.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Image"}},[ou.PRICING_PAGE]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[ou.LINK]:{metadata:{prettyUpgradeSource:"Checkout Link"}},[ou.REACTIVATE_LICENSE]:{metadata:{prettyUpgradeSource:"Reactivate License"}}},cu=e=>lu[e].permission||iu,du="https://cdn-useast1.kapwing.com/static/9EB-img_upsell_sidebar.webp",uu="Upgrade to store unlimited projects, add folders, create without a watermark, and more.",mu=e=>{var t,a,o,n,r,i,s,l;const c=e&&lu[e],d=(null==c?void 0:c.permission)&&su[null==c?void 0:c.permission];return{img:{imgSrc:(null==(t=null==c?void 0:c.metadata)?void 0:t.imgSrc)||(null==d?void 0:d.imgSrc)||du,imgAlt:(null==(a=null==c?void 0:c.metadata)?void 0:a.upsellHeading)||(null==d?void 0:d.upsellHeading)||uu},heroImg:{imgSrc:(null==(o=null==c?void 0:c.metadata)?void 0:o.heroImg)||(null==d?void 0:d.heroImg)||du,imgAlt:(null==(n=null==c?void 0:c.metadata)?void 0:n.heroHeader)||(null==d?void 0:d.heroHeader)||"Staying on brand has never been easier"},upsellHeroHeading:(null==(r=null==c?void 0:c.metadata)?void 0:r.heroHeader)||(null==d?void 0:d.heroHeader)||"Staying on brand has never been easier",upsellHeroBody:(null==(i=null==c?void 0:c.metadata)?void 0:i.heroBody)||(null==d?void 0:d.heroBody)||"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",upsellBlockHeading:(null==(s=null==c?void 0:c.metadata)?void 0:s.upsellHeading)||(null==d?void 0:d.upsellHeading)||"Unlock the full Kapwing experience",upsellBlockBody:(null==(l=null==c?void 0:c.metadata)?void 0:l.upsellBody)||(null==d?void 0:d.upsellBody)||uu,upgradePermission:cu(e),buttonText:"Upgrade"}},pu=e=>{const t=e.toLowerCase().split(" ");for(let a=0;a<t.length;a+=1)t[a]=t[a].charAt(0).toUpperCase()+t[a].substring(1);return t.join(" ")},hu=(e,t,a)=>1===Math.abs(a)?e:t,gu=e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"}),fu=new Date,yu=(e,t)=>{const a=e.getTime(),o=t.getTime();return Math.round(Math.abs(a-o)/864e5)},Eu=e=>{switch(e){case jd.FREE:return new vu;case jd.BASIC:return new bu;case jd.PRO:return new Su;case jd.TEAM:return new Tu;default:return new vu}};class _u{constructor(e){t(this,"_planTier"),this._planTier=e}toString(){return this.displayPlan}get planTier(){return this._planTier}get displayTier(){return pu(this._planTier)}get displayPlan(){return`${pu(this._planTier)} Plan`}get className(){return this._planTier.toLowerCase()}get isMultiUser(){return this.hasPermission(au.MULTI_USER)}get planData(){return nu[this._planTier]}get isPaid(){return this._planTier!==jd.FREE}get showUpgrades(){return!this.hasPermission(au.NO_UPSELLS)}hasPermission(e){return su[e].planTiers.includes(this.planTier)}getBasePrice(){return this.planData.basePrice}}class vu extends _u{constructor(){super(jd.FREE)}}class wu extends _u{constructor(e){super(e),t(this,"_planTier"),this._planTier=e}get planTier(){return this._planTier}}class bu extends wu{constructor(){super(jd.BASIC)}}class Su extends wu{constructor(){super(jd.PRO)}}class Tu extends wu{constructor(){super(jd.TEAM),this.planTier}}const Iu=(e,t)=>{var a;let o;const n=null!=(a=null==t?void 0:t.paymentTerm)?a:Vd.NO_TERM;switch(e.toLowerCase()){case jd.FREE.toLowerCase():o=new Cu(jd.FREE,n);break;case jd.BASIC.toLowerCase():o=new Nu(jd.BASIC,n);break;case jd.PRO.toLowerCase():o=new Au(jd.PRO,n);break;case"teams".toLowerCase():case jd.TEAM.toLowerCase():o=new xu(jd.TEAM,n);break;default:throw Error(`Unable to create a payment plan for ${e} ${null==t?void 0:t.paymentTerm}`)}return o};class ku{constructor(e,a){t(this,"_planTier"),t(this,"_paymentTerm"),this._paymentTerm=a,this._planTier=Eu(e)}getPriceForTeam(e){return this.isMultiUser?this.basePrice*e.users.filter((e=>!e.isLegacy)).length:this.basePrice}toString(){return this.getTitle()}getTitle(){return pu(`Kapwing ${this.displayPlanTier} ${this.displayPaymentTerm?`${this.displayPaymentTerm} `:""}Plan`)}get isPaid(){return this._planTier.isPaid}get planTier(){return this._planTier.planTier}get paymentTerm(){return this._paymentTerm}get planTierClassName(){return this._planTier.className}get displayPlanTier(){return pu(this.planTier)}get displayPaymentTerm(){return this.paymentTerm===Vd.ANNUALLY?"Annual":this.paymentTerm===Vd.NO_TERM?"":this.paymentTerm}get showUpgrades(){return this._planTier.showUpgrades}get basePrice(){try{if(this.paymentTerm===Vd.NO_TERM)return 0;return this._planTier.getBasePrice()[this.paymentTerm]}catch(e){const t=Error("Invalid payment option");throw t.status=400,t}}get planData(){return nu[this.planTier]}get isMultiUser(){return this._planTier.isMultiUser}hasPermission(e){return this._planTier.hasPermission(e)}getReactivateText(e){return`${e} is the last day you’ll have access to ${pu(this.planTier)} features including watermark-free projects ${this.hasPermission(au.HIGH_QUALITY)?" and HD video quality":""}. Reactivate to continue using these features.`}showReactivate(e){if(this.paymentTerm===Vd.MONTHLY)return!0;if(this.paymentTerm===Vd.ANNUALLY){if(yu(new Date(e.current_period_end),fu)<30)return!0}return!1}}class Cu extends ku{constructor(e,t){if(super(e,t),t!==Vd.NO_TERM)throw new Error(`Error initializing ${e} payment plan with ${t} payment term`)}}class Nu extends ku{}class Au extends ku{}class xu extends ku{getPriceForTeam(e){const t=Eu(e.planTier);return!e.stripeId&&t.isPaid?0:super.getPriceForTeam(e)}}const Pu=()=>{const e=cn((e=>{var t;return null==(t=e.teams)?void 0:t.allTeams})),t=cn((e=>{var t;return null==(t=e.teams)?void 0:t.selectedTeamId}));if(!t||!e.length)return Hd;const a=null==e?void 0:e.filter((e=>!!e)).find((e=>e._id===t));return a||e[0]},Ru=(e={})=>{const t=Pu();return Ou({team:t,...e})},Ou=e=>{var t;return(null==(t=e.team)?void 0:t.planTier)?Iu(e.team.planTier,{paymentTerm:e.team.paymentTerm}):Iu(jd.FREE)},Du=(e,t)=>Ou({team:e.team}).hasPermission(t),Lu=(e,t={})=>{var a;t.upgradePermission&&(t.upgradeTiers=(a=t.upgradePermission,su[a].planTiers).filter((e=>!Eu(e).planData.isFree)));const o=((e,t,a)=>{if(Uu(e.planTier,e))return t.filter((e=>e===jd.TEAM));const o=e.planTier||jd.FREE;return t.filter((e=>e!==o)).filter((e=>e!==jd.BASIC||a)).filter((e=>nu[e].basePrice.annually>=nu[o].basePrice.annually)).filter((t=>{const{isMultiUser:a}=Eu(t);return!(e.users.length>1)||a}))})(e,t.upgradeTiers&&t.upgradeTiers.length?t.upgradeTiers:Gd,t.basicAvailable);if(o.length)return o;throw new Error(`Unable to determine upgrade tier ${o.join(", ")}`)},Uu=(e,t)=>!!t&&(e===jd.TEAM?!t.stripeId&&t.paymentTerm===Vd.NO_TERM:!![jd.BASIC,jd.PRO].includes(e)&&!t.stripeId),Mu=(e,t)=>!(!e||!t)&&(!!e.stripeId&&e.stripeId===t&&e.paymentTerm===Vd.NO_TERM),Fu=(e,t)=>t?e.filter((e=>!!e.stripeId&&e.stripeId===t)):[],Bu=e=>{const{teams:t}=null!=e?e:io().state,{allTeams:a,selectedTeamId:o}=t;if(!o||!a.length)return Hd;try{return t.allTeams.find((e=>e._id===t.selectedTeamId))}catch($ae){throw console.error("Unable to find current team..."),new Error(`Unable to find team - ${t} - ${null==t?void 0:t.selectedTeamId}`)}};function Wu(e){if(!e)return"";if("string"!=typeof e)return"";try{const t=e.split(/#|\?/)[0].split(".").pop();return(null!=t?t:"").trim()}catch{return""}}function Vu(e){const t=Wu(e);return""===t?"project":"jpg"===t||"png"===t||"jpeg"===t?"image":"gif"===t||"webp"===t?"gif":"mp3"===t?"audio":"video"}function ju(e){let t="";const{isCreator:a,origin:o}=e;t=e.isTrimmedOnly||e.isAudioTrimmedOnly?"Trimmed":e.memeTemplate||a&&"memeMaker"===o?"Meme":e.isStopMotionVideo?"Stop Motion":a&&"subtitler"===o?"Subtitled":e.isLooped?"Looped":e.isMontage?"Montage":e.isCollage||a&&"collage"===o?"Collage":e.isMuted?"Muted":e.isReversed?"Reversed":e.isImageVideo?"Converted Image":e.isTextVideo||a&&"addText"===o?"Text Added":e.isRotate?"Rotated":e.isSpeedVideo?"Speed Change":e.isConvertVideo?"Converted":e.isCreator||e.isStudio?"Studio":"Edited";const n=Vu(e.fullPath);return t+=` ${n.charAt(0).toUpperCase()}${n.slice(1)}`,t}function Hu(e){const{state:t}=io(),{currentUser:a}=t;return e===a.user._id}function Gu(e){const{state:t}=io(),{teams:a}=t;return!!a.allTeams.find((t=>t._id===e))}const $u=e=>{var t;return null==(t=null==window?void 0:window.fbq)?void 0:t.call(window,"trackCustom",e)};function Ku(e,t=0){const[a,o]=[Math.min(e,t),Math.max(e,t)],n=Math.abs(o-a);return[...Array(n+1).keys()].map((e=>e+a))}function Yu(e){return new Promise((t=>{setTimeout(t,e)}))}function zu(e,t=2){return+parseFloat((null!=e?e:0).toString()).toFixed(t)}function qu(e){return e.reduce(((e,t)=>(e[t.id]=t,e)),{})}const Ju=(e,t)=>{if(!e||!t)return!1;return e.split("@")[1]===t.split("@")[1]},Xu=e=>e.reduce(((e,t)=>e+t),0);function Qu(e,t){return e.length>t?`${e.substr(0,t-1)}...`:e}const Zu=()=>{const e=document.domain||"",t=e.startsWith("localhost");return e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")},em=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");let tm=1e5;function am(){return tm+=1,String(tm)}function om(e){const{user:t,token:a}=e||{};return!(E(t)||!a)}function nm(e,t){let a;if(t)a=t;else{const{state:e}=io();a=e.teams.allTeams}return a.find((t=>t.users.some((t=>t.userId===e&&t.hasLicense))))}function rm(e){if(!om(e))return!1;const{hasBasic:t}=e.user;return!!t}function im(e){if(!om(e))return!1;const{accountType:t}=e.user;return t===Oo.admin}function sm(e){if(!om(e))return!1;const{accountType:t}=e.user;return t===Oo.teacher||t===Oo.student}function lm(e){var t;if(!om(e))return!1;const{accountType:a,onboarding:o}=e.user,n=null==(t=null==o?void 0:o.survey)?void 0:t.occupation,r="student"===n||"teacher"===n;return a===Oo.teacher||a===Oo.student||r}function cm(e){if(!om(e))return"";const{user:t}=e,{name:a,firstName:o,lastName:n}=t;return a||(o&&n?`${o} ${n}`:o||(n||""))}function dm(e){if(!om(e))return"";const{user:t}=e,{name:a,firstName:o}=t;let n="";try{if(o){n=Qu(o.split(" ")[0],24)}else if(a){n=Qu(a.split(" ")[0],24)}}catch($ae){}return n}function um(e){if(!om(e))return"";const{user:t}=e,{email:a}=t;return a||""}function mm(){if("undefined"==typeof window||"undefined"==typeof document)return!1;let e=null;try{e=localStorage.getItem("isTWA")}catch($ae){console.error($ae)}return"getDigitalGoodsService"in window&&e&&window.matchMedia("(display-mode: standalone)").matches}var pm=(e=>(e.GetStarted="Get Started",e.NewContentWorkspace="New Content (Workspace)",e.EditThisTemplate="Edit this Template",e.PasteALink="Paste a Link",e.UploadFiles="Upload File(s)",e))(pm||{});Md();let hm=!1;if("undefined"!=typeof window){const e=document.domain||"",t=e.startsWith("localhost");hm=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")}let gm=[];function fm(e,t={}){const{state:a}=io(),{currentUser:o,currentVideo:n,studio:r,teams:i}=a||{},{user:s}=o||{},{_id:l}=s||{};if(l&&amplitude.getInstance().setUserId(l),amplitude.getInstance().setUserProperties({"Workspace Count":i.allTeams.length}),!t["Video ID"]){const{_id:e}=n||{},{_id:a}=r||{},o=a||e;o&&(t["Video ID"]=o)}const c=ao(),d=hm?c:"v2023.02.22.2";t["App Version"]=d,t["Canary Server"]=!1,t["App Type"]=mm()?"Android":"Web",t.hostname=window.location.hostname,Object.assign(t,function(){const e=420;return{...Bd(),maxExportDurationNonPro:e}}()),amplitude.getInstance().logEvent(e,t,(()=>{}),(()=>{navigator.onLine?console.error(`Error submitting event ${e}: `,t):gm.push({eventName:e,eventProperties:t,dateTime:new Date,userId:l})}))}function ym(){const{state:e,dispatch:t}=io();(e.projectSessionSettings.splitsLogged||0)<100&&(fm("Split Video Layer",{}),t(_i()))}function Em(e,t){const{state:a,dispatch:o}=io();(a.projectSessionSettings.addLayerLogged||0)<50&&"video"===e&&(fm("Add Video Layer To Project",{place:t}),o(Ei()))}function _m(e){var t;const{state:a,dispatch:o}=io();((null==(t=a.projectSessionSettings.trimsLogged)?void 0:t[e])||0)<2&&(o(vi(e)),fm("Used Trimmer",{location:e}))}function vm(e,t,a,o=!1){let n={Email:e.email,"Entry Point":a};o&&(n={...n,"Google One-Tap":!0}),amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),t?(amplitude.getInstance().logEvent("Create Account",n),$u("Create Account"),Ir("Create Account")):amplitude.getInstance().logEvent("Log In",n)}function wm({couponId:e=null,checkoutType:t,isAnonUpgrade:a,paymentTerm:o,planTier:n,paymentProcessor:r,upgradeSource:i,extraAmplitudeEventProperties:s,currentPlan:l,teamId:c,upgradePlan:d,quantity:u}){const m=Sm(i),p=pu(n);fm("Upgrade Workspace",{"Signed In":!a,"Monthly/Annual":o,"License Tier Purchased":p,"Payment Processor":r,"Upgrade Source":m,"Checkout Type":t,"Current Plan":a?void 0:pu(l),Coupon:e,"Team ID":c,"Purchased Plan":d,"Number of Workspace Members":u,...s});const h={"Account Type":p};e&&(h.Coupon=e),amplitude.getInstance().setUserProperties(h),$u("Upgraded")}function bm(e,t){fm("Timing Tab Exact Time Set",{"Layer Type":t,"Start or End Input":e})}"undefined"!=typeof window&&(window.onload=()=>{Md()},window.addEventListener("online",(()=>{const e=[...gm];gm=[],e.forEach((e=>{e.userId&&amplitude.getInstance().setUserId(e.userId),amplitude.getInstance().logEvent(e.eventName,{...e.eventProperties,"Event Sent While Offline":!0,"Offline Event Time":e.dateTime},(()=>{}),(()=>{navigator.onLine?console.error(`Error submitting event ${e.eventName}: `,e.eventProperties):gm.push(e)}))}))})));const Sm=e=>{var t;return e&&(null==(t=lu[e].metadata)?void 0:t.prettyUpgradeSource)||e};function Tm(e,t={}){const{chosenPlan:a,dripDiscount:o,extraProperties:n={}}=t,{state:r}=io(),{currentUser:i}=r,s=Sm(e),l=Bu(),c=Ou({team:l}).planTier,d=om(i),u={"Upgrade Source":s,"Signed In":d,"Current Plan":d?pu(c):void 0,"Team ID":l?l._id:"","Number of Workspace Members":l?l.users.length:1};a&&(a===jd.PRO&&(u["Chosen Plan"]="Pro"),a===jd.BASIC&&(u["Chosen Plan"]="Basic")),o&&(u["Discount Value"]=o),fm("Visit Checkout",{...u,...n})}function Im(e,t,a){var o;const{analytics:n,magicSubtitles:r,scenes:i}=t;if(n&&(n.usedSplit&&(e["Used Split"]=!0),e["Number of Video Splits"]=null!=(o=n.timesVideoSplit)?o:0,n.usedCollaboration&&(e["User Collaboration"]=!0),n.usedCollaborationWithOtherUser&&(e["User Collaboration With Other User"]=!0),n.usedSmartCut&&(e["Used Smart Cut"]=!0),n.usedSceneSplit&&(e["Used Scene Split"]=!0),n.usedCanvasResize&&(e["Used Canvas Resize"]=!0)),i){let t=0;const o=new Set;for(const n of i)for(const r of n.layers){const n=Od(r,a.mediaCache);r.type===xr.Video&&n&&o.add(n),r.type===xr.Subtitle&&(e["Has Subtitles"]=!0),r.type===xr.Text&&(e["Has Text"]=!0,t+=1)}e["Number of Video Input Files"]=o.size,e["Number of Text Layers"]=t,(e=>{for(const t of e)for(const e of t.layers)if(Kr(e))return!0;return!1})(i)&&(e["Used Text to Speech"]=!0)}r&&Object.values(r).some((e=>null==e?void 0:e.enabled))&&(e["Has Magic Subtitles"]=!0),t.duration&&(e.Duration=t.duration)}function km(e,t,a){(Math.random()<a||document.domain.startsWith("localhost"))&&fm(e,t)}function Cm(e=window.location.pathname){var t,a,o,n;const{state:{currentUser:r,mediaCache:i,studioLocal:{initialIDBAssetIdLoadDone:s,isProjectFetched:l,idbAssetIds:c,isNewProject:d},studio:u}}=io(),{creatorEmail:m,scenes:p}=u;if(!(s&&l||d))return;const h=new Set(c);let g=0,f=!1;for(const T of p)for(const e of T.layers){const t=Od(e,i);qr(e)&&t&&!h.has(t)&&(g+=1,e.type===xr.Video&&(f=!0))}const y={"Video Id":u._id,"N Remote Layers":g,"Has Remote Video":f,"Project Owner Email":m};let E=u.origin;const _=e.includes("/sharing");_&&(E="Project Share");const{history:v}=io(),w="shared-with-me"===(null==(t=v.location.state)?void 0:t.from);w&&(E="Shared with Me");let b=!1;const S=null==(a=r.user)?void 0:a.email;om(r)&&(b=Ju(S,m)),y.Origin=E,y["Owner And Collaborator Domain Match"]=b,y["Project Collaborator Email"]=S||"Anonymous",y["Is Team Member"]=Gu(null!=(o=u.teamId)?o:""),y["Is Project Owner"]=Hu(null!=(n=u.creatorId)?n:""),(g>0||_||w)&&fm("Remote Re-Edit Started",y)}const Nm=new Map;function Am({accountType:e,hasLicense:t,hasBasic:a}){switch(e){case Oo.student:return"Student";case Oo.teacher:return"Teacher"}if(t)return"Pro";if(a)return"Basic";switch(e){case Oo.admin:return"Admin";case Oo.free:return"Free"}return null}function xm(e,t){const a={};a["Add Transition Method"]=e,a["Transition Name"]=t,fm("Add Transition",a)}const Pm=[];"undefined"!=typeof window&&(window.amplitudeOnExit=()=>{for(const e of Pm)e()});const Rm=(e,t,a,o)=>{if(!o.includes("/sharing")&&!o.includes("/invites"))return;const{currentFolderId:n,currentVideoId:r,creatorEmail:i,workspaceOwnerEmail:s,teamId:l,teamOwnerEmail:c}={currentFolderId:(d=io().state).workspaces.sharedWorkspaceId,currentVideoId:d.studio._id,creatorEmail:d.studio.creatorEmail,workspaceOwnerEmail:d.workspaces.workspaceOwnerEmail,teamId:d.teams.sharedTeamId,teamOwnerEmail:d.teams.sharedTeamOwnerEmail};var d;const u=null==o?void 0:o.includes("/studio/editor"),m=null==o?void 0:o.includes("team");let p,h,g,f,y;u?(p="Studio Project",h="Video ID",g=r,f="Project Owner Email",y=i):m?(p="Team",h="Team ID",g=l,f="Team Owner Email",y=c):(p="Folder",h="Folder ID",g=n,f="Folder Owner Email",y=s);const E=Ju(e.email,y),_={"Share Flow":p,"Sign In Method":a,Email:e.email,"New User":t,[h]:g,[f]:y,"Owner and Collaborator Domain Match":E};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Share Sign In Success",_)},Om=(e,t,a,o,n,r)=>{const i={"Project Owner Email":a,"Sharer Email":e.email,"Share Type":n,"Share Permissions":r,"Video ID":t,"Share Origin":o};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Completed",i)},Dm=(e,t,a={})=>{const{includeTimestamp:o,teamId:n,creatorId:r}=a,i={"Activity type":e,"Comment location":t};o&&(i["Timestamp included"]=o),n&&(i["Is Team Member"]=Gu(n)),r&&(i["Is Project Owner"]=Hu(r)),fm("New Comment Activity",i)},Lm=(e,t)=>{fm("Changed Text Outline Color",{layerType:e,color:t})},Um=(e,t,a)=>{const{state:o}=io(),{currentUser:n}=o||{},{user:r}=n||{},{_id:i}=r||{},s={Usage:e,Occupation:t,"Project Usage":a};fm("Completed Onboarding Survey",s),i&&amplitude.getInstance().setUserId(i),amplitude.getInstance().setUserProperties(s)},Mm=()=>{var e,t;return null==(t=null==(e=null==amplitude?void 0:amplitude.getInstance())?void 0:e.getSessionId)?void 0:t.call(e)};function Fm(e,t,a=null){var o;const n=31536e3;return(new _).set("ssrSignedInCookie",t,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:n,secure:!0}),e.email&&(null==(o=window.profitwell)||o.call(window,"user_email",e.email)),function(e){const t=Am(e),a=Nm.get(e._id);t&&t!==a&&(amplitude.getInstance().setUserProperties({"Account Type":t}),Nm.set(e._id,t))}(e),{type:"RECEIVE_USER_AND_SET_TOKEN",user:e,token:t,receivedAt:Date.now(),impersonatingAdminEmail:a}}function Bm(){return{type:"REQUEST_USER"}}function Wm(){return(new _).remove("ssrSignedInCookie",{path:"/"}),{type:"SIGN_OUT"}}function Vm(e,t=!1){return a=>op("/api/v1/users/google/findUser",{body:{user:e}}).then((e=>{a(Fm(e.user,e.token));vm(e.user,e.newUser,"Google",t)}))}function jm(){return new Worker("/assets/gzip-worker.462a36ed.js")}const Hm={Accept:"application/json","Content-Type":"application/json"},Gm={method:"GET",parseJSON:!0,timeout:3e4},$m="undefined"!=typeof window;function Km(){return $m?window.location.host:"localhost:5000"}function Ym(){let e=Km();return e=e.startsWith("http")?e.replace("http","ws"):e.startsWith("localhost")?`ws://${e}/websocket`:`wss://${e}/websocket`,e=e.replace("localhost:3000","localhost:5000"),e}function zm(){return["127.0.0.1","localhost"].some((e=>Km().startsWith(e)))}function qm(e){if(e.includeAuth){const o=(null==(a=null==(t=io().state)?void 0:t.currentUser)?void 0:a.token)||"";o&&(e.headers={"x-access-token":o,...e.headers||{}})}var t,a}function Jm(e,t){let a=e;const{params:o}=t;if(o){const t=e.includes("?")?"&":"?",n=function(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(o);a+=`${t}${n}`}return a}async function Xm(e,t={}){const a={...Gm,...t},{body:o,parseJSON:n,timeout:r,retries:i=0,zipBody:s}=a;let l,c;delete a.parseJSON,delete a.zipBody,a.headers={...Hm,...a.headers||{}},"object"==typeof o&&(a.body=JSON.stringify(a.body)),s&&"string"==typeof a.body&&(a.headers={...a.headers,"Content-Encoding":"gzip"},a.body=await async function(e){return new Promise(((t,a)=>{const o=new jm;o.postMessage(e),o.onmessage=e=>{o.terminate(),t(e.data)},o.onerror=()=>{o.terminate(),a()}}))}(a.body));const d=new Date;let u=null,m=0;const p=$m&&window.openReplayFetch;for(;m<=i;){r&&(delete a.timeout,c=new(p?window.AbortController:AbortController),a.signal=c.signal,l=setTimeout((()=>{console.debug("timeout on url",e," req sent on ",d," options are ",JSON.stringify(a)),c.abort()}),r));const t=Jm(e,a);try{const e=p?window.openReplayFetch:v;u=await e(t,a);break}catch(h){if(m>=i||sn())throw h;w({category:"fetch retry",message:`Url ${e} retry ${m}`}),m+=1,await new Promise((e=>setTimeout(e,2**m*1e3)))}finally{l&&clearTimeout(l)}}return u&&!u.ok&&await async function(e,t){let a=t.statusText||"An unexpected error occurred.",o=null;try{const e=await t.json(),{message:n,statusText:r,invalid_token:i,...s}=e;a=n||r||n,Object.keys(s).length>0&&(o=s),i&&(io().dispatch(Wm()),a="Your token was invalid. Please sign in again.")}catch(n){try{a=await t.text()||a}catch(r){}}throw new Qm(a,t.status,e,o)}(e,u),n?u.json():u}class Qm extends Error{constructor(e,a,o,n){super(e),t(this,"name","FetchStatusError"),this.status=a,this.url=o,this.additionalData=n}}async function Zm(e,t={}){return async function(e,t={}){const a={...t,includeAuth:!0};let o;if(qm(a),Za)o=Za;else{o=`https://notifications.${zm()||Km().includes("dev")?"kapwing-dev":"kapwing"}.com`}return Xm(`${o}/${e}`,a)}(e,{...t,method:"POST"})}async function ep(e,t={}){const a={zipBody:!0,...t,includeAuth:!0};qm(a);return Xm(`${zm()?"http":"https"}://${Km()}${e}`,a)}function tp(e,t={}){return ep(e,{...t,method:"DELETE"})}function ap(e,t={}){return ep(e,{...t,method:"GET"})}function op(e,t={}){return ep(e,{...t,method:"POST"})}function np(e,t={}){return ep(e,{...t,method:"PUT"})}function rp(e,t={}){return ep(e,{...t,method:"PATCH"})}function ip(e,t={}){return function(e,t={}){qm(t);const{CLOUD_FUNCTIONS_PREFIX:a}=io().state.config;return Xm(`https://us-central1-kapwing-181323.cloudfunctions.net/${a}${e}`,t)}(e,{...t,method:"POST"})}var sp=(e=>(e.SET_TEAM_CHECKOUT_DATA="SET_TEAM_PRORATION_DISCOUNT",e.SET_TEAM_CHECKOUT_DATA_LOADING="SET_TEAM_PRORATION_DISCOUNT_LOADING",e))(sp||{});function lp(e,t,a){return{type:"SET_TEAM_PRORATION_DISCOUNT",payload:{teamId:e,prorationDiscount:t,subscription:a}}}function cp(e){return{type:"SET_TEAM_PRORATION_DISCOUNT_LOADING",payload:{teamId:e}}}const dp=(e=!1)=>async(t,a)=>{const{checkoutStore:o}=a();if(!o.legacy||e)try{t(cp("REDUX_LEGACY_ID"));t(lp("REDUX_LEGACY_ID",0,(await ap("/api/v2/payment/getLegacySubscription")).subscription))}catch($ae){console.error("Error fetching legacy checkout data",$ae),t(lp("REDUX_LEGACY_ID",0))}},up=(e,t=!1)=>async(a,o)=>{if(!e)return void console.error("No team id to fetch checkout data.");const{checkoutStore:n}=o();if(!n[e]||t)try{a(cp(e));const t=await ap(`/api/v2/payment/teamCheckoutData?teamId=${e}`);t.success&&a(lp(e,t.prorationDiscount/100,t.teamDTO.subscriptionDTO))}catch($ae){console.error("Error fetching team checkout data",$ae)}};const mp=b({},{[sp.SET_TEAM_CHECKOUT_DATA]:(e,t)=>{e[t.payload.teamId]={loading:!1,prorationDiscount:t.payload.prorationDiscount,subscription:t.payload.subscription}},[sp.SET_TEAM_CHECKOUT_DATA_LOADING]:(e,t)=>{var a,o;e[t.payload.teamId]={loading:!0,prorationDiscount:null==(a=e[t.payload.teamId])?void 0:a.prorationDiscount,subscription:null==(o=e[t.payload.teamId])?void 0:o.subscription}}}),pp=d({name:"theme",initialState:{darkMode:!1},reducers:{setDarkMode:(e,t)=>{e.darkMode=t.payload}}}),{setDarkMode:hp}=pp.actions,gp={CLOUD_FUNCTIONS_PREFIX:""};function fp(e){var t;const a={};for(const o in e)if(!["scenes","selectedSceneIndex"].includes(o))if("allLayers"===o){const t=c(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),a.allLayers=t}else a[o]=e[o];if("scenes"in e){a.scenes=[];for(const o of e.scenes)if(o){a.scenes.push(o.id),a[`scene_${o.id}`]={},a[`scene_${o.id}_layers`]=[];for(const e in o)"layers"!==e&&(a[`scene_${o.id}`][e]=o[e]);for(const e of o.layers){if(!e)continue;const n=c(e);delete n.local_url,a[`layer_${e.id}`]=n,null==(t=a[`scene_${o.id}_layers`])||t.push(e.id)}}}return c(a)}let yp=0,Ep=0,_p=0,vp=0,wp=!1,bp=0;const Sp=()=>{Ep=0},Tp=e=>{wp!==e&&(wp=e,bp=performance.now())},Ip=()=>{vp=performance.now()},kp=()=>{const e=performance.now();return{appSession:Ud,amplitudeSession:Mm(),sessionDuration:e,timeSinceLastOpSent:e-_p,timeSinceLastOpReceived:e-vp,globalOpCounter:yp,projectOpCounter:Ep,wsConnected:wp,timeSinceWsConnectedChanged:e-bp}};let Cp;function Np(e,t){const a=function(e,t){const a={cv:"0.6",submittedAt:Date.now(),...kp(),...t};return{...e,__md:a,__localMd:{id:y()}}}(c(e),t);yp+=1,Ep+=1;const{sharedDoc:o}=window;(null==o?void 0:o.opsDisabled)||(pi.push(a),null==Cp&&(Cp=setTimeout((()=>{if(Cp=void 0,window.sharedDoc){const e=pi.dequeueAll();Ap(e,"live",(()=>{for(const t of e)pi.removePending(t)}))}else console.info("sharedDoc is unavailable. can't submit ops")}))))}function Ap(e,t,a){Hp();const{sharedDoc:o}=window;if(!o)return console.info("sharedDoc is unavailable. can't submit ops"),!1;console.debug("submitting ",e.length,"ops");const n=Array.from(e,(e=>T.omit(e,"__localMd")));return o.submitOp(n,void 0,(e=>{e?function(e,t,a={}){const o=e.message.includes("Version mismatch");o&&(window.sharedDoc.opsDisabled=!0);const n=t.slice(0,10);console.error("Failed to submit op.",e),s("Failed to submit op",{extra:{error:e,opsCount:t.length,ops:n},tags:{...a,versionMismatch:o}})}(e,n,{isSyncOfflineOps:"offline"===t}):(Gp(),_p=performance.now()),a()})),!0}function xp(e=1e4){var t;if(!window.sharedDoc)return Promise.reject(new Error("Sharedb is not connected"));const a=c(null!=(t=null==pi?void 0:pi.getAllPendingOps())?t:[]);if(!pi||!a.length)return Promise.resolve([]);console.info(`Submitting ${a.length} offline ops`);for(const n of a)n.__md.offlineOpSubmittedAt=Date.now();const o=new Promise((e=>Ap(a,"offline",(()=>e())))).then((()=>{for(const e of a)pi.removePending(e)}));return Promise.race([o,rn(e)])}function Pp({path:e,val:t,oldVal:a,srcFn:o,skipLastUpdated:n}){(t||t!==a)&&Np({p:e,od:a,oi:t},{srcFn:o,skipLastUpdated:n})}function Rp({path:e,val:t,srcFn:a,skipLastUpdated:o}){Np({p:e,li:t},{srcFn:a,skipLastUpdated:o})}function Op({path:e,oldVal:t,srcFn:a,skipLastUpdated:o}){Np({p:e,ld:t},{srcFn:a,skipLastUpdated:o})}function Dp({path:e,val:t,oldVal:a,srcFn:o,skipLastUpdated:n}){Np({p:e,li:t,ld:a},{srcFn:o,skipLastUpdated:n})}function Lp(e,t,a,o,n){JSON.stringify(a)!==JSON.stringify(t)&&Np({p:[e],od:a,oi:t},{srcFn:o,skipLastUpdated:n})}function Up(e,t,a,o,n,r){if(o===a)return;Np({p:[e,t],od:o,oi:a},{srcFn:n,skipLastUpdated:r})}function Mp(e,t,a,o,n){return Up(e,t,a,o,n)}function Fp(e,t,a,o){Np({p:[e,t],od:a},{srcFn:o})}function Bp(e,t,a,o){Np({p:[`layer_${t.id}`],oi:t},{srcFn:o});Np({p:[`scene_${e.id}_layers`,a],li:t.id},{srcFn:o})}function Wp(e,t,a,o){Np({p:[`scene_${a.id}_layers`,e],ld:t.id},{srcFn:o});Np({p:[`layer_${t.id}`],od:t},{srcFn:o})}function Vp(e,t,a,o){Np({p:["subtitles",t],li:e,ld:a},{srcFn:o})}function jp(e,t,a,o){0===Object.keys(e.presence||{}).length?Pp({path:["presence"],val:{[a]:t},oldVal:e.presence,srcFn:o,skipLastUpdated:!0}):Pp({path:["presence",a],val:t,oldVal:e.presence[a]||{},srcFn:o,skipLastUpdated:!0})}const Hp=S((()=>{setTimeout((()=>{io().dispatch(Sl("websocket"))}))}),5e3),Gp=S((()=>{setTimeout((()=>{io().dispatch(Tl("websocket"))}))}),5e3);function $p(e){return{type:"SET_MOUSE_POSITION_TOOLTIP",mousePosition:e}}function Kp(){return{type:"CLEAR_MOUSE_POSITION_TOOLTIP"}}const Yp={user:{},token:""},zp=e=>{const t=31536e3;(new _).set("ssrSignedInCookie",e,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:t,secure:!0})},qp=e=>{var t;I(null!=e?{id:e._id,email:e.email,segment:null!=(t=Am(e))?t:void 0,accountType:""}:null)},Jp={currentTemplate:(e={},t)=>"SET_CURRENT_TEMPLATE"===t.type?t.currentTemplate:e,exampleVideos:(e=[],t)=>"SET_TEMPLATE_EXAMPLE_VIDEOS"===t.type?t.exampleVideos:e,infoForSelectedTemplateLetter:(e={letter:"",count:0},t)=>"SET_NUM_TEMPLATES_FOR_LETTER"===t.type?{letter:t.letter,count:t.count}:e,parentId:(e="",t)=>{switch(t.type){case"SET_PARENT_ID":return t.parentId||"";case"RESET_EDITOR":return"";default:return e}},templateSource:(e="",t)=>"SET_TEMPLATE_SOURCE"===t.type?t.source:e,templates:(e=[],t)=>{switch(t.type){case"SET_TEMPLATES":return t.templates;case"RESET_EDITOR":return[];default:return e}}},Xp={numPostsForCurrentCategory:(e=0,t)=>{switch(t.type){case"SET_NUM_POSTS_FOR_CURRENT_CATEGORY":return t.numPosts;case"RESET_CATEGORIES":case"RESET_EDITOR":return 0;default:return e}}},Qp={currentPost:(e={},t)=>"SET_CURRENT_POST"===t.type?t.currentPost:e,postsForCurrentCategory:(e=[],t)=>{switch(t.type){case"SET_CATEGORY_POSTS":return t.posts;case"RESET_CATEGORIES":case"RESET_EDITOR":return[];default:return e}}},Zp=k("CMLFiles/removeFromMyMedia",(async e=>await tp(`/api/v1/cloudMediaLibrary/myMedia/${e}`)),{condition:(e,{getState:t})=>"pending"!==t().CMLFiles.removeFromMyMediaFetchStatuses[e]}),eh=k("CMLFiles/removeAllMyMedia",(async()=>await tp("/api/v1/cloudMediaLibrary/myMedia")),{condition:(e,{getState:t})=>"pending"!==t().CMLFiles.removeAllMyMediaFetchStatus}),th=d({initialState:{byId:{},initializingCMLFromIDB:!1,myMediaIds:[],myMediaInitialized:!1,promptRemoveFiles:null,removeFromMyMediaFetchStatuses:{},removeAllMyMediaFetchStatus:null,toUploadId:{}},name:"CMLFiles",reducers:{addToMyMedia:(e,t)=>{t.payload.forEach((t=>{e.myMediaIds.includes(t)||e.myMediaIds.push(t)})),e.myMediaInitialized=!0},filesFetched:(e,t)=>{t.payload.forEach((t=>{e.byId[t.id]=t}))},linkToUploadId:(e,t)=>{e.toUploadId[t.payload.cmlFileId]=t.payload.uploadId},initializingCMLFromIDBStart:e=>{e.initializingCMLFromIDB=!0},initializingCMLFromIDBComplete:e=>{e.initializingCMLFromIDB=!1},promptRemove:(e,t)=>{e.promptRemoveFiles=t.payload},promptRemoveCompleted:e=>{e.promptRemoveFiles=null},changeCMLFileName:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].fileName=t.payload.newFileName)},updateLocalCMLFileModifiedDate:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].modified=t.payload.modified.toISOString())}},extraReducers:e=>{(e=>{e.addCase(Zp.pending,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="pending"})),e.addCase(Zp.rejected,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="rejected"})),e.addCase(Zp.fulfilled,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="fulfilled",e.myMediaIds=e.myMediaIds.filter((e=>e!==t.meta.arg))}))})(e),(e=>{e.addCase(eh.pending,(e=>{e.removeAllMyMediaFetchStatus="pending"})),e.addCase(eh.rejected,(e=>{e.removeAllMyMediaFetchStatus="rejected"})),e.addCase(eh.fulfilled,(e=>{e.removeAllMyMediaFetchStatus="fulfilled",e.myMediaIds=[]}))})(e)}}),{addToMyMedia:ah,filesFetched:oh,initializingCMLFromIDBComplete:nh,initializingCMLFromIDBStart:rh,linkToUploadId:ih,promptRemove:sh,promptRemoveCompleted:lh,updateLocalCMLFileModifiedDate:ch,changeCMLFileName:dh}=th.actions;async function uh(){return await ap("/api/v1/cloudMediaLibrary/myMedia")}async function mh(e){return await ap(`/api/v1/cloudMediaLibrary/file/${e}`)}function ph(e){setTimeout((()=>{e()}))}async function hh(e,t){ph((()=>op(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}async function gh(e,t){return await op("/api/v1/cloudMediaLibrary/filesFromAssets",{body:{assetIds:e,linkToUser:t}})}async function fh(e,t){return await op(`/api/v1/cloudMediaLibrary/file/${e}/conversionFinished`,{body:{convertedAssetId:t}})}async function yh(e,t){return await rp("/api/v1/cloudMediaLibrary/updateFileName",{body:{cmlFileID:e,newFileName:t}})}const Eh=e=>No.includes(e.value)&&void 0===(null==e?void 0:e.default)||!0===(null==e?void 0:e.default),_h=e=>"custom"===e.type&&"62962eab0af119277ab7c9c3"===e.asset_id,vh=e=>"62d61954f85729d3ec1db3f4"===e;function wh(e,t=Ko){console.error(e);let a="";return"string"==typeof e&&(a=e),"object"==typeof e&&null!==e&&e.message&&(a=e.message),"Network request failed"===a?{type:"NOOP"}:{type:"SHOW_ERROR",errorMessage:a,errorType:t}}function bh(e){return{type:"SHOW_SUCCESS",successMessage:e}}function Sh(e){let t="";return"string"==typeof e?t=e:e instanceof Error?t=e.message:console.error(`Cannot show warning for ${e}`),{type:"SHOW_WARNING",warningMessage:t}}function Th(e,t="blue"){return{type:"SHOW_INFO",infoMessageName:e,theme:t}}function Ih(){return{type:"HIDE_INFO"}}function kh(){return{type:"SHOW_VIEW_ONLY_MODE_TOAST"}}function Ch(){return{type:"HIDE_VIEW_ONLY_MODE_TOAST"}}const Nh={epochs:["yr","month","day","hr","min"],yr:31536e3,month:2592e3,day:86400,hr:3600,min:60},Ah=14,xh=new Date;function Ph(e,t){try{const t=function(e){let t,a;for(let o=0;o<Nh.epochs.length;o+=1)if(t=Nh.epochs[o],a=Math.floor(e/Nh[t]),a>=1)return{interval:a,epoch:t};return null}(Math.floor((new Date-new Date(e))/1e3)),a=t.interval>1||0===t.interval?"s":"";return`${t.interval} ${t.epoch}${a}`}catch($ae){return t||"a little while"}}function Rh(e,t={}){const{excludeMs:a,msPrecision:o=2,dontPadMax:n}=t,r=!n,i=Number(Number.parseFloat(e).toFixed(o));if(Number.isNaN(i))return"0.00";const s=Math.round(1e3*i);let l=Math.floor(s%1e3),c=Math.floor(i%60),d=Math.floor(s/6e4%60),u=Math.floor(s/36e5%60);u<10&&r&&(u=`0${u}`),d<10&&(u>0||r)&&(d=`0${d}`),c<10&&(u>0||d>0||r)&&(c=`0${c}`),l<100&&(l=`0${l}`),l<10&&o>2&&(l=`0${l}`);let m=`${c}`;return a||(m=`${c}.${l.toString().slice(0,o)}`),(d>0||parseFloat(u.toString()))&&(m=`${d}:${m}`),u>0&&(m=`${u}:${m}`),m}function Oh(e,t,a){let o=Rh(e,a);return t||(o=o.replace(".00","")),o.includes(":")||(o=`0:${o}`),o.startsWith("0")&&!o.startsWith("0:")&&(o=o.slice(1)),o}const Dh=(e,t)=>{const a=e.getTime(),o=t.getTime();return Math.floor(Math.abs(a-o)/864e5)},Lh=e=>{const t=C(new Date).diff(e,"days"),a=C(e).day(),o=C().day(),n=C().subtract(1,"days").day();return t<7?a===o?C(e).format("[today at] h:mma"):a===n?C(e).format("[yesterday at] h:mma"):C(e).format("[last] dddd [at] h:mma"):C(e).format("MM/DD/YYYY")},Uh=e=>{const t=C(e).get("date"),a=C().get("date"),o=C().subtract(1,"days").get("date");return t===a?C(e).format("[today at] h:mma"):t===o?C(e).format("[yesterday at] h:mma"):C(e).format("MM/DD/YYYY")};function Mh(e){const t=new Date(1e3*e);return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}function Fh(e){return new Date(e.getFullYear(),e.getMonth())}function Bh(){const{teams:e}=io().state,{allTeams:t,selectedTeamId:a}=e;return!(0===t.length||!a)&&t.some((e=>e._id===a))}async function Wh(){const{state:e}=io(),{currentUser:t}=e,{token:a,user:o}=t,{_id:n}=o||{};return ap("/api/v1/teams/early-access-customers",{params:{token:a,userId:n}})}async function Vh(e){const{dispatch:t,state:a}=io(),{currentUser:o}=a,{token:n,user:r}=o,{_id:i}=r||{};try{await op("/api/v1/teams/early-access-customers/add",{body:{token:n,userId:i,email:e},parseJSON:!1}),t(bh(`User ${e} has been added.`))}catch($ae){t(wh(`There was an error adding user ${e}.`))}}async function jh(e){const{dispatch:t,state:a}=io(),{currentUser:o}=a,{token:n,user:r}=o,{_id:i}=r||{};try{await tp("/api/v1/teams/early-access-customers/remove",{body:{token:n,userId:i,email:e},parseJSON:!1}),t(bh(`User ${e} has been removed.`))}catch($ae){t(wh(`There was an error removing user ${e}.`))}}const Hh=e=>e&&e.users?e.users.filter((e=>e.isLegacy)):[],Gh=()=>{var e;const t=Bu();if(!(null==t?void 0:t.limits))return!1;const a=Fh(new Date(null==(e=t.limits)?void 0:e.lastUpdatedTranscribe));return Fh(new Date)>a};async function $h(e,t){const{dispatch:a}=io(),o={requesterId:t.user._id,teamId:e,requesterEmail:t.user.email};try{await op("/api/v1/requests/teams",{body:o})}catch($ae){a(wh($ae))}}const Kh={createdAt:new Date,creatorId:"",_id:"",licensesAvailable:"",licensesTotal:"",name:"",users:[],planTier:jd.FREE,paymentTerm:Vd.NO_TERM,emailDomain:"",settings:{defaultPrivacy:Po.unlisted},limits:{cumulativeExportDuration:0,lastUpdatedCumulativeDuration:new Date,transcribeUsage:0,lastUpdatedTranscribe:new Date}},Yh=e=>{const{teams:{allTeams:t}}=io().state;return t.find((t=>t._id===e))||Kh},zh=async(e,t,a,o,n)=>{const r=await og(e);if(!r)return;const i={"Team ID":e,"Number of Workspace Members":r.totalTeamMembers,"Brandkit is set up":r.isBrandkitSetup,"Current Plan":pu(t),"Monthly/Annual":a,"Subscription Status":o,"Quantity Legacy Members":n,"Is Paying":a!==Vd.NO_TERM};window.sessionStorage.setItem("TEAM_WORKSPACE_ACCESS_LOGGED","TRUE"),fm("Team Workspace Accessed",i)},qh=async(e,t,a,o,n)=>{const{workspaceId:r}=e,{state:i}=io(),s=i.workspaces.allWorkspaces.find((e=>e._id===r)),l=await og((null==s?void 0:s.teamId)||"");if(!l)return;const{team:c}=l,{_id:d}=c||{},u=!!c,m=null==s?void 0:s.type;if(u){const{currentUser:{user:{_id:r}}}=i,s=e.creatorId&&e.creatorId===r;let c;m===Io.team?c="Team Folder":m===Io.personal&&(c="My Folder");fm("Team Project Accessed",{"Project Location":c,"Is Project Owner":s,"Team ID":d,"Number of Workspace Members":l.totalTeamMembers,"Brandkit is set up":l.isBrandkitSetup,"Current Plan":pu(t),"Monthly/Annual":a,"Subscription Status":o,"Quantity Legacy Members":n,"Is Paying":a!==Vd.NO_TERM})}},Jh=(e,t,a,o)=>{const n=Ju(e.email,a),r={"Team ID":t,"Team Owner Email":a,"Team Collaborator Email":e.email||"Anonymous","Owner And Collaborator Domain Match":n,"Entry Point":o};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Invite Visited",r)},Xh=(e,t,a,o,n,r)=>{var i;const s=Ju(a,t),l={"Team ID":n._id,"Team Owner Email":t,"Team Collaborator Email":e.email,"Owner And Collaborator Domain Match":s,"Entry Point":o,"Current Plan":pu(n.planTier),"Subscription Status":r||"None","Monthly/Annual":n.paymentTerm,"Quantity Legacy Members":Hh(n).length,"Number of Workspace Members":(null==(i=n.users)?void 0:i.length)||1};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Joined",l)},Qh=(e,t,a,o,n,r,i,s)=>{const l={"Team ID":e,"Removed Email":t,"Removed Role":a,"Number of Workspace Members":o,"Current Plan":pu(n),"Monthly/Annual":r,"Subscription Status":i,"Quantity Legacy Members":s,"Is Paying":r!==Vd.NO_TERM};amplitude.getInstance().logEvent("Team Member Removed",l)},Zh=async(e,t,a,o,n,r)=>{const i=await og(e);if(!i)return;fm("Opened Team Settings",{"Team ID":e,Email:t,"Number of Workspace Members":i.totalTeamMembers,"Brandkit is set up":i.isBrandkitSetup,"Current Plan":pu(a),"Monthly/Annual":o,"Subscription Status":n,"Quantity Legacy Members":r,"Is Paying":o!==Vd.NO_TERM})};var eg=(e=>(e.SIDEBAR="Add Members in Sidebar",e.WORKSPACE_HEADER="Workspace Header",e.USER_ONBOARDING="New User Onboarding",e.TEAM_SETTINGS="Team Settings",e.TEAM_CREATION="Team Creation",e))(eg||{}),tg=(e=>(e.WORKSPACE_SETTINGS="Workspace Settings",e.WORKSPACE_HEADER="Workspace Header Pill",e.WORKSPACE_PAST_DUE_BANNER="Workspace Past Due Banner",e))(tg||{});const ag=({teamId:e,inviterEmail:t,shareType:a,origin:o,planTier:n,paymentTerm:r,subscriptionStatus:i,legacyMembers:s})=>{fm("Team Members Invited",{"Team ID":e,"Team Inviter Email":t,"Share Type":a,Origin:o,"Current Plan":pu(n),"Monthly/Annual":r,"Subscription Status":i||"None","Quantity Legacy Members":s,"Is Paying":r!==Vd.NO_TERM})},og=async e=>{var t;try{const{state:a}=io(),o=Yh(e);if(!o)throw new Error("Unable to get team");const n=null==(t=null==a?void 0:a.teams)?void 0:t.activeBrandkit,r=!!n&&await(async e=>{const t=e.colors.some((e=>!Eh(e))),a=e.fonts.some((e=>!_h(e)));let o=!0;if(0===e.cmlIds.length&&(o=!1),1===e.cmlIds.length)try{const t=await mh(e.cmlIds[0]);vh(t.cml_file.asset_id)&&(o=!1)}catch($ae){console.error($ae)}return t||a||o})(n);return{totalTeamMembers:o.users.length,isBrandkitSetup:r,team:o}}catch($ae){console.error($ae)}},ng=(e,t,a,o)=>{fm("Continue to Survey",{"Current Plan":pu(e.planTier),"Subscription Status":t||"None","Monthly/Annual":e.paymentTerm,"Team ID":e._id,"Number of Workspace Members":e.users.length,"Quantity Legacy Members":Hh(e).length,"Is Legacy Account Based Subscription":!!a&&e.stripeId===a,"Quantity Impacted Workspaces":o,"Is Paying":e.paymentTerm!==Vd.NO_TERM})},rg=(e,t,a,o)=>{fm("Delete Workspace",{"Current Plan":pu(e.planTier),"Subscription Status":t||"None","Monthly/Annual":e.paymentTerm,"Team ID":e._id,"Number of Workspace Members":e.users.length,"Quantity Legacy Members":Hh(e).length,"Is Legacy Account Based Subscription":!!a&&e.stripeId===a,"Quantity Impacted Workspaces":o,"Is Paying":e.paymentTerm!==Vd.NO_TERM})},ig=e=>e?e.cancel_at_period_end?Mr.PENDING_DOWNGRADE:e.status:"None",sg=e=>{var t;const{state:a}=io(),o=null!=e?e:Bu();return{paymentPlan:Ou({team:o}),teamSubscription:null==(t=a.checkoutStore[a.teams.selectedTeamId])?void 0:t.subscription,currentTeam:o}},lg=e=>{const{paymentPlan:t,teamSubscription:a,currentTeam:o}=sg();if(!o)return;fm(`Join Request ${e}`,{"Team ID":o._id,"Current Plan":pu(t.planTier),"Monthly/Annual":t.paymentTerm,"Subscription Status":ig(a),"Quantity Legacy Members":Hh(o).length,"Number of Workspace Members":"Accepted"===e?o.users.length+1:o.users.length,"Is Paying":o.paymentTerm!==Vd.NO_TERM})};function cg(){const{paymentPlan:e,teamSubscription:t,currentTeam:a}=sg();return{"Current Plan":pu(e.planTier),"Subscription Status":ig(t),"Team ID":a?a._id:null}}function dg(e){return{type:"SET_CURRENT_TEAM",_id:e}}function ug(e){return{type:"SET_TEAMS",teams:e}}function mg(e){return{type:"SET_TEAMS_INVITES",invites:e}}function pg(e,t){return{type:"UPDATE_TEAM_NAME",id:e,name:t}}function hg(e){return{type:"SET_SHARED_TEAM_OWNER_EMAIL",sharedTeamOwnerEmail:e}}function gg(e){return{type:"SET_SHARED_TEAM_ID",sharedTeamId:e}}function fg(e){return{type:"SET_ACTIVE_BRANDKIT",update:e}}function yg(e){return{type:"SET_BRANDKIT_TEMPLATES",projects:e}}function Eg(){return async(e,t)=>{var a;const{teams:o,currentUser:n}=t(),{selectedTeamId:r}=o;if(!r)return;const i=await bg(r,n,0===((null==(a=o.brandkitTemplates)?void 0:a.length)||0)),{brandkit:s,brandkitTemplates:l}=i;e(fg(s)),l&&e(yg(l))}}function _g(){return async(e,t)=>{const{teams:{selectedTeamId:a},currentUser:o}=t(),{token:n,user:r}=o||{},{_id:i}=r||{},s={token:n,userId:i};try{const t=await ap("/api/v1/teams/getUserTeams",{params:s});return a||e(dg(t[0]._id)),e(ug(t)),t}catch($ae){return[]}}}function vg(){return async(e,t)=>{const a=t(),{teams:o}=a,{selectedTeamId:n}=o,r=await ap(`/api/v2/teams/${n}`);e({type:"UPDATE_TEAM",id:r._id,updateDict:r})}}function wg(){return async(e,t)=>{const{teams:a,currentUser:o}=t(),{allTeams:n}=a,{token:r,user:i,email:s}=o||{},{_id:l}=i||{},c={token:r,userId:l,email:s};try{const t=await ap("/api/v1/team_invites",{params:c});return e(mg(t.filter((e=>!n.some((t=>e.team._id===t._id)))))),a}catch($ae){return[]}}}function bg(e,t,a){const{token:o,user:n}=t||{},{_id:r}=n||{};return ap(`/api/v2/teams/${e}`,{params:{token:o,userId:r,teamId:e,fetchBrandkitTemplates:a}})}function Sg(e,t){return(a,o)=>{const{token:n,user:r}=o().currentUser||{},{_id:i}=r||{};return op(`/api/v1/teams/${e}`,{body:{token:n,userId:i,teamId:e,updateDict:t},parseJSON:!1})}}function Tg(e,t,a){const{token:o,user:n}=a||{},{_id:r}=n||{};return op(`/api/v2/teams/${e}/removeUsers`,{body:{token:o,userId:r,teamId:e,users:t},parseJSON:!1})}function Ig(e){return async(t,a)=>{const{token:o,user:n}=a().currentUser||{},{allTeams:r}=a().teams,{_id:i}=n||{};await tp("/api/v1/teams/delete",{body:{token:o,userId:i,teamId:e},parseJSON:!1}),t(ug([...r.filter((t=>t._id!==e))])),t(dg(r[0]._id))}}function kg(e,t,a){return async(o,n)=>{const{currentUser:r}=n(),{token:i,user:s}=r,{_id:l}=s||{};await op(`/api/v1/teams/${e}/updateUser`,{body:{token:i,userId:l,updateUserId:t,teamId:e,updateDict:a},parseJSON:!1})}}function Cg(e,t){const{state:a}=io(),{currentUser:o}=a,{token:n,user:r}=o||{};return np(`/api/v2/teams/${e}/privacy`,{body:{privacy:t,token:n,userId:r&&r._id}})}async function Ng(e,t){const{state:a,dispatch:o}=io(),{currentUser:n}=a,{token:r,user:i}=n||{},s={discoverability:t,token:r,userId:i&&i._id},l=await np(`/api/v2/teams/${e}/discoverability`,{body:s});return o(vg()),l}function Ag(){return async(e,t)=>{const a=t(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{},{teams:i}=a;await op("/api/v2/teams/cumulativeDuration/reset",{body:{token:o,userId:r,teamId:i.selectedTeamId},parseJSON:!1}),e(vg())}}function xg(e){return async(t,a)=>{const o=a(),{token:n,user:r}=a().currentUser||{},{_id:i}=r||{},{teams:s}=o;await op("/api/v2/teams/cumulativeDuration/update",{body:{token:n,userId:i,duration:e,teamId:s.selectedTeamId},parseJSON:!1}),t(vg())}}function Pg(){return async(e,t)=>{const a=t(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{},{teams:i}=a;await op("/api/v2/teams/transcribeUsage/reset",{body:{token:o,userId:r,teamId:i.selectedTeamId},parseJSON:!1}),e(vg())}}function Rg(e){return async(t,a)=>{const o=a(),{token:n,user:r}=o.currentUser||{},{_id:i}=r||{},{teams:s}=o;await op("/api/v2/teams/transcribeUsage/update",{body:{token:n,userId:i,usage:e,teamId:s.selectedTeamId},parseJSON:!1}),t(vg())}}async function Og(){const{dispatch:e,state:t}=io(),{user:a,token:o,impersonatingAdminEmail:n}=t.currentUser||{},{_id:r}=a||{};if(!r||!o){return void(new _).remove("ssrSignedInCookie",{path:"/"})}const i={userId:r,token:o},s=await op("/api/v1/users/getProfile",{body:i});e(Fm(s.user,s.token,n))}function Dg(e){return{type:"SET_GDRIVE_TOKEN",token:e}}function Lg(e){return{type:"SET_USER",user:e}}function Ug(){return(e,t)=>{const{token:a,user:o}=t().currentUser||{};if(!o)return null;const{_id:n}=o;return a?np("/api/v1/users/lastOptimizedProjectTime",{body:{token:a,userId:n},parseJSON:!1}).then((()=>{Og()})):Promise.resolve()}}async function Mg(e,t,a){const{state:o,dispatch:n}=io(),{token:r,user:i}=o.currentUser||{},{_id:s}=i||{};try{const o=await Zm("api/v1/settingsUpdate",{body:{token:r,userId:s,notifType:e,on:t,location:a}});o.success?n(function(e,t,a){return{type:"UPDATE_USER_NOTIF_SETTING",on:e,notifType:t,location:a}}(t,e,a)):(console.error("Error update user settings:",o.messsage),n(wh("There was an error with updating your notification settings.")))}catch(l){console.error("Error update user settings:",l),n(wh("There was an error with updating your notification settings."))}}function Fg(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(Lg({...o,onboarding:e})),o._id?op("/api/v1/users/updateProfile/onboarding",{body:{onboarding:e},parseJSON:!1}).then((()=>{Og()})):(t(gr(e)),new Promise((()=>{})))}}function Bg(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(Lg({...o,muteExportCompleteNotificationSound:e})),o._id?op("/api/v1/users/updateProfile/muteExportCompleteNotificationSound",{body:{muteExportCompleteNotificationSound:e},parseJSON:!1}).then((()=>Og())):new Promise((()=>{}))}}function Wg(e){const{state:t,dispatch:a}=io(),{user:o}=t.currentUser||{};a(Lg({...o,resizeCanvasShortcuts:e})),o._id&&op("/api/v1/users/updateProfile/resizeCanvasShortcuts",{body:{resizeCanvasShortcuts:e},parseJSON:!1}).catch((e=>console.error(e)))}function Vg(e){const{state:t,dispatch:a}=io(),{user:o}=t.currentUser||{};a(Lg({...o,royaltyFreePreference:e})),o._id&&op("/api/v1/users/updateProfile/royaltyFreePreference",{body:{royaltyFreePreference:e},parseJSON:!1}).catch((e=>console.error(e)))}function jg(e){return op("/api/v1/users/updateProfile/upsells",{body:{upsells:e},parseJSON:!1})}function Hg(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(Lg({...o,tooltipActivity:e})),o._id?op("/api/v1/users/updateProfile/tooltipActivity",{body:{tooltipActivity:e},parseJSON:!1}).then((()=>{Og()})):new Promise((()=>{}))}}function Gg(e){return{type:"SET_COLLABORATING",isCollaborating:e}}function $g(e,t){return{type:"INIT_PRESENCE",presenceInfo:e,userId:t}}function Kg(e,t){return{type:"UPDATE_PRESENCE",presenceInfo:e,userId:t}}function Yg(e){return{type:"SET_PRESENT_USER",userId:e}}var zg=(e=>(e.UPDATE_ANALYTICS="UPDATE_ANALYTICS",e.ADD_CONTEXT_MENU_ANALYTICS="ADD_CONTEXT_MENU_ANALYTICS",e))(zg||{});function qg(e){return{type:"UPDATE_ANALYTICS",updates:e}}function Jg(){return{type:"ADD_CONTEXT_MENU_ANALYTICS"}}function Xg(e){if(!e)throw Error("currentUser not set.");return!!e.impersonatingAdminEmail}function Qg(){return{type:"MOCK_SIGN_IN"}}function Zg(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function ef(){const{state:e}=io(),{presence:t}=e.studio,a=[];t&&Object.keys(t).forEach((e=>{e&&a.push(t[e].color)}));const o=Yi.filter((e=>!a.includes(e)));return o[Math.floor(Math.random()*o.length)]}const tf=["Abyssinian","Balinese","Bengal","Bobtail","Calico","Maine Coon","Manx","Mau","Munchkin","Persian","Peterbald","Ragdoll","Russian Blue","Scottish Fold","Shorthair","Siamese","Sphynx","Tabby"],af=["https://cdn-useast1.kapwing.com/samples/kat_blue.jpeg","https://cdn-useast1.kapwing.com/samples/kat_blue_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_brown.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_yellow.jpeg"];function of(e,t){if(!e._id){const e=tf[Math.floor(Math.random()*tf.length)];return{color:ef(),heartbeat:Date.now(),name:`Anonymous ${e}`,profileImg:af[Math.floor(Math.random()*af.length)],selectedLayerId:t}}const{name:a,picture:o}=e;return{color:ef(),heartbeat:Date.now(),name:a,profileImg:null!=o?o:void 0,selectedLayerId:t}}function nf(e,t){if(!e||!t)return;return Object.keys(e).find((a=>{if(e[a]&&e[a].selectedLayerId===t&&rf(e[a].heartbeat))return a}))}function rf(e){return function(e,t){const a=new Date(e),o=new Date(t);return(a.getTime()-o.getTime())/1e3}(Date.now(),e)<60}function sf(e,t,a){if(!e)return;let o=!1;Object.keys(e).forEach((n=>{const r=rf(e[n].heartbeat);n!==t&&r&&(o=!0),r||a({type:"REMOVE_PRESENCE",presenceInfo:e[n],userId:n})})),o?io().state.studio.analytics.usedCollaborationWithOtherUser||a(qg({usedCollaborationWithOtherUser:!0})):a(Gg(!1))}function lf(e){if(!e)return!1;const{user:t}=e;if(!t)return!1;const a=function(e={},t=!1){if(!e||!e.lastVideosPublished)return 0;let a=0;const o=new Date;return e.lastVideosPublished.forEach((e=>{const n=new Date(e);if(t&&o-n<2592e6)a-=1;else if(!t){const e=o.getFullYear(),t=o.getMonth(),r=n.getFullYear(),i=n.getMonth();e===r&&t===i&&(a-=1)}})),Math.max(a,0)}(t);return a>=1}const cf=e=>{const t="Captcha check error. Please try again.";return e.statusText===t||e.message===t};function df(e,t,a){const{state:o}=io(),{token:n,user:r}=o.currentUser;return op("/api/v1/invoices/billingDetails",{body:{token:n,userId:r._id,id:e,customerType:t,updateDict:a},parseJSON:!1})}function uf(){var e;const{state:t}=io(),{user:a}=t.currentUser,{onboarding:o}=t.sessionValues;return null!=(e=null==o?void 0:o.newUser)?e:a.createdAt===a.lastSignIn}function mf(){const{state:e}=io(),{user:t}=e.currentUser,{email:a}=t;if(t&&a){return a.split("@").pop()}return""}const pf=async(e,t,a,o)=>{const{state:n}=io(),r=n.workspaces.allWorkspaces.find((t=>t._id===e)),i=await og((null==r?void 0:r.teamId)||"");if(!i)return;const{team:s}=i,{_id:l}=s||{},c=!!s,d=null==r?void 0:r.type;let u;u=c?d===Io.team?"Team Folder":"My Folder":a?"Shared Folder":"Personal Workspace";const{paymentPlan:m,teamSubscription:p,currentTeam:h}=sg(),g={"Project Location":u,Source:t,"Number of Workspace Members":i.totalTeamMembers,"Brandkit is set up":i.isBrandkitSetup,"Current Plan":pu(m.planTier),"Monthly/Annual":m.paymentTerm,"Subscription Status":ig(p),"Quantity Legacy Members":Hh(h).length};l&&(g["Team ID"]=l),o&&(g["Is Original Project Owner"]=o),fm("New Project In Workspace",g)},hf=(e,t,a,o)=>{const n=Ju(e.email,a),r={"Folder ID":t,"Folder Owner Email":a,"Folder Collaborator Email":e.email||"Anonymous","Owner And Collaborator Domain Match":n,"Entry Point":o};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Folder Invite Visited",r)},gf=(e,t,a,o,n)=>{const r=Ju(o,a),i={"Folder ID":t,"Folder Owner Email":a,"Folder Collaborator Email":e.email,"Owner And Collaborator Domain Match":r,"Entry Point":n};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Folder Joined",i)},ff=(e,t)=>{fm("Multi Select Project Management Action Initiated",{"Project Action":e,"Number of Projects":t})};var yf=(e=>(e.INITIATE="Initiated Payment Details Update",e.UPDATE="Updated Payment Details",e))(yf||{});const Ef=(e,t)=>{fm(t,{"Entry Point":e})},_f=new Set;const vf=()=>{fm("Exit Onboarding Flow")},wf=()=>{fm("Begin Add Workspace Details")},bf=()=>{fm("Began Onboarding Survey")},Sf=(e,t)=>{amplitude.getInstance().setUserId(e),amplitude.getInstance().setUserProperties({prefersDarkMode:t})},Tf=e=>{let t=0,a=0;return e.teams.forEach((e=>{var o;switch(null==(o=e.settings)?void 0:o.discoverability){case Vr.AnyoneCanJoin:t+=1;break;case Vr.RequestToJoin:default:a+=1}})),{numOpenToJoin:t,numAskToJoin:a}},If=({numPendingInvites:e,suggestedWorkspaces:t,entryPoint:a,isQualifiedLead:o})=>{const{numAskToJoin:n,numOpenToJoin:r}=Tf(t);fm("Begin Suggested Workspaces",{Domain:t.teams.length>0?t.teams[0].emailDomain:"","Number Invite Workspaces":e,"Number Suggested Workspaces - Ask to Join":n,"Number Suggested Workspaces - Open to Join":r,"Entry Point":a}),amplitude.getInstance().setUserProperties({Domain:mf()}),o&&amplitude.getInstance().setUserProperties({"Is Qualified Lead":o})};var kf=(e=>(e.Onboarding="New User Onboarding",e.Sidebar="Sidebar",e))(kf||{});const Cf=async(e,t,a)=>{const o=await bg(t,a,!1),{paymentPlan:n,teamSubscription:r,currentTeam:i}=sg(o);fm("Request to Join",{"Team ID":o._id,"Entry Point":e,"Number of Workspace Members":o.numberOfUsers,"Current Plan":pu(n.planTier),"Monthly/Annual":n.paymentTerm,"Subscription Status":ig(r),"Quantity Legacy Members":Hh(i).length})};function Nf(e){return{type:"SET_WORKSPACES",workspaces:e}}function Af(e){return{type:"SET_CURRENT_WORKSPACE",workspaceId:e}}function xf(e,t,a,o,n){return()=>{const{state:r}=io(),{user:i}=r.currentUser,s=r.projects.byId[e];t&&(async()=>{let e;try{e=(await ap(`/api/v1/workspaces/${t}/getUsers`)).keys.length>1}catch($ae){e=void 0}const a=i._id===s.creatorId;pf(t,"Copied",e,a)})();return op(`/api/v1/projects/${e}/copy`,{body:{workspaceId:t,teamId:a,customProjectName:o,setAsTemplate:n}})}}function Pf(e,t){return()=>{const{token:a,user:o}=t||{},n={token:a,userId:o&&o._id};return tp(`/api/v1/projects/${e}`,{parseJSON:!1,params:n})}}function Rf(e,t){return()=>{const{token:a,user:o}=t||{};return tp("/api/v1/projects/",{parseJSON:!1,params:{token:a,userId:o&&o._id},body:{projectIds:e}})}}function Of(e,t,a){return()=>{const{token:o,user:n}=t||{},r={token:o,userId:n&&n._id};return op(`/api/v1/projects/${e}/move`,{parseJSON:!1,params:r,body:{newWorkspaceId:a}})}}function Df(e,t,a){return()=>{const{token:o,user:n}=t||{};return op("/api/v1/projects/move",{parseJSON:!1,params:{token:o,userId:n&&n._id},body:{projectIds:e,newWorkspaceId:a}})}}async function Lf(e,t,a){if(!e)return;const{token:o,user:n}=a||{};try{await np(`/api/v1/projects/${e}`,{body:{token:o,userId:n&&n._id,project:t},parseJSON:!1})}catch($ae){console.warn($ae)}}function Uf(e,t,a){return()=>{const{token:o,user:n}=a||{};return np(`/api/v1/workspaces/${e}`,{body:{token:o,userId:n&&n._id,workspaceFields:t},parseJSON:!1})}}function Mf(){return{type:"SET_WORKSPACE_MENU"}}function Ff(){return{type:"SHOW_UPLOAD_DIALOG"}}function Bf(){return{type:"HIDE_UPLOAD_DIALOG"}}function Wf(){return{type:"SHOW_DRAG_UPLOAD_DIALOG"}}function Vf(){return{type:"HIDE_DRAG_UPLOAD_DIALOG"}}function jf(e){return{type:"SET_WORKSPACE_UPLOAD_STATUS",text:e}}function Hf(e){return{type:"ADD_WORKSPACE_UPLOAD_FILE",file:e}}function Gf(e,t){return{type:"SET_FILE_UPLOAD_PROGRESS",id:e,uploadProgress:t}}function $f(e){return{type:"ADD_WORKSPACE_UPLOAD_PROJECT",video:e}}function Kf(){return{type:"CLEAR_WORKSPACE_UPLOAD_FILES"}}function Yf(e){return{type:"REMOVE_WORKSPACE_UPLOAD_FILE",fileId:e}}function zf(e){return{type:"REMOVE_WORKSPACE_UPLOAD_FILES",fileIds:e}}function qf(e,t){return{type:"UPDATE_WORKSPACE_UPLOAD_FILE",id:e,fileInfo:t}}function Jf(e){return{type:"MARK_UPLOAD_AS_CREATED",id:e}}function Xf(e){return{type:"MARK_UPLOAD_AS_CANCELLED",id:e}}function Qf(e,t){return{type:"UPDATE_WORKSPACE_RECENT_FONTS",workspaceId:e,recentlyUsedFonts:t}}function Zf(e,t){return{type:"UPDATE_WORKSPACE_CUSTOM_FONTS",workspaceId:e,customFonts:t}}function ey(e){return{type:"SET_CURRENT_FOLDER_SETTINGS",folderSettings:e}}function ty(e){return{type:"SET_SWM_FOLDER_SETTINGS",folderSettings:e}}function ay(e){return{type:"SET_SHARED_WORKSPACE_OWNER_EMAIL",workspaceOwnerEmail:e}}function oy(e){return{type:"SET_SHARED_WORKSPACE_ID",sharedWorkspaceId:e}}function ny(e){return{type:"SET_SELECTION_MODE",selectionMode:e}}function ry(e){return{type:"SET_SHOW_ONBOARDING_UPSELL",upsellType:e}}function iy(e){return{type:"SET_SUGGESTED_WORKSPACES",payload:e}}var sy=(e=>(e[e.GRID_VIEW=0]="GRID_VIEW",e[e.LIST_VIEW=1]="LIST_VIEW",e))(sy||{}),ly=(e=>(e[e.PROJECT_NAME=0]="PROJECT_NAME",e[e.DATE_EDITED=1]="DATE_EDITED",e[e.DATE_CREATED=2]="DATE_CREATED",e[e.LAST_EDITOR=3]="LAST_EDITOR",e))(ly||{}),cy=(e=>(e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING",e))(cy||{}),dy=(e=>(e[e.PAYWALL=0]="PAYWALL",e[e.MOVE=1]="MOVE",e[e.REMOVE=2]="REMOVE",e[e.DELETE=3]="DELETE",e[e.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT=4]="TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT",e[e.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT=5]="TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT",e[e.TWO_WEEK_RECURRING_MULTI_ACCOUNT=6]="TWO_WEEK_RECURRING_MULTI_ACCOUNT",e[e.TWO_WEEK_RECURRING_SINGLE_ACCOUNT=7]="TWO_WEEK_RECURRING_SINGLE_ACCOUNT",e[e.NONE=8]="NONE",e))(dy||{}),uy=(e=>(e[e.WORKSPACE=0]="WORKSPACE",e[e.INVITE=1]="INVITE",e[e.ROLE=2]="ROLE",e))(uy||{}),my=(e=>(e.Work="Work",e.School="School",e.PersonalProjects="Personal Projects",e.SuggestedWorkspaces="Suggested Workspaces",e.None="",e))(my||{});const py=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,hy=/^rgba?\((-?\d{1,3}), ?(-?\d{1,3}), ?(-?\d{1,3})(?:(?:, ?)([0,1](?:\.\d*)?|undefined))?\)$/i,gy="rgba(-255,-255,-255,0)";function fy(e){const t=hy.exec(e);if(!t)return null;return{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10),a:5===t.length?parseFloat(t[4]):1}}function yy(e){if(!e||"none"===e)return null;let t=null;return"#"===e[0]?t=function(e){const t=py.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16),a:1}:null}(e):e.startsWith("rgb")&&(t=fy(e)),t}function Ey(e,t){if(!e)return e;const a=yy(e);if(!a)return e;Object.assign(a,t);const{r:o,g:n,b:r}=a;return`#${o.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}`}function _y(e,t){if(!e)return e;const a=yy(e);if(!a)return null;Object.assign(a,t);const{r:o,g:n,b:r,a:i}=a;return`rgba(${o},${n},${r},${i})`}function vy(e){var t,a;return null!=(a=null==(t=yy(e))?void 0:t.a)?a:1}function wy(e,t){const a=yy(e);if(!a)return e;a.a=t;const{r:o,g:n,b:r,a:i}=a;return`rgba(${o},${n},${r},${i})`}function by(e){if("none"===e)return!0;if(e&&!e.startsWith("rgb"))return!1;const t=fy(e);return!t||0===t.a}function Sy(e,t){if(t&&t.textShadow&&"black"!==t.textShadow&&"white"!==t.textShadow)return"transparent";const a=yy(e);if(!a)return"black";const{r:o,g:n,b:r}=a,i=[o,n,r];return Math.round((299*i[0]+587*i[1]+114*i[2])/1e3)>125?"black":"white"}function Ty(e,t,a=!1){return{type:"UPDATE_SCENE",scene:e,properties:t,undoable:a}}function Iy(){const{state:e}=io(),t=e.currentUser.user._id;return"trim"===e.studio.origin||"cut-video"===e.studio.origin?{type:"DISABLE_SNAP_IN_TIMELINE",userId:t}:{type:"ENABLE_SNAP_IN_TIMELINE",userId:t}}function ky(){const{state:e}=io();return{type:"ENABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function Cy(){const{state:e}=io();return{type:"DISABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function Ny(e){return{type:"SET_VIDEO_TYPE",videoType:e}}function Ay(e){return{type:"SET_IMAGE_TYPE",imageType:e}}function xy(e){return{type:"SET_GIF_TYPE",gifType:e}}function Py(e){return{type:"SET_EXPORT_FRAME_TIME",exportFrameTime:e}}function Ry(e){return{type:"SET_QUALITY",quality:e}}function Oy(e,t){const{state:a}=io();return{type:"SET_USER_SPECIFIC_SETTING",key:e,value:t,userId:a.currentUser.user._id}}function Dy(e){return{type:"REMOVE_SUBTITLE",subtitle:e}}function Ly(e){return{type:"DUPLICATE_SUBTITLE",subtitle:e}}function Uy(e,t){return{type:"UPDATE_SUBTITLE",properties:e,undoable:t}}function My(e,t){return{type:"SET_SUBTITLE_TIME",subtitle:e,times:t}}function Fy(e,t){return{type:"SET_SUBTITLE_TEXT",subtitle:e,text:t}}function By(e,t=!1,a,o,n,r){return{type:"SET_SUBTITLES_FONT",hasCustomFont:t,font:e,url:a,fontType:o,source:n,asset_id:r}}function Wy(e){return{type:"SET_SUBTITLES_FONT_SIZE",fontSize:e}}function Vy(e){return{type:"SET_SUBTITLES_FONT_SIZE_RATIO",sizeRatio:e}}function jy(e){return{type:"SET_SUBTITLES_FONT_WEIGHT",fontWeight:e}}function Hy(e){return{type:"SET_SUBTITLES_FONT_COLOR",color:e}}function Gy(e){return{type:"SET_SUBTITLES_FONT_STYLE",fontStyle:e}}function $y(e){return{type:"SET_SUBTITLES_TEXT_ALIGN",textAlign:e}}function Ky(e){return{type:"SET_SUBTITLE_TEXT_VERTICAL_ALIGN",textVerticalAlign:e}}function Yy(e){return{type:"SET_ACTIVE_SUBTITLE_TEXT_AREA",textAreaId:e}}function zy(){return{type:"SET_UPDATE_SUBTITLE_POSITION"}}function qy(e){return{type:"SET_SUBTITLE_FIXED_POSITION",position:e}}function Jy(e){return{type:"SET_SUBTITLES_BACKGROUND_COLOR",background:e}}function Xy(e){return{type:"SET_SUBTITLES_BACKGROUND_STYLE",style:e}}function Qy(e){return{type:"SET_SUBTITLES_LINE_WIDTH",lineWidth:e}}function Zy(e){return{type:"SET_SUBTITLES_TEXT_SHADOW",textShadow:e}}function eE(e){return{type:"SET_SUBTITLE_VIDEO",video:e}}function tE(e){return{type:"SET_SUBTITLES_BACKGROUND_OPACITY",bgOpacity:e}}function aE(){return{type:"SET_HIGHLIGHT_SUBTITLES"}}function oE(){return{type:"RESET_HIGHLIGHT_SUBTITLES"}}function nE(e=!1){return{type:"SET_TRANSLATE",translate:e}}function rE(e){return{type:"SET_TRANSLATE_LANGUAGE_CODE",translateLanguageCode:e}}function iE({languageCode:e,transcribeVideo:t,translate:a,translateLanguageCode:o,selectedSceneIndex:n}){return r=>op("/api/v2/transcriptions",{body:{languageCode:e,sourceVideo:t,translate:a,translateLanguageCode:o,selectedSceneIndex:n}}).then((({success:e,transcriptionId:t,error:n})=>{if(!e)throw fm("Auto-generate Subtitles Fails",{failureMessage:"Failed to dispatch","Translated Language":a&&o?o:""}),console.error(n),new Error("Something went wrong while transcribing. Please try again later!");r({type:"STARTED_TRANSCRIBING",success:e,transcriptionId:t})}))}function sE(e,t={}){return a=>ap(`/api/v1/transcriptions/${e}`).then((({success:e,response:o})=>{var n;const r=e&&o&&o.done,i=o&&o.error,s=o&&o.source_video&&o.source_video.asset_id;if(i)fm("Auto-generate Subtitles Fails",{asset_id:s,...t});else if(r){fm("Auto-generate Subtitles Succeeds",{asset_id:s,...t}),a({type:"FINISHED_TRANSCRIBING",success:e});const r=!!(null==(n=null==o?void 0:o.progress)?void 0:n.translation_done);a(qg(r?{usedClassicTranslate:!0}:{usedClassicTranscribe:!0}))}return{done:r,response:o}}))}function lE(e,t,a,o,n){return async r=>{const i=e.filter((({type:e})=>"subtitle"!==e)),s=e.filter((({type:e,text:t})=>"subtitle"===e&&t)),l={sourceVideo:t,subtitles:s,languageCode:o,translateLanguageCode:n},{success:c,response:d}=await op("/api/v1/translate",{body:l}),u=c&&d.done;if(!c||!u)throw fm("Auto-generate Subtitles Fails",{failureMessage:"Failed to dispatch","Translated Language":n}),new Error("Something went wrong while translating. Please try again later!");const m=[...i,...d.subtitles];for(let t=0;t<e.length;t+=1){const a=e[t];"subtitle"!==a.type||a.text||r(Zi(a,"translateVideo"))}for(let e=0;e<d.subtitles.length;e+=1)e>0&&e%50==0&&(r(us(m,a)),d.subtitles.length=0,await new Promise((e=>setTimeout(e,1e3))));d.subtitles.length&&r(us(m,a))}}const cE={commentsLoading:!0},dE=d({initialState:cE,name:"comments",reducers:{setComments:(e,t)=>{e.comments=t.payload},setSelectedCommentId:(e,t)=>{e.selectedCommentId=t.payload},setCommentsOpen:(e,t)=>{e.commentsOpen=t.payload},setCommentsLoading:(e,t)=>{e.commentsLoading=t.payload},addComment:(e,t)=>{e.comments=e.comments?[...e.comments,t.payload]:[t.payload]},editComment:(e,t)=>{var a;const{commentId:o,updates:n}=t.payload,r=null==(a=e.comments)?void 0:a.map((e=>e._id===o?{...e,...n}:e));e.comments=r},deleteComment:(e,t)=>{var a;const o=t.payload,n=null==(a=e.comments)?void 0:a.filter((e=>e._id!==o));e.comments=n}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return cE;case"SET_STUDIO":return t.projectIdChanged?cE:e;case"SELECT_ITEM":return t.item&&(e.selectedCommentId="",e.commentsOpen=!1),e;default:return e}}))}),{setComments:uE,setSelectedCommentId:mE,setCommentsOpen:pE,setCommentsLoading:hE,addComment:gE,editComment:fE,deleteComment:yE}=dE.actions;const EE=["hidden","local_url","removeBgPreviewUrl"],_E=["duration","startTime","endTime","videoDelay"];function vE(e,t,a,o,n,r=!0){const i=`${"scene"===o?"scene":"layer"}_${t}`;let s;const l=e.map((e=>e.id!==t?e:(Object.keys(a).forEach((t=>{if(_E.includes(t)){const e=a[t];null!=e&&(a[t]=Number(e))}EE.includes(t)||!r||A(a[t],e[t])||Up(i,t,a[t],e[t],`${n}/editSegment`)})),s={...e,...a},s)));return[l,l.find((e=>e.id===t))]}function wE(e,t){const{axis:a}=t;let o=t.layer.position;for(const n of e)if(n.id===t.layer.id){"position"in n&&(o=n.position);break}return o.flip||(o.flip={x:!1,y:!1}),vE(e,t.layer.id,{position:{...o,flip:{...o.flip,[a]:!o.flip[a]}}},"layer","setFlip")}function bE(e,t,a,o=!1){let n=e.layers.length-1;for(let u=e.layers.length-1;u>=0;u-=1)if(o||"subtitle"!==e.layers[u].type){n=u;break}const r=e.layers.map((e=>e.id)).indexOf(t.id),i=r+a,s=`scene_${e.id}_layers`;if(i<=n){!function(e,t,a,o){Np({p:[e,t],lm:a},{srcFn:o})}(s,r,i,"reorderLayer");return l=e.layers,c=r,d=i,l.reduce(((e,t,a,o)=>(c===d&&e.push(t),a===c||(c<d&&e.push(t),a===d&&e.push(o[c]),c>d&&e.push(t)),e)),[])}var l,c,d;return e.layers}function SE(e,t){return Object.values(e).findIndex((e=>e.id===t))}function TE(e,t){return t.allLayers.byId[e]?0:-1}function IE(e,t){return t.allLayers.byId[e]}function kE(e,t){const a=[],{layers:o}=t.scenes[t.selectedSceneIndex],{layers:n}=e;for(const r of n){const e=o.find((({id:e})=>e===r.id));e&&void 0!==e.timelineRow&&a.indexOf(e.timelineRow)<0&&a.push(e.timelineRow)}return a.sort()}function CE(e,t){let a=[];const{layers:o}=t.scenes[t.selectedSceneIndex];if(!e)return[];if("group"===e.type){const o=t.groups[e.id];if(!o)return[];a=kE(o,t)}else if("gap"===e.type)t.timelineGap&&t.timelineGap.gapId===e.id&&a.push(t.timelineGap.timelineRow);else if("layer"===e.type){const t=o.find((({id:t})=>t===e.id));t&&void 0!==t.timelineRow&&a.push(t.timelineRow)}return a}function NE(e){let t=0;for(const a of e)a.duration&&(t+=Number(a.duration));return t}function AE(e,t,a){if(!((e,t)=>{if("gif"===e.videoType)return!0;if(e.scenes.length>1)return!1;if(0===t){for(const t of e.scenes)for(const e of t.layers)if("image/gif"===e.mime||"image/gif"===e.content_type)return!1;return!0}return!1})(e,t))for(const o of a)"rgba(-255,-255,-255,0)"===o.background&&(o.background="#FFFFFF")}function xE(e){const t=[],a=[];for(const o of e)Xr(o)?a.push(o):t.push(o);return a.sort(((e,t)=>e.startTime-t.startTime)),t.concat(a)}function PE(e,{asset_id:t,cmlFileId:a}){e.thisProjectCMLFiles||(e.thisProjectCMLFiles={},Lp("thisProjectCMLFiles",{},void 0,"linkCMLFileToThisProject"));const o=e.thisProjectCMLFiles[a],n={addedTimestamp:Date.now(),asset_id:t,cmlFileId:a};e.thisProjectCMLFiles[a]=n,Mp("thisProjectCMLFiles",a,n,o,"linkCMLFileToThisProject")}function RE(e,t){if(!e.thisProjectCMLFiles)return;const a=e.thisProjectCMLFiles[t];delete e.thisProjectCMLFiles[t],function(e,t,a,o){Fp(e,t,a,o)}("thisProjectCMLFiles",t,a,"unlinkAssetFromThisProject")}const OE=(e,t,a,o)=>{let n,r=null;const i="FORWARDS"===o?1:-1;for(n="FORWARDS"===o?a+1:a-1;"FORWARDS"===o?n<=t.length-1:n>=0;n+=i){const a=t[n],o=Object.entries(e.groups).find((([e,t])=>t.layers.find((e=>e.id===a.id))));if(!o)break;{const[e]=o;if(r){if(e!==r)break}else r=e}}return r&&(n-=i),n},DE=(e,t)=>{const a={...e.groups},o={...a[t]},n={...o};let r;o.layers||(o.layers=[],o.saved=!1);let i=o.layers.filter((e=>e.saved));const s=o.layers.filter((e=>!e.saved&&e.fromMergedGroup)),l=Object.keys(i.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));l.forEach((e=>{delete a[e]})),i=i.map((e=>({id:e.id,saved:e.saved})));const c=Object.keys(s.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));c.forEach((e=>{a[e]={...a[e],layers:s.filter((t=>t.fromMergedGroup===e)).map((e=>({id:e.id,saved:!0})))}}));const d={...o,layers:i};0===l.length&&(d.rotation=o.preMergeRotation||o.rotation,delete d.preMergeRotation),a[t]=d,o.saved||(delete a[t],r={type:"UPDATE_GROUP",updates:n,groupId:t,undoable:!1});return(!o.saved||s.length>0||l.length>0||c.length>0||i.length!==o.layers.length)&&(o.saved?Up("groups",t,d,e.groups[t],"onDeselectLayerGroup"):Fp("groups",t,e.groups[t],"onDeselectLayerGroup")),{groups:a,undo:r}};function LE(e,t){const a=SE(e.scenes[e.selectedSceneIndex].layers,t.layer.id),o={...t.layer,...t.properties};!function(e,t,a,o,n){Np({p:[`layer_${a.id}`],od:a},{srcFn:n}),Np({p:[`layer_${t.id}`],oi:t},{srcFn:n}),Np({p:[`scene_${e.id}_layers`,o],li:t.id,ld:a.id},{srcFn:n})}(e.scenes[e.selectedSceneIndex],o,t.layer,a,"replaceLayer")}const UE=(e,t)=>{switch(e.type){case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":{let a=-1;for(let n=0;n<t.pendingGoogleDriveUploads.length;n+=1){const{filename:o}=t.pendingGoogleDriveUploads[n];if(o===e.filename){a=n;break}}if(-1===a)return t;const o=[...t.pendingGoogleDriveUploads];return o.splice(a,1),{...t,pendingGoogleDriveUploads:o}}case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":{const a=[...t.pendingGoogleDriveUploads];for(let o=0;o<t.pendingGoogleDriveUploads.length;o+=1){const{filename:n}=t.pendingGoogleDriveUploads[o];if(n===e.filename){a[o]={filename:e.filename,progress:e.progress};break}}return{...t,pendingGoogleDriveUploads:a}}case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":return{...t,pendingGoogleDriveUploads:[...t.pendingGoogleDriveUploads,{filename:e.filename,progress:e.progress}]};default:return t}},ME={lockAspectRatio:!1,style:{backgroundColor:"rgba(0, 0, 0, 0.8)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,italic:!1,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Montserrat"},fontSize:30,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textShadow:"transparent",underline:!1},position:{heightPct:0,widthPct:80,xPct:10,yPct:80,rotation:0}},FE=e=>P(e)?R(e):e;function BE(e){return e.magicSubtitleFrames&&0!==Object.keys(e.magicSubtitleFrames).length||(e.magicSubtitleFrames={},Pp({path:["magicSubtitleFrames"],val:{},oldVal:void 0,srcFn:"INITIALIZE_MAGIC_SUBTITLE_FRAMES"})),e.magicSubtitleFrames}const WE=e=>e?Math.floor(1e3*e)/1e3:e,VE=e=>{let t=0,a="",o=!1;const{isImageVideo:n}=e,{layers:r}=e;for(const s of r){const e=!(jr(s)||$r(s)||Kr(s));if(!s.isTrimmed&&e)continue;if("subtitle"!==s.type&&s.isTrimmed&&(o=!0),e){const e=Number(s.endTime||0);e>t&&(t=e,a=s.id);continue}if($r(s)&&!s.converted_gif&&(o=!0),$r(s)&&s.converted_gif)continue;const n=Yr(s)?s.startTime:Number(s.videoDelay||0);let r=ti(s);r+=n,r>t&&(t=r,a=s.id)}const i=e.userSelectedDuration||0;return t||(t=0),0===t&&n&&(t=e.duration||i||5),o||(t=Math.max(t,i)),t=WE(t),{duration:t,maxLayerId:a}};function jE(e,t=!0){return{type:"SET_CANVAS_BLUR",value:e,undoable:t}}function HE(e){return{type:"SET_SNAP_TO_GRID",value:e}}function GE(e){return{type:"SELECT_SAFEZONE",value:e}}function $E(e,t,a){return{color:e,selectedSceneIndex:t,type:"SET_STUDIO_BACKGROUND",undoable:a}}function KE(e){return{type:"SET_STUDIO_DIMENSIONS",dimensions:e}}function YE(){return{type:"SHOW_STUDIO_CANVAS"}}function zE(e=!1){return{type:"SET_IMAGE_VIDEO",isImageVideo:e}}function qE(e=0,t=!1){return{type:"SET_STUDIO_DURATION",duration:e,undoable:t}}function JE(e){return{canvasDimensions:e,type:"SET_CANVAS_DIMENSIONS"}}const XE=e=>{const{canvasWidth:t,canvasHeight:a,maxHeight:o=350}=e;let n=320,r=n*a/t;const i=Rn()?Math.min(o,300):o;return i&&i<=r&&(r=i,n=t*i/a),{canvasWidth:n,canvasHeight:r}};function QE(e,t){return{type:"SET_STUDIO_RATIO",ratio:e,undoable:t}}const ZE=g("setDidUserManualSeek");function e_(e,t,a,o){return{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:e,customOutputWidth:t,customOutputHeight:a,undoable:o}}function t_(e){return{type:"SET_DRAGGING",isDragging:e}}function a_(e){return{type:"SET_TRACK_DRAGGING",trackIsDragging:e}}function o_(e){return{type:"SET_RESIZING",isResizing:e}}function n_(e){return{type:"SET_ROTATING",isRotating:e}}function r_(e){return{type:"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT",playCanvasPreviewOnMount:e}}function i_(){return{type:"PAUSE_STUDIO"}}function s_(){return{type:"PLAY_STUDIO"}}function l_(e){return{type:"SET_ORIGIN",origin:e}}function c_(e){return{type:"SET_OVERLAY_MOUNTED",overlayMounted:e}}function d_(){return{type:"UPDATE_LAST_SAVED"}}function u_(e){return{type:"SHOW_TOOL_TIP",toolTip:e}}function m_(e){return{type:"SET_EYEDROPPER_MODE",status:e}}function p_(e){const{state:t}=io();return{type:"SET_RIPPLE_MODE",rippleMode:e,userId:t.currentUser.user._id}}const h_=(e,t)=>({type:"ADD_MAGIC_SUBTITLE",assetId:e,initialProperties:t,undoable:!0}),g_=e=>({type:"REMOVE_MAGIC_SUBTITLE",assetId:e,undoable:!0}),f_=(e,t,a=!0)=>({type:"UPDATE_MAGIC_SUBTITLE",assetId:e,updates:t,undoable:a}),y_=(e,t,a)=>({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:e,frames:t,undoable:a}),E_=(e,t)=>{const a=e[0]/e[1],o=t.width/t.height;let n=t.width,r=t.height;return a>=o?r=e[1]*t.width/e[0]:n=e[0]*t.height/e[1],{width:n,height:r}},__=(e,t,a,o,n,r)=>({x:(e-n)/2+a,y:(t-r)/2+o}),v_=(e,t)=>{if(!e||!t||0===t.width||0===t.height)return;const a=w_(e,t),o=b_(e,t);return{x:a.x,y:a.y,width:o.width,height:o.height}},w_=(e,t)=>({x:e.x/100*t.width+t.x,y:e.y/100*t.height+t.y}),b_=(e,t)=>({width:e.width/100*t.width,height:e.height/100*t.height}),S_={x:0,y:0,width:100,height:100,presetIndex:-1},T_=e=>{let t=e.split(":");2!==t.length&&(t=["1","1"]);const a=t.map((e=>{const t=parseFloat(e);return t?t<0?1:t:1}));return{ratioWidth:a[0],ratioHeight:a[1]}},I_=(e,t,a)=>{const o=(e=>e||Wl()||Vl()?0:30)(a||!1),n=t.width-2*o,r=t.height-2*o,{ratioWidth:i,ratioHeight:s}=T_(e),l=E_([i,s],{width:n,height:r}),c=__(t.width,t.height,0,0,l.width,l.height);return{width:l.width,height:l.height,canvasX:c.x,canvasY:c.y,containerX:t.x,containerY:t.y,containerWidth:t.width,containerHeight:t.height}};function k_(e,t,a="preview",o){var n,r,i;let s="";const l=null!=o?o:io().state;if(!e)return s;if(t&&t.length&&(s=e[t]),"ttsAudio"in e&&e.ttsAudio)return e.ttsAudio.url;const{id:c}=e;if("track_preview"in e){const{track_preview:t}=e,{trackPreviewLocalUrl:o}=(null==(r=null==(n=l.studioLocal)?void 0:n.layerTempValues)?void 0:r[c])||{};if("track_preview"===a){if(t){if(o)return o;if(t.url)return t.url}a="preview"}}const{local_url:d}=e;if(d&&("original"!==a||!("preview"in e)))return d;"preview"===a&&(s=(null==(i=e.preview)?void 0:i.url)||s);const{soundUrl:u,url:m}=e,{uri:p}=e;if(s=s||u||m||p||"",s||"FULFILLED"!==l.ffmpegReducer.ffmpegStatus||void 0===l.ffmpegReducer.outputFile){if(!s)return s}else s=l.ffmpegReducer.outputFileUrl;return"string"!=typeof s||s.includes("X-Goog-Expires=")||(s=s.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"),s=s.replace("https://storage.googleapis.com/kapwing-useast1",po)),s}const C_=e=>e.includes("https://cdn.kapwing.com/")||e.includes("https://cdn.kapwing-useast1.com/");function N_(e){const{thumbnail_url:t,image_url:a,fullPath:o}=e;let n=t;return n||(n=a),n||(n=o),n&&"string"==typeof n||(n="https://cdn-useast1.kapwing.com/video_image-cHDmsyz_G.jpg"),n.includes("X-Goog-Expires=")||(n=n.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"),n=n.replace("https://storage.googleapis.com/kapwing-useast1",po)),n}function A_(e){return e.includes("cdn.kapwing.com")||e.includes("cdn.kapwing-useast1.com/")}function x_(e){if(!Lr(e))return{padding:0,doublePadding:0};let t=(e.lineHeight||1)*e.fontSize;"wrap"!==e.wrapOrFill&&(t=Math.min(e.position.pixel_height,e.position.pixel_width));const a=(e.textPadding||0)*t/100;return{padding:a,doublePadding:2*a}}const P_=function(e){const{layer:t,ctx:a,frameBezValue:o}=e;let{padding:n}=x_(t);n*=2;const r=2*n;a.beginPath(),a.rect(-n,-n,(t.position.pixel_width+r)*o,t.position.pixel_height+r),a.clip()},R_=function(e){const{ctx:t,frameBezValue:a,invertedFrameBezValue:o}=e;t.globalAlpha=0,t.globalAlpha=a,t.filter=`blur(${String(12*o)}px)`},O_=function(e){const{ctx:t,frameBezValue:a}=e;t.globalAlpha=a},D_=function(e){const{ctx:t}=e;t.globalAlpha=0},L_=O(.42,0,.58,1),U_={none:{bezArray:[],animationFunction:()=>{},duration:0},drop:{bezArray:[.175,.885,.32,1.275],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,frameBezValueMinusOne:n}=e,{padding:r,doublePadding:i}=x_(t),s=(t.position.pixel_height+i)*(t.position.float_y-r)/100;a.translate(0,-s*n),a.scale(1,o)},duration:.5},"flicker-in-glow":{bezArray:[],animationFunction:function(e){const{ctx:t,framePercent:a}=e;let o;o=a>0&&a<.1?0:a>=.1&&a<.101||a>=.101&&a<.102?1:a>=.102&&a<.2?0:a>=.2&&a<.201?1:a>=.201&&a<.206?0:a>=.206&&a<.3||a>=.3&&a<.301?1:a>=.301&&a<.305?0:a>=.305&&a<.306||a>=.306&&a<.45?1:a>=.45&&a<.451?0:a>=.451&&a<.5?1:a>=.5&&a<.55?0:a>=.55&&a<.551||a>=.551&&a<.57?1:a>=.57&&a<.571?0:a>=.571&&a<.6||a>=.6&&a<.601?1:a>=.601&&a<.65||a>=.65&&a<.651?0:a>=.651&&a<.75||a>=.75&&a<.751?1:a>=.751&&a<.77?0:a>=.77&&a<.771||a>=.771&&a<.85?1:a>=.85&&a<.851?0:a>=.851&&a<.86?1:a>=.86&&a<.861?0:1,t.globalAlpha=o},duration:2},"focus-in":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,invertedFrameBezValue:n}=e,r="number"==typeof t.globalAlpha?t.globalAlpha:1;a.globalAlpha=o*r;const i=`blur(${12*n}px)`;"none"===a.filter?a.filter=i:a.filter=`${a.filter}  ${i}`},duration:.5},"hue-rotate":{bezArray:[.25,.25,.75,.75],animationFunction:function(e){const{ctx:t,repeatingFramePercent:a}=e,o=`hue-rotate(${-360-360*a}deg)`;"none"===t.filter?t.filter=o:t.filter=`${t.filter}  ${o}`},duration:1},"pop-in-bounce":{bezArray:[.09,.54,.38,2.47],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,frameBezValueMinusOne:n}=e,r=t.position.pixel_width*(t.position.float_x+t.position.float_width/2)/100||0,i=t.position.pixel_height*(t.position.float_y+t.position.float_height/2)/100||0;a.translate(-r*n,-i*n),a.scale(o,o)},duration:.5},reveal:{bezArray:[.25,.1,.25,1],animationFunction:P_,duration:1},"slide-up":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{frameBezValue:t,invertedFrameBezValue:a,ctx:o}=e;o.translate(0,20*a),o.globalAlpha=t},duration:.5},vibrate:{bezArray:[],animationFunction:function(e){const{ctx:t,fontSize:a,repeatingFramePercent:o}=e,n=.03*a,r=.2;let i=0,s=0;o>0&&o<=r?(i=-n*o/r,s=n*o/r):o>.2&&o<=.4?(i=-n,s=n-2*n*(o%r/r)):o>.4&&o<=.6?(s=2*n*(o%r/r)-n,i=2*n*(o%r/r)-n):o>.6&&o<.8?(s=n+n*(o%r/r),i=n):o>=.8&&o<1&&(s=2*n-2*n*(o%r/r),i=n-n*(o%r/r)),t.translate(i,s)},duration:.3},"wipe-rectangle":{bezArray:[.25,.1,.25,1],animationFunction:function(e){P_(e)},duration:1},"blur-in":{bezArray:[.24,.085,.72,.93],animationFunction:R_,duration:.5},"blur-out":{bezArray:[.24,.085,.72,.93],animationFunction:R_,duration:.5},"fade-in":{bezArray:[.24,.9,.72,.93],animationFunction:O_,duration:.5},"fade-out":{bezArray:[.24,.9,.72,.93],animationFunction:O_,duration:.5},"hide-in":{bezArray:[],animationFunction:D_,duration:.5},"hide-out":{bezArray:[],animationFunction:D_,duration:.5},"magic-fade":{bezArray:[],animationFunction:function(e){const{frameTime:t,layer:a,ctx:o,animation:n}=e,{transitionDuration:r=0}=n,{startTime:i,endTime:s}=a;if(!i||!s)return;const l=t-i<s-t;let c,d,u;var m,p,h;if(l?(c=i,d=c+r):(d=s,c=d-r),u=(t-c)/r,m=u,p=0,h=1,u=Math.min(Math.max(parseFloat(m),p),h),l||(u=1-u),1===u)return;const g=L_(u),f=20-20*g;o.filter=`blur(${f}px)`,o.globalAlpha=g},duration:2}},M_={"cross-dissolve":{intro:"fade-in",outro:"fade-out"},"cross-blur":{intro:"blur-in",outro:"blur-out"},...Object.assign({},...D.map((({name:e})=>({[e]:{intro:"hide-in",outro:"hide-out"}}))))},F_={"fade-in":Pr.FocusIn,"text-focus-in":Pr.FocusIn,"text-flicker-in-glow":Pr.FlickerInGlow,"linear-wipe":Pr.Reveal,"swing-in-top-fwd":Pr.Drop},B_=async function({animation:e,layer:t,ctx:a,frameTime:o,fontSize:n=50,studioAnimations:r=null}){if(!e||!t||!e.id)return null;let{start:i,end:s}=ei(t,5);i=parseFloat(i.toFixed(2)),s=parseFloat(s.toFixed(2));const l=H_(e,r);let c=Math.max(0,Math.min((o-i)/l,1)),d=Math.max(0,(o-i)/l%1);if("outro"===e.type){const e=o-(s-l);e<0?(c=0,d=0):(c=Math.min(e/l,1),d=e/l%1)}const u={animation:e,layer:t,ctx:a,id:e.id,fontSize:n,frameTime:o,framePercent:c,repeatingFramePercent:d,frameBezValue:0,invertedFrameBezValue:1,frameBezValueMinusOne:1};!e.transitionId&&F_[u.id]&&(u.id=F_[u.id]),M_[u.id]&&(u.id=M_[u.id][e.type]);const{bezArray:m=[],animationFunction:p=(()=>{})}=U_[u.id]||{},h=((e,t,a,o)=>{let n=t;return"outro"===e.type&&(n=o<=a?1-t:1),n})(e,c,l,s-o);if(4===m.length){const e=O(m[0],m[1],m[2],m[3]);u.frameBezValue=e(h),u.frameBezValueMinusOne=u.frameBezValue-1,u.invertedFrameBezValue=Math.max(0,1-u.frameBezValue)}return u.animationFunction=p,u},W_=(e,t)=>{if(!e.animation)return!1;if(e.animation.id&&"none"!==e.animation.id)return!0;return V_(e,t).length>0||void 0},V_=(e,t)=>{if(!e.animation)return[];if(e.animation&&e.animation.id)return"none"===e.animation.id?[]:[e.animation];const a=[];for(const o of["intro","outro","constant"]){(e.animation[o]||[]).forEach((e=>{if("string"==typeof e&&t&&t.byId&&t.byId[e]){const n=t.byId[e];a.push({...n,type:o,id:n.animationName})}else"none"!==e.id&&a.push(e)}))}return a},j_=async(e,t,a,o,n)=>{if(!t.animation)return;if(t.animation.id)return void(async(e,t,a,o)=>{const{animation:n}=e,r=await B_({animation:n,layer:e,ctx:t,frameTime:a,fontSize:o});r&&r.animationFunction&&r.animationFunction(r)})(t,a,o,n);const r=V_(t,e),i=r.find((e=>"intro"===e.type)),s=r.find((e=>"outro"===e.type)),l=r.find((e=>"constant"===e.type)),{start:c,end:d}=ei(t,5),u=o-c,m={start:0,end:i?H_(i,e):0},p={start:s?d-H_(s,e)-c:0,end:s?d-c:0};if(l){const r=l,i=await B_({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!i||!i.animationFunction)return;i.animationFunction(i)}if(i&&u>=m.start&&u<m.end){const r=i,s=await B_({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!s||!s.animationFunction)return;s.animationFunction(s)}else if(s&&u>=p.start&&u<=p.end){const r=s,i=await B_({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!i||!i.animationFunction)return;i.animationFunction(i)}else o>d?i?a.globalAlpha=1:s&&(a.globalAlpha=0):o<c&&(i?a.globalAlpha=0:s&&(a.globalAlpha=1))},H_=(e,t)=>{var a;let o,n;if("string"==typeof e){const r=null==(a=null==t?void 0:t.byId)?void 0:a[e];r&&(o=U_[r.animationName].duration,n=r.speed)}else o=e.animationName?(U_[e.animationName]||{}).duration:e.duration,n=e.speed;switch(null==o&&(o=.5),n){case"slow":o*=2;break;case"fast":o*=.5}return o},G_=new Set(["fade","BowTieVertical","BowTieWithParameter","CircleCrop","TopBottom","LeftRight","LinearBlur","ZoomLeftWipe","ZoomRigthWipe","angular","cannabisleaf","circle","coord-from-in","fadecolor","fadegrayscale","polar_function","squareswire"]),$_=[Rr.CrossDissolve,"CrossZoom"],K_=Object.assign({},...L.map((e=>({[e.name]:e})))),Y_={[Rr.CrossDissolve]:{id:Rr.CrossDissolve,name:"Cross Dissolve",introAnimId:Pr.FadeIn,outroAnimId:Pr.FadeOut,isCrossTransition:!0,gltransition:!1},[Rr.CrossBlur]:{id:Rr.CrossBlur,name:"Cross Blur",introAnimId:Pr.BlurIn,outroAnimId:Pr.BlurOut,isCrossTransition:!0,gltransition:!1},...Object.assign({},...L.filter((({name:e})=>!G_.has(e))).map((({name:e,displayName:t})=>({[e]:{id:e,name:t,introAnimId:Pr.HideIn,outroAnimId:Pr.HideOut,isCrossTransition:!0,gltransition:!0}}))))},z_=e=>e in Y_,q_=e=>!!Q_(e),J_=[Rr.CrossDissolve,...L.filter((({name:e})=>!G_.has(e))).map((({name:e})=>e))].map((e=>({...Y_[e]}))).sort(((e,t)=>{const a=$_.indexOf(e.id)+1||$_.length+1,o=$_.indexOf(t.id)+1||$_.length+1;return a===o?e.name.toLowerCase().localeCompare(t.name.toLowerCase()):a>o?1:-1}));function X_(e){return{...Y_[e]}}function Q_(e){return K_[e]}const Z_=["video","image"],ev=.5,tv=e=>{let t=M(`${e}`).hsl();const a=t.array()[1],o=t.array()[2];return a<25&&(t=t.saturationl(25)),o<25&&(t=t.lightness(25)),o>80&&(t=t.lightness(80)),t.hex()},av=U(.42,0,.58,1),ov={[Pr.None]:{id:Pr.None,name:"None",duration:U_.none.duration,speed:"default",type:"none",animationFunc:()=>({})},[Pr.MagicFade]:{id:Pr.MagicFade,name:"Fade",duration:U_.none.duration,speed:"default",type:"constant",animationFunc:(e,t,a)=>{const{state:o}=io(),n=o.studio.magicSubtitles[a],{transitionDuration:r=0,transitionOverlapDuration:i=0}=n,[s,l]=(e=>[e.startTime||0,e.endTime||e.duration||io().state.studio.duration])(t),c=e-s<l-e;let d,u,m;if(c?(d=s-i,u=d+r):(u=l+i,d=u-r),m=(e-d)/r,m=nd(m,0,1),c||(m=1-m),1===m)return{};const p=av(m);return{WebkitFilter:`blur(${20-20*p}px)`,opacity:100*p+"%"}}}},nv={...ov,[Pr.Drop]:{id:Pr.Drop,name:"Drop",duration:U_.drop.duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,a)=>{const o=U(.175,.885,.32,1.275)(e);return{...Pv({layer:t,yPercent:50*-(1-o),transform:`${a} scaleY(${o})`})}}},[Pr.FlickerInGlow]:{id:Pr.FlickerInGlow,name:"Flicker",duration:U_["flicker-in-glow"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const a=ai(t)||1;return e>=0&&e<.1?{opacity:0}:e>=.1&&e<.101||e>=.101&&e<.102?{opacity:a}:e>=.102&&e<.2?{opacity:0}:e>=.2&&e<.201?{opacity:a}:e>=.201&&e<.206?{opacity:0}:e>=.206&&e<.3||e>=.3&&e<.301?{opacity:a}:e>=.301&&e<.305?{opacity:0}:e>=.305&&e<.306||e>=.306&&e<.45?{opacity:a}:e>=.45&&e<.451?{opacity:0}:e>=.451&&e<.5?{opacity:a}:e>=.5&&e<.55?{opacity:0}:e>=.55&&e<.551||e>=.551&&e<.57?{opacity:a}:e>=.57&&e<.571?{opacity:0}:e>=.571&&e<.6||e>=.6&&e<.601?{opacity:a}:e>=.601&&e<.65||e>=.601&&e<.65?{opacity:0}:e>=.651&&e<.75||e>=.75&&e<.751?{opacity:a}:e>=.751&&e<.77?{opacity:0}:e>=.77&&e<.771||e>=.771&&e<.85?{opacity:a}:e>=.85&&e<.851?{opacity:0}:e>=.851&&e<.86?{opacity:a}:e>=.86&&e<.861?{opacity:0}:e>=.861&&e<=.1?{opacity:a}:{}}},[Pr.FocusIn]:{id:Pr.FocusIn,name:"Fade",duration:U_["focus-in"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const a=ai(t)||1,o=U(.55,.085,.68,.53)(e),n=1*o;return{WebkitFilter:`blur(${12*(1-o)}px)`,opacity:n>a?a:n}}},[Pr.HueRotate]:{id:Pr.HueRotate,name:"Hue Rotate",duration:U_["hue-rotate"].duration,speed:"default",animatesForever:!0,type:"constant",animationFunc:e=>({WebkitFilter:`hue-rotate(${-360*U(.25,.25,.75,.75)(e)}deg)`}),selectionFunc:e=>{switch(e.type){case xr.Text:return{color:`${tv(e.color)}`,textShadow:"transparent",originalColor:e.color};case xr.Shape:return{background:`${tv(e.background)}`,originalColor:e.background}}return{}}},[Pr.Reveal]:{id:Pr.Reveal,name:"Reveal",duration:U_.reveal.duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-U(.22,1.03,.67,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Pr.PopInBounce]:{id:Pr.PopInBounce,name:"Pop",duration:U_["pop-in-bounce"].duration,speed:"default",type:"intro",animationFunc:e=>({transform:`scale(${U(.09,.54,.38,2.47)(e)})`,transformOrigin:"center"})},[Pr.SlideUp]:{id:Pr.SlideUp,name:"Slide",duration:U_["slide-up"].duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,a)=>{const o=ai(t)||1,n=U(.55,.085,.68,.53)(e);return{...xv({yPixels:20*(1-n),layer:t,transform:a}),opacity:e*o}}},[Pr.Vibrate]:{id:Pr.Vibrate,name:"Vibrate",duration:U_.vibrate.duration,speed:"default",animatesForever:!0,layerInvolvesMovement:!0,type:"constant",animationFunc:(e,t,a)=>{const o=e%1,n=.01*parseInt(String(t.fontSize||"50")),r=.2;let i=0,s=0;return o>0&&o<=r?(i=-n*o/r,s=n*o/r):o>r&&o<=.4?(i=-n,s=n-2*n*(o%r/r)):o>.4&&o<=.6000000000000001?(s=2*n*(o%r/r)-n,i=2*n*(o%r/r)-n):o>.6000000000000001&&o<.8?(s=n+n*(o%r/r),i=n):o>=.8&&o<1&&(s=2*n-2*n*(o%r/r),i=n-n*(o%r/r)),xv({layer:t,xPixels:i,yPixels:s,transform:a})}},[Pr.WipeRectangle]:{id:Pr.WipeRectangle,name:"Wipe",duration:U_["wipe-rectangle"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-U(.25,.1,.25,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Pr.ProgressBar]:{id:Pr.ProgressBar,name:"Progress Bar",duration:1,speed:"default",type:"constant",animationFunc:e=>{const t=100*(1-e);return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[Pr.BlurIn]:{id:Pr.BlurIn,name:"Blur in",duration:U_["blur-in"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=U(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*(1-t)}px)`,opacity:t}}},[Pr.BlurOut]:{id:Pr.BlurOut,name:"Blur Out",duration:U_["blur-out"].duration,speed:"default",type:"outro",animationFunc:e=>{const t=U(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*t}px)`,opacity:t}}},[Pr.FadeIn]:{id:Pr.FadeIn,name:"Fade in",duration:U_["fade-in"].duration,speed:"default",type:"intro",animationFunc:e=>({opacity:U(.24,.9,.72,.93)(e)})},[Pr.FadeOut]:{id:Pr.FadeOut,name:"Fade Out",duration:U_["fade-out"].duration,speed:"default",type:"outro",animationFunc:e=>({opacity:U(.24,.9,.72,.93)(e)})},[Pr.HideIn]:{id:Pr.HideIn,name:"Hide In",duration:U_["hide-in"].duration,speed:"default",type:"intro",animationFunc:()=>({display:"none"})},[Pr.HideOut]:{id:Pr.HideOut,name:"Hide Out",duration:U_["hide-out"].duration,speed:"default",type:"outro",animationFunc:()=>({display:"none"})}};function rv(e){return{...e}}const iv=["id","name","animationFunc","duration","speed"];function sv(e){if(!e)return!1;if(!e.id)return!1;if(e.duration<=0)return!1;for(let t=0;t<iv.length;t+=1)if(!e[iv[t]])return!1;return!e.layerInvolvesMovement||"boolean"==typeof e.layerInvolvesMovement}function lv(e){let t=nv[Pr.None],a=e;return e?(!nv[e]&&F_[e]&&(a=F_[e]),t=nv[a],sv(t)?rv(t):rv(nv[Pr.None])):rv(t)}function cv(e,t=io().state.studio.animations){if(null==t?void 0:t.byId[e])return null==t?void 0:t.byId[e]}function dv(e,t){const a=e.intro||[],o=e.outro||[],n=e.constant||[],r=[],i=[],s=[];return a.forEach((e=>{const a=cv(e,t);a&&r.push(a)})),o.forEach((e=>{const a=cv(e,t);a&&i.push(a)})),n.forEach((e=>{const a=cv(e,t);a&&s.push(a)})),{intro:r,outro:i,constant:s}}function uv(e,t){let a,o=!0;if(z_(e.animationName)){const{introAnimId:o,outroAnimId:n}=X_(e.animationName);a="intro"===t?o:n}else e.animationName===Pr.None?a=Pr.None:(o=!1,a=e.animationName);const n=nv[a];if(sv(n)){if(e.isCrossTransition){return{...n,speed:e.speed,transitionId:o?e.animationName:void 0,animationStateMapId:e.id,type:t,isCrossTransition:!0,introLayerId:e.introLayerId,outroLayerId:e.outroLayerId}}return{...n,speed:e.speed,isCrossTransition:e.isCrossTransition,animationStateMapId:e.id,type:t,layerId:e.layerId}}return null}function mv(e){const t=e.intro||[],a=e.outro||[],o=e.constant||[],n=[],r=[],i=[];t.forEach((e=>{const t=uv(e,"intro");t&&n.push(t)})),a.forEach((e=>{const t=uv(e,"outro");t&&r.push(t)})),o.forEach((e=>{const t=uv(e,"constant");t&&i.push(t)}));return{intro:n,outro:r,constant:i}}function pv(e){const t={intro:[],constant:[],outro:[]};if(!e.animation)return t;const a=mv(dv(e.animation));return a||t}function hv(e){var t,a;const o=nv[Pr.None];if(!e.animation)return rv(o);if((null==(t=e.animation.constant)?void 0:t[0])===Pr.ProgressBar)return rv(nv[Pr.ProgressBar]);const n=mv(dv(e.animation));if(!n)return rv(o);let r=null;for(const s of Object.keys(n))n[s]&&(null==(a=n[s][0])?void 0:a.id)&&([r]=n[s]);if(!r||r.id===Pr.None)return rv(nv[Pr.None]);const i=lv(r.id);return i.speed=r.speed||"default",rv(i)}function gv(e){var t;const a=nv[Pr.None];if(!e.animation)return[rv(a)];if((null==(t=e.animation.constant)?void 0:t[0])===Pr.ProgressBar)return[rv(nv[Pr.ProgressBar])];const o=mv(dv(e.animation));if(!o)return[rv(a)];let n=[];for(const r of Object.keys(o)){if(!r)return[rv(a)];o[r]&&(n=[...n,o[r][0]])}return n.map((e=>{if(!e)return rv(a);const t=lv(e.id);return t.speed=e.speed,t.type=e.type,rv(t)}))}function fv(e,t,a){var o,n;if(!e.animation)return null;const r=mv(dv(e.animation,a));if(!r)return null;let i=null;if((null==(o=null==r?void 0:r[t])?void 0:o[0])&&(i=null==(n=null==r?void 0:r[t])?void 0:n[0]),!i||i.id===Pr.None)return null;return{...lv(i.id),...i}}function yv(e){if(!e.animation)return{introTransition:null,outroTransition:null};const t=mv(dv(e.animation));if(!t)return{introTransition:null,outroTransition:null};let a=null,o=null;for(const i of Object.keys(t)){const e=t[i][0];e&&e.isCrossTransition&&("intro"===i&&(a=e),"outro"===i&&(o=e))}if(!a&&!o)return{introTransition:null,outroTransition:null};let n=null,r=null;return a&&(n=rv({...lv(a.id),...a})),o&&(r=rv({...lv(o.id),...o})),{introTransition:n,outroTransition:r}}function Ev(e){const t=Nv.find((t=>t.id===e.introAnimId)),a=Nv.find((t=>t.id===e.outroAnimId));if(!t||!a)throw Error(`Missing intro or outro animation for transition ${e.id}`);return{introAnimation:rv(t),outroAnimation:rv(a)}}const _v=e=>e.map((e=>({...nv[e]}))),vv=_v([Pr.None,Pr.Drop,Pr.FlickerInGlow,Pr.FocusIn,Pr.Reveal,Pr.PopInBounce,Pr.SlideUp,Pr.WipeRectangle]),wv=_v([Pr.None,Pr.Vibrate]),bv=_v([Pr.None,Pr.Drop,Pr.FlickerInGlow,Pr.FocusIn,Pr.Reveal,Pr.PopInBounce,Pr.SlideUp]),Sv=_v([Pr.None,Pr.HueRotate,Pr.Vibrate]),Tv=_v([Pr.None,Pr.FlickerInGlow,Pr.FocusIn,Pr.Reveal,Pr.SlideUp]),Iv=_v([Pr.None,Pr.HueRotate,Pr.Vibrate]),kv=_v([Pr.None,Pr.HueRotate]),Cv=_v([Pr.None,Pr.Drop,Pr.FocusIn,Pr.FlickerInGlow,Pr.Reveal,Pr.PopInBounce,Pr.SlideUp]),Nv=_v([Pr.FadeIn,Pr.FadeOut,Pr.BlurIn,Pr.BlurOut,Pr.HideIn,Pr.HideOut]),Av=_v([Pr.FocusIn,Pr.Drop,Pr.FlickerInGlow,Pr.Reveal,Pr.PopInBounce,Pr.SlideUp]),xv=({layer:e,xPixels:t=0,yPixels:a=0,transform:o=""})=>{switch(e.type){case xr.Audio:case xr.Video:case xr.Image:case xr.Shape:return{x:t,y:a,transform:o};case xr.Text:return{transform:`${o} translate(${t}px, ${a}px)`};case xr.Subtitle:default:return{}}},Pv=({layer:e,xPercent:t=0,yPercent:a=0,transform:o=""})=>{var n,r,i,s,l,c;switch(e.type){case xr.Audio:case xr.Video:case xr.Image:case xr.Shape:return{x:.01*t*(null!=(i=null!=(r=null==(n=null==e?void 0:e.position)?void 0:n.float_width)?r:e.width)?i:0),y:.01*a*(null!=(c=null!=(l=null==(s=null==e?void 0:e.position)?void 0:s.float_height)?l:e.width)?c:0),transform:o};case xr.Text:return{transform:`${o} translate(${t}%, ${a}%)`};case xr.Subtitle:default:return{}}};function Rv(e){const t=hv(e);return!e.animation||"none"===t.id}function Ov(e){return!(e.requireConversion||"gif-to-webm"===e.conversion_type||"pastedLink"===e.source||e.pastedUrl)}function Dv(e){return!(!e.isReversed&&!e.isAudiogram)||!!$r(e)&&!!(e.removeBg||e.blurBg||e.chromaKey||!Rv(e)||e.audioEffect)}function Lv(e){return!(Dv(e)||!Ov(e)||jr(e)&&!e.isAudiogram||!e.width||!e.height)}const Uv=1/30,Mv=33.333333333333336,Fv=[],Bv=r((e=>e.studio.scenes),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),((e,t,a,o)=>{const n=[];return e.forEach((({layers:r},i)=>{var s,l,c,d;const u=mn(e,i);for(const m of r){if("subtitle"===m.type)break;if(($r(m)||jr(m)||Kr(m))&&!Lv(m)){const r=null==a?void 0:a[m.id],p=xd(m,r),h=hn(p),g=k_(m),{assetSource:f}=m,y=Od(m,o),E={layerId:m.id,playbackRate:Number(m.playbackRate)||1,mediaId:y||m.asset_id||m.uploadId||m.id,url:g,type:m.type,disableCORS:f&&["Google Photos","Youtube"].includes(f)&&!C_(g),volume:null!=(c=null!=(l=null==(s=t[m.id])?void 0:s.volumeTemp)?l:m.volume)?c:1,relativeStartEndTimes:[WE(p.startTime||0),WE(null!=(d=p.endTime)?d:(p.startTime||0)+m.duration)],startEndTimes:[WE(u+((Kr(p)?p.startTime:p.videoDelay)||0)),WE(u+((Kr(p)?p.startTime:p.videoDelay)||0)+h)]};r&&("trim-start"===r.type||"trim-end"===r.type||r.leftMost)&&(E.shouldBePlayingOverride=!0),E.startEndTimes[1]===WE(e[i].duration-u)&&(E.isAtEnd=!0),n.push(E)}}})),0===n.length?Fv:n.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))})),Wv=()=>r((e=>e.studio.scenes),((e,t)=>t),((e,t)=>{var a;const o=null==(a=e[0])?void 0:a.id,n=e.findIndex((({id:e})=>e===o));if(-1===n)return[0,0];const r=mn(e,n);return Vv(t,r)}));r((e=>e.studio.scenes),(e=>{const t=[];for(let a=0;a<e.length;a+=1){const o=mn(e,a);for(const n of e[a].layers){if("subtitle"===n.type)break;const[e,a]=Vv(n,o);t.push({...n,absoluteStartTime:e,absoluteEndTime:a})}}return t}));const Vv=(e,t)=>{if($r(e)||jr(e)){const a=t+(e.videoDelay||0),o=a+hn(e);return[WE(a),WE(o)]}return[t+(e.startTime||0),t+(e.endTime||e.duration||io().state.studio.duration)]},jv=r((e=>e.studio.scenes),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),(e=>e.studio.canvasBlur),((e,t,a,o,n)=>{const r=[];let i=0;if(e.forEach((({layers:n},s)=>{var l,c,d,u;const m=mn(e,s);for(const p of n){if("subtitle"===p.type)break;if($r(p)&&Lv(p)){const n=null==a?void 0:a[p.id],h=xd(p,n),g=hn(h),f=k_(p),y=Od(p,o),E={layerId:p.id,playbackRate:Number(p.playbackRate)||1,mediaId:y||p.asset_id||p.uploadId||p.id,url:f,type:p.type,volume:null!=(d=null!=(c=null==(l=t[p.id])?void 0:l.volumeTemp)?c:p.volume)?d:1,relativeStartEndTimes:[WE(h.startTime||0),WE(null!=(u=h.endTime)?u:(h.startTime||0)+p.duration)],startEndTimes:[WE(m+(h.videoDelay||0)),WE(m+(h.videoDelay||0)+g)]};n&&("trim-start"===n.type||"trim-end"===n.type||n.leftMost)&&(E.shouldBePlayingOverride=!0),E.startEndTimes[1]===WE(e[s].duration-i)&&(E.isAtEnd=!0),r.push(E)}}i+=e[s].duration})),n)return r.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]));const s={};for(const l of r)l.mediaId in s?s[l.mediaId].push(l):s[l.mediaId]=[l];for(const l in s)s[l].sort(((e,t)=>e.relativeStartEndTimes[0]-t.relativeStartEndTimes[0]));return r.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))})),Hv=e=>({layerId:e.layerId,startEndTimes:[WE(e.startEndTimes[0]),WE(e.startEndTimes[1])]}),Gv=r(jv,Bv,((e,t)=>{const a=[];return e.forEach((e=>a.push(Hv(e)))),t.forEach((e=>a.push(Hv(e)))),a}));function $v(){const e=ic(),{state:t}=io(),a=e-.06666666666666667,o=e+.06666666666666667,n=jv(io().state),r=Gv(t);for(const i of n){const[t,n]=i.startEndTimes;if(t<a&&o<n&&cc([t,n],e,r))return!0}return!1}const Kv=(e,t,a)=>{const[o,n]=e.startEndTimes,r=t.filter((e=>{const[t,o]=e.startEndTimes;return t<=a&&a<=o}));for(const{startEndTimes:[i,s]}of r){if(o<i&&i<n)return!0;if(o<s&&s<n)return!0;if(dc(o,i,.01)&&dc(n,s,.01))return!0}return!1};function Yv(){const e=ic(),{state:t}=io(),a=e-.03333333333333333,o=e+.03333333333333333,n=Gv(t),r=n.filter((({layerId:e})=>{const a=IE(e,t.studio);return!!a&&!(Lv(a)||(o=a,!Lv(o)&&(!$r(o)&&!jr(o)||Dv(o)||!Ov(o))));var o})),i=n.filter((({layerId:e})=>{const a=IE(e,t.studio);return!!a&&Lv(a)}));for(const s of r){const[t,r]=s.startEndTimes;if(t<a&&o<r&&cc([t,r],e,n)&&!Kv(s,i,e))return!0}return!1}const zv=(e,t,a)=>!a&&!!uc(e,t,e+qv),qv=.16666666666666666,Jv=()=>r(jv,Bv,(e=>e.studioLocal.isLayerMountedByLayerId),((e,t)=>t),((e,t,a,o)=>{const n=e.find((e=>dc(o,e.startEndTimes[0],.03333333333333333)))||t.find((e=>e.type===xr.Video&&dc(o,e.startEndTimes[0],.03333333333333333)));return!!n&&!a[n.layerId]})),Xv=()=>{const{state:e}=io(),{overlayWithHeader:t}=e.studio;return t&&""!==t?t:void 0},Qv=e=>{const{dispatch:t}=io();t(xi({key:As.trim,params:e}))},Zv=()=>{const{dispatch:e}=io();e(yi())},ew=e=>{fm("Smart Cut Opened",{layerType:e.previewLayer.type});const{dispatch:t}=io();t(xi({key:As.smartCut,params:e}))},tw=e=>{fm("Scene Split Opened");const{dispatch:t}=io();t(xi({key:As.sceneSplit,params:e}))},aw=()=>{const{dispatch:e}=io();e({type:"HIDE_SIGN_IN"})},ow=()=>{const{dispatch:e}=io();e(c_(!0))},nw=()=>{const{dispatch:e}=io();e(c_(!1))},rw=()=>{const{dispatch:e}=io();e(e_(!1,void 0,void 0))};function iw(e,t,a,o){const n=(a.width-t.width)/t.width,r=(a.height-t.height)/t.height;let i=e.xPct*t.width/a.width,s=e.yPct*t.height/a.height;const l=e.widthPct/(1+n),c=e.heightPct/(1+r);if(o.left){const o=t.width-e.xPct/100*t.width;i=100*(a.width-o)/a.width}if(o.top){const o=t.height-e.yPct/100*t.height;s=100*(a.height-o)/a.height}return{xPct:i,yPct:s,widthPct:l,heightPct:c}}const sw=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=io(),{scenes:r,hasCustomOutput:s}=n.studio,l=n.studio.width,c=n.studio.height,d=(e-l)/l,u=(t-c)/c;i.exports.batch((()=>{for(const n of r)for(const r of n.layers){const n=r.position,i=parseFloat(n.x),s=parseFloat(n.y),d=parseFloat(n.width),u=iw({heightPct:parseFloat(n.height),widthPct:d,xPct:i,yPct:s},{height:c,width:l},{height:t,width:e},a);o(ds(r,{position:{...r.position,x:`${u.xPct}%`,y:`${u.yPct}%`,width:`${u.widthPct}%`,height:`${u.heightPct}%`}},!0))}}));for(const[i,v]of Object.entries(n.studio.magicSubtitles||{})){if(!v)continue;const n=iw(v.position,{height:c,width:l},{height:t,width:e},a);o(f_(i,{position:{...v.position,...n}}))}const m=n.studio.customOutputWidth,p=n.studio.customOutputHeight,h=(e,t)=>0===t?e:h(t,e<t?e%t:t%e),g=h(e,t),f=t/g,y=e=>{const t=e.toString().substring(0,4);return["1.76","1.77","1.78"].includes(t)?"1.7":gc(e,2)},E=`${y(e/g)}:${y(f)}`,_={"1:1":"1:1","1:1.7":"9:16","1.7:1":"16:9","1.25:1":"5:4","1:1.25":"4:5"}[E]||E;if(s){let a=Math.min(d*m+m,1920),n=Math.min(u*p+p,1920);if(1920===a&&1920===n)rw(),o(QE(_,!0));else{if(1920===a&&n<1920){n-=e/t/100*n}if(1920===n&&a<1920){a-=t/e/100*a}lw(a,n),o(QE(`${a}:${n}`,!0))}}else o(QE(_,!0))})),lw=(e,t)=>{const{dispatch:a}=io();a(e_(!0,Number(e),Number(t),!0))},cw=()=>{const{state:e}=io(),{customOutputWidth:t}=e.studio,{customOutputHeight:a}=e.studio;(t>1920||a>1920)&&rw()},dw=tr.withUndoBatch((()=>{const{dispatch:e,state:t}=io(),{ratio:a,selectedSceneIndex:o}=t.studio,{layers:n}=t.studio.scenes[o],{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:c}=T_(a),d=wd(n),u=d.right-d.left,m=d.bottom-d.top,p=u*i/100,h=m*s/100;e(QE(`${u*l}:${m*c}`,!0)),r&&lw(p,h);const g=[];for(let f=0;f<n.length;f+=1){const e=n[f],t=n[f].position;let a={};a="subtitle"!==e.type?{position:{...t,x:100*(parseFloat(t.x)-d.left)/u+"%",y:100*(parseFloat(t.y)-d.top)/m+"%",width:100*parseFloat(t.width)/u+"%",height:100*parseFloat(t.height)/m+"%"}}:{position:{x:"0%",y:"80%",width:"100%",height:"10%"}};const o={...n[f],...a};g.push(o)}return e(us(g,o,!0)),g})),uw=tr.withUndoBatch((()=>{const{dispatch:e,state:t}=io(),{ratio:a,selectedSceneIndex:o}=t.studio,{layers:n}=t.studio.scenes[o],{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:c}=T_(a),d=1.1*c;if(d/l>=100)return;if(e(QE(`${l}:${d}`,!0)),r){const e=Math.min(1.1*s,1920);if(1920===e){const t=(e-s)/s;lw(0===t?.9*i:i-i*t,e)}else lw(i,e)}const u=[];for(let m=0;m<n.length;m+=1){const e=n[m].position,t={position:{...e,y:`${nd(parseFloat(e.y)/1.1,0,100)}%`,height:`${nd(parseFloat(e.height)/1.1,0,100)}%`}},a={...n[m],...t};u.push(a)}e(us(u,o,!0))})),mw=tr.withUndoBatch((()=>{const{dispatch:e,state:t}=io(),{ratio:a,selectedSceneIndex:o}=t.studio,{layers:n}=t.studio.scenes[o],{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,l=t.studio.height,{ratioWidth:c,ratioHeight:d}=T_(a);if(1.1*d/c>=100)return;if(e(QE(`${c}:${1.1*d}`,!0)),r){const e=Math.min(1.1*s,1920);if(1920===e){const t=(e-s)/s;lw(0===t?.9*i:i-i*t,e)}else lw(i,e)}const u=[];for(let m=0;m<n.length;m+=1){const e=n[m].position,t=1.1*l,a=100*(t-(l-parseFloat(e.y)/100*l))/t,o=parseFloat(e.height)/1.1,r={position:{...e,y:`${nd(a,0,100)}%`,height:`${nd(o,0,100)}%`}},i={...n[m],...r};u.push(i)}e(us(u,o,!0))})),pw=tr.withUndoBatch((()=>{const{dispatch:e,state:t}=io(),{ratio:a,selectedSceneIndex:o}=t.studio,{layers:n}=t.studio.scenes[o],{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,l=t.studio.width,{ratioWidth:c,ratioHeight:d}=T_(a),u=1.1*c;if(u/d>=100)return;e(QE(`${u}:${d}`,!0));let m=!1;if(r){const e=Math.min(1.1*i,1920);if(1920===e){m=!0;const t=(e-i)/i;lw(e,0===t?.9*s:s-s*t)}else lw(e,s)}const p=[];for(let h=0;h<n.length;h+=1){const e=n[h].position,t=parseFloat(e.x),a=parseFloat(e.width),o=1.1*l,r=100*(o-(l-t/100*l))/o,i=m?a:a/1.1,s={position:{...e,x:`${nd(r,0,100)}%`,width:`${nd(i,0,100)}%`}},c={...n[h],...s};p.push(c)}e(us(p,o,!0))})),hw=tr.withUndoBatch((()=>{const{dispatch:e,state:t}=io(),{ratio:a,selectedSceneIndex:o}=t.studio,{layers:n}=t.studio.scenes[o],{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:c}=T_(a),d=1.1*l;if(d/c>=100)return;let u=!1;if(r){const e=Math.min(1.1*i,1920);if(1920===e){u=!0;const t=(e-i)/i;lw(e,0===t?.9*s:s-s*t)}else lw(e,s)}const m=[];for(let p=0;p<n.length;p+=1){const e=n[p].position,t=parseFloat(e.width),a=u?t:t/1.1,o={position:{...e,x:`${nd(parseFloat(e.x)/1.1,0,100)}%`,width:`${nd(a,0,100)}%`}},r={...n[p],...o};m.push(r)}e(QE(`${d}:${c}`,!0)),e(us(m,o,!0))})),gw=(e,t,a,o,n,r)=>{const{state:i,dispatch:s}=io(),{scenes:l,containerWidth:c,containerHeight:d,width:u,height:m}=i.studio,p=u,h=m;if(!p||!h)return;lw(e,t),yw(e,t,!0,!0,r||void 0,a?"Fill and Crop":"Fit to Center",o,n);const{width:g,height:f}=I_(`${e}:${t}`,{width:u,height:m},!1),{width:y,height:E}=I_(`${e}:${t}`,{width:c,height:d},!1),_=Fc(l[0].layers,p,h,a?y:g,a?E:f);l[0].layers.filter((e=>"subtitle"!==e.type)).forEach((e=>{let t;if(a?"shape"===e.type&&e.position&&p&&h&&y&&E?t=Wc(e.position,y,E,p,h):_&&(t=Bc(e,p,h,y,E)):t=_?Bc(e,p,h,g,f):Mc(e,p,h,g,f),t){const o=a?y:g,n=a?E:f;s(es(e,t.x/o*100+"%",t.y/n*100+"%",t.width/o*100+"%",t.height/n*100+"%",!0))}}));for(const[v,w]of Object.entries(i.studio.magicSubtitles||{})){if(!w)continue;const{height:e}=vc(w.position.widthPct,w.position.heightPct,{width:p,height:h}),t=e/E*100,a=w.position.heightPct-t,o=w.position.yPct+a,n=y/p;s(f_(v,{position:{...w.position,heightPct:t,yPct:o},style:{...w.style,fontSize:Math.max(1,Math.round(w.style.fontSize/n))}}))}a&&rw()},fw=(e,t,a,o)=>e/t==a/o,yw=(e,t,a=!1,o=!1,n,r,i,s)=>{const{dispatch:l,state:c}=io(),d=c.studio.ratio,u=`${e}:${t}`;if(l(QE(u,a)),o){const e=c.studio.scenes[0],t=new Set;for(const n of e.layers){const e=Od(n,c.mediaCache);n.type===xr.Video&&e&&t.add(e)}const a={};for(const n of e.layers)if("number"==typeof n.timelineRow){const t=`${e.id}_${n.timelineRow}`;a[t]=(a[t]||0)+1}const o=ic();let m=e.layers;e.duration>0&&(m=m.filter((e=>{const t=Vv(e,0);return o>=t[0]&&o<t[1]}))),l(qg({usedCanvasResize:!0})),fm("Canvas Resize",n&&r&&void 0!==i&&void 0!==s?{"Previous Aspect Ratio":d,"New Aspect Ratio":u,"New Size Selected":n,"Fit or Fill":r,"Canvas Blur Applied":i,"Background Color Changed":s,"Number of Video Splits":c.studio.analytics.timesVideoSplit,"Number of Layers":e.layers.length,"Number of Layers Shown in Preview":m.length,"Number of Tracks Used":Object.keys(a).length,"Number of Video Input Files":t.size}:{"Previous Aspect Ratio":d,"New Aspect Ratio":u,"Number of Video Splits":c.studio.analytics.timesVideoSplit,"Number of Layers":e.layers.length,"Number of Layers Shown in Preview":m.length,"Number of Tracks Used":Object.keys(a).length,"Number of Video Input Files":t.size})}"Scenes"===Xv()&&Ew(u,{x:0,y:0,width:c.studio.containerWidth||1500,height:c.studio.containerHeight||1500},!1)},Ew=(e,t,a)=>{const{dispatch:o}=io(),n=I_(e,t,a);o(KE(n)),o(JE(XE({canvasWidth:n.width,canvasHeight:n.height})))},_w=e=>{const{dispatch:t}=io();t(hs(e))},vw=()=>{const{state:e}=io();return e.studio.snapToGrid&&!e.studioLocal.commandIsBeingPressed&&!e.studioLocal.controlIsBeingPressed},ww=e=>{const t=["/studio/editor/scenes","/studio/editor/scenes/duration","/studio/editor/scenes/drag-upload","/studio/edtior/scenes/output-resize",/\/studio\/editor\/export-as-image.*/,"/studio/editor/audio",/\/studio\/editor\/subtitle-overlay(.*)/,"/studio/editor/trimmer","/studio/editor/animate","/studio/editor/adjust","/studio/editor/volume-adjust","/studio/editor/animate/colors","/studio/editor/animate/animation-background-color","/studio/editor/remove-background"];let a=!1;for(let o=0;o<t.length;o+=1){const n=t[o];if("string"==typeof n){if(Ll(e)===n){a=!0;break}}else if(n instanceof RegExp&&n.test(e)){a=!0;break}}return!a},bw=()=>{const{state:e}=io();let t=0;return e.studio.selectedSceneIndex&&(t=e.studio.selectedSceneIndex),e.studio.scenes[t]};function Sw(e){const{state:t}=io(),{scenes:a}=t.studio;for(const o of a){const{duration:t}=kw(o);Tw(o,t,e)}}function Tw(e,t,a){const{dispatch:o}=io(),n=t>0;i.exports.batch((()=>{for(const r of e.layers)Nd(r)&&"subtitle"!==r.type&&(null==r.endTime&&n||null==r.startTime&&n||r.isTrimmed!==n)&&(r.pluginSource?o(ds(r,{startTime:t,endTime:t+3,isTrimmed:n},a)):o(ds(r,{startTime:0,endTime:t,isTrimmed:n},a)))}))}const Iw=r((e=>e.studio.scenes[e.studio.selectedSceneIndex]),(e=>kw(e).duration)),kw=(e=bw())=>VE(e),Cw=tr.withUndoBatch((({scene:e,newDuration:t,userSetDuration:a,hasCustomOutput:o,isImageVideo:n})=>{var r;const{state:i,dispatch:s}=io(),{videoTypeSetting:l}=i.studio;t&&Tw(e,t,!0),(null==(r=e.layers)?void 0:r.length)&&t||(s(qE(t,!0)),s(zE(n))),s(Ty(e,{userSelectedDuration:t,userSetDuration:a,duration:t},!0)),(!l||l&&"gif"!==l)&&s(Ny("mp4")),o&&cw()})),Nw=(e=!0)=>{const{state:t}=io(),{hasCustomOutput:a}=t.studio,o=((e=!1)=>{const{state:t}=io();let{duration:a}=t.studio;a=a||0;const o=a.toString();if(o.match(/^(\d*\.*\d+|\.\d)$/))return parseFloat(o);if(o.match(/^(\d+):(\d+)$/)){const e=o.match(/^(\d+):(\d+)$/);if(e&&parseInt(e[2],10)<60)return 60*Number(e[1])+parseInt(e[2],10)}return-1})(),n=t.studio.scenes[t.studio.selectedSceneIndex];Cw({scene:n,newDuration:o,userSetDuration:e,hasCustomOutput:a,isImageVideo:!1})},Aw=(e,t,a)=>{e.layers.splice(a,0,t)},xw=(e,t,a)=>{let o;o="subtitle"===a.type?((e,t,a)=>{const{layers:o}=e;let n=-1;if(t.duplicatedLayerId){for(let r=0;r<o.length;r+=1)if(o[r].id===t.duplicatedLayerId){n=r,Aw(e,a,n);break}}else if(e.layers.push(a),"layerIndex"in t&&t.layerIndex!==e.layers.length-1){const o=t.layerIndex-(e.layers.length-1);n=t.layerIndex,e.layers=bE(e,a,o,!0)}else n=e.layers.length-1;return n})(e,t,a):((e,t,a)=>{const{layerIndex:o}=t;let n=o;if(void 0===n){const t=(e=>{for(let t=e.length-1;t>=0;t-=1)if("subtitle"!==e[t].type)return t;return null})(e.layers);n=null===t?0:t+1}return Aw(e,a,n),n})(e,t,a);const n={...a};delete n.local_url,Bp(e,n,o,"insertLayer")};function Pw(e,t){e.undoable&&tr.add({undo:{type:"REMOVE_LAYER",layer:e.layer,isUndo:!0,selectedSceneIndex:t.selectedSceneIndex,undoable:!1},redo:{...e,isRedo:!0,undoable:!1}});let{layer:a}=e;const{deletedLayerDict:o}=t;let n=!1;(e.isRedo||e.isUndo)&&o[e.layer.id]&&(a=o[e.layer.id],delete o[e.layer.id],n=!0);const{scenes:r}=t;w({category:"Studio Add Layer",message:`Layer: ${JSON.stringify(a)}`});const i=e.sceneId||t.scenes[0].id;t.selectedSceneIndex=0;const s=r[t.selectedSceneIndex];xw(s,e,a);const l=!n||e.isRedo||e.isUndo,{duration:c}=kw(s),[d,u]=vE(r,i,{duration:c},"scene","handleAddLayerAction");t.scenes=d;const m=NE(d);Lp("duration",m,t.duration,"handleAddLayerAction"),t.duration=m,AE(t,m,d),Lp("showCanvas",!0,t.showCanvas,"handleAddLayerAction"),t.showCanvas=l||t.showCanvas,t.updateKey=F.v4();const p=t._id;a.asset_id&&a.cmlFileId&&PE(t,{asset_id:a.asset_id,cmlFileId:a.cmlFileId}),t.allLayers.byId[a.id]=a;const h=t.scenes.some((e=>e.layers.some((e=>e.cmlFileId===a.cmlFileId&&e.id!==a.id))));p&&a.cmlFileId&&!h&&hh(a.cmlFileId,p)}function Rw(e,t,a,o){const n=`removeLayer/${o}`,{scenes:r}=e,i=[...r];i[a].layers=function(e,t){const a=[];for(let o=0;o<t.layers.length;o+=1)t.layers[o].id!==e.id?a.push(t.layers[o]):Wp(o,t.layers[o],t,"removeLayerHelper");return a}(t,i[a]);const s=1===i.length&&0===i[0].layers.length;let l=!1;for(const u of i[a].layers)if(["video","audio"].includes(u.type)){l=!0;break}if(i.length>1&&!l){const e=`scene_${i[a].id}`,{duration:t}=i[a],{isImageVideo:o}=i[0];Up(e,"isImageVideo",!0,o,n),i[a].isImageVideo=!0;const r=t||3;Up(e,"duration",r,t,n),i[a].duration=r}else if(s){i[0].isImageVideo=!1,i[0].duration=0,i[0].userSelectedDuration=0;const e=`scene_${i[0].id}`;Up(e,"isImageVideo",!1,i[0].isImageVideo,n),Up(e,"duration",0,i[0].duration,n)}t.local_url&&(e.deletedLayerLocalBlobDict[t.id]=t.local_url),e.deletedLayerDict={...e.deletedLayerDict,[t.id]:{...t}};const c=NE(i);1===i.length&&i[a].layers.length<=0&&(Lp("showCanvas",!1,e.showCanvas,n),e.showCanvas=!1,e.width=void 0,e.height=void 0);const d=F.v4();return{...e,scenes:i,duration:c,updateKey:d}}function Ow(e,t){const{deletedLayerDict:a,deletedLayerLocalBlobDict:o}=t;return N(t,(t=>{if(o[e.layer.id]){const n=a[e.layer.id],r=o[e.layer.id];n&&(n.source="upload",n.url=e.layer.url),e.layer.url&&Dw(t.scenes,e.layer,r)}const n=function(e,t){const a={};Lw.forEach((t=>{t in e&&(a[t]=e[t])}));const o=[];return t.forEach((t=>{t.layers.every(((n,r)=>{if("subtitle"===n.type)return!1;if(n.local_url&&n.local_url===e.local_url||n.uploadId&&n.uploadId===e.uploadId){const e={...n,...a};Lp(`layer_${n.id}`,e,n,"modifyUploadedLayer"),t.layers[r]=e,o.push(e)}return!0}))})),o}(e.layer,t.scenes),r=TE(e.layer.id,t),i=t.scenes[r];if(i){const[t,a]=vE(i.layers,e.layer.id,e.properties,"layer","updateUploadedLayer",!e.properties.id);i.layers=t}if(n)for(const a of n){const o={...a,...e.properties};t.allLayers.byId[o.id]=o}}))}const Dw=(e,t,a)=>{for(const o of e)for(const e of o.layers)if(e.local_url===a){const a=`layer_${e.id}`;Up(a,"source","upload",e.source,"updateLayersWithLocalBlob"),e.source="upload",Up(a,"url",t.url,e.url,"updateLayersWithLocalBlob"),e.url=t.url}},Lw=["url","local_url","asset_id","source","ffprobeData","duration","conversion_type","conversion_id","conversion_failed","uploadConfirmed","uploadPending","pastedUrl","cmlFileId","videoConvertedState","doRetryExtraction"];function Uw(e,t){var a;const o={...t.allLayers.byId};if(e.undoable){const{layer:t}=e,a=Object.keys(e.properties);let o;if(e.initialProperties)o=B(e.initialProperties,...a);else{const e={};a.forEach((a=>{e[a]=t[a]})),o=e}tr.add({undo:{type:"UPDATE_LAYER",layer:t,properties:o},redo:{type:"UPDATE_LAYER",layer:t,properties:{...e.properties}}})}const n=t.deletedLayerDict[e.layer.id];if(n)return{...t,deletedLayerDict:{...t.deletedLayerDict,[e.layer.id]:{...n,...e.properties}}};(function(e){var t;return!!(null==(t=e.properties)?void 0:t.id)})(e)&&LE(t,e);const r=[...t.scenes],i=TE(e.layer.id,t);let s=null;if(r[i]){s={...r[i]};const[t,a]=vE(s.layers,e.layer.id,e.properties,"layer","UPDATE_LAYER",!e.properties.id);s.layers=t,o[a.id]=a}const l=NE(r),c=s?r.map((e=>s&&e.id===s.id?s:e)):r;let{selectedTimelineRows:d}=t;return(null==(a=t.selectedItem)?void 0:a.id)===e.layer.id&&!e.layer.timelineRow&&e.properties.timelineRow&&(d=[],d.push(e.properties.timelineRow)),{...t,scenes:c,selectedTimelineRows:d,duration:l,updateKey:y(),allLayers:{byId:o}}}const Mw=(e,t)=>{var a,o,n,r,i,l,c,d,u,m,p,h,g,f,E,_,v,b,S;const T=[...e.scenes];let I=-1,k=0;switch(t.type){case"ADD_ANIMATION":return N(e,(a=>{var o,n;const r=(null==(o=a.animations)?void 0:o.allIds)||[];r.push(t.animationInstance.id),a.animations.allIds=r;const i=(null==(n=a.animations)?void 0:n.byId)||{};if(i[t.animationInstance.id]=t.animationInstance,a.animations.byId=i,t.undoable){const e={type:"DELETE_ANIMATION",animationId:t.animationInstance.id},a={type:"ADD_ANIMATION",animationInstance:t.animationInstance};tr.add({undo:e,redo:a})}Up("animations","byId",i,e.animations.byId,"ADD_ANIMATION_BY_ID"),Up("animations","allIds",r,e.animations.allIds,"ADD_ANIMATION_ALL_IDS")}));case"ADD_GROUP_TO_GROUP":{let a;if(t.undoable&&tr.add({undo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}}),e.groups[t.destGroupId]){const o=[...e.groups[t.destGroupId].layers,...e.groups[t.srcGroupId].layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))];a={...e.groups[t.destGroupId],layers:o,rotation:0,preMergeRotation:e.groups[t.destGroupId].preMergeRotation||e.groups[t.destGroupId].rotation}}else{a={layers:[...e.groups[t.srcGroupId].layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))],saved:!1,rotation:0}}const o=kE(a,e),n={...e.groups,[t.destGroupId]:a,[t.srcGroupId]:{...e.groups[t.srcGroupId],layers:[]}};return Lp("groups",n,e.groups,"ADD_GROUP_TO_GROUP"),{...e,groups:n,selectedTimelineRows:o,updateKey:y()}}case"ADD_LAYER":return e.allLayers.byId[t.layer.id]?(console.error("Refusing to add a layer that exists. Updating the layer instead","\nOld layer: ",e.allLayers.byId[t.layer.id],"\nNew layer: ",t.layer),s("Creating a layer with a duplicate ID",{extra:{oldLayer:e.allLayers.byId[t.layer.id],action:t}}),Uw({type:"UPDATE_LAYER",layer:e.allLayers.byId[t.layer.id],properties:t.layer,undoable:!1},e)):N(e,(e=>Pw(t,e)));case"ADD_LAYERS":{const a=!!t.isUndoable,o=t.fromUndo;return N(e,(e=>{t.layers.forEach(((n,r)=>{const i=void 0!==t.layerIndex?t.layerIndex+r:void 0;Pw({type:"ADD_LAYER",layer:n,undoable:a,isUndo:o,layerIndex:i},e)}))}))}case"ADD_LAYERS_TO_GROUP":{if(!(null==(a=t.layerIds)?void 0:a.length))return e;if(t.undoable&&tr.add({undo:{type:"REMOVE_LAYERS_FROM_GROUP",layerId:t.layerIds,groupId:t.groupId},redo:{type:"ADD_LAYERS_TO_GROUP",layerId:t.layerIds,groupId:t.groupId}}),!e.groups[t.groupId]){const a={layers:t.layerIds.map((e=>({id:e,saved:!1}))),saved:!1,rotation:0,isTimelineGroup:t.isTimelineGroup};Up("groups",t.groupId,a,e.groups[t.groupId],"ADD_LAYERS_TO_GROUP");const o=kE(a,e);return{...e,groups:{...e.groups,[t.groupId]:a},selectedTimelineRows:o,updateKey:y()}}const o=[...e.groups[t.groupId].layers,...t.layerIds.map((e=>({id:e,saved:t.isUndoFromRemoveLayerFromGroup||!1})))],n={...e.groups[t.groupId],layers:o,rotation:0,preMergeRotation:e.groups[t.groupId].preMergeRotation||e.groups[t.groupId].rotation},r=kE(n,e);if(Up("groups",t.groupId,n,e.groups[t.groupId],"ADD_LAYERS_TO_GROUP"),e.presence&&e.presentUserId){const a=e.presentUserId,o={...e.presence[a],selectedLayerId:t.groupId};jp(e,o,a,"ADD_LAYER_TO_GROUP")}return{...e,groups:{...e.groups,[t.groupId]:n},selectedTimelineRows:r,updateKey:y()}}case"ADD_SELECTED_TIMELINE_ROWS":{const a=[...e.selectedTimelineRows];for(const e of t.timelineRows)a.indexOf(e)<0&&a.push(e);return{...e,selectedTimelineRows:a}}case"ADD_SUBTITLE_LAYERS":{w({category:"Studio Add Subtitle Layers",message:`Layer: ${JSON.stringify(t.subtitles)}`});const a=T[t.sceneIndex].layers.slice();t.subtitles.forEach((e=>{e.timelineRow=-1,Bp(T[t.sceneIndex],e,a.length,"ADD_SUBTITLE_LAYERS"),a.push(e)})),T[t.sceneIndex].layers=a;const{duration:o}=VE(T[t.sceneIndex]);T[t.sceneIndex].duration=o;const{...n}=e.allLayers.byId;for(const e of t.subtitles)n[e.id]=e;return{...e,duration:o,scenes:T,updateKey:y(),allLayers:{byId:n}}}case"BRING_LAYER_FORWARD":{const{layers:a}=T[e.selectedSceneIndex],o=a.findIndex((e=>e.id===t.layer.id));if(o===a.length-1)return e;const n=OE(e,a,o,"FORWARDS")-o;if(T[e.selectedSceneIndex].layers=bE(T[e.selectedSceneIndex],t.layer,n),t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"SEND_LAYER_BACK",layer:a},redo:{type:"BRING_LAYER_FORWARD",layer:t.layer}})}return{...e,scenes:T,updateKey:y()}}case"DELETE_ANIMATION":return N(e,(a=>{var o,n;const r=e.animations.byId[t.animationId];if(!r)return;if(t.undoable){const e={type:"ADD_ANIMATION",animationInstance:r},a={type:"DELETE_ANIMATION",animationId:t.animationId};tr.add({undo:e,redo:a})}const i=(null==(o=a.animations)?void 0:o.allIds)||[],s=i.filter((e=>e!==t.animationId));a.animations.allIds=s;const l=(null==(n=a.animations)?void 0:n.byId)||{};delete l[t.animationId],a.animations.byId=l,Up("animations","byId",l,e.animations.byId,"DELETE_ANIMATION_BY_ID"),Up("animations","allIds",i,e.animations.allIds,"DELETE_ANIMATION_ALL_IDS")}));case"ENHANCE_LAYER":{const{assetId:a,enhanceJobId:o}=t;if(!a)return e;const n={...e.enhanceJobIds||{}};return o?(n[a]=o,Up("enhanceJobIds",a,o,e.enhanceJobIds[a],"update enhanceJobIds")):(delete n[a],Fp("enhanceJobIds",a,e.enhanceJobIds[a],"update enhanceJobIds")),{...e,enhanceJobIds:n}}case"MOVE_LAYER_TO_INDEX":{const a=T[e.selectedSceneIndex].layers.findIndex((e=>e.id===t.layer.id));t.undoable&&tr.add({undo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:a},redo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:t.targetIndex}});const o=t.targetIndex-a;return T[e.selectedSceneIndex].layers=bE(T[e.selectedSceneIndex],t.layer,o),{...e,scenes:T,updateKey:y()}}case"REMOVE_GROUP_FROM_GROUP":{t.undoable&&tr.add({undo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}});const a=e.groups[t.destGroupId].layers.filter((e=>e.fromMergedGroup!==t.srcGroupId)),o=e.groups[t.destGroupId].layers.filter((e=>e.fromMergedGroup===t.srcGroupId)).map((e=>({id:e.id,saved:!0}))),n={...e.groups[t.destGroupId],layers:a};a.every((e=>e.saved))&&void 0!==n.preMergeRotation&&(n.rotation=n.preMergeRotation,n.preMergeRotation=void 0);const r={...e.groups[t.srcGroupId],layers:o},i={...e.groups,[t.destGroupId]:n,[t.srcGroupId]:r};return Lp("groups",i,e.groups,"REMOVE_GROUP_FROM_GROUP"),{...e,groups:i,updateKey:y()}}case"REMOVE_LAYER":return function(e,t){if(e.undoable){const a=t.allLayers.byId[e.layer.id],o=SE(t.scenes[t.selectedSceneIndex].layers,(null==a?void 0:a.id)||"");a&&tr.add({undo:{type:"ADD_LAYER",layer:a,layerIndex:o,isUndo:!0},redo:{type:"REMOVE_LAYER",layer:e.layer}})}const a=t.allLayers.byId[e.layer.id];let{selectedSceneIndex:o}=t;return e.selectedSceneIndex&&(o=e.selectedSceneIndex),t.allLayers.byId[a.id]&&delete t.allLayers.byId[a.id],Rw(t,a,o,e.source)}(t,e);case"REMOVE_LAYERS_FROM_GROUP":{t.undoable&&tr.add({undo:{type:"ADD_LAYERS_TO_GROUP",layerId:t.layerIds,groupId:t.groupId,isUndoFromRemoveLayerFromGroup:!0},redo:{type:"REMOVE_LAYERS_FROM_GROUP",layerId:t.layerIds,groupId:t.groupId}});const a=e.groups[t.groupId],o=new Set(t.layerIds),n=a?a.layers.filter((e=>!o.has(e.id))):[];if(n.length<=1){const a={...e.groups};delete a[t.groupId];const o=n[0]?n[0].id:null;return Up("groups",t.groupId,a[t.groupId],e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:a,selectedItem:o?{id:o,type:"layer"}:null,updateKey:y()}}const r={...e.groups[t.groupId],layers:n};return n.every((e=>e.saved))&&void 0!==r.preMergeRotation&&(r.rotation=r.preMergeRotation,r.preMergeRotation=void 0),Up("groups",t.groupId,r,e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:{...e.groups,[t.groupId]:r},updateKey:y()}}case"REPOSITION_LAYER":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"REPOSITION_LAYER",layer:a,x:null==(o=a.position)?void 0:o.x,y:null==(n=a.position)?void 0:n.y},redo:{type:"REPOSITION_LAYER",layer:t.layer,x:t.x,y:t.y}})}w({category:"Studio Reposition Layer",message:`Layer: ${t.layer.id}, New X: ${t.x}, New Y: ${t.y}`});const{...a}=e.allLayers.byId,[r,i]=function(e,t){const{x:a,y:o}=t,n=a,r=o;let i=t.layer.position;for(const s of e)if(s.id===t.layer.id){"position"in s&&(i=s.position);break}return vE(e,t.layer.id,{position:{...i,x:n,y:r}},"layer","repositionLayer")}(T[e.selectedSceneIndex].layers,t);return T[e.selectedSceneIndex].layers=r,a[i.id]=i,{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"RESIZE_LAYER":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"RESIZE_LAYER",layer:a,x:null==(r=a.position)?void 0:r.x,y:null==(i=a.position)?void 0:i.y,width:null==(l=a.position)?void 0:l.width,height:null==(c=a.position)?void 0:c.height},redo:{type:"RESIZE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height}})}w({category:"Studio Resize Layer",message:`Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`});const{...a}=e.allLayers.byId;if(I=TE(t.layer.id,e),T[I]){const[e,o]=function(e,t){const{x:a,y:o,width:n,height:r}=t,i=a,s=o,l=n,c=r;let d=t.layer.position;for(const u of e)if(u.id===t.layer.id){"position"in u&&(d=u.position);break}return vE(e,t.layer.id,{position:{...d,x:i,y:s,width:l,height:c}},"layer","resizeLayer")}(T[I].layers,t);T[I].layers=e,a[t.layer.id]=o}return{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"RESIZE_LINE_LAYER":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"RESIZE_LINE_LAYER",layer:a,x:null==(d=a.position)?void 0:d.x,y:null==(u=a.position)?void 0:u.y,width:null==(m=a.position)?void 0:m.width,height:null==(p=a.position)?void 0:p.height,linePointStartCorner:a.linePointStartCorner,lineRightAngle:a.lineRightAngle},redo:{type:"RESIZE_LINE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height,linePointStartCorner:t.linePointStartCorner,lineRightAngle:t.lineRightAngle}})}w({category:"Studio Resize Layer",message:`Line Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`}),I=TE(t.layer.id,e);const{...a}=e.allLayers.byId;if(T[I]){const[e,o]=function(e,t){const{x:a,y:o,width:n,height:r,linePointStartCorner:i,lineRightAngle:s}=t,l=a,c=o,d=n,u=r;let m=t.layer.position,p=null;i&&(p={linePointStartCorner:i,lineRightAngle:s});for(const h of e)if(h.id===t.layer.id){"position"in h&&(m=h.position);break}return vE(e,t.layer.id,{position:{...m,x:l,y:c,width:d,height:u},...p},"layer","resizeLineLayer")}(T[I].layers,t);T[I].layers=e,a[t.layer.id]=o}return{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"SAVE_LAYER_GROUP":{let a=1;const o=Object.values(e.groups).map((e=>e.name?Number(e.name.split(" ")[1]):0)).sort(((e,t)=>t-e))[0];o&&(a=o+1);const n=`Group ${a}`,r={...e.groups[t.groupId]},i={...r,layers:r.layers.map((e=>({...e,saved:t.saved}))),saved:t.saved,name:r.name?r.name:n},s=T[e.selectedSceneIndex];let l=s.layers.reduce(((e,t,a)=>i.layers.map((e=>e.id)).includes(t.id)?a:e),0);const c=[...s.layers].reverse(),d=[];for(const e of c){if(!i.layers.map((e=>e.id)).includes(e.id))continue;const t=s.layers.map((e=>e.id)).indexOf(e.id);0!==l-t&&d.push([t,l]),l-=1}const u=[...s.layers];for(const[e,t]of d){const a=t-e;s.layers=bE(s,u[e],a)}return t.undoable&&tr.add({undo:{func(){const{dispatch:e,state:a}=io();e({type:"UPDATE_GROUP",groupId:t.groupId,updates:{...r}});const o=a.studio.scenes[a.studio.selectedSceneIndex],n=[...d].reverse();for(const[t,r]of n)e({type:"MOVE_LAYER_TO_INDEX",layer:o.layers[r],targetIndex:t})}},redo:{type:"SAVE_LAYER_GROUP",groupId:t.groupId,saved:t.saved}}),Up("groups",t.groupId,i,e.groups[t.groupId],"SAVE_LAYER_GROUP"),{...e,groups:{...e.groups,[t.groupId]:i},selectedItem:{type:"group",id:t.groupId},scenes:T,updateKey:y()}}case"SELECT_ITEM":{if(t.undoable&&tr.add({undo:{type:"SELECT_ITEM",item:e.selectedItem},redo:{type:"SELECT_ITEM",item:t.item}}),e.presence&&e.presentUserId){const a=e.presentUserId,o=t.item&&"layer"===t.item.type?t.item.id:"",n={...e.presence[a],selectedLayerId:o};jp(e,n,a,"SELECT_LAYER")}let a=e;const o=t.item?CE(t.item,e):[];if(("group"===(null==(h=e.selectedItem)?void 0:h.type)?e.groups[e.selectedItem.id]:null)&&(null==(g=t.item)?void 0:g.id)!==(null==(f=e.selectedItem)?void 0:f.id)){const{groups:o,undo:n}=DE(e,(null==(E=e.selectedItem)?void 0:E.id)||"");a={...a,groups:o,updateKey:y()};const r=tr.getState(),i=r.actions[r.index];n&&i&&"STUDIO_DELETE_GROUP"!==i.type&&!1!==t.undoable&&tr.add({undo:n,redo:{type:"SELECT_ITEM",item:t.item}})}return"gap"===(null==(_=e.selectedItem)?void 0:_.type)&&e.timelineGap&&e.timelineGap.gapId===e.selectedItem.id&&(null==(v=t.item)?void 0:v.id)!==e.selectedItem.id&&(a={...a,timelineGap:null,updateKey:y()}),{...a,selectedItem:t.item,selectedTimelineRows:o}}case"SELECT_TRANSITION":if(t.undoable){const a={type:"SELECT_TRANSITION",payload:(null==(b=e.selectedTransition)?void 0:b.id)||null},o={type:"SELECT_TRANSITION",payload:t.payload};tr.add({undo:a,redo:o})}return{...e,selectedTransition:t.payload?{id:t.payload}:null};case"SEND_LAYER_BACK":{const{layers:a}=T[e.selectedSceneIndex],o=a.findIndex((e=>e.id===t.layer.id));if(0===o)return e;const n=OE(e,a,o,"BACKWARDS")-o;if(T[e.selectedSceneIndex].layers=bE(T[e.selectedSceneIndex],t.layer,n),t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"BRING_LAYER_FORWARD",layer:a},redo:{type:"SEND_LAYER_BACK",layer:t.layer}})}return{...e,scenes:T,updateKey:y()}}case"SET_LAYER_DUPLICATED":return{...e,layerDuplicated:t.layerDuplicated};case"SET_SCALE":{const{...a}=e.allLayers.byId,[o,n]=function(e,t){const{scaleX:a,scaleY:o}=t;let n=t.layer.position;for(const r of e)if(r.id===t.layer.id){"position"in r&&(n=r.position);break}return vE(e,t.layer.id,{position:{...n,scaleX:a,scaleY:o}},"layer","setScale")}(T[e.selectedSceneIndex].layers,t);return T[e.selectedSceneIndex].layers=o,a[n.id]=n,{...e,scenes:T,allLayers:{byId:a},updateKey:y()}}case"SET_SELECTED_TIMELINE_ROWS":return{...e,selectedTimelineRows:t.timelineRows};case"SET_STUDIO_FLIP_HORIZONTAL":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:a,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:t.layer,axis:t.axis}})}w({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...a}=e.allLayers.byId,[o,n]=wE(T[e.selectedSceneIndex].layers,t);return T[e.selectedSceneIndex].layers=o,a[n.id]=n,{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"SET_STUDIO_FLIP_VERTICAL":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:a,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:t.layer,axis:t.axis}})}w({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...a}=e.allLayers.byId,[o,n]=wE(T[e.selectedSceneIndex].layers,t);return T[e.selectedSceneIndex].layers=o,a[n.id]=n,{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"SET_STUDIO_ROTATION":{if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&tr.add({undo:{type:"SET_STUDIO_ROTATION",layer:a,rotation:null==(S=a.position)?void 0:S.rotation},redo:{type:"SET_STUDIO_ROTATION",layer:t.layer,rotation:t.rotation}})}w({category:"Studio Set Layer Rotation",message:`Layer: ${t.layer.id}, New Rotation: ${t.rotation}`});const{...a}=e.allLayers.byId,[o,n]=function(e,t){let{rotation:a}=t;a=a<0?360+a:a;let o=t.layer.position;for(const n of e)if(n.id===t.layer.id){"position"in n&&(o=n.position);break}return vE(e,t.layer.id,{position:{...o,rotation:a}},"layer","setRotation")}(T[e.selectedSceneIndex].layers,t);return T[e.selectedSceneIndex].layers=o,n&&(a[n.id]=n),{...e,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"SET_TIMELINE_GAP":{const{gapId:a,startTime:o,duration:n,timelineRow:r}=t,i={gapId:a,startTime:o,duration:n,timelineRow:r};return{...e,timelineGap:i}}case"SHOW_SNAP_LINES":return{...e,snapLines:t.lines};case"SORT_SUBTITLE_LAYERS":return{...e,scenes:e.scenes.map((e=>({...e,layers:xE(e.layers)})))};case"UPDATE_ANIMATION":return N(e,(a=>{var o;const n=(null==(o=a.animations)?void 0:o.byId)||{};if(n[t.animationId]={...n[t.animationId],...t.layerAnim},a.animations.byId=n,t.undoable){const a={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:e.animations.byId[t.animationId],undoable:!1},o={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:t.layerAnim,undoable:!1};tr.add({undo:a,redo:o})}Up("animations","byId",n,e.animations.byId,"UPDATE_ANIMATION_BY_ID")}));case"UPDATE_CLIPBOARD":return{...e,clipboardCopyId:t.clipboardCopyId||e.clipboardCopyId,clipboard:t.clipboard,updateKey:y()};case"UPDATE_GROUP":{const a={...e.groups[t.groupId],...t.updates};if(!a.layers)return e;if(Up("groups",t.groupId,a,e.groups[t.groupId],"UPDATE_GROUP"),t.undoable){const a={...e.groups[t.groupId]},o=Object.keys(t.updates).reduce(((e,t)=>(e[t]=a[t],e)),{});tr.add({undo:{type:"UPDATE_GROUP",groupId:t.groupId,updates:o},redo:{type:"UPDATE_GROUP",groupId:t.groupId,updates:t.updates}})}const o=kE(a,e);return{...e,groups:{...e.groups,[t.groupId]:a},selectedItem:{type:"group",id:t.groupId},selectedTimelineRows:o,updateKey:y()}}case"UPDATE_LAYER":return Uw(t,e);case"UPDATE_LAYERS":return N(e,(a=>{t.undoable&&tr.add({undo:{type:"UPDATE_LAYERS",layers:e.scenes[e.selectedSceneIndex].layers,sceneIndex:t.sceneIndex},redo:{type:"UPDATE_LAYERS",layers:t.layers,sceneIndex:t.sceneIndex}}),t.layers.forEach(((o,n)=>{o&&(Lp(`layer_${o.id}`,o,e.scenes[t.sceneIndex].layers[n],"UPDATE_LAYERS"),a.scenes[t.sceneIndex].layers[n]=o,a.allLayers.byId[o.id]=o)})),a.duration=NE(null==a?void 0:a.scenes),Lp("duration",a.duration,e.duration,"UPDATE_LAYERS"),AE(e,a.duration,a.scenes)}));case"UPDATE_LAYERS_NO_SYNC":{const{...a}=e.allLayers.byId,{updates:o}=t;return Object.keys(o).forEach((e=>{const t=a[e];t&&(a[e]={...t,...o[e]})})),T[0].layers.forEach(((e,t)=>{o[e.id]&&(T[0].layers[t]={...e,...o[e.id]})})),k=NE(T),{...e,duration:k,scenes:T,updateKey:y(),allLayers:{byId:a}}}case"UPDATE_SELECTED_TIMELINE_ROWS":{const t=e.selectedItem?CE(e.selectedItem,e):e.selectedTimelineRows;return{...e,selectedTimelineRows:t}}case"UPDATE_UPLOADED_LAYER":return Ow(t,e);default:return e}},Fw=F.v4(),Bw=()=>({analytics:{},projectName:"",projectVersion:"0.6",ratio:"1:1",hasCustomOutput:!1,customOutputWidth:void 0,customOutputHeight:void 0,topFontsLoaded:!1,origin:"",studioPaused:!0,overlayMounted:!1,isDragging:!1,trackIsDragging:!1,scenes:[{id:Fw,layers:[],background:"#ffffff",duration:0,userSelectedDuration:0,userSetDuration:!1,subtitle:{...Dd}}],animations:{byId:{},allIds:[]},allLayers:{byId:{}},localId:F.v4(),deletedLayerLocalBlobDict:{},deletedLayerDict:{},selectedLayerId:"",selectedSceneIndex:0,selectedTimelineRows:[0],groups:{},pendingGoogleDriveUploads:[],timelineGap:null,clipboardCopyId:null,clipboard:{itemType:"empty",item:{}},safeZoneChosen:"none",snapToGrid:!0,showCanvas:!1,background:"#ffffff",canvasBlur:!1,isImageVideo:!1,duration:0,toolTip:"",videoType:"mp4",imageType:"png",gifType:"gif",exportFrameTime:-1,quality:"standard",addedOptimizedLayer:!1,draft:!1,done:!1,createdAt:"",fullPath:"",image_url:"",updateKey:0,refreshKey:0,lastSaved:"",dimensions:{screenWidth:0,screenHeight:0},canvasDimensions:{canvasWidth:0,canvasHeight:0},name:"",canvasX:0,canvasY:0,containerX:0,containerY:0,containerWidth:0,containerHeight:0,workspaceId:null,projectId:null,creatorId:void 0,creatorEmail:void 0,copiedProjectId:void 0,teamId:void 0,canvasPreviewSeekerTimestampId:F.v4(),contextMenuUsed:0,customFontsFetched:!1,playCanvasPreviewOnMount:!1,usedEyedropper:!1,watermark:!1,layerDuplicated:!1,thisProjectCMLFiles:void 0,enhanceJobIds:{},userSpecificSettings:{},userSpecificSettingsAnonymous:{},selectedTransition:null,magicSubtitles:{},magicSubtitleFrames:{},assetUploadedSubtitles:{},isCollaborating:!1,presence:{},presentUserId:"",readonly:!1,exportQuality:"Standard",exportResolution:"AUTO",isBrandKitTemplate:null,fromBrandKitTemplate:null});const Ww=e=>{const{groups:t}=(e=>{let t={...e.groups||{}};if(!e.selectedItem)for(const a of Object.keys(t)){const{groups:o}=DE({...e,groups:t},a);t=o}return{groups:t}})(e),{scenes:a}=(e=>{const t=new Set,a=e.scenes;return a[0].layers.forEach(((e,o)=>{t.has(e.id)&&a[0].layers.splice(o,1),t.add(e.id)})),{scenes:a}})(e);return{groups:t,scenes:a}},Vw=(e,t)=>{const a=c(Bw()),{source:o}=t;((e,t)=>{const a=["origin","overlayWithHeader"],o=["fullPath","image_url"];Object.keys(Bw()).forEach((n=>{if(a.includes(n))return;const r=n;if("scenes"!==r||t.studio.scenes)o.includes(r)?t.preserveId&&(e[r]=t.studio[r]):r in t.studio&&(e[r]=t.studio[r]);else for(const a of["layers","background","duration","isImageVideo"])e.scenes[0][a]=t.studio[a]})),Object.keys(t.studio).forEach((a=>{a.startsWith("magicSubtitleCorrection_")&&(e[a]=t.studio[a])}))})(a,t),t.studio.scenes&&t.studio.scenes.length&&!t.studio.scenes[0].subtitle&&(e=>{const t={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textShadow:"#000000",textVerticalAlign:"bottom"};t.updateSubtitlePosition=F.v4();for(let a=0;a<e.scenes.length;a+=1)e.scenes[a].subtitle={...t}})(a),((e,t,a)=>{e.origin=t.origin,e.snapToGrid=t.snapToGrid,e.selectedItem=t.selectedItem,e.selectedSceneIndex=t.selectedSceneIndex,e.overlayMounted=t.overlayMounted,e.canvasDimensions=t.canvasDimensions||{canvasWidth:0,canvasHeight:0},t.width&&t.height&&(e.width=t.width,e.height=t.height,e.canvasX=t.canvasX,e.canvasY=t.canvasY,e.containerX=t.containerX,e.containerY=t.containerY,e.containerWidth=t.containerWidth,e.containerHeight=t.containerHeight);for(const o of e.scenes)o.layers.every((e=>{if("subtitle"===e.type)return!1;const a=IE(e.id,t);return["video","image","audio"].includes(e.type)&&(e.local_url=(null==a?void 0:a.local_url)||""),!0}));e.duration=NE(e.scenes),e.studioPaused=t.studioPaused,a.preserveId&&(e._id=a.studio._id,e.projectId=a.studio.projectId);for(const o of e.scenes)o.layers.every((e=>{if("subtitle"===e.type)return!1;if("local"!==e.source)return!0;const a=IE(e.id,t);return"local"!==(null==a?void 0:a.source)&&Object.assign(e,a),!0}));e.presentUserId=t.presentUserId})(a,e,t);const n=t.isFirstVideoLoad||"onGetSharedDoc"===t.source?Ww(a):{},r=(e=>{const t={};for(const a of e.scenes)for(const e of a.layers)t[e.id]=e;return t})(a);return(e=>{e.selectedSceneIndex=0})(a),a.refreshKey=F.v4(),"onOp"!==o&&(a.pendingGoogleDriveUploads=[]),{...a,...n,allLayers:{byId:r}}},jw=(e,t,a)=>{const o=e[0],n={subtitle:{...null==o?void 0:o.subtitle,...a}};if(a.backgroundColor){const e="rgba(-255,-255,-255,0)"===a.backgroundColor?0:null==o?void 0:o.subtitle.backgroundOpacity,t=_y(a.backgroundColor,{a:e});n.subtitle.backgroundColor=t}if(a.backgroundOpacity){const e=_y(null==o?void 0:o.subtitle.backgroundColor,{a:a.backgroundOpacity});n.subtitle.backgroundColor=e}const[r,i]=vE(e,t.scenes[0].id,n,"scene","updateSubtitle"),s=NE(r);return Lp("duration",s,t.duration,"updateSubtitle"),AE(t,s,r),{...t,duration:s,scenes:r,updateKey:F.v4()}},Hw=(e=Bw(),t)=>{var a,o;let n=e,r=[...n.scenes],i=0;switch(n.allLayers||(n.allLayers={byId:{}}),n=((e,t)=>{switch(t.type){case"ADD_MAGIC_SUBTITLE":return x(e,(e=>{e.magicSubtitles&&0!==Object.keys(e.magicSubtitles).length||(e.magicSubtitles={},Lp("magicSubtitles",{},void 0,"ADD_MAGIC_SUBTITLE"));const a=e.magicSubtitles[t.assetId],o=a?{...a,...t.initialProperties,enabled:!0}:{...ME,...t.initialProperties,enabled:!0};e.magicSubtitles[t.assetId]=o,Mp("magicSubtitles",t.assetId,o,a,"ADD_MAGIC_SUBTITLE"),t.undoable&&tr.add({undo:{...t,type:"REMOVE_MAGIC_SUBTITLE",undoable:!1},redo:{...t,undoable:!1}})}));case"REMOVE_MAGIC_SUBTITLE":return x(e,(e=>{if(!e.magicSubtitles)return;const a=e.magicSubtitles[t.assetId];if(!a||!a.enabled)return;const o=FE(a);a.enabled=!1,a.languageKey="",a.translatedLanguageCode="",a.translated=!1,a.transcriptionSource=void 0,Mp("magicSubtitles",t.assetId,a,o,"REMOVE_MAGIC_SUBTITLE"),t.undoable&&tr.add({undo:{...t,type:"ADD_MAGIC_SUBTITLE",undoable:!1,initialProperties:o},redo:{...t,undoable:!1}})}));case"UPDATE_MAGIC_SUBTITLE":return x(e,(e=>{e.magicSubtitles||(e.magicSubtitles={},Lp("magicSubtitles",{},void 0,"UPDATE_MAGIC_SUBTITLE"));const a={...t.updates},o=T.cloneDeep(e.magicSubtitles[t.assetId]);if(Object.assign(e.magicSubtitles[t.assetId]||{},a),Mp("magicSubtitles",t.assetId,e.magicSubtitles[t.assetId],o,"UPDATE_MAGIC_SUBTITLE"),t.undoable){const e={...o};Object.keys(t.updates).forEach((t=>{t in e||(e[t]=void 0)})),tr.add({undo:{...t,undoable:!1,updates:e},redo:{...t,undoable:!1}})}}));case"SET_MAGIC_SUBTITLE_FRAMES":return x(e,(e=>{const a=BE(e),o=FE(a[t.assetId]);a[t.assetId]=t.frames,Pp({path:["magicSubtitleFrames",t.assetId],val:t.frames,oldVal:o,srcFn:"SET_MAGIC_SUBTITLE_FRAMES"});const n={...t,frames:o,undoable:!1},r={...t,undoable:!1};t.undoable&&tr.add({undo:n,redo:r})}));case"INSERT_MAGIC_SUBTITLE_FRAME":{const{assetId:a,frame:o,frameNdx:n,undoable:r}=t,i={type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:a,frameNdx:n,undoable:!1},s={...t,undoable:!1};return r&&tr.add({undo:i,redo:s}),x(e,(e=>{var r;const i=BE(e),s=null!=(r=i[a])?r:[];s.splice(n,0,o),i[a]=s,Rp({path:["magicSubtitleFrames",t.assetId,n],val:o,srcFn:t.type})}))}case"REMOVE_MAGIC_SUBTITLE_FRAME":return x(e,(e=>{var a;const{assetId:o,frameNdx:n,undoable:r}=t,i=BE(e),s=null!=(a=i[o])?a:[];if(!s[n])throw Error(`No frame at ndx ${n}`);const l=FE(s[n]),c={type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:o,frameNdx:n,frame:l,undoable:!1},d={...t,undoable:!1};r&&tr.add({undo:c,redo:d}),s.splice(n,1),i[o]=s,Op({path:["magicSubtitleFrames",t.assetId,n],oldVal:l,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAME":return x(e,(e=>{var a;const{assetId:o,frameNdx:n,undoable:r,update:i}=t,s=BE(e),l=null!=(a=s[o])?a:[];let c=l[n];if(!c)throw Error(`Missing frame ndx ${n}`);const d=FE(c),u={type:"UPDATE_MAGIC_SUBTITLE_FRAME",assetId:o,frameNdx:n,update:T.pick(d,Object.keys(i)),undoable:!1},m={...t,undoable:!1};r&&tr.add({undo:u,redo:m}),c={...c,...i},l[n]=c,s[o]=l,Dp({path:["magicSubtitleFrames",t.assetId,n],val:FE(c),oldVal:d,srcFn:t.type})}));case"INSERT_MAGIC_SUBTITLE_FRAME_WORD":{const{assetId:a,frameNdx:o,wordNdx:n,undoable:r,word:i}=t,s={type:"REMOVE_MAGIC_SUBTITLE_FRAME_WORD",assetId:a,frameNdx:o,wordNdx:n,undoable:!1},l={...t,undoable:!1};return r&&tr.add({undo:s,redo:l}),x(e,(e=>{var r;const s=BE(e),l=null!=(r=s[a])?r:[],c=l[o];if(!c)throw Error(`Missing frame ${o}`);c.words.splice(n,0,i),l[o]=c,s[a]=l,Rp({path:["magicSubtitleFrames",t.assetId,o,"words",n],val:i,srcFn:t.type})}))}case"REMOVE_MAGIC_SUBTITLE_FRAME_WORD":return x(e,(e=>{var a;const{assetId:o,frameNdx:n,wordNdx:r,undoable:i}=t,s=BE(e),l=null!=(a=s[o])?a:[],c=l[n];if(!c)throw Error(`Missing frame ${n}`);const d=FE(c.words[r]),u={type:"INSERT_MAGIC_SUBTITLE_FRAME_WORD",assetId:o,frameNdx:n,wordNdx:r,word:d,undoable:!1},m={...t,undoable:!1};i&&tr.add({undo:u,redo:m}),c.words.splice(r,1),l[n]=c,s[o]=l,Op({path:["magicSubtitleFrames",t.assetId,n,"words",r],oldVal:d,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAME_WORD":return x(e,(e=>{var a;const{assetId:o,frameNdx:n,wordNdx:r,undoable:i,undoBeforeWord:s={},update:l}=t,c=BE(e),d=null!=(a=c[o])?a:[],u=d[n];if(!u)throw Error(`Missing frame ${n}`);let m=u.words[r];if(!u)throw Error(`Missing frame ${n} word ${r}`);const p={...FE(u.words[r]),...s},h={type:"UPDATE_MAGIC_SUBTITLE_FRAME_WORD",assetId:o,frameNdx:n,wordNdx:r,update:T.pick(p,Object.keys(l)),shouldSync:!0,undoable:!1},g={...t,shouldSync:!0,undoable:!1};i&&tr.add({undo:h,redo:g}),m={...m,...l},u.words[r]=m,d[n]=u,c[o]=d,t.shouldSync&&Dp({path:["magicSubtitleFrames",t.assetId,n,"words",r],val:FE(m),oldVal:p,srcFn:t.type})}));default:return e}})(n,t),n=Mw(n,t),n=((e,t)=>"SET_ASSET_PARSED_SUBTITLE"===t.type?x(e,(a=>{var o,n;a.assetUploadedSubtitles&&0!==Object.keys(a.assetUploadedSubtitles).length||(a.assetUploadedSubtitles={},Pp({path:["assetUploadedSubtitles"],oldVal:void 0,val:{},srcFn:"SET_ASSET_PARSED_SUBTITLE"}));const r=a.assetUploadedSubtitles[t.assetId];a.assetUploadedSubtitles[t.assetId]=t.subtitles?{subtitles:t.subtitles}:void 0,Pp({path:["assetUploadedSubtitles",t.assetId],oldVal:r,val:a.assetUploadedSubtitles[t.assetId],srcFn:"SET_ASSET_PARSED_SUBTITLE"}),t.undoable&&tr.add({undo:{...t,undoable:!1,subtitles:null==(n=null==(o=e.assetUploadedSubtitles)?void 0:o[t.assetId])?void 0:n.subtitles},redo:{...t,undoable:!1}})})):e)(n,t),t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":{Sp();const e=c(Bw());return t.hasLicense&&(e.quality="high"),e}case"SET_VIDEO_ID":return N(n,(e=>{const a=t._id;e._id=a;for(const t of n.scenes)for(const o of t.layers){const{asset_id:t,cmlFileId:n}=o;a&&o.cmlFileId&&hh(o.cmlFileId,a),t&&n&&PE(e,{asset_id:t,cmlFileId:n})}e.readonly=!1}));case"SET_IMAGE_URL":return{...n,image_url:t.image_url};case"SET_VIDEO_DRAFT_INFO":return Lp("draft",t.draft,n.draft,"SET_VIDEO_DRAFT_INFO"),{...n,draft:t.draft,done:t.done,createdAt:t.createdAt,lastSaved:t.lastSaved};case"SET_STUDIO":return t.undoable&&tr.add({undo:{...t,studio:n,undoable:!1},redo:{...t,undoable:!1}}),n.projectId!==t.studio.projectId&&Sp(),t.sync&&window.sharedDoc&&function(e,t){const a=fp(t);Object.entries(a).forEach((([a,o])=>{a&&o&&e.submitOp({p:[a],oi:o,od:e.data[a],__md:{srcFn:"client/syncVideoToSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}})})),Object.entries(e.data).forEach((([o,n])=>{o&&n&&(a[o]||e.submitOp({p:[o],od:n,_md:{srcFn:"removeKeyFromSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}}))}))}(window.sharedDoc,t.studio),Vw(n,t);case"KAPWING_INIT":{if("scenes"in n){const e=Ww(n);return i=NE(n.scenes),Lp("duration",i,n.duration,"KAPWING_INIT"),function(e){e.scenes.forEach((e=>{e.layers.every((e=>!e||"subtitle"!==e.type&&(delete e.local_url,delete e.base64_img,!0)))}))}(n),{...n,...e,duration:i}}!function(e){e.scenes=[{id:Fw,layers:e.layers,duration:e.duration,isImageVideo:!1,background:e.background}],e.selectedItem=null,e.selectedSceneIndex=0,e.duration=NE(e.scenes)}(n);const e=Ww(n);return{...n,...e,deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}case"SET_STUDIO_DIMENSIONS":return w({category:"Studio Update Dimensions",message:`Dimensions: ${JSON.stringify(t.dimensions)}`}),{...n,...t.dimensions,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_STUDIO_RATIO":return t.undoable&&tr.add({undo:{type:"SET_STUDIO_RATIO",ratio:n.ratio},redo:{type:"SET_STUDIO_RATIO",ratio:t.ratio}}),Lp("ratio",t.ratio,n.ratio,"SET_STUDIO_RATIO"),{...n,ratio:t.ratio,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_CUSTOM_OUTPUT_SIZE":return t.undoable&&tr.add({undo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:n.hasCustomOutput,customOutputWidth:n.customOutputWidth,customOutputHeight:n.customOutputHeight},redo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight}}),Lp("hasCustomOutput",t.hasCustomOutput,n.hasCustomOutput,"SET_CUSTOM_OUTPUT_SIZE"),Lp("customOutputWidth",t.customOutputWidth,n.customOutputWidth,"SET_CUSTOM_OUTPUT_SIZE"),Lp("customOutputHeight",t.customOutputHeight,n.customOutputHeight,"SET_CUSTOM_OUTPUT_SIZE"),{...n,hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight};case"SET_VIDEO_TYPE":return Lp("videoType",t.videoType,n.videoType,"SET_VIDEO_TYPE"),AE({...n,videoType:t.videoType},i,r),{...n,videoType:t.videoType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_IMAGE_TYPE":return Lp("imageType",t.imageType,n.imageType,"SET_IMAGE_TYPE"),{...n,imageType:t.imageType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_GIF_TYPE":return Lp("gifType",t.gifType,n.gifType,"SET_GIF_TYPE"),{...n,gifType:t.gifType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_EXPORT_FRAME_TIME":return Lp("exportFrameTime",t.exportFrameTime,n.exportFrameTime,"SET_EXPORT_FRAME_TIME"),{...n,exportFrameTime:t.exportFrameTime,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_QUALITY":return Lp("quality",t.quality,n.quality,"SET_QUALITY"),{...n,quality:t.quality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_EXPORT_QUALITY":return Lp("exportQuality",t.exportQuality,n.exportQuality,"SET_EXPORT_QUALITY"),{...n,exportQuality:t.exportQuality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_EXPORT_RESOLUTION":return Lp("exportResolution",t.exportResolution,n.exportResolution,"SET_EXPORT_RESOLUTION"),{...n,exportResolution:t.exportResolution,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_ADDED_OPTIMIZED_LAYER":return Lp("addedOptimizedLayer",!0,n.addedOptimizedLayer,"SET_ADDED_OPTIMIZED_LAYER"),{...n,addedOptimizedLayer:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_DRAGGING":return{...n,isDragging:t.isDragging};case"SET_TRACK_DRAGGING":return{...n,trackIsDragging:t.trackIsDragging};case"SET_RESIZING":return{...n,isResizing:t.isResizing};case"SET_ROTATING":return{...n,isRotating:t.isRotating};case"SET_ORIGIN":return{...n,origin:t.origin};case"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT":return{...n,playCanvasPreviewOnMount:!0};case"PAUSE_STUDIO":return{...n,studioPaused:!0};case"PLAY_STUDIO":return{...n,studioPaused:!1};case"TOGGLE_STUDIO_PAUSED":return{...n,studioPaused:!n.studioPaused};case"SET_OVERLAY_MOUNTED":return{...n,overlayMounted:t.overlayMounted};case"UPDATE_SCENE":if(t.undoable){const{scene:e}=t,a={};Object.keys(t.properties).forEach((t=>{const o=t;a[o]=e[o]}));const o=t.initialProperties||a;tr.add({undo:{type:"UPDATE_SCENE",scene:e,properties:{...o}},redo:{type:"UPDATE_SCENE",scene:e,properties:{...t.properties}}})}return[r]=vE(r,t.scene.id,t.properties,"scene","UPDATE_SCENE"),i=NE(r),Lp("duration",i,n.duration,"UPDATE_SCENE"),AE(n,i,r),{...n,duration:i,scenes:r,updateKey:F.v4()};case"SELECT_SAFEZONE":return{...n,safeZoneChosen:t.value,updateKey:F.v4()};case"SET_SNAP_TO_GRID":return{...n,snapToGrid:t.value,updateKey:F.v4()};case"ENABLE_SNAP_IN_TIMELINE":return Gw("snapInTimeline",!0,t.userId,n);case"DISABLE_SNAP_IN_TIMELINE":return Gw("snapInTimeline",!1,t.userId,n);case"SET_CANVAS_BLUR":return t.undoable&&tr.add({undo:{type:"SET_CANVAS_BLUR",value:!t.value},redo:{type:"SET_CANVAS_BLUR",value:t.value}}),Lp("canvasBlur",t.value,n.canvasBlur,"SET_CANVAS_BLUR"),{...n,canvasBlur:t.value,updateKey:F.v4()};case"SET_USER_SPECIFIC_SETTING":return Gw(t.key,t.value,t.userId,n);case"SHOW_STUDIO_CANVAS":return Lp("showCanvas",!0,n.showCanvas,"SHOW_STUDIO_CANVAS"),{...n,showCanvas:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_STUDIO_BACKGROUND":return t.undoable&&tr.add({undo:{type:"SET_STUDIO_BACKGROUND",color:r[n.selectedSceneIndex].background},redo:{type:"SET_STUDIO_BACKGROUND",color:t.color}}),Up(`scene_${r[n.selectedSceneIndex].id}`,"background",t.color,r[n.selectedSceneIndex].background,"SET_STUDIO_BACKGROUND"),r[n.selectedSceneIndex].background=t.color,Lp("background",t.color,n.background,"SET_STUDIO_BACKGROUND"),{...n,scenes:r,background:t.color,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?F.v4():n.updateKey};case"SET_IMAGE_VIDEO":return Up(`scene_${n.scenes[0].id}`,"isImageVideo",t.isImageVideo,r[n.selectedSceneIndex].isImageVideo,"SET_IMAGE_VIDEO"),r[n.selectedSceneIndex].isImageVideo=t.isImageVideo,i=NE(r),Lp("duration",i,n.duration,"SET_IMAGE_VIDEO"),AE(n,i,r),{...n,duration:i,scenes:r,updateKey:F.v4()};case"SET_STUDIO_DURATION":return t.undoable&&tr.add({undo:{type:"SET_STUDIO_DURATION",duration:n.duration},redo:{type:"SET_STUDIO_DURATION",duration:t.duration}}),(null==r?void 0:r.length)?(Up(`scene_${n.scenes[0].id}`,"duration",t.duration,r[n.selectedSceneIndex].duration,"SET_STUDIO_DURATION"),r[n.selectedSceneIndex].duration=t.duration,i=function(e,t){const a=NE(t);return Lp("duration",a,e.duration,"updateStudioDurationFromScenes"),AE(e,a,t),a}(n,r),{...n,scenes:r,duration:i,updateKey:F.v4()}):{...n,duration:t.duration,updateKey:F.v4()};case"UPDATE_LAST_SAVED":{const e=new Date;return Lp("lastSaved",e,n.lastSaved,"UPDATE_LAST_SAVED"),{...n,lastSaved:e}}case"SET_CANVAS_DIMENSIONS":return{...n,canvasDimensions:t.canvasDimensions};case"FORCE_UPDATE_CANVAS_PREVIEW_SEEKER_TIMESTAMP":return{...n,canvasPreviewSeekerTimestampId:F.v4()};case"UPDATE_SUBTITLE":return t.undoable&&tr.add({undo:{...t,properties:n.scenes[n.selectedSceneIndex].subtitle,undoable:!1},redo:{...t,undoable:!1}}),jw(r,n,t.properties);case"SET_SUBTITLES_FONT":return jw(r,n,{font:t.font,hasCustomFont:t.hasCustomFont,url:t.url,fontType:t.fontType,source:t.source,asset_id:t.asset_id});case"SET_SUBTITLES_FONT_SIZE":return jw(r,n,{fontSizeRaw:t.fontSize});case"SET_SUBTITLES_FONT_STYLE":return jw(r,n,{fontStyle:t.fontStyle});case"SET_SUBTITLES_FONT_COLOR":return t.color?jw(r,n,{fontColor:t.color}):{...n};case"SET_SUBTITLES_FONT_WEIGHT":return jw(r,n,{fontWeight:t.fontWeight});case"SET_SUBTITLES_BACKGROUND_COLOR":return jw(r,n,{backgroundColor:t.background});case"SET_SUBTITLES_BACKGROUND_STYLE":return jw(r,n,{backgroundStyle:t.style});case"SET_SUBTITLES_LINE_WIDTH":return jw(r,n,{lineWidth:t.lineWidth});case"SET_SUBTITLES_TEXT_ALIGN":return jw(r,n,{textAlign:t.textAlign});case"SET_SUBTITLE_FIXED_POSITION":return jw(r,n,{fixedPosition:t.position});case"SET_SUBTITLE_TEXT_VERTICAL_ALIGN":return jw(r,n,{textVerticalAlign:t.textVerticalAlign});case"SET_ACTIVE_SUBTITLE_TEXT_AREA":return jw(r,n,{textAreaId:t.textAreaId});case"SET_UPDATE_SUBTITLE_POSITION":return jw(r,n,{updateSubtitlePosition:F.v4()});case"SET_SUBTITLES_TEXT_SHADOW":return jw(r,n,{textShadow:t.textShadow});case"SET_SUBTITLES_FONT_SIZE_RATIO":return jw(r,n,{fontSizeRatio:t.sizeRatio});case"SET_SUBTITLES_BACKGROUND_OPACITY":return jw(r,n,{backgroundOpacity:t.bgOpacity});case"REMOVE_SUBTITLE":case"DUPLICATE_SUBTITLE":case"SET_SUBTITLE_TEXT":case"SET_HIGHLIGHT_SUBTITLES":case"SET_SUBTITLE_TIME":case"RESET_HIGHLIGHT_SUBTITLES":return{...n,updateKey:F.v4()};case"SET_EDIT_HISTORY_INDEX":return{...n,historyIndex:t.historyIndex,usedUndo:t.usedUndo,lastUndoTimestamp:t.usedUndo?Date.now():n.lastUndoTimestamp};case"SET_EDIT_HISTORY_INDEX_MINIMUM":return{...n,historyIndexMinimum:t.historyIndexMinimum};case"DISABLE_STUDIO_UNDO":return{...n,disableUndo:t.disableUndo};case"SET_EYEDROPPER_MODE":return{...n,eyedropperMode:t.status,usedEyedropper:!0};case zg.UPDATE_ANALYTICS:{const e={...t.updates};return"timesVideoSplit"in t.updates&&(e.timesVideoSplit=(null!=(a=n.analytics.timesVideoSplit)?a:0)+(null!=(o=t.updates.timesVideoSplit)?o:0)),Lp("analytics",{...n.analytics,...e},n.analytics,"UPDATE_ANALYTICS"),{...n,analytics:{...n.analytics,...e}}}case"ADD_CONTEXT_MENU_ANALYTICS":return{...n,contextMenuUsed:n.contextMenuUsed?n.contextMenuUsed+1:1};case"SET_RIPPLE_MODE":return Gw("rippleMode",t.rippleMode,t.userId,n);case"SET_COLLABORATING":return n.readonly?n:(Lp("isCollaborating",t.isCollaborating,n.isCollaborating,"SET_COLLABORATING",!0),{...n,isCollaborating:t.isCollaborating});case"INIT_PRESENCE":{const{presenceInfo:e,userId:a}=t;return jp(n,e,a,"INIT_PRESENCE"),{...n,presence:{...n.presence,[a]:e}}}case"REMOVE_PRESENCE":{const{presenceInfo:e,userId:a}=t;!function(e,t,a){Np({p:["presence",t],od:e},{srcFn:a,skipLastUpdated:!0})}(e,a,"REMOVE_PRESENCE");const o={...n.presence};return delete o[a],{...n,presence:o}}case"UPDATE_PRESENCE":{const{presenceInfo:e,userId:a}=t;return jp(n,e,a,"UPDATE_PRESENCE"),{...n,presence:{...n.presence,[a]:{...e}}}}case"SET_PRESENT_USER":return{...n,presentUserId:t.userId};case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":return UE(t,n);case"LINK_CML_FILE_TO_PROJECT":{const{assetId:e,cmlFileId:a,videoId:o}=t;return o&&hh(a,o),N(n,(t=>{PE(t,{asset_id:e,cmlFileId:a})}))}case"UNLINK_CML_FILE_FROM_PROJECT":{const{cmlFileId:e,videoId:a}=t;return a&&async function(e,t){ph((()=>tp(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}(e,a),N(n,(t=>{RE(t,e)}))}case"SET_PROJECT_ID":return n.projectId!==t.projectId&&Sp(),{...n,projectId:t.projectId};case gE.type:case fE.type:case yE.type:{const e=Date.now();return Lp("commentsLastUpdated",e,n.commentsLastUpdated,t.type),{...n,commentsLastUpdated:e}}case"SET_STUDIO_ID":return{...n,_id:t.id};case"SET_IS_BRANDKIT_TEMPLATE":return Lp("isBrandKitTemplate",t.isBrandKitTemplate,n.isBrandKitTemplate,t.type),{...n,isBrandKitTemplate:t.isBrandKitTemplate};default:return n}};function Gw(e,t,a,o){var n;if(a){const r={...o.userSpecificSettings,[a]:{...null==(n=o.userSpecificSettings)?void 0:n[a],[e]:t}};return Lp("userSpecificSettings",r,o.userSpecificSettings,"updateUserSpecificSettings"),{...o,userSpecificSettings:r}}const r={...o.userSpecificSettingsAnonymous,[e]:t};return{...o,userSpecificSettingsAnonymous:r}}async function $w(e){const t=document.createElement("video"),a=new Promise((e=>{t.addEventListener("loadedmetadata",(()=>{t.duration===1/0?(t.currentTime=Number.MAX_SAFE_INTEGER,t.ontimeupdate=()=>{t.ontimeupdate=null,e(t.duration),t.currentTime=0}):e(t.duration)})),t.addEventListener("error",(()=>{console.error("Failed to get blob duration"),e(void 0)}))}));return t.src="string"==typeof e||e instanceof String?e:window.URL.createObjectURL(e),a}function Kw(e){let t=function(e){let t=V(e);return t=t.replace(/[^a-z0-9.]/gi,"_"),t=t.replace(/_{2,}/g,"_"),t}(e);const a=t.split(".").pop();t=t.replace(/\..+$/,"");return t=`${t}-${W.generate()}`,t=`${t}.${a}`,t}function Yw({files:e,isPrivate:t=!0,useNameDirectly:a}){return ip("create_resumable_upload",{body:{files:e.map((({file:e})=>({fileName:a?e.name:Kw(e.name||""),fileType:e.type,private:t})))},retries:5})}const zw=()=>{},qw=e=>new Promise((t=>setTimeout((()=>t()),e)));class Jw{constructor({file:e,layer:a,bucket:o=co,isPrivate:n=!1,onProgress:r=zw,onFinish:i=zw,onError:s=zw,onCancel:l=zw,onRetry:c=zw,origin:d="unknown",uploadSourceComponent:u,useNameDirectly:m=!1,analyticsUploadSource:p}){t(this,"file"),t(this,"layer"),t(this,"bucket"),t(this,"isPrivate"),t(this,"onProgress"),t(this,"onFinish"),t(this,"onError"),t(this,"onCancel"),t(this,"onRetry"),t(this,"origin"),t(this,"upload_uri",""),t(this,"read_uri",""),t(this,"uploadSourceComponent"),t(this,"xhr",null),t(this,"offlineRetries",0),t(this,"otherRetries",0),t(this,"useNameDirectly"),t(this,"analyticsUploadSource"),t(this,"logError",((e,t,a=!0)=>{w({category:"Upload Fails",message:`Orign: ${this.origin} stage: ${t}, file: ${JSON.stringify(this.file)}`}),a&&j(e),fm("Upload Fails",{Origin:this.origin,Message:"string"==typeof e?e:e.message,FailStage:t,FileType:this.file.type,"File Size (MB)":this.file.size/1e6})})),t(this,"logProgress",(e=>{w({category:"Upload Progress",message:e})})),t(this,"upload",(async()=>{for(let t=0;t<=5;t+=1){try{this.logProgress("Upload Begins");const e=await Yw({files:[{file:this.file}],isPrivate:this.isPrivate,useNameDirectly:this.useNameDirectly}),{read_uri:t,upload_uri:a}=e.uris[0];this.upload_uri=a,this.read_uri=t,this.uploadToGCS()}catch(e){if(t<5){await qw(2**t*1e3);continue}this.logError(e,"upload"),this.onError(e.message,this.file,this.layer,"upload",!1)}break}})),t(this,"uploadToGCS",(async({retry:e=0,startByte:t=0}={})=>{let a=null,o=null;const n=setInterval((()=>{if(null!==a&&null!==o&&1!==o){0===Math.abs(o-a)&&(fm("Upload Stalled",{"File Type":this.file.type,"Size (MB)":this.file.size/1e6,"Upload Location":this.analyticsUploadSource}),clearInterval(n))}a=o}),6e4);let r=this.file;const i={};if(t){const e=this.file.size-1;i["Content-Range"]=`bytes ${t}-${e}/${this.file.size}`,r=new File([this.file.slice(t,e+1)],this.file.name,{type:this.file.type})}const s=new XMLHttpRequest;s.open("PUT",this.upload_uri,!0),s.onerror=t=>{clearInterval(n),t&&console.error("upload error",t),this.handleUploadRetry(s.status,e)},s.onabort=()=>{clearInterval(n)},s.onload=async()=>{if(clearInterval(n),200!==s.status)return console.error(`xhr returned status ${s.status}, `,s),void this.handleUploadRetry(s.status,e);this.logProgress("Upload Finish Begins"),this.runInRetryLoop((()=>this.onFinish(s,this.read_uri,this.file,this.layer,{retries:e})),7,(()=>this.logProgress("Upload Flow Succeeds")),"onFinish")},s.upload.onprogress=e=>{const a=(t+e.loaded)/this.file.size;this.onProgress(a,this.file,this.layer),o=a},s.setRequestHeader("Content-Type",r.type),Object.keys(i).forEach((e=>{s.setRequestHeader(e,i[e])})),s.send(r),this.xhr=s})),t(this,"runInRetryLoop",(async(e,t,a,o)=>{let n="";for(let i=0;i<t;i+=1)try{return await e(),a(),void(n="")}catch(r){console.info(r),n=r;const e=2**Math.max(i,5)*1e3;await qw(e),console.info(`Retrying (${i+1}) UploadManager stage ${o}`)}n&&this.logError(n,o)})),t(this,"waitForUserToBeOnline",(()=>new Promise((e=>{let t;const a=()=>{e(),clearTimeout(t)};window.addEventListener("online",a,{once:!0}),t=window.setTimeout((()=>{e(),window.removeEventListener("online",a)}),12e5)})))),t(this,"waitForNextUploadRetry",(async e=>{await qw(1e3);let t;if(navigator.onLine){const a=2**e,o=1e3*Math.max(15,Math.min(200,a));t=qw(o),this.otherRetries+=1}else this.logProgress("User is offline, waiting for network to reconnect"),t=this.waitForUserToBeOnline(),this.offlineRetries+=1;this.onRetry(this.layer,{retries:e+1,offlineRetries:this.offlineRetries,otherRetries:this.otherRetries}),await t;const a=5e3*Math.random();await qw(a)})),t(this,"handleUploadRetry",(async(e,t=0)=>{if(t<=1e3)return this.logProgress(`Upload Retry ${t}`),await this.waitForNextUploadRetry(t),void(0===e||503===e?this.resumeUploadToGCS(t+1):this.uploadToGCS({retry:t+1}));const a="An error occurred during upload. Please try again later.",o=new Error(a);this.logError(o,"handleUploadRetry"),this.onError(a,this.file,this.layer,"handleUploadRetry",!1)})),t(this,"resumeUploadToGCS",(e=>{const{upload_uri:t,read_uri:a}=this,o=new XMLHttpRequest;o.open("PUT",t,!0),o.onload=async t=>{if(308===t.target.status){this.logProgress("Upload Resumes"),console.debug("gcs returned 308, try resuming upload");const t=o.getResponseHeader("Range");if(!t)return console.debug("no range returned, try again"),void this.uploadToGCS({retry:e});const a=parseInt(t.split("-").pop(),10);if(a<0)return console.debug("Last uploaded byte < 0, try again from beginning"),void this.uploadToGCS({retry:e});const n=a+1;console.debug("Resuming upload, starting at byte ",a),this.uploadToGCS({startByte:n,retry:e})}else this.logProgress("Resumed Upload Finishes"),this.runInRetryLoop((()=>this.onFinish(o,a,this.file,this.layer,{retries:e})),7,(()=>this.logProgress("Upload Flow Resumes and Succeeds")),"onFinish/resumed")},o.onerror=()=>{this.handleUploadRetry(o.status,e)},o.setRequestHeader("Content-Range",`bytes */${this.file.size}`),o.send(),this.xhr=o})),t(this,"cancel",(()=>{const{xhr:e}=this;e&&(e.abort(),this.onCancel())})),this.file=e,this.layer=a,this.bucket=o,this.isPrivate=n,this.onProgress=r,this.onFinish=i,this.onError=s,this.onCancel=l,this.onRetry=c,this.origin=d,this.uploadSourceComponent=u,this.useNameDirectly=m,this.analyticsUploadSource=p}}const Xw=(e,t)=>e.filter((e=>{const a=e.teamId===t&&e.type===Io.personal&&!e.sharedAt,o=!(e.teamId&&"personal"!==e.teamId||"personal"!==t||e.sharedAt);return a||o})),Qw=(e,t)=>e.filter((e=>e.teamId===t&&e.type===Io.team&&!e.sharedAt));function Zw(e){const{teams:t}=io().state,{selectedTeamId:a}=t,o=Yh(a);return null==o?void 0:o.users.find((t=>t.userId===e))}function eb(e){return!!e&&e===Ro.admin}const tb=e=>new Promise((t=>{new Jw({file:e,onFinish:async(e,a)=>{t(a)},onError:()=>t(null),layer:{},useNameDirectly:!0,analyticsUploadSource:"Team creation modal",uploadSourceComponent:"CreateNewTeamModal"}).upload()})),ab=async(e,t)=>{const{currentUser:a}=io().state;try{const o=await tb(e),{token:n,user:{_id:r}}=a;return await op(`/api/v1/teams/${t}/`,{body:{token:n,userId:r,updateDict:{picture:o}}})}catch($ae){return console.error($ae),null}};function ob(e){const{state:t}=io(),{allWorkspaces:a}=t.workspaces;for(const o of a)if(e===o._id)return o;return null}function nb(e){const{state:t}=io(),{allWorkspaces:a}=t.workspaces;for(const o of a)if(o._id===e)return!0;return!1}async function rb(e){var t;const{dispatch:a,state:o}=io(),{currentUser:n}=o,{token:r,user:i}=n||{},{_id:s}=i||{};if(!e)return a(wh("Could not grab user role. No workspace id found")),{};if("shared-with-me"===e)return{role:Lo.owner};const l=ob(e),c={token:r,userId:s,teamId:"",type:null!=(t=null==l?void 0:l.type)?t:Io.personal,folderId:e};(null==l?void 0:l.teamId)&&"personal"!==l.teamId&&(c.teamId=l.teamId);try{return await ap(`/api/v1/workspaces/${e}/getUser`,{params:c})}catch($ae){return console.error($ae),$ae}}function ib(e){const{dispatch:t}=io();t({type:"REMOVE_WORKSPACE",workspaceId:e})}function sb(e,t){const{dispatch:a}=io();a(function(e,t){return{type:"CHANGE_WORKSPACE_NAME",workspaceId:e,newName:t}}(e,t))}function lb(e){if("shared-with-me"===e)return"Shared with Me";const t=ob(e);return null==t?"":t.name||""}function cb(){const{dispatch:e}=io();e(bh("Your folder has been successfully deleted."))}function db(e){const{dispatch:t}=io();t(Sh(e))}function ub(){var e;const{state:t}=io(),{allWorkspaces:a}=t.workspaces,{allTeams:o}=t.teams,n=o[0]._id,r=Qw(a,n);return(null==r?void 0:r.length)?null==(e=r[0])?void 0:e._id:""}function mb(e){const{allWorkspaces:t}=io().state.workspaces,a=Qw(t,e);return a.length?a[0]._id:""}function pb(e){return e.teamId&&"personal"!==e.teamId&&e.type===Io.team}async function hb(e,t,a=""){const{dispatch:o,state:n}=io(),{currentUser:r,teams:i,workspaces:s}=n,{allWorkspaces:l}=s,{selectedTeamId:c}=i,{token:d,user:u}=r||{},{_id:m}=u||{},p={token:d,userId:m,name:e||"Untitled Folder",type:t,teamId:a||c},{workspace:h}=await op("/api/v1/createWorkspace",{body:p});return o(Nf([h,...l])),o(Af(h._id)),fm("Create Folder",{Email:um(r),"Folder ID":h._id,"Team ID":a||c,"Folder Type":T.capitalize(Io[t])}),h}const gb={"/studio/editor":"Studio Project","/editor/subtitles":"Subtitles Project","/editor/resize":"Resized Project","/editor/add-audio-to-video":"Add Audio Project","/editor/image-to-video":"Image to Video Project","/editor/loop-video":"Looped Video Project","/editor/filters":"Filtered Video Project","/editor/convert":"Converted Video Project","/":"Studio Project","/editor/mute-video":"Muted Video Project","/editor/reverse":"Reversed Video Project","/editor/rotate":"Rotated Video Project","/editor/stop-motion":"Stop Motion Project","/editor/trimmer":"Trimmed Audio Project","/editor/video-speed":"Changed Speed Project"},fb={"3gp":!0,avi:!0,flv:!0,gif:!0,hls:!0,jpeg:!0,jpg:!0,mov:!0,mp3:!0,mp4:!0,png:!0,wmv:!0,webp:!0,webm:!0},yb={},Eb=function(e,t,a){if(!t||0===t.length)return e();const o=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in yb)return;yb[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(!!a)for(let a=o.length-1;a>=0;a--){const n=o[a];if(n.href===e&&(!t||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))};let _b=null,vb=!1;function wb(e,t){_b&&_b.issue(e,t)}const bb=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const e=Ru().isPaid,{shouldTrack:t,userID:a,videoId:o}=cn((t=>{const{_id:a}=t.currentUser.user||{},o=t.studio._id;return{shouldTrack:"undefined"!=typeof window&&!window.Cypress&&!sn()&&!eo&&e,userID:a,videoId:o}}),dn);return n.exports.useEffect((function(){t&&!vb&&async function(e){const{default:t}=await Eb((()=>import("./index.765f674f.js").then((e=>e.i))),["assets/index.765f674f.js","assets/vendor.6b80416b.js"]),{default:a}=await Eb((()=>import("./index.370c0f03.js").then((e=>e.i))),["assets/index.370c0f03.js","assets/vendor.6b80416b.js","assets/index.765f674f.js"]);_b=new t({projectKey:"XWKtmaC5j8aO78qMVX4v"});const o=_b.use(a({}));window.openReplayFetch=o;try{await _b.start({userID:e,forceNew:!1,metadata:{version:"v2023.02.22.2",amplitudeSession:Mm()}}),vb=!0,console.info("Started openreplay")}catch(n){if(console.info("openreplay failed to start: ",n),"string"==typeof n&&n.includes("capture limit has been reached"))return;j(n)}}(a)}),[t,a]),n.exports.useEffect((function(){t&&vb&&o&&_b&&_b.event("opened_video",o)}),[o,t]),null},reportOpenReplayIssue:wb},Symbol.toStringTag,{value:"Module"})),Sb={versionNumber:"0.1",migrate:e=>{if(!e.scenes)return[];for(const t of e.scenes){for(const o of t.layers)for(const e of["duration","startTime","endTime","videoDelay"]){const t=o[e];t&&"number"==typeof t&&(o[e]=WE(t))}const{duration:e,maxLayerId:a}=VE(t);t.duration=e,t.maxLayerId=a}return e.duration&&(e.duration=e.scenes.reduce(((e,t)=>t.duration+e),0)),["scenes","duration"]}},Tb=["intro","outro","constant"],Ib=["id",...Tb],kb={versionNumber:"0.6",migrate:e=>{const t=e.scenes.map((e=>e.layers.map((e=>e.id)))).flat(),a=new Set(t);if(t.length!==a.size){const t=new Set;return e.scenes=e.scenes.map((e=>({...e,layers:e.layers.filter((e=>!t.has(e.id)&&(t.add(e.id),!0)))}))),e.allLayers={byId:Object.fromEntries(e.scenes.map((e=>e.layers)).flat().map((e=>[e.id,e])))},["scenes","allLayers"]}return[]}},Cb=(Nb=[Sb,{versionNumber:"0.2",migrate:e=>{e.animations={allIds:[],byId:{}};const t=["animations"];return e.scenes?(t.push("scenes"),e.scenes.forEach((t=>{t.layers.forEach((t=>{if(!t.animation)return;if("progress-bar"===t.animation.id)return void(t.animation={constant:["progress-bar"]});if(Ib.every((e=>!(e in t.animation))))return void delete t.animation;if("id"in t.animation){const e=t.animation,a=e.animatesForever?"constant":"intro";t.animation={[a]:[e]}}Tb.forEach((a=>{const o=t.animation[a];if(!o)return;const n=o.map((o=>{const n=H();if(o.transitionId){const[r,i]="intro"===a?[t.id,o.transitionLayerId]:[o.transitionLayerId,t.id],s=Object.values(e.animations.byId).find((e=>{if(!e.isCrossTransition)return!1;return("intro"===a?e.introLayerId:e.outroLayerId)===t.id}));if(s)return s.id;e.animations.allIds.push(n),e.animations.byId[n]={animationName:o.transitionId,id:n,isCrossTransition:!0,speed:o.speed,introLayerId:r,outroLayerId:i}}else e.animations.allIds.push(n),e.animations.byId[n]={animationName:o.id,id:n,isCrossTransition:!1,layerId:t.id,speed:o.speed};return n}));t.animation[a]=n}))}))})),t):t}},{versionNumber:"0.3",migrate:e=>{var t;const a=[];if(!e.scenes||1===e.scenes.length&&0===Object.keys(null!=(t=e.audio)?t:{}).length)return a;a.push("scenes","duration");const o=[],n={background:e.scenes[0].background||"",duration:0,id:e.scenes[0].id||"",isImageVideo:!1,layers:[],subtitle:e.scenes[0].subtitle||{},userSelectedDuration:0,userSetDuration:!1};let r=0,i=-1;if(e.scenes.forEach((e=>{!n.isImageVideo&&e.isImageVideo&&(n.isImageVideo=!0),!n.background&&e.background&&(n.background=e.background),!n.id&&e.id&&(n.id=e.id),!n.subtitle&&e.subtitle&&(n.subtitle=e.subtitle),n.duration+=e.duration;let t=0;e.layers.forEach(((a,n)=>{i=Math.max(i,a.timelineRow||-1);let s=0;const{start:l,end:c}=ei(a);"video"===a.type||"audio"===a.type?(a.videoDelay||(a.videoDelay=0),s=a.videoDelay+((c||0)-(l||0)),a.videoDelay=r+(a.videoDelay||0)):(a.isTrimmed||(a.isTrimmed=!0),s=c||0,a.startTime=r+(l||0),a.endTime=r+(c||0)),t=Math.max(t,s),n===e.layers.length-1&&(r+=t),o.push(a)}))})),e.audio&&0!==Object.keys(e.audio).length){const t=e.audio,r={asset_id:t.asset_id,cmlFileId:t.cmlFileId,duration:t.duration,hasAudio:t.hasAudio,height:t.height,id:t.id,mime:t.mime,name:t.name,objectFit:t.objectFit,timelineRow:i+1,videoDelay:t.videoDelay,url:t.url,source:t.source,type:"audio",position:{height:"100%",rotation:0,width:"100%",x:"0%",y:"0%"},startTime:0,endTime:t.duration>n.duration?n.duration:t.duration,volume:1};e.audio={},a.push("audio"),o.push(r)}return n.layers=o,n.duration=WE(n.duration),e.duration=n.duration,e.scenes=[n],a}},{versionNumber:"0.4",migrate:e=>(e.scenes[0].layers.forEach((e=>{if("string"==typeof e.fontSize){const t=e.fontSize;e.fontSize=t.includes("px")?parseFloat(t.slice(0,t.length-2)):parseFloat(t)}})),["scenes"])},{versionNumber:"0.5",migrate:e=>{if(!e.scenes)return[];let t=!1;for(const a of e.scenes)for(const e of a.layers)"text"===e.type&&""===e.textShadow&&(e.textShadow="transparent",t=!0);return t?["scenes"]:[]}},kb],function(e,t){const a=[];for(const o of Nb){const n=Ab(o.versionNumber),r="Older"===Rb(e,n),i="Newer"!==Rb(n,t);r&&i&&a.push(o)}return a});var Nb;function Ab(e){return e?e.split(".").map((e=>parseInt(e))):[0,0]}var xb=(e=>(e.Equal="Equal",e.Newer="Newer",e.Older="Older",e))(xb||{});function Pb(e,t){return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]}function Rb(e,t){return Pb(e,t)?"Older":Pb(t,e)?"Newer":"Equal"}const Ob=new class{constructor(){if(t(this,"storageEvictionAttempts",0),t(this,"supported"),"undefined"==typeof window)return void(this.supported=!1);let e;try{e=typeof localStorage}catch(a){console.error(a)}this.supported=!!e}get(e,t){if(!this.supported)return t.disabled||null;const a=localStorage.getItem(e);if(null===a)return null;try{return JSON.parse(a)}catch(o){return null}}set(e,t){if(!this.supported)return;const a=JSON.stringify(t);try{localStorage.setItem(e,a)}catch(o){this.evictOldSessionsFromStorage()}try{localStorage.setItem(e,a)}catch(o){console.error(`Failed to write ${e} in localstorage`,o)}}getAndUnset(e){const t=this.get(e,{disabled:null});return this.remove(e),t}remove(e){this.supported&&localStorage.removeItem(e)}evictOldSessionsFromStorage(){this.storageEvictionAttempts+=1;const e=[];for(let t=0;t<localStorage.length;t+=1){const a=localStorage.key(t);a&&a.startsWith("session_")&&e.push(a)}(1===this.storageEvictionAttempts||Math.random()<.1)&&fm("Localstorage Quota Exceeded",{"Cached Sessions":e.length,"Storage Size (MB)":this.getLocalStorageSizeMB(),"Eviction Attempts":this.storageEvictionAttempts});for(const t of e)Math.random()<.3&&localStorage.removeItem(t)}getLocalStorageSizeMB(){return new Blob(Object.values(localStorage)).size/1e3/1e3}};function Db(e){return Ob.get(`session_${e}`,{disabled:null})}const Lb=d({initialState:{byId:{}},name:"assets",reducers:{assetTranscriptionFailed:(e,t)=>{const{assetId:a,languageKey:o}=t.payload,n=e.byId[a]||{};delete n[o],e.byId[a]=n},assetTranscriptionFetched:(e,t)=>{t.payload.forEach((({assetId:t,languageKey:a,status:o})=>{const n=e.byId[t]||{};n[a]=o,e.byId[t]=n}))}}}),{assetTranscriptionFailed:Ub,assetTranscriptionFetched:Mb}=Lb.actions,Fb=d({initialState:{byId:{},layerIdsByAssetId:{},assetIdByLayerId:{}},name:"assets",reducers:{assetsFetched:(e,t)=>{t.payload.forEach((t=>{e.byId[t._id]=t}))},changeAssetFileName:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].name=t.payload.newFileName)}},extraReducers:e=>{e.addCase(Mb,((e,t)=>{t.payload.forEach((t=>{const a=e.byId[t.assetId];if(a){a.transcriptionIds||(a.transcriptionIds={});const e=a.transcriptionIds[t.languageKey];e?"pending"===t.status.state?e.job=t.status.transcriptionId:e.result=t.status.assetTranscriptionId:"pending"===t.status.state&&(a.transcriptionIds[t.languageKey]={job:t.status.transcriptionId})}}))})),e.addCase("SET_STUDIO",((e,t)=>{if(!t.studio.scenes||!t.studio.scenes.length)return;const{layers:a}=t.studio.scenes[0];for(const o of a)o.asset_id&&(e.assetIdByLayerId[o.id]=o.asset_id,e.layerIdsByAssetId[o.asset_id]?e.layerIdsByAssetId[o.asset_id].includes(o.id)||e.layerIdsByAssetId[o.asset_id].push(o.id):e.layerIdsByAssetId[o.asset_id]=[o.id])})),e.addCase("ADD_LAYERS",((e,t)=>{t.layers.forEach((t=>{t.asset_id&&(e.assetIdByLayerId[t.id]=t.asset_id,e.layerIdsByAssetId[t.asset_id]?e.layerIdsByAssetId[t.asset_id].includes(t.id)||e.layerIdsByAssetId[t.asset_id].push(t.id):e.layerIdsByAssetId[t.asset_id]=[t.id])}))})),e.addCase("REMOVE_LAYER",((e,t)=>{t.layer.asset_id&&(e.assetIdByLayerId[t.layer.id]&&delete e.assetIdByLayerId[t.layer.id],e.layerIdsByAssetId[t.layer.asset_id]&&(e.layerIdsByAssetId[t.layer.asset_id]=e.layerIdsByAssetId[t.layer.asset_id].filter((e=>e!==t.layer.id))))})),e.addCase("UPDATE_LAYER",((e,t)=>{const a=e.assetIdByLayerId[t.layer.id];if(a!==t.layer.asset_id){if(!t.layer.asset_id)return e.layerIdsByAssetId[a]=e.layerIdsByAssetId[a].filter((e=>e!==t.layer.id)),void delete e.assetIdByLayerId[t.layer.id];e.assetIdByLayerId[t.layer.id]=t.layer.asset_id,a&&(e.layerIdsByAssetId[a]=e.layerIdsByAssetId[a].filter((e=>e!==t.layer.id))),e.layerIdsByAssetId[t.layer.asset_id]?e.layerIdsByAssetId[t.layer.asset_id].push(t.layer.id):e.layerIdsByAssetId[t.layer.asset_id]=[t.layer.id]}}))}}),{assetsFetched:Bb,changeAssetFileName:Wb}=Fb.actions;function Vb(){const{state:e}=io(),t=e.studio.scenes[e.studio.selectedSceneIndex].duration;ic()>t&&$b(t)}function jb(){const{dispatch:e}=io();e({type:"TOGGLE_STUDIO_PAUSED"})}function Hb(){const{state:e}=io();e.studio.studioPaused||jb()}function Gb(){const{state:e}=io();e.studio.studioPaused&&jb()}function $b(e){sc(e);const{state:t,dispatch:a}=io();t.studio.studioPaused&&a(ZE(!0))}const Kb=e=>{const{state:t,dispatch:a}=io(),o=t.studio.scenes[t.studio.selectedSceneIndex],{start:n}=ei(e,o.duration);$b(n),setTimeout((()=>{a({type:"PLAY_STUDIO"})}),20),a(ZE(!0))},Yb=e=>{const{state:t}=io(),{scenes:a,selectedSceneIndex:o}=t.studio,n=a[o],r=mn(a,o),i=r+kw(n).duration,s=ic(),[l,c]=Vv(e,r),d=l<=s&&s<c,u=WE(i)<=s&&dc(c,i,.03333333333333333);return d||u},zb=()=>{const{state:e,dispatch:t}=io();t(dl(!e.studioLocal.previewPlaying))},qb=e=>{const{layers:t}=e.studio.scenes[e.studio.selectedSceneIndex],{selectedItem:a}=e.studio;return t.length<=1||t[0].id===(null==a?void 0:a.id)},Jb=e=>{const{layers:t}=e.studio.scenes[e.studio.selectedSceneIndex],{selectedItem:a}=e.studio;let o=t[t.length-1];for(const n of t){if("subtitle"===n.type)break;o=n}return t.length<=1||t[t.length-1].id===(null==a?void 0:a.id)||o.id===(null==a?void 0:a.id)},Xb=r((e=>e.studio.scenes),(e=>{const t=[];return e.forEach((e=>t.push(...e.layers))),t}));let Qb=Number.MAX_SAFE_INTEGER,Zb=Number.MIN_SAFE_INTEGER,eS=0;const tS=r((e=>e.studio.scenes[e.studio.selectedSceneIndex].layers),(e=>e.studioLocal.draggedTracksOverrides),(e=>Iw(e)>0),(e=>e.studio.scenes),(e=>e.studio.selectedSceneIndex),(e=>e.studio.groups),((e,t)=>Qb<=t&&t<Zb?eS:(eS=t,t)),((e,t,a,o,n,r,i)=>{const s=new Map,l=new Map;for(const[h,g]of Object.entries(r)){l.set(h,!1);for(const{id:e}of g.layers)s.has(e)?s.get(e).push(h):s.set(e,[h])}const c=e.map((e=>xd(e,null==t?void 0:t[e.id]))),d=mn(o,n),u=[],m=[];for(const h of c){const[e,t]=Vv(h,d);e<=i&&u.push(e),e>=i&&m.push(e),t<=i&&u.push(t),t>=i&&m.push(t)}Qb=Math.max(...u),Zb=Math.min(...m);const p=[];for(const h of c){if(s.has(h.id))for(const e of s.get(h.id))l.get(e)||(l.set(e,!0),p.push(e));a?(jr(h)||Hr(h)||Gr(h)||Xr(h)||$r(h)||Kr(h)||Yb(h)||(null==t?void 0:t[h.id]))&&p.push(h):p.push(h)}return p})),aS=r((e=>e.studio.allLayers.byId),(e=>{var t,a;return null!=(a=null==(t=e.studio.selectedItem)?void 0:t.id)?a:""}),((e,t)=>e[t])),oS=r((e=>e.studio.selectedItem),(e=>e.studio.groups),(e=>{var t;return null==(t=e.studio.allLayers)?void 0:t.byId}),((e,t,a)=>{if(!e)return[];if("group"===e.type){const o=t[e.id];return o?o.layers.map((e=>a[e.id])):[]}if("layer"===e.type){const t=a[e.id];return t?[t]:[]}return[]}));function nS(e,t={}){if(e.layers)return e;const a={...t,scenes:[]};for(const o in e)if(!o.startsWith("scene_")&&!o.startsWith("layer_")&&!["scenes","layers","selectedSceneIndex"].includes(o)&&"lastUpdatedByPOST"!==o)if("allLayers"===o){const t=c(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),a.allLayers=t}else a[o]=e[o];return"scenes"in e&&(a.scenes=e.scenes.map((t=>{const a=[...new Set(e[`scene_${t}_layers`]||[])];return{...e[`scene_${t}`],layers:a.filter((t=>null!=e[`layer_${t}`])).map((t=>e[`layer_${t}`]))}}))),c(a)}function rS(e){return{type:"SET_PROJECT_NAME",projectName:e}}function iS(e){return{type:"SET_EXPORT_RESOLUTION",exportResolution:e}}function sS(e){return{type:"SET_EXPORT_QUALITY",exportQuality:e}}function lS(){return{type:"SET_ADDED_OPTIMIZED_LAYER"}}function cS(e){return{type:"SET_IS_BRANDKIT_TEMPLATE",isBrandKitTemplate:e}}function dS({video:e,source:t,preserveId:a=!1,preserveStudioTime:o=!1,origin:n=!1,undoable:r=!1,sync:i=!1,isFirstVideoLoad:s}){const{state:{studio:{_id:l}}}=io();return{type:"SET_STUDIO",source:t,studio:e,preserveId:a,preserveStudioTime:o,projectIdChanged:!!l&&l!==e._id,origin:n,undoable:r,sync:i,isFirstVideoLoad:s}}function uS(){const{state:e}=io(),t=Bu(e);return{type:"RESET_STUDIO",hasLicense:!Ou({team:t}).planData.isFree}}const mS=(e,t)=>({type:"LINK_CML_FILE_TO_PROJECT",assetId:e.asset_id,cmlFileId:e.id,videoId:t}),pS=(e,t)=>({type:"UNLINK_CML_FILE_FROM_PROJECT",cmlFileId:e,videoId:t});class hS{constructor(){t(this,"first",!0),t(this,"amIFirst",(()=>!!this.first&&(this.first=!1,!0)))}}function gS(){return{type:"KAPWING_INIT"}}function fS(e){return{type:"SET_CURRENT_VIDEO",video:e}}function yS(e){return{type:"UPDATE_CURRENT_VIDEO",videoUpdates:e}}function ES(e){return{type:"SET_VIDEO_JUST_SAVED",justSaved:e}}function _S(e){return{type:e?"SET_VIDEO_SAVING":"CLEAR_VIDEO_SAVING"}}function vS(e){return{type:"SET_SHARED_DOC",sharedDoc:e}}function wS(){return{type:"RESET_CURRENT_VIDEO"}}async function bS(e){return await ap("/api/v1/teamWorkspaces",{params:e})}async function SS(e){return await ap("/api/v1/workspaces",{params:e})}function TS(e){return ap(`/api/v1/workspaces/${e}`)}function IS(e=!1,t=!1){return async(a,o)=>{var n,r,i;const{currentUser:s,teams:l}=o(),{selectedTeamId:c}=l,{token:d}=s||{};let u=t||c;"personal"===u&&(u="");const m={token:d,teamId:u},[p,h]=await Promise.all([bS(m),SS(m)]);if("shared-with-me"!==e&&p.length>0){if(a(Nf([...p,...h])),!e){const e=mb(u||(null==(n=p[0])?void 0:n.teamId));return a(dg(u||(null==(r=p[0])?void 0:r.teamId))),a(Af(e)),e}return a(dg(u||(null==(i=p[0])?void 0:i.teamId))),a(Af(e)),e}if(a(Nf([...p||[],...h])),!e){const e=ub();return a(Af(e)),e}return e}}function kS(e){return(t,a)=>{const{token:o,user:n}=a().currentUser||{},r=n&&n._id;return op(`/api/v1/admin/${e}/operations`,{params:{token:o,userId:r}})}}function CS(e){return{id:e.id,type:e.type}}function NS(e,t,a,o){var n,r;try{if(!(e._id&&t._id&&String(e._id)===String(t._id)))return;const i=(null==(n=e.scenes)?void 0:n[0].layers)||[],l=(null==(r=t.scenes)?void 0:r[0].layers)||[],c=i.length,d=l.length,u=d-c;0!==c&&c!==d&&Math.abs(u)>=o&&(s("Potential mongodb/sharedb conflict",{extra:{currentLayerLen:c,newLayerLen:d,currentLayers:JSON.stringify(i.map(CS)),newLayers:JSON.stringify(l.map(CS)),currentVideo:e,newVideo:t,source:a,__FORCE_SAMPLE:!0},tags:{overwriteSource:a}}),wb("Potential lost work",{currentLayerLen:c,newLayerLen:d}),fm("Potential lost work",{currentLayerLen:c,newLayerLen:d,diff:u,overwriteSource:a}))}catch(i){console.error(i),j(i)}}function AS({video:e,source:t,dispatch:a,preserveId:o,preserveStudioTime:n=!1,sync:r=!1,isFirstVideoLoad:s,undoable:l=!1}){if(e.isCreator||e.isStudio){const{state:i}=io();a(dS({video:e,source:t,preserveId:o,preserveStudioTime:n,sync:r,origin:i.studio.origin,undoable:l,isFirstVideoLoad:s}))}if(o||(delete e._id,e.studio&&delete e.studio._id),a(fS(e)),e.scenes)for(let i=0;i<e.scenes.length;i+=1){const t=e.scenes[i];t&&t.layers.find((({type:e})=>"subtitle"===e))&&a({type:"SORT_SUBTITLE_LAYERS"})}return s&&e.scenes&&(async function(e){const t=new Set;if(e.scenes.forEach((e=>{e.layers.every((e=>"subtitle"!==e.type&&("text"===e.type||e.asset_id&&!e.cmlFileId&&t.add(e.asset_id),!0)))})),!t.size)return;const a=Array.from(t.values()),{assets:o,cml_files:n}=await gh(a,!1),{dispatch:r,state:s}=io();r(Bb(o)),r(oh(n)),i.exports.batch((()=>{const t=Xb(s);n.forEach((a=>{r(mS(a,e._id));for(const e of t)e.asset_id===a.asset_id&&r(ds(e,{cmlFileId:a.id}))}))}))}(e),function(e){const{dispatch:t,state:{mediaCache:a}}=io();i.exports.batch((()=>{e.scenes.forEach((e=>{e.layers.every((e=>{if("subtitle"===e.type)return!1;if(!e.asset_id)return!0;if(a.assetIdToMediaCacheId[e.asset_id])return!0;const o=y();return t(Yc({assetId:e.asset_id,mediaCacheId:o})),e.uploadId&&t(zc({uploadId:e.uploadId,mediaCacheId:o})),!0}))}))}))}(e)),e}function xS({id:e,preserveId:t=!1,preservePreviousId:a=!1,forEditing:o=!1,fetchDraft:n=!1,forDebugPage:r=!1,forTemplate:i=!1,undoable:s=!1,sync:l=!1,fromBrandTemplate:c="",projectIsBrandTemplate:d=!1}){return async u=>{const m=await PS({dispatch:u,id:e,forDebugPage:r,forEditing:o,forTemplate:i,fetchDraft:n});if(!m)throw new Error("Video object undefined while fetching video");c&&(m.isBrandKitTemplate=null,m.fromBrandKitTemplate=c),d&&(m.isBrandKitTemplate="published");const p=new hS;return OS({dispatch:u,video:m,fetchDraft:n,forTemplate:i,preserveId:t,preservePreviousId:a,sync:l,firstTracker:p,undoable:s})}}async function PS({dispatch:e,id:t,forDebugPage:a,forEditing:o,forTemplate:n,fetchDraft:r,cancellationSource:i}){const{state:s}=io(),{token:l,user:c}=s.currentUser||{},d={editing:o,fetchAssets:!0,fetchCMLFiles:!0,fetchDraft:r,id:t,supportedVersion:"0.6",token:l,userId:c&&c._id};n&&(d.forTemplate=!0),a&&(d.forDebugPage=!0);const{assets:u,assetTranscriptions:m,cmlFiles:p,video:h}=await ap("/api/v1/videos/getVideo_v2",{params:d,retries:3,timeout:1e4}),g=n?h.name:await async function(e,t,a){return(await ap(`/api/v1/projectname/${e}`)).projectName||gb[a]}(h.projectId,0,h.editorPath);if(i&&i.cancelled)return null;if(null!=g&&e(rS(g)),n&&Lf(s.studio.projectId||"",{name:g},s.currentUser),h.creatorId&&!h.creatorEmail&&l){const e={id:h.creatorId};try{const{user:t}=await ap("/api/v1/users/getUserById",{params:e});h.creatorEmail=t.email}catch(f){console.error("Could not get user by id",f)}}if(h.localId){const t=Db(h.localId);t&&e(Ni(t))}if(e(Bb(u)),e(oh(p)),m){const t=[];for(const e of m)"asset_transcription"===e.type?t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetTranscriptionId:e.assetTranscription._id,state:"completed",languageKey:e.languageKey,words:e.assetTranscription.words}}):t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetDuration:e.assetDuration,assetId:e.assetId,transcriptionId:e.transcriptionJob._id,progress:e.transcriptionJob.progress,languageKey:e.languageKey,state:"pending"}});e(Mb(t))}return h}async function RS(e,t){if(e)try{const a=await ap(`/api/v1/videos/${e}/comments`);a&&(a.sort(((e,t)=>e._id<t._id?-1:1)),t(uE(a)))}catch($ae){console.error($ae.message),t(wh("There was an error with loading comments."))}t(hE(!1))}function OS({dispatch:e,video:t,fetchDraft:a,forTemplate:o,preserveId:n,preservePreviousId:r,sync:i=!1,firstTracker:s,undoable:l}){var c,d,u,m;const{state:p}=io();if(r&&(t._id=p.studio._id,t.projectId=p.studio.projectId),a){const a=nS(t,{_id:t._id});return o||NS(p.studio,a,"Get Video Sync",1),AS({video:a,source:"getVideoSharedDoc",dispatch:e,preserveId:n||r,sync:i,isFirstVideoLoad:s.amIFirst(),undoable:l})}return o?(t.workspaceId=p.workspaces.selectedWorkspace,t.creatorId=null==(d=null==(c=p.currentUser)?void 0:c.user)?void 0:d._id,t.creatorEmail=null==(m=null==(u=p.currentUser)?void 0:u.user)?void 0:m.email,t.projectName=t.name,t.teamId=p.teams.selectedTeamId):NS(p.studio,t,"Get Video No Sync",1),AS({video:t,source:"getVideo",dispatch:e,preserveId:n||r,sync:i,isFirstVideoLoad:s.amIFirst(),undoable:l})}class DS{constructor(e){t(this,"frame"),t(this,"fps"),t(this,"q"),t(this,"size"),t(this,"time"),t(this,"bitrate"),t(this,"speed");const a=e.match(/frame=\s*([0-9]*)\s*fps=\s*([0-9.]*)\s*q=([0-9.]*)\s*size=\s*([0-9]*).*time=([0-9:.]*).*bitrate=\s*([0-9.]*)kbits\/s\s*(.*)speed=([0-9.]*)/);if(!a)return;const[o,n,r,i,s,l,c,d]=a;this.frame=parseInt(n),this.fps=parseInt(r),this.q=parseInt(i),this.size=parseInt(s);const[u,m,p]=l.split(":").map((e=>parseInt(e)));this.time={hours:u,minutes:m,seconds:p},this.bitrate=parseFloat(c),this.speed=parseFloat(d)}}function LS(e,t){const a=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach(((t,o)=>{const n=function(e,t){const a=e._malloc((t.length+1)*Uint8Array.BYTES_PER_ELEMENT);for(let o=0;o<t.length;o+=1)e.setValue(a+o,t.charCodeAt(o),"i8");return e.setValue(a+t.length,0,"i8"),a}(e,t);e.setValue(a+4*o,n,"i32")})),a}function US(e){const t=[];let a=0,o=0;for(;(a=e.indexOf(" ",o))>=0;){let n=e.substring(o,a),r=n.indexOf("'"),i=n.indexOf('"');if(0===r||0===i){const r=n[0],i=e.indexOf(r,o+1);if(i<0)throw new Error(`Bad command escape sequence ${r} near ${a}`);n=e.substring(o+1,i),o=i+2,t.push(n)}else if(r>0||i>0){-1===r&&(r=1/0),-1===i&&(i=1/0);const s=r<i?"'":'"',l=Math.min(r,i),c=e.indexOf(s,o+l+1);if(c<0)throw new Error(`Bad command escape sequence ${s} near ${a}`);n=e.substring(o,c+1),o=c+2,t.push(n)}else""!==n?(t.push(n),o=a+1):o=a+1}return o!==e.length&&t.push(e.substring(o)),t}class MS{constructor(){if(t(this,"moduleFactory"),t(this,"instance"),t(this,"ffmpegMain"),t(this,"FS"),t(this,"duration"),t(this,"defaultArgs",["./ffmpeg","-nostdin","-hide_banner"]),t(this,"currLog"),t(this,"currLogProxy"),t(this,"logs",[]),t(this,"logsProxy",[]),t(this,"amplitudeData",{}),t(this,"allMessages",[]),t(this,"lastFFmpegStdout"),!window||!window.createModule)throw new Error("createModule does not exist on window. Ensure that ffmpeg-core.js      is included via a script tag, and that it exports a createModule function.");this.moduleFactory=window.createModule()}logInDev(e){(window.location.href.includes("kapwing-dev")||window.location.href.includes("localhost"))&&console.info(e)}abort(){}isSupportedByClient(){const e=(new l.exports.UAParser).getBrowser();return!!(navigator.hardwareConcurrency>=4&&e.name.startsWith("Chrome")&&parseFloat(e.version)>=74)}modulePromise(){return new Promise((e=>this.moduleFactory.then((t=>{delete t.then,e(t)}))))}async initialize(e){try{this.instance||(this.instance=await this.modulePromise())}catch($ae){throw new Error($ae)}this.ffmpegMain=this.instance.cwrap("proxy_main","number",["number","number"]),this.FS=this.instance.FS,this.instance.setLogger((t=>{let a;if(!this.duration){const e=/Duration:\s*([0-9][0-9]:[0-9][0-9]:[0-9][0-9]\.[0-9][0-9])/,a=t.message.match(e);a&&a[1]&&(this.duration=a[1])}if(new DS(t.message).frame){if(this.allMessages.length>0){const e=t.message.replace(this.lastFFmpegStdout,"");this.allMessages.push(e),a=e}else this.allMessages.push(t.message),a=t.message;this.lastFFmpegStdout=t.message}const o=()=>{const{dispatch:e}=io();e(yS({progressText:this.allMessages.join("\n")}))};function n(e){const[t,a,o]=e.split(":");return 60*parseFloat(t)*60+60*parseFloat(a)+parseFloat(o)}if(this.allMessages.length>0&&this.allMessages.length%5==0&&o(),this.logsProxy.push(t),this.currLog=t,this.currLogProxy&&(this.currLogProxy.currLog=t),a&&a.startsWith("frame")){const t=n(a.split("time=")[1].split(" ")[0]),o=n(this.duration);this.logInDev({progress:t/o}),e&&e(t/o)}else a&&a.startsWith("video:")&&(this.logInDev({progress:1}),e&&e(1))}))}async runCommandOnFile(e,t,a,o="output.mp4",n){const r=a.split(".").pop();this.amplitudeData.extension=r,this.amplitudeData.hardwareConcurrency=navigator.hardwareConcurrency,this.amplitudeData.command=e,this.amplitudeData.inputVideoSize=t.size,this.logInDev(e),a=a.replaceAll(" ","");try{void 0===this.instance&&await this.initialize(),await this.writeFile(a,t);const r="clientSideTrim"===n?`${e}`:`-i ${a} ${e} ${o}`,i=await this.run(r);this.amplitudeData.timeToRun=i;const s=this.readVideoFile(o);return this.logInDev(URL.createObjectURL(s)),this.amplitudeData.outputVideoDuration=await $w(s),this.amplitudeData.outputVideoSize=s.size,this.FS.unlink(a),this.FS.unlink(o),s}catch($ae){throw this.amplitudeData.timeToError=$ae.timeToError,this.amplitudeData.errorMessage=$ae.message,new Error($ae)}}async run(e){const t=Date.now(),a=[...this.defaultArgs,...US(e)].filter((e=>0!==e.length)),o=LS(this.instance,a);return new Promise(((e,n)=>{const r={set(a,o,r){if(a[o]=r,"ffmpeg-stdout"===r.type&&"FFMPEG_END"===r.message){if("Conversion failed!"===a[a.length-2].message){const e=()=>{let e="";return e+=`1)${a[a.length-5].message}\n2)${a[a.length-4].message}\n3)${a[a.length-3].message}`,e},o={timeToError:(Date.now()-t)/1e3,message:a.length>=5?e():"Unable to get error messages."};n(o)}else e((Date.now()-t)/1e3)}return!0}};this.logsProxy=new Proxy(this.logs,r),this.ffmpegMain(a.length,o)}))}readVideoFile(e){const t=this.FS.readFile(e);return new File([t.buffer],e,{type:"video/mp4"})}async writeFile(e,t){if(t instanceof File||t instanceof Blob){const a=await t.arrayBuffer(),o=new Uint8Array(a);this.FS.writeFile(e,o)}else if(t.startsWith("blob:")){const a=await fetch(t).then((e=>e.blob())),o=await a.arrayBuffer(),n=new Uint8Array(o);this.FS.writeFile(e,n)}else{const a=await fetch(t),o=await a.arrayBuffer(),n=new Uint8Array(o);this.FS.writeFile(e,n)}}}const FS=k("ffmpegTranscode",(async(e,t)=>{const a=new MS;try{const o=e=>{t.dispatch(WS(e))};await a.initialize(o);return await a.runCommandOnFile("-vcodec libx264 -crf 27 -preset ultrafast -threads 4",e.file,e.file.name,"output.mp4","transcode")}catch($ae){return t.rejectWithValue($ae)}})),BS={ffmpegStatus:void 0,outputFile:void 0,outputFileUrl:void 0,progress:void 0},WS=g("updateProgress"),VS=g("resetState"),jS=d({name:"ffmpegProcessor",initialState:BS,reducers:{},extraReducers:e=>{e.addCase(WS,((e,t)=>{e.progress=t.payload})),e.addCase(FS.pending,(e=>{e.ffmpegStatus="PENDING"})),e.addCase(FS.fulfilled,((e,t)=>{e.ffmpegStatus="FULFILLED",e.outputFile=t.payload,e.outputFileUrl=URL.createObjectURL(t.payload)})),e.addCase(FS.rejected,(e=>{e.ffmpegStatus="REJECTED"})),e.addCase(VS,(()=>BS))}}),{reducer:HS}=jS;var GS=(e=>(e.SHOW_CONTEXT_MENU="SHOW_CONTEXT_MENU",e.HIDE_CONTEXT_MENU="HIDE_CONTEXT_MENU",e))(GS||{});function $S(e){return{type:"SHOW_CONTEXT_MENU",contextMenu:e}}function KS(){return{type:"HIDE_CONTEXT_MENU"}}const YS={collections:(e=[],t)=>{switch(t.type){case"SET_COLLECTIONS":return t.collections;case"RESET_EDITOR":return[];default:return e}},currentCollection:(e={},t)=>"SET_CURRENT_COLLECTION"===t.type?t.currentCollection:e,infoForSelectedCollectionLetter:(e={letter:"",count:0},t)=>"SET_NUM_COLLECTIONS_FOR_LETTER"===t.type?{letter:t.letter,count:t.count}:e},zS="controls";var qS=(e=>(e.Canvas="canvas",e.Timing="timing",e.Versions="versions",e))(qS||{});const JS=d({initialState:{},name:"selectedTabs",reducers:{selectTab:(e,t)=>{t.payload.tabId?e[t.payload.tabContainerId]=t.payload.tabId:delete e[t.payload.tabContainerId]}},extraReducers:e=>e.addCase("SELECT_ITEM",((e,t)=>{t.item&&(e.controls=qS.Canvas)}))}),{selectTab:XS}=JS.actions,QS={attempted:{http:null,websocket:null},firstAttemptSinceLastSuccess:{http:null,websocket:null},succeeded:{http:null,websocket:null}},ZS=()=>({altIsBeingPressed:!1,assetMonitorId:"",boxSelectedIds:[],commandIsBeingPressed:!1,controlIsBeingPressed:!1,didUserManualSeek:!1,dragPreviewDisplacements:{},ghostTimeOffsets:null,idbAssetIds:null,initialIDBAssetIdLoadDone:!1,isNewProject:!1,isProjectFetched:!1,layerTempValues:{},localProjectId:F.v4(),mediaItemDropLocation:null,mediaItemGhostTrack:null,mediaSidebarSelectedTab:"thisProject",mouseState:null,shadowInfos:{},selectedEditorPane:"timeline",shiftIsBeingPressed:!1,showSignIn:!1,showTranscribe:!1,studioDragDropActive:!1,textLayerIDsAddedInSession:[],thumbnailTrackFallbacks:{},timelineContainerHeight:0,timelineContainerWidth:0,volumeSliderIsDragging:!1,infoToastShownThisSession:!1,trimPreviewPlaying:!1,rowUploadInProgress:!1,awaitingRecordings:null,staticUploadIds:[],groupDragOverrides:{},lastSyncedWithServer:QS,lastSyncedUserFacing:null,isLayerMountedByLayerId:{},isAdding:{},playbackRate:1,magicSubtitles:{},mediaBarWidth:325,isResizingMediaBar:!1,lastThumbnailGenerated:new Date,showReportIssueModal:!1,magicSubtitleFrames:{}});function eT(e){for(const t in e)delete e[t];Object.assign(e,ZS())}function tT(e,t,a){e.layerTempValues[t]||(e.layerTempValues[t]={hasBeenPlayable:!1});for(const[o,n]of Object.entries(a))if(n!==e.layerTempValues[t][o])return void Object.assign(e.layerTempValues[t],a)}const aT=b(ZS(),{SET_STUDIO:(e,t)=>{t.isFirstVideoLoad&&(e.initialProjectLoadAt=Date.now()),e.lastSyncedWithServer=QS},RESET_STUDIO:e=>{eT(e)},RESET_STATE_PRESERVE_USER:e=>{eT(e)},[Us.SET_LOCAL_LAYER_VALUES]:(e,t)=>{tT(e,t.layerId,t.properties)},[Us.BATCHED_SET_LOCAL_LAYER_VALUES]:(e,t)=>{Object.entries(t.updates).forEach((([t,a])=>{tT(e,t,a)}))},[Us.SET_IS_INLINE_CROPPING]:(e,t)=>{const{layerTempValues:a}=e;Object.keys(a).forEach((e=>{const o=a[e];o.isBeingInlineCropped=null,e===t.layerId&&(o.isBeingInlineCropped=t.isInlineCropping)}))},[Us.SET_PROJECT_FETCHED]:e=>{e.isProjectFetched=!0},[Us.CLEAR_PROJECT_FETCHED]:e=>{e.isProjectFetched=!1},[Us.SET_SHOW_TRANSCRIBE]:(e,t)=>{e.showTranscribe=t.showTranscribe},[Us.SET_SNAP_TIMELINE_TO_SEEKER]:(e,t)=>{e.snapTimelineToSeeker=t.snapTimelineToSeeker},[Us.SET_STUDIO_DRAG_DROP_ACTIVE]:(e,t)=>{e.studioDragDropActive=t.studioDragDropActive},[Us.SET_SELECTED_EDITOR_PANE]:(e,t)=>{e.selectedEditorPane=t.selectedEditorPane},[Us.SET_VOLUME_SLIDER_IS_DRAGGING]:(e,t)=>{e.volumeSliderIsDragging=t.isDragging},[Us.SET_MEDIA_ITEM_GHOST_TRACK]:(e,t)=>{e.mediaItemGhostTrack=t.track},[Us.SET_MEDIA_ITEM_LOCATION]:(e,t)=>{e.mediaItemDropLocation=t.location},[Us.SET_SHADOW_INFOS]:(e,t)=>{E(e.shadowInfos)&&E(t.shadowInfos)||(e.shadowInfos=t.shadowInfos)},[Us.UPDATE_SHADOW_INFOS]:(e,t)=>{e.shadowInfos={...e.shadowInfos,...t.shadowInfos}},[Us.ADD_IDB_ASSET_IDS]:(e,t)=>{const a=new Set(t.idbAssetIds),o=new Set(e.idbAssetIds),n=new Set([...a,...o]);e.idbAssetIds=Array.from(n)},[Us.REMOVE_IDB_ASSET_ID]:(e,t)=>{const a=(e.idbAssetIds||[]).filter((e=>e!==t.idbAssetId));e.idbAssetIds=a},[Us.CLEAR_IDB_ASSET_IDS]:e=>{e.idbAssetIds=[]},[Us.SET_DRAGGED_TRACKS_OVERRIDES]:(e,t)=>{E(t.overrides)&&E(e.draggedTracksOverrides)||(e.draggedTracksOverrides=t.overrides)},[Us.ALT_IS_BEING_PRESSED]:(e,t)=>{e.altIsBeingPressed=t.isPressed},[Us.COMMAND_IS_BEING_PRESSED]:(e,t)=>{e.commandIsBeingPressed=t.isPressed},[Us.CONTROL_IS_BEING_PRESSED]:(e,t)=>{e.controlIsBeingPressed=t.isPressed},[Us.SHIFT_IS_BEING_PRESSED]:(e,t)=>{e.shiftIsBeingPressed=t.isPressed},[Us.SET_TIMELINE_CONTAINER_HEIGHT]:(e,t)=>{e.timelineContainerHeight=t.height},[Us.SET_TIMELINE_CONTAINER_WIDTH]:(e,t)=>{e.timelineContainerWidth=t.width},[Us.SET_TRACK_THUMBNAIL_FALLBACK]:(e,t)=>{e.thumbnailTrackFallbacks[t.mediaCacheId]=!0},[Us.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE]:e=>{e.initialIDBAssetIdLoadDone=!0},[Us.SET_IS_NEW_PROJECT]:e=>{e.isNewProject=!0},[Us.START_EDITING_TEXT_LAYER]:(e,t)=>{tT(e,t.payload.id,{isEditing:!0,textTemp:t.payload.text})},[Ls.toString()]:(e,t)=>{e.elementPoolContainerMounted=t.payload},[Us.SET_MEDIA_SIDEBAR_SELECTED_TAB]:(e,t)=>{e.mediaSidebarSelectedTab=t.payload},[Us.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION]:(e,t)=>{const a=new Set([...e.textLayerIDsAddedInSession,t.id]);e.textLayerIDsAddedInSession=Array.from(a)},[ZE.toString()]:(e,t)=>{e.didUserManualSeek=t.payload},[Us.SET_MOUSE_DOWN]:(e,t)=>{e.mouseState=t.payload},[Us.CLEAR_DRAG_PREVIEW_DISPLACEMENTS]:e=>{e.dragPreviewDisplacements={}},[Us.SET_DRAG_PREVIEW_DISPLACEMENTS]:(e,t)=>{A(e.dragPreviewDisplacements,t.payload)||(e.dragPreviewDisplacements={...e.dragPreviewDisplacements,...t.payload})},[Us.SET_INFO_TOAST_SHOWN_THIS_SESSION]:(e,t)=>{e.infoToastShownThisSession=t.payload},[Us.SET_PREVIEW_PLAYING]:(e,t)=>{e.previewPlaying=t.payload},[Us.SHOW_SIGN_IN]:e=>{e.showSignIn=!0},[Us.HIDE_SIGN_IN]:e=>{e.showSignIn=!1},[Us.SET_MORE_OVERLAY_OFFSET]:(e,t)=>{e.moreOverlayOffset=t.payload},[Us.SET_ROW_UPLOAD_IN_PROGRESS]:(e,t)=>{e.rowUploadInProgress=t.payload},[Us.SET_AWAITING_RECORDINGS]:(e,t)=>{e.awaitingRecordings={...e.awaitingRecordings,...t.payload},"string"==typeof e.awaitingRecordings.screen&&"string"==typeof e.awaitingRecordings.video&&(e.awaitingRecordings=null)},[Us.SET_PREVIEW_TRACK]:(e,t)=>{e.previewTrack=t.payload},[Us.SET_PREVIEW_TIMELINE_STATE]:(e,t)=>{t.timelineState?e.previewTimelineState?e.previewTimelineState={...e.previewTimelineState,...t.timelineState}:e.previewTimelineState={pxInSecond:0,timelineWidth:0,scrollLeft:0,...t.timelineState}:e.previewTimelineState=void 0},[Us.SET_GHOST_SEEKER_OFFSET]:(e,t)=>{e.ghostTimeOffsets=t.payload},[Us.SET_STATIC_UPLOAD_IDS]:(e,t)=>{e.staticUploadIds=t.payload},[Us.SET_MOBILE_TRAY_CONTENT]:(e,t)=>{e.mobileTrayContent=t.payload},[Us.SET_BOX_SELECTED_IDS]:(e,t)=>{e.boxSelectedIds=t.payload},[Us.SET_GROUP_DRAG_OVERRIDES]:(e,t)=>{e.groupDragOverrides[t.payload.groupId]=t.payload.overrides},[Us.CLEAR_GROUP_DRAG_OVERRIDES]:(e,t)=>{delete e.groupDragOverrides[t.payload]},[Us.SYNC_ATTEMPTED]:(e,t)=>{const a=Date.now();e.lastSyncedWithServer.attempted[t.payload]=a;const o=e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload],n=e.lastSyncedWithServer.succeeded[t.payload];(!o||n&&n>o)&&(e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=a)},[Us.SYNC_SUCCEEDED]:(e,t)=>{const a=Date.now();e.lastSyncedWithServer.succeeded[t.payload]=a,e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=null,e.lastSyncedUserFacing=a},[Us.SET_IS_ADDING]:(e,t)=>{Object.prototype.hasOwnProperty.call(e.isAdding,t.payload)?e.isAdding[t.payload]=!e.isAdding[t.payload]:e.isAdding[t.payload]=!0},[Us.PLAYBACK_RATE]:(e,t)=>{e.playbackRate=t.payload},[Us.UPDATE_MAGIC_SUBTITLE_LOCAL]:(e,t)=>{const{assetId:a,updates:o}=t.payload;e.magicSubtitles[a]||(e.magicSubtitles[a]={});const n=e.magicSubtitles[a];n&&(o.position&&(n.position={...n.position,...o.position}),o.style&&(n.style={...n.style,...o.style}),o.lockAspectRatio&&(n.lockAspectRatio=o.lockAspectRatio),o.selection&&(n.selection=o.selection),o.focusedNdx&&(n.focusedNdx=o.focusedNdx))},UPDATE_MAGIC_SUBTITLE:(e,{assetId:t,updates:a})=>{const o=e.magicSubtitles[t];o&&(a.lockAspectRatio&&delete o.lockAspectRatio,a.position&&delete o.position,a.style&&delete o.style)},[Us.SET_LOCAL_MAGIC_SUBTITLE_FRAMES]:(e,t)=>{e.magicSubtitleFrames[t.payload.assetId]=t.payload.frames},[Us.RESIZE_MEDIABAR]:(e,t)=>{e.mediaBarWidth=t.payload},[Us.RESIZING_MEDIABAR]:(e,t)=>{e.isResizingMediaBar=t.payload},[Us.UPDATE_LAST_GENERATED_THUMBNAIL]:e=>{const t=new Date;e.lastThumbnailGenerated=t},[Us.SET_SHOW_REPORT_ISSUE_MODAL]:(e,t)=>{e.showReportIssueModal=t.payload},[Us.SET_LAYER_MOUNTED_STATE]:(e,t)=>{e.isLayerMountedByLayerId[t.payload.layerId]=t.payload.mounted},[Us.SET_ASSET_MONITOR_ID]:(e,t)=>{e.assetMonitorId=t.payload}}),oT=g("SET_IDB_IS_DISABLED"),nT=b({idb:!0},(e=>e.addCase(oT,(e=>{e.idb=!1})))),rT=d({initialState:F.v4(),name:"sessionId",reducers:{}}),iT=d({initialState:{},name:"notifications",reducers:{setNotifications:(e,t)=>{e.notifications=t.payload},addNotifications:(e,t)=>{e.notifications=[...t.payload,...e.notifications||[]]},setNotificationsRead:(e,t)=>{e.notifications=e.notifications?e.notifications.map((e=>t.payload.includes(e._id.toString())?{...e,state:Nr.read}:e)):void 0}}}),{setNotifications:sT,addNotifications:lT,setNotificationsRead:cT}=iT.actions,dT={byId:{},projectIdsByFolderId:{}},uT=d({initialState:dT,name:"projects",reducers:{projectsFetched:(e,{payload:{projects:t,folderId:a}})=>{t.forEach((t=>{e.byId[t._id]=t}));const o=e.projectIdsByFolderId[a],n=t.map((e=>e._id)),r=o?[...new Set([...n,...o])]:n;e.projectIdsByFolderId[a]=r.sort()},removeProject:(e,{payload:{projectId:t,folderId:a}})=>{delete e.byId[t];const o=e.projectIdsByFolderId[a];o&&(e.projectIdsByFolderId[a]=o.filter((e=>e!==t)))},clearAllProjects:e=>dT}}),{projectsFetched:mT,removeProject:pT,clearAllProjects:hT}=uT.actions,gT=d({initialState:{recordSet:!1},name:"assets",reducers:{setRecord:e=>{e.recordSet=!0},unsetRecord:e=>{e.recordSet=!1}}}),{setRecord:fT,unsetRecord:yT}=gT.actions;function ET(e,t){let a=t.getStartKey();const o=t.getEndKey();let n=t.getStartOffset(),r=e.getBlockForKey(a).getCharacterList().slice(n);const i=[];for(;a!==o;){for(const e of r.toArray())i.push(e);const t=e.getBlockAfter(a);a=t.getKey(),r=t.getCharacterList(),n=0}r=r.slice(0,t.getEndOffset()-n);for(const s of r.toArray())i.push(s);return i}const _T=e=>{const t=e.getFirstBlock().getKey();return G.SelectionState.createEmpty(t).merge({anchorKey:t,anchorOffset:0,focusKey:e.getLastBlock().getKey(),focusOffset:e.getLastBlock().getLength()})},vT=e=>{const t=e.getCurrentContent(),a=_T(t);return G.EditorState.forceSelection(e,a)},wT=e=>{const t=e.getCurrentContent(),a=t.getFirstBlock().getKey(),o=t.getLastBlock().getKey(),n=t.getLastBlock().getLength(),r=e.getSelection();return r.getStartKey()===a&&0===r.getStartOffset()&&r.getEndKey()===o&&r.getEndOffset()===n},bT=e=>{const t=e.getCurrentContent().getBlocksAsArray(),a=e.getSelection(),o=a.getStartKey(),n=a.getStartOffset(),r=a.getEndKey(),i=a.getEndOffset(),s=t.map((e=>[e.getKey(),e.getLength()]));let l=0;for(const[d,u]of s){if(d===o){l+=n;break}l+=u+1}let c=0;for(const[d,u]of s){if(d===r){c+=i;break}c+=u+1}return[l,c]},ST=(e,t)=>{let a=0,o=null,n=0;const r=e.getCurrentContent().getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));if(t>-1)for(const[i,s]of r){const e=a;if(a+=s+1,a>t){o=i,n=t-e;break}}else{const t=e.getCurrentContent().getBlockMap().toList();o=t.last().get("key"),n=t.last().getLength()}if(o){const t=G.SelectionState.createEmpty(o).merge({anchorKey:o,anchorOffset:n,focusKey:o,focusOffset:n});return G.EditorState.forceSelection(e,t)}return e},TT=(e,t,a)=>{const o=e.getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));let n=0,r=null,i=0;for(const[c,d]of o){const e=n;if(n+=d+1,n>t){r=c,i=t-e;break}}n=0;let s=null,l=0;for(const[c,d]of o){const e=n;if(n+=d+1,n>a){s=c,l=a-e;break}}if(r&&s){return G.SelectionState.createEmpty(r).merge({anchorKey:r,anchorOffset:i,focusKey:s,focusOffset:l})}return null},IT=(e,t)=>{const a=e.getCurrentContent(),o=_T(a);return G.Modifier.replaceText(a,o,t)},kT=e=>e.getCurrentContent().getPlainText(),CT=(e,t,a)=>{const o=TT(e,t,t+1);return o?G.Modifier.applyInlineStyle(e,o,a):e};var NT=(e=>(e.MOUNT_ACTIVE_EDITOR="MOUNT_ACTIVE_EDITOR",e.UNMOUNT_ACTIVE_EDITOR="UNMOUNT_ACTIVE_EDITOR",e.UPDATE_ACTIVE_EDITOR="UPDATE_ACTIVE_EDITOR",e.SET_TEXT_BOLD="SET_EDITOR_TEXT_BOLD",e.SET_TEXT_ITALICS="SET_EDITOR_TEXT_ITALICS",e.SET_TEXT_UNDERLINE="SET_EDITOR_TEXT_UNDERLINE",e.SET_TEXT_COLOR="SET_EDITOR_TEXT_COLOR",e))(NT||{});const AT=g("MOUNT_ACTIVE_EDITOR"),xT=g("UNMOUNT_ACTIVE_EDITOR"),PT=g("UPDATE_ACTIVE_EDITOR"),RT=g("SET_EDITOR_TEXT_BOLD"),OT=g("SET_EDITOR_TEXT_ITALICS"),DT=g("SET_EDITOR_TEXT_UNDERLINE"),LT=g("SET_EDITOR_TEXT_COLOR");const UT=(e,t,a,o)=>{const n=t.borderRadius?parseFloat(t.borderRadius.relative):0;if(BT(t.position.pixel_width,t.position.pixel_height,n))FT(e,t.position.pixel_width/2,t.position.pixel_height/2,t.position.pixel_width/2,a,o);else{const r=n/100*(t.position.pixel_width<t.position.pixel_height?t.position.pixel_width:t.position.pixel_height);MT(e,t,t.position.pixel_width,t.position.pixel_height,r,a,o)}e.clip()},MT=(e,t,a,o,n,r,i)=>{e.beginPath(),r&&(e.lineWidth=r,e.strokeStyle=i),e.moveTo(n,0),e.lineTo(a-n,0),e.arcTo(a,0,a,n,n),e.lineTo(a,o-n),e.arcTo(a,o,a-n,o,n),e.lineTo(n,o),e.arcTo(0,o,0,o-n,n),e.lineTo(0,n),e.arcTo(0,0,n,0,n),"dropShadow"===t.imageEffect&&(!function(e,t){const a=t.imageShadowDist||0,o=(t.imageShadowRot||0)*Math.PI/180,n=100*a*Math.cos(o),r=100*a*Math.sin(o);e.shadowOffsetX=n,e.shadowOffsetY=r,e.shadowColor=t.imageEffectColor,e.shadowBlur=50*t.imageShadowBlur}(e,t),e.fill()),e.closePath(),r&&e.stroke()},FT=(e,t,a,o,n,r)=>{e.beginPath(),n&&(e.lineWidth=n,e.strokeStyle=r),e.arc(t,a,o,0,2*Math.PI),e.closePath(),n&&e.stroke()},BT=(e,t,a)=>e/t>=.98&&e/t<=1.02&&a>=49;function WT(e,t,a,o,n,r){const i=t+o,s=a+n;e.moveTo(t+r,a),e.lineTo(i-r,a),e.arcTo(i,a,i,a+r,r),e.lineTo(i,s-r),e.arcTo(i,s,i-r,s,r),e.lineTo(t+r,s),e.arcTo(t,s,t,s-r,r),e.lineTo(t,a+r),e.arcTo(t,a,t+r,a,r)}function VT(e,t,a,o,n){o&&(e.moveTo(t,a+o),e.arcTo(t,a,t-o,a,o),e.lineTo(t,a),e.lineTo(t,a+o)),n&&(e.moveTo(t,a+n),e.arcTo(t,a,t+n,a,n),e.lineTo(t,a),e.lineTo(t,a+n))}function jT(e,t,a,o,n){o&&(e.moveTo(t,a-o),e.arcTo(t,a,t-o,a,o),e.lineTo(t,a),e.lineTo(t,a-o)),n&&(e.moveTo(t,a-n),e.arcTo(t,a,t+n,a,n),e.lineTo(t,a),e.lineTo(t,a-n))}function HT(e,t,a){const{baseWidth:o,position:n}=a,r=parseFloat(null==n?void 0:n.width);if(null==o||isNaN(r))return e.height/(t.sceneHeight||1);return e.width*r/100/o}function GT(e,t){let a=`"${e.fontFamily}", Noto Sans, Apple Color Emoji, Noto Color Emoji`;return(null==t?void 0:t.length)&&(a+=`, ${t.join(", ")}`),a}function $T(e,t,a){const o=[];e.italic&&o.push("italic"),e.fontWeight&&o.push(e.fontWeight);const n=`${t}px/${null!=e.lineHeight?e.lineHeight:1}`;o.push(n),o.push(GT(e,a));return o.join(" ")}function KT(e,t,a){const o=document.createElement("span"),n=document.createElement("div"),r=document.createElement("div");n.style.display="inline-block",n.style.width="1px",n.style.height="0",n.style.verticalAlign="baseline",r.style.visibility="hidden",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.whiteSpace="nowrap",o.style.whiteSpace="nowrap",o.style.font=$T(e,t,e.fallbackFonts),a&&(o.style.lineHeight=`${a}px`),o.textContent=e.text.replace(/\s/g,String.fromCharCode(160)),r.appendChild(o),r.appendChild(n),document.body.appendChild(r);const{offsetTop:i}=n,{height:s}=o.getBoundingClientRect();return r.remove(),{baseline:i,height:s}}function YT({ctx:e,lines:t,pxCap:a}){let o=[];const n=" ",r=e.measureText(n).width;let i,s;return t.filter((e=>e&&e.length)).forEach((t=>{i="",s=0;t.split(n).forEach((t=>{let{width:l}=e.measureText(t);if(l>a){s&&o.push([i,s]);const n=((e,t,a)=>{const o=t.split(""),n=[];let r="",i=0;return o.forEach((t=>{const{width:o}=e.measureText(t);i+o>a?(i&&n.push([r,i]),r=t,i=o):(r+=t,i+=o)})),i&&n.push([r,i]),n})(e,t,a),r=n.pop();return[i,s]=r,void(o=[...o,...n])}s+r+l>a?(s&&o.push([i,s]),i="",s=0):s&&""!==t&&(i+=n,s+=r),""===t&&(t=n,l=r),i+=t,s+=l})),s&&o.push([i,s])})),o}function zT(e,t,a,o,n,r){let i;switch(r.textEffect){case"dropShadow":{e.save();const s=r.textShadowDist*n,l=r.textShadowRot*(Math.PI/180),c=s*Math.cos(l),d=s*Math.sin(l);i=`blur(${r.textShadowBlur*n/2}px)`,e.filter="none"===e.filter?i:i+e.filter,e.fillStyle=r.textEffectColor,e.fillText(t,a+c,o+d),r.underline&&qT(e,t,a+c,o+d,n,r),e.restore();break}case"textBlur":{const{textBlurTemp:t,textBlur:a}=r;i=`blur(${.2*+n*+(t||a||.2)}px)`,e.filter=e.filter&&"none"!==e.filter?i+e.filter:i;break}}}function qT(e,t,a,o,n,r,i=0){e.save();const s=e.measureText(t).width+i,l=.004*(e.canvas.clientHeight||e.canvas.height);switch(e.textAlign){case"center":a-=s/2;break;case"right":a-=s}e.beginPath(),e.strokeStyle=r.textShadow,e.lineWidth=Math.max(2,l),e.lineJoin="round";const c=.05*n;e.strokeRect(a,o+c,s,n/10),e.rect(a,o+c,s,n/10),e.fill(),e.restore()}function JT(e,t,a,o,n,r,i){var s;if(null==i?void 0:i.backgroundColor){const l=t.strokeStyle;t.fillStyle=i.backgroundColor,t.strokeStyle="transparent";const{width:c}=t.measureText(a.text),d=t.measureText(e.wordSeparator).width/2,u=r*e.lineHeight,m=u/5,p=30,h=Math.min(1,Math.floor(e.fontSize/p));!function(e,t,a,o,n,r){const i=Math.min(o,n)/2*.95,s=Math.min(r,i);e.beginPath(),WT(e,t,a,o,n,s),e.stroke(),e.fill()}(t,Math.floor(o-d)-h,n-u+m-parseFloat((i.bottom||0).toString())*r,Math.ceil(c+2*d)+h,u,parseFloat((null==(s=i.borderRadius)?void 0:s.toString())||"0")*r),t.strokeStyle=l}const l=o;let c=n;return(null==i?void 0:i.bottom)&&(c-=parseFloat(i.bottom.toString())*r),t.fillStyle=(null==i?void 0:i.color)||e.color,"none"===i.textShadow?t.strokeStyle="transparent":t.strokeStyle=i.textShadow||e.textShadow,{...i,x:l,y:c}}const XT=e=>{try{return[...(new Intl.Segmenter).segment(e)].map((e=>e.segment))}catch($ae){console.error("safeSplitText error",$ae)}return[...e]};const QT=(e,t,a)=>{const o=XT(e.text),n=[];let r,i=t||0;return o.forEach(((o,s)=>{var l;const c=null==(l=e.styles)?void 0:l[s];a&&void 0!==t&&a.selectionStart<=i&&a.selectionEnd>=i||0===s||!function(e,t){if(!e||!t)return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a of Object.keys(e)){if("index"===a)continue;const o=a;if(e[o]!==t[o])return!1}return!0}(c,r)?n.push({text:o,styles:c}):n[n.length-1].text+=o,r=c,i+=o.length})),n},ZT=(e,t,a)=>{let o={index:-1};return!!t&&!!a&&(Object.keys(a).forEach((e=>{const n=e;n in a&&a[n]===t[n]&&(o={...o,[n]:a[n]})})),!e.underline||"none"!==a.textDecoration&&"none"!==t.textDecoration||(o.textDecoration="none")),e.underline&&"none"!==o.textDecoration&&(o.textDecoration="underline"),o};function eI(e,t){const a={...e};return"italic"===(null==t?void 0:t.fontStyle)?a.italic=!0:"normal"===(null==t?void 0:t.fontStyle)&&(a.italic=!1),"bold"===(null==t?void 0:t.fontWeight)?a.fontWeight="bold":"normal"===(null==t?void 0:t.fontWeight)&&(a.fontWeight="normal"),a}function tI(e,t,a,o){var n;const r=a.position.pixel_width,i=a.position.pixel_height;t.textBaseline="alphabetic",t.textAlign="left";for(const{text:s,css:l,position:c}of e){const e=null==(n=l.textDecoration)?void 0:n.toString().includes("underline"),d={...a,text:s,textWithLineBreaks:s,fontSize:o,lineHeight:1,underline:e,italic:"italic"===l.fontStyle,fontWeight:l.fontWeight},u=$T(d,o,a.fallbackFonts);t.font=u,t.fillStyle=l.color;const m=c.left*r,p=c.height*i,{baseline:h}=KT({...d,lineHeight:"normal"},o,p),g=c.bottom*i-(p-h);a.textEffect&&zT(t,s,m,g,o,d),e&&qT(t,s,m,g,o,d),t.strokeText(s,m,g),t.fillText(s,m,g)}}const aI=e=>{let t=[];t=e.replace(/\r?\n|\r/g,"\n").split(/(\n)/);return t.filter((function(e){return""!==e})).filter((function(e,t,a){return 0===t||!("\n"===e&&"\n"!==a[t-1])}))};function oI(e,t,a=null,o=null,n=null,r=null){const i=a||t.position.pixel_width,s=o||t.position.pixel_height;if(i<=0||s<=0)return;let l="0%";n?l=n:t.borderRadius&&t.borderRadius.relative&&(l=t.borderRadius.relative);const c=parseFloat(l)/100*Math.min(i,s),d=(r||t.textPadding||0)*Math.min(i,s)/100,u=2*d,m=document.createElement("canvas");m.width=i+u,m.height=s+u;const p=m.getContext("2d");p.beginPath(),p.rect(0,0,m.width,m.height),p.clip(),p.beginPath(),WT(p,0,0,m.width,m.height,c),p.lineWidth=1,p.strokeStyle=t.backgroundColor,p.stroke(),p.fillStyle=t.backgroundColor,p.fill(),m.width>0&&m.height>0&&e.drawImage(m,-d,-d,m.width,m.height)}function nI(e,t,a){return Math.max(e,Math.min(a,t))}function rI(e,t,a,o,n=null,r=null,i=null,s=null,l=null,c=null){const d=n||o.position.pixel_width,u=r||o.position.pixel_height;if(d<=0||u<=0)return;const m=o.textAlign,p="left"===m,h="right"===m,g=o.lineHeight||1,f=i||g*a,y=c||o.textPadding||0,E=y*f/100,_=2*E;let v=s||Math.max(0,(u-f*t.length)/2);const w=document.createElement("canvas");w.width=d+_,w.height=u+_;const b=w.getContext("2d");b.beginPath(),b.rect(0,0,w.width,w.height),b.clip();let S=0;l?S=parseFloat(l)/100:o.borderRadius&&o.borderRadius.relative&&(S=parseFloat(o.borderRadius.relative)/100);const T=S*f,I=T+T;let k=t;const C=(e,t)=>{const a=k[t-1];let o=e;if(t>0){Math.abs(a-e)<I&&(o=Math.max(a,e))}return o};function N(e){const t=k[e],a=Math.min(d-2,t);let o=0;switch(m){case"right":o=d-a-1;break;case"center":o=(d-a)/2}return{x:o,w:a}}let A;k=t.map(C).reverse(),k=k.map(C).reverse();let x=1;const P=yy(o.backgroundColor);function R(){b.lineWidth=1,b.strokeStyle=A,b.stroke(),b.fillStyle=A,b.fill(),b.beginPath()}P?(x=P.a,A=`rgb(${P.r}, ${P.g}, ${P.b})`):A=o.backgroundColor,b.beginPath();const O=S+y/100;let D=T;O>.5&&(D=T-f*(O-.5));for(let L=0;L<t.length;L++){const{x:e,w:a}=N(L);if(WT(b,e,v,a+_,f+_,T),R(),L>0){const{x:t,w:o}=N(L-1);let n=o>a+T+T;(h||p)&&(n=o>a+T),VT(b,e,v+_-(p||o===a?E:0),p?0:nI(0,e-(t+T),D),p||n||o===a?T:0),R(),VT(b,e+a+_,v+_-("right"===m||o===a?E:0),h||n||o===a?T:0,h?0:nI(0,t+o-T-(e+a),D)),R()}if(L<t.length-1){const{x:t,w:o}=N(L+1);let n=o>a+T+T;(h||p)&&(n=o>a+T),jT(b,e,v+f+("left"===m||o===a?E:0),p?0:nI(0,e-(t+T),D),p||n||o===a?T:0),R(),jT(b,e+a+_,v+f+("right"===m||o===a?E:0),h||n||o===a?T:0,h?0:nI(0,t+o-T-(e+a),D)),R()}R(),v+=f}if(w.width>0&&w.height>0){const t=e.globalAlpha;e.globalAlpha=x*e.globalAlpha,e.drawImage(w,-E,-E,w.width,w.height),e.globalAlpha=t}}async function iI(e,t,a,o,n){var r;if(!t.text)return;e.save();const i=Number(t.fontSize||0)*o;e.font=$T(t,i),document.fonts.check(e.font)||console.error("Font not loaded, output may not have correct fidelity"),e.textAlign="left",e.textBaseline="alphabetic";const s=t.position.pixel_width,l=.004*(e.canvas.clientHeight||e.canvas.height);e.strokeStyle=t.textShadow,e.lineWidth=Math.max(2,l),e.lineJoin="round";const c=t.position.adjusted_x,d=t.position.adjusted_y,u=c+t.position.pixel_width/2,m=d+t.position.pixel_height/2;e.translate(u,m),(null==(r=t.position)?void 0:r.rotation)&&e.rotate(t.position.rotation*Math.PI/180),e.translate(-u,-m),e.translate(c,d),e.globalAlpha=t.globalAlpha;let p=null;W_(t,n)&&(p=((e,t)=>V_(e,t).find((({animationName:e,wordByWordStyles:t})=>!!t&&e!==Pr.None))||null)(t,n),await j_(n,t,e,a,i)),e.fillStyle=t.color;const h=!!t.textWithLineBreaks&&(g=t.text,f=t.textWithLineBreaks,g.replace(/[\s\n]/g,"")===f.replace(/[\s\n]/g,""));var g,f;const y=YT({ctx:e,lines:aI(h?t.textWithLineBreaks:t.text)||[],pxCap:h?Number.MAX_SAFE_INTEGER:s});if(t.backgroundColor&&"RGBA(-255,-255,-255,0)"!==t.backgroundColor)if("wrap"===t.wrapOrFill){rI(e,y.map((([e,t])=>t)),i,t)}else oI(e,t);if(t.isRTL&&(e.direction="rtl"),t.textBlocks)tI(t.textBlocks,e,t,i);else if(t.draftJSTextTree){tI(pI(t,t.draftJSTextTree,i),e,t,i)}else t.frame?function(e,t,a,o,n,r){const{frame:i}=a;if(!i)return;let s=i;a.isRTL&&(s={...i,lines:i.lines.map((e=>({...e,words:[...e.words].reverse()})))}),t.font=$T(a,o);const l=a.position.pixel_width,c=a.position.pixel_height,d=(a.lineHeight||1)*o,u=c/2-d*e.length/2;if(l<=0||c<=0)return;const{wordByWordStyles:m,animationName:p}=r||{},{active:h,spoken:g,unspoken:f,inactive:y}=m||{};s.lines.forEach(((r,i)=>{const[,s]=e[i],c=[];let m=0,E=0;switch(a.textAlign){case"center":m=(l-s)/2;break;case"right":m=l-s;break;default:m=0}const _=m;E=u+d*i+KT(a,o,d).baseline,r.words.forEach(((e,i)=>{var s,l;const d=n<e.start,u=n>=e.start,v=p&&n>=e.start&&n<e.end;let w={};!v&&(w={...w,...y}),d&&(w={...w,...f}),u&&(w={...w,...g}),v&&(w={...w,...h});const{x:b,y:S}=JT(a,t,e,m,E,o,w),T=i+1===r.words.length;let I=b,k="";const C=QT(e);if(a.isRTL&&C.reverse(),C.forEach((e=>{t.save();const n=e.styles,r=eI(a,n);if((null==n?void 0:n.color)&&((!v||v&&!(null==h?void 0:h.color))&&(t.fillStyle=n.color),d&&"transparent"===(null==f?void 0:f.color)&&(t.fillStyle="transparent")),t.font=$T(r,o),a.underline&&"none"!==(null==n?void 0:n.textDecoration)||"underline"===(null==n?void 0:n.textDecoration)){const n=.5;qT(t,e.text,I,S,o,a,n)}t.strokeText(e.text,I,S),t.fillText(e.text,I,S),k+=e.text,I+=t.measureText(e.text).width,t.restore()})),!T&&a.wordSeparator){t.save();const n=i+1,c=r.words[n],u=a.isRTL?c.text.length-1:0,m=null==(s=null==c?void 0:c.styles)?void 0:s[u],p=a.isRTL?0:e.text.length-1,h=null==(l=e.styles)?void 0:l[p],g=ZT(a,h,m),y=eI(a,g);if(t.font=$T(y,o),v&&(t.fillStyle=g.color||a.color),(null==g?void 0:g.color)&&(t.fillStyle=g.color),d&&"transparent"===(null==f?void 0:f.color)&&(t.fillStyle="transparent"),"underline"===(null==g?void 0:g.textDecoration)){const e=.5;qT(t,a.wordSeparator,I,E,o,a,e)}t.strokeText(a.wordSeparator,I,S),t.fillText(a.wordSeparator,I,S),k+=a.wordSeparator,I+=t.measureText(a.wordSeparator).width,t.restore()}c.push(k);const N=c.join("");m=_+t.measureText(N).width}))}))}(y,e,t,i,a,p):function(e,t,a,o,n=null,r=null){const i=n||a.position.pixel_width,s=r||a.position.pixel_height;if(i<=0||s<=0)return;const l=(a.lineHeight||1)*o,c=s/2-l*e.length/2;for(let d=0;d<e.length;d++){const n=e[d][0],r=e[d][1];let s;switch(a.textAlign){case"center":s=(i-r)/2;break;case"right":s=i-r;break;default:s=0}const u=c+l*d+KT(a,o,l).baseline;a.textEffect&&zT(t,n,s,u,o,a),a.underline&&qT(t,n,s,u,o,a),t.strokeText(n,s,u),t.fillText(n,s,u)}}(y,e,t,i);e.restore()}const sI=e=>[...new Set(e.getBlocksAsArray().flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle().toArray())))))],lI=e=>{if(""===e.getPlainText())return[];const t=e.getBlocksAsArray();if(0===t.length)return[];const a=t.flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle()))));return 0===a.length?[]:a[0].intersect(...a).toArray()},cI=(e,t)=>{const a=e=>{var t;return e.hasChildNodes()?Array.from(e.childNodes,a).flat(1):e instanceof Element?"BR"===e.tagName?[{text:"",css:{},position:K(e.getBoundingClientRect(),"top","left","right","bottom","width","height")}]:[]:e.nodeType===Node.TEXT_NODE&&null!=(t=(e=>{const t=e.textContent||"";if(e.nodeType!==Node.TEXT_NODE||null==e.parentElement||["\r\n","\n"].includes(t))return[];let a=e.parentElement;for(;!a.getAttribute("data-offset-key");){if(null==a.parentElement){a=e.parentElement;break}a=a.parentElement}const o=getComputedStyle(a),n={fontWeight:o.fontWeight,fontStyle:o.fontStyle,textDecoration:o.textDecoration,color:o.color},r=[],i=document.createRange();i.setStart(e,0),i.setEnd(e,1);let s,l=i.getBoundingClientRect();for(let d=2;d<=t.length;d+=1){i.setEnd(e,d);const t=i.getBoundingClientRect();if(l.bottom!==t.bottom){i.setEnd(e,d-1);const t={...K(i.getBoundingClientRect(),"top","left","right","bottom","width","height")};s=s||t.height,t.top=t.bottom-s,t.height=s,r.push({text:i.toString(),css:n,position:t}),i.setStart(e,d-1),i.setEnd(e,d),l=i.getBoundingClientRect()}}i.setEnd(e,t.length);const c={...K(i.getBoundingClientRect(),"top","left","right","bottom","width","height")};return s=s||c.height,c.top=c.bottom-s,c.height=s,r.push({text:i.toString(),css:n,position:c}),r})(e))?t:[]},o=a(t),n=e.getBoundingClientRect();return o.map((({position:e,...t})=>{const a={top:(e.top-n.top)/n.height,bottom:(e.bottom-n.top)/n.height,height:e.height/n.height,left:(e.left-n.left)/n.width,right:(e.right-n.left)/n.width,width:e.width/n.width};return{...t,text:t.text.replace(/\r\n/g,"").replace(/\n/g,""),position:$(a,(e=>((e,t)=>{if(t<1){const a=1/t;return Math.round(e*a)/a}return Math.round(e/t)*t})(e,1e-4)))}}))},dI="COLOR",uI=e=>e.startsWith("COLOR");function mI(e){if(e.startsWith("COLOR"))return{color:e.slice("COLOR".length+1)}}const pI=(e,t,a)=>{var o,n,r,i;const s=(e=>{const t=document.createElement("div"),a=e.getCurrentContent().getBlocksAsArray(),o={...Y.DefaultDraftInlineStyle},n=sI(e.getCurrentContent());for(const r of n)uI(r)&&(o[r]=mI(r));for(const r of a){const a=document.createElement("div");a.style.whiteSpace="pre-wrap";const n=r.getKey(),i=r.getText(),s=e.getBlockTree(n);for(const e of s.toArray()){const t=e.get("leaves");for(const e of t){const t=e.get("start"),n=e.get("end"),s=document.createElement("span");s.setAttribute("data-offset-key",String(t));for(const e of r.getInlineStyleAt(t).toArray())Object.assign(s.style,o[e]);s.textContent=i.slice(t,n).replace(/\r\n/g,""),a.appendChild(s)}}t.appendChild(a)}return t})(Y.EditorState.createWithContent(Y.convertFromRaw(t)));Object.assign(s.style,{font:$T(e,a,e.fallbackFonts),fontSize:a,width:`${null==(o=e.position)?void 0:o.pixel_width}px`,height:`${null==(n=e.position)?void 0:n.pixel_height}px`,textAlign:null!=(r=e.textAlign)?r:"initial",color:e.color,textDecoration:e.underline?"underline":"none",alignItems:"center"});const l=null==(i=e.textAlign)?void 0:i.toLowerCase();"left"===l?s.style.justifyContent="flex-start":"right"===l&&(s.style.justifyContent="flex-end");const c=document.createElement("div");c.style.display="flex",c.style.position="absolute",c.style.left="10000px",c.appendChild(s),document.body.appendChild(c);try{return cI(s,s)}finally{c.remove()}},hI=(e,t,a)=>{const o=e.getSelection(),n=e.getCurrentContent(),r=o.isCollapsed()?_T(n):o,i=a?G.Modifier.applyInlineStyle(n,r,t):G.Modifier.removeInlineStyle(n,r,t),s=G.EditorState.push(e,i,"change-inline-style");return G.EditorState.acceptSelection(s,o)},gI=(e,t,a)=>{const o=e.getSelection(),n=e.getCurrentContent(),r=o.isCollapsed()?_T(n):o;let i=sI(n).filter((e=>e.startsWith(t))).reduce(((e,t)=>G.Modifier.removeInlineStyle(e,r,t)),n);i=G.Modifier.applyInlineStyle(i,r,`${t}_${a}`);const s=G.EditorState.push(e,i,"change-inline-style");return G.EditorState.acceptSelection(s,o)},fI=b({},{[NT.MOUNT_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t.id]?e[t.id].mountCounter+=1:e[t.id]={editor:t.editor,syncCounter:0,mountCounter:1}},[NT.UPDATE_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t.id]?e[t.id].editor=t.editor:e[t.id]={editor:t.editor,syncCounter:0,mountCounter:1}},[NT.UNMOUNT_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t]&&(e[t].mountCounter-=1,e[t].mountCounter<=0&&(e[t]=void 0))},[NT.SET_TEXT_BOLD]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=hI(e[a].editor,"BOLD",t.value),e[a].syncCounter=e[a].syncCounter+1)},[NT.SET_TEXT_ITALICS]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=hI(e[a].editor,"ITALIC",t.value),e[a].syncCounter=e[a].syncCounter+1)},[NT.SET_TEXT_UNDERLINE]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=hI(e[a].editor,"UNDERLINE",t.value),e[a].syncCounter=e[a].syncCounter+1)},[NT.SET_TEXT_COLOR]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=gI(e[a].editor,"COLOR",t.value),e[a].syncCounter=e[a].syncCounter+1)}}),yI=z({ffmpegReducer:HS,toasts:(e={},t)=>{switch(t.type){case"SHOW_ERROR":return e.errorType===Yo?{...e}:{...e,showError:!0,errorMessage:t.errorMessage,errorType:t.errorType};case"HIDE_ERROR":return{...e,showError:!1,errorType:null};case"SHOW_SUCCESS":return{...e,showSuccess:!0,successMessage:t.successMessage};case"HIDE_SUCCESS":return{...e,showSuccess:!1};case"SHOW_WARNING":return{...e,showWarning:!0,warningMessage:t.warningMessage};case"HIDE_WARNING":return{...e,showWarning:!1};case"SHOW_INFO":return{...e,showInfo:!0,infoMessageName:t.infoMessageName,theme:t.theme};case"HIDE_INFO":case"RESET_STUDIO":return{...e,showInfo:!1};case"SHOW_VIEW_ONLY_MODE_TOAST":return{...e,showViewOnlyModeToast:!0};case"HIDE_VIEW_ONLY_MODE_TOAST":return{...e,showViewOnlyModeToast:!1};default:return e}},config:(e=gp,t)=>"SET_CONFIG"===t.type?{...e,...t.config||{}}:e,sourceVideo:(e={},t)=>{switch(t.type){case"KAPWING_INIT":return"local"===e.source?{}:{...e,local_url:null};case"SET_SOURCE_VIDEO":return t.updateSharedDoc&&Lp("sourceVideo",t.video,e,"SET_SOURCE_VIDEO"),t.video;case"SET_UPLOAD_PROGRESS_TEXT":return"sourceVideo"!==t.id?e:{...e,uploadProgressText:t.text};default:return e}},uploadStatuses:(e={},t)=>{switch(t.type){case"RESET_EDITOR":return{};case"ADD_UPLOAD_STATUS":{if(e[t.id])return e;const a={id:t.id,beganAt:performance.now(),beganAtTimestamp:Date.now(),fileName:t.fileName,stage:Cs.unstarted,stageStarted:performance.now(),retryInfo:{offlineRetries:0,otherRetries:0,retries:0}};return{...e,[t.id]:a}}case"DELETE_UPLOAD_STATUS":{const a={...e};return delete a[t.id],a}case"UPDATE_UPLOAD_STATUS":{if(!e[t.id])return e;const a="stage"in t.updates&&e[t.id]&&t.updates.stage!==e[t.id].stage?{stageStarted:performance.now()}:{};return{...e,[t.id]:{...e[t.id],...t.updates,...a}}}default:return e}},toolTip:(e="",t)=>{switch(t.type){case"SHOW_TOOL_TIP":return t.toolTip;case"RESET_EDITOR":return"";default:return e}},mousePositionToolTip:(e=null,t)=>{switch(t.type){case"SET_MOUSE_POSITION_TOOLTIP":return t.mousePosition;case"CLEAR_MOUSE_POSITION_TOOLTIP":return null;default:return e}},privacy:(e=null,t)=>{let a;switch(t.type){case"SET_CURRENT_VIDEO":a=(t.video||{}).privacy,a=null==a?null:a;break;case"SET_PRIVACY":a=t.privacy;break;case"RESET_EDITOR":case"RESET_PRIVACY":case"RESET_STUDIO":a=null;break;default:a=e}return a},startTime:(e=0,t)=>{switch(t.type){case"SET_START_TIME":return t.startTime;case"RESET_EDITOR":return 0;default:return e}},endTime:(e=0,t)=>{switch(t.type){case"SET_END_TIME":return t.endTime;case"RESET_EDITOR":return 0;default:return e}},editorPath:(e="/",t)=>{switch(t.type){case"SET_EDITOR_PATH":return t.path;case"RESET_EDITOR":return"/";default:return e}},currentVideo:(e={},t)=>{switch(t.type){case"SET_CURRENT_VIDEO":return t.video;case"UPDATE_CURRENT_VIDEO":return{...e,...t.videoUpdates};case"RESET_STUDIO":case"RESET_CURRENT_VIDEO":return{};default:return e}},recentVideos:(e=[],t)=>"SET_RECENT_VIDEOS"===t.type?t.videos:e,videoJustSaved:(e=!1,t)=>"SET_VIDEO_JUST_SAVED"===t.type?t.justSaved:e,videoSaving:(e=!1,t)=>{switch(t.type){case"SET_VIDEO_SAVING":return!0;case"CLEAR_VIDEO_SAVING":return!1;default:return e}},sharedDoc:(e=null,t)=>{switch(t.type){case"SET_SHARED_DOC":return e&&e.destroy&&e.destroy(),window.sharedDoc=t.sharedDoc,t.sharedDoc;case"RESET_EDITOR":return e&&e.destroy&&e.destroy(),window.sharedDoc=null,null;default:return e}},currentUser:(e=(()=>"object"==typeof Cypress&&"env"in Cypress?"team"===Cypress.env("isSignedIn")?(zp(Cypress.env("teamsUserToken")),{user:Cypress.env("teamsUserDict"),token:Cypress.env("teamsUserToken")}):"individual"===Cypress.env("isSignedIn")?(zp(Cypress.env("userToken")),{user:Cypress.env("userDict"),token:Cypress.env("userToken")}):Yp:Yp)(),t)=>{var a;switch(t.type){case"REQUEST_USER":return{...e,user:{},token:e.token};case"RECEIVE_USER_AND_SET_TOKEN":const{user:o,token:n,impersonatingAdminEmail:r}=t;return qp(o),{...e,user:o,token:n,impersonatingAdminEmail:r};case"SET_TOKEN":return{...e,token:t.token};case"MOCK_SIGN_IN":return{...e,token:Cypress.env("teamsSignIn")?Cypress.env("teamsUserToken"):Cypress.env("userToken"),user:Cypress.env("teamsSignIn")?Cypress.env("teamsUserDict"):Cypress.env("userDict")};case"SIGN_OUT":return qp(null),Yp;case"SET_GDRIVE_TOKEN":return{...e,google_drive_token:t.token};case"SET_USER":return qp(t.user),{...e,user:t.user};case"UPDATE_USER_NOTIF_SETTING":{if(!(null==(a=e.user)?void 0:a._id))return e;const{notifType:o,on:n,location:r}=t,i=r===kr.Email?"optOutEmails":"optOutNotifs",s=e.user[i];if(!n&&!(null==s?void 0:s.includes(o))){const t=s?[...s,o]:[o];return{...e,user:{...e.user,[i]:t}}}if(n&&(null==s?void 0:s.includes(o))){const t=s.filter((e=>e!==o));return{...e,user:{...e.user,[i]:t}}}return e}default:return e}},isStopMotionVideo:(e=!1,t)=>{switch(t.type){case"MARK_AS_STOP_MOTION":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},stopMotionClipRate:(e=.6,t)=>{switch(t.type){case"SET_STOP_MOTION_CLIP_RATE":return t.clipRate;case"RESET_EDITOR":return.6;default:return e}},stopMotionSpeed:(e=.2,t)=>{switch(t.type){case"SET_STOP_MOTION_SPEED":return t.speed;case"RESET_EDITOR":return.2;default:return e}},reverseStopMotion:(e=!1,t)=>{switch(t.type){case"TOGGLE_REVERSE_STOP_MOTION":return!e;case"RESET_EDITOR":return!1;default:return e}},languageCode:(e="auto-detect",t)=>{let a;if("RESET_EDITOR"===t.type)a="auto-detect";else a=e;return a||"auto-detect"},isTranscribed:(e=!1,t)=>{let a;switch(t.type){case"STARTED_TRANSCRIBING":Lp("isTranscribed",e||t.success,e,"STARTED_TRANSCRIBING"),a=e||t.success;break;case"RESET_EDITOR":a=!1;break;default:a=e}return a||!1},transcriptionId:(e=null,t)=>{let a;switch(t.type){case"STARTED_TRANSCRIBING":Lp("transcriptionId",t.success?t.transcriptionId:null,e,"STARTED_TRANSCRIBING"),a=t.success?t.transcriptionId:null;break;case"RESET_EDITOR":a=null;break;default:a=e}return a||null},finishedTranscribingAt:(e=null,t)=>{let a;switch(t.type){case"FINISHED_TRANSCRIBING":return a=t.success?new Date:null,Lp("finishedTranscribingAt",a,e,"FINISHED_TRANSCRIBING"),a;case"STARTED_TRANSCRIBING":return Lp("finishedTranscribingAt",null,e,"STARTED_TRANSCRIBING"),null;case"RESET_EDITOR":return null;default:return e}},translate:(e=!1,t)=>{switch(t.type){case"SET_TRANSLATE":return Lp("translate",t.translate,e,"SET_TRANSLATE"),t.translate;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},translateLanguageCode:(e="",t)=>{switch(t.type){case"SET_TRANSLATE_LANGUAGE_CODE":return Lp("translateLanguageCode",t.translateLanguageCode,e,"SET_TRANSLATE_LANGUAGE_CODE"),t.translateLanguageCode;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return"";default:return e}},subtitles:(e=[],t)=>{let a,o,n=[];const r=e.length>1||1===e.length&&e[0].text;switch(t.type){case"REMOVE_SUBTITLE":return i=t.subtitle,Np({p:["subtitles",e.indexOf(t.subtitle)],ld:i},{srcFn:"REMOVE_SUBTITLE"}),e.filter((({id:e})=>e!==t.subtitle.id));case"DUPLICATE_SUBTITLE":return a=e.indexOf(t.subtitle),o={...t.subtitle,id:y()},function(e,t,a){Np({p:["subtitles",t],li:e},{srcFn:a})}(o,a+1,"DUPLICATE_SUBTITLE"),n=[...e],n.splice(a+1,0,o),n;case"SET_SUBTITLE_TIME":return n=e.map(((e,a)=>{if(e.id!==t.subtitle.id)return e;const o={...e,startTime:parseFloat(t.times.startTime),endTime:parseFloat(t.times.endTime)};return Vp(o,a,e,"SET_SUBTITLE_TIME"),o})),n;case"SET_SUBTITLE_TEXT":n=[];for(let a=0;a<e.length;a+=1)e[a].id===t.subtitle.id?(o={id:t.subtitle.id,text:t.text,startTime:parseFloat(t.subtitle.startTime),endTime:parseFloat(t.subtitle.endTime)},Vp(o,a,e[a],"SET_SUBTITLE_TEXT"),n.push(o)):n.push(e[a]);return n;case"ADD_SUBTITLES":return n=r?[...e,...t.subtitles]:[...t.subtitles],n;case"RESET_EDITOR":return[{id:y(),startTime:0,endTime:3,text:""}];default:return e}var i},subtitleVideo:(e=null,t)=>{switch(t.type){case"SET_SUBTITLE_VIDEO":return t.video;case"RESET_EDITOR":return null;default:return e}},highlightSubtitles:(e=!1,t)=>{switch(t.type){case"SET_HIGHLIGHT_SUBTITLES":return Lp("highlightSubtitles",!0,e,"SET_HIGHLIGHT_SUBTITLES"),!0;case"RESET_HIGHLIGHT_SUBTITLES":return Lp("highlightSubtitles",!1,e,"RESET_HIGHLIGHT_SUBTITLES"),!1;case"RESET_EDITOR":return!1;default:return e}},isLooped:(e=!1,t)=>{switch(t.type){case"MARK_AS_LOOPED":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},numLoops:(e=2,t)=>{switch(t.type){case"SET_NUM_LOOPS":return t.numLoops;case"RESET_EDITOR":return 2;default:return e}},isStudio:(e=!1,t)=>{switch(t.type){case"MARK_AS_STUDIO":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},seekInProgress:(e=!1,t)=>{switch(t.type){case"SET_SEEK_IN_PROGRESS":return!0;case"CLEAR_SEEK_IN_PROGRESS":return!1;default:return e}},...Jp,...Xp,...Qp,...ro,...YS,studio:(e=Bw(),t)=>{const a=Hw(e,t);if(e.allLayers&&e.allLayers.byId===a.allLayers.byId&&e.scenes[0].layers!==a.scenes[0].layers&&"BRING_LAYER_FORWARD"!==t.type&&"MOVE_LAYER_TO_INDEX"!==t.type&&"SEND_LAYER_BACK"!==t.type){const e={};for(const t of a.scenes[0].layers)e[t.id]=t;return s("Layer updates not propagating correctly.",{extra:{action:t}}),console.error("Layer updated withour updating studio.layers.byId!",t.type),{...a,allLayers:{byId:e}}}return a},paywall:(e={show:!1,options:null},t)=>{switch(t.type){case"SHOW_PAYWALL":return{show:!0,options:t.options};case"HIDE_PAYWALL":return{show:!1,options:null};default:return e}},workspaces:(e={allWorkspaces:[],workspaceMenuVisible:!1,showUploadDialog:!1,showDragUploadDialog:!1,selectedWorkspace:"",workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[],setSharedWorkspaceOwnerEmail:"",workspaceOwnerEmail:"",sharedWorkspaceId:"",selectionMode:!1,currentFolderSettings:{view:sy.GRID_VIEW,sortField:ly.DATE_CREATED,sortOrder:cy.ASCENDING},SWMFolderSettings:{view:sy.LIST_VIEW,sortField:ly.DATE_EDITED,sortOrder:cy.ASCENDING},showOnboardingUpsell:my.None,suggestedWorkspaces:{isQualifiedLead:!1,teams:[]}},t)=>{switch(t.type){case"SET_WORKSPACES":return{...e,allWorkspaces:t.workspaces};case"SET_CURRENT_WORKSPACE":return{...e,selectedWorkspace:t.workspaceId};case"UNSET_WORKSPACE_MENU":return{...e,workspaceMenuVisible:!1};case"SET_WORKSPACE_MENU":return{...e,workspaceMenuVisible:!0};case"REMOVE_WORKSPACE":{const a=c(e);return a.allWorkspaces=a.allWorkspaces.filter((e=>e._id!==t.workspaceId)),a.selectedWorkspace===t.workspaceId&&(a.selectedWorkspace=""),a}case"CHANGE_WORKSPACE_NAME":{const a=c(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(e.name=t.newName);return a}case"SET_CURRENT_FOLDER_SETTINGS":return{...e,currentFolderSettings:t.folderSettings};case"SET_SWM_FOLDER_SETTINGS":return{...e,SWMFolderSettings:t.folderSettings};case"UPDATE_WORKSPACE_RECENT_FONTS":{const a=c(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(e.recentlyUsedFonts=[...t.recentlyUsedFonts]);return a}case"UPDATE_WORKSPACE_CUSTOM_FONTS":{const a=c(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(Array.isArray(t.customFonts)?e.customFonts=t.customFonts:e.customFonts=[t.customFonts,...e.customFonts||[]]);return a}case"SIGN_OUT":return{allWorkspaces:[],workspaceMenuVisible:!1,showUploadDialog:!1,showDragUploadDialog:!1,workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[],selectedWorkspace:void 0,selectionMode:!1};case"SHOW_UPLOAD_DIALOG":return{...e,showUploadDialog:!0};case"HIDE_UPLOAD_DIALOG":return{...e,showUploadDialog:!1};case"SHOW_DRAG_UPLOAD_DIALOG":return{...e,showDragUploadDialog:!0};case"HIDE_DRAG_UPLOAD_DIALOG":return{...e,showDragUploadDialog:!1};case"ADD_WORKSPACE_UPLOAD_FILE":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.file.id]:t.file}};case"UPDATE_WORKSPACE_UPLOAD_FILE":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],...t.fileInfo}}};case"ADD_WORKSPACE_UPLOAD_PROJECT":return{...e,workspaceUploadProjects:[...e.workspaceUploadProjects,t.video]};case"SET_WORKSPACE_UPLOAD_STATUS":return{...e,workspaceUploadStatus:t.text};case"SET_FILE_UPLOAD_PROGRESS":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],uploadProgress:t.uploadProgress}}};case"MARK_UPLOAD_AS_CANCELLED":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],uploadCancelled:!0}}};case"MARK_UPLOAD_AS_CREATED":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],startedVideoCreation:!0}}};case"CLEAR_WORKSPACE_UPLOAD_FILES":return{...e,workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[]};case"REMOVE_WORKSPACE_UPLOAD_FILE":{const a={...e};return delete a.workspaceUploadFiles[t.fileId],a}case"REMOVE_WORKSPACE_UPLOAD_FILES":{const a={...e};return t.fileIds.forEach((e=>delete a.workspaceUploadFiles[e])),a}case"SET_SHARED_WORKSPACE_OWNER_EMAIL":return{...e,workspaceOwnerEmail:t.workspaceOwnerEmail};case"SET_SHARED_WORKSPACE_ID":return{...e,sharedWorkspaceId:t.sharedWorkspaceId};case"SET_SELECTION_MODE":return{...e,selectionMode:t.selectionMode};case"UPDATE_WORKSPACE_EA_BANNER":{const{workspaceId:a}=t,{allWorkspaces:o}=e,n=o.map((e=>e._id===a?{...e}:e));return{...e,allWorkspaces:n}}case"SET_SHOW_ONBOARDING_UPSELL":return{...e,showOnboardingUpsell:t.upsellType};case"SET_SUGGESTED_WORKSPACES":return{...e,suggestedWorkspaces:t.payload};default:return e}},previewVideo:(e=null,t)=>{switch(t.type){case"SET_PREVIEW_VIDEO":return t.video;case"RESET_EDITOR":return null;default:return e}},projectName:(e="",t)=>"SET_PROJECT_NAME"===t.type?t.projectName:e,teams:(e={allTeams:[],allInvites:[],selectedTeamId:"",sharedTeamId:"",sharedTeamOwnerEmail:"",activeBrandkit:{fonts:[],colors:[],cmlIds:[]},brandkitTemplates:[]},t)=>{switch(t.type){case"SET_CURRENT_TEAM":{const{_id:a}=t;return{...e,selectedTeamId:a}}case"SET_TEAMS":return{...e,allTeams:t.teams};case"SET_TEAMS_INVITES":return{...e,allInvites:t.invites};case"UPDATE_TEAM":return N(e,(a=>{const{id:o,updateDict:n}=t,r=(i=e.allTeams,s=o,i.findIndex((e=>e._id===s)));var i,s;const l={...e.allTeams[r],...n};a.allTeams[r]=l}));case"UPDATE_TEAM_NAME":return N(e,(e=>{for(const a of e.allTeams)a._id===t.id&&(a.name=t.name)}));case"SET_SHARED_TEAM_OWNER_EMAIL":return{...e,sharedTeamOwnerEmail:t.sharedTeamOwnerEmail};case"SET_SHARED_TEAM_ID":return{...e,teamOwnerEmail:t.sharedTeamId};case"SIGN_OUT":return{allTeams:[],selectedTeamId:""};case"SET_ACTIVE_BRANDKIT":{const{activeBrandkit:a}=e,{update:o}=t;return"function"==typeof o&&a?{...e,activeBrandkit:o(a)}:{...e,activeBrandkit:{...a,...o}}}case"SET_BRANDKIT_TEMPLATES":{const{projects:a}=t;return{...e,brandkitTemplates:a}}default:return e}},groupSidebarOpen:(e={},t)=>"TOGGLE_SIDEBAR"===t.type?{...e,[t.groupId]:!e[t.groupId]}:e,selectedTabs:JS.reducer,mediaLibrary:(e={})=>e,contextMenu:(e=null,t)=>{switch(t.type){case GS.SHOW_CONTEXT_MENU:return t.contextMenu;case GS.HIDE_CONTEXT_MENU:return null;default:return e}},studioLocal:aT,featureSupport:nT,projectSessionSettings:gi.reducer,sessionId:rT.reducer,sessionValues:hr.reducer,CMLFiles:th.reducer,assets:Fb.reducer,mediaCache:Kc.reducer,comments:dE.reducer,onboarding:(e={showOnboarding:!1},t)=>{switch(t.type){case"SET_SHOW_ONBOARDING":return{...e,showOnboarding:!0};case"SET_HIDE_ONBOARDING":return{...e,showOnboarding:!1};default:return e}},recordAudio:gT.reducer,assetTranscriptions:Lb.reducer,loadedFonts:Sr.reducer,activeEditors:fI,notifications:iT.reducer,projects:uT.reducer,checkoutStore:mp,hubModal:cr.reducer,theme:pp.reducer}),EI="undefined"!=typeof window;q(!1);const _I=function(){var e,t;if("undefined"!=typeof window)try{const a=Ob.get("state",{disabled:null});if(null===a)return;const o=a;if(!o)return o;const n=window.location.href,r=o.studio._id;r&&!n.includes(r)&&(o.studio=Bw());let i=!1;if(null==(e=o.studio)?void 0:e.localId){const e=Db(o.studio.localId);if(e){e.pendingOps=pi;for(const a of null!=(t=e.offlineOps)?t:[])pi.push(a);o.projectSessionSettings=e,i=!0}}o.projectSessionSettings&&i||(o.projectSessionSettings={...hi});const s=Ab(o.studio.projectVersion),l=Ab("0.6"),c=Cb(s,l);return function(e,t){if(!t.length)return e;for(const o of t)try{o.migrate(e),e.projectVersion=o.versionNumber}catch(a){return console.error(a),j(a,{extra:{__FORCE_SAMPLE:!0},tags:{migrationFailure:!0}}),e}}(o.studio,c),function(e){var t;(null==(t=null==e?void 0:e.allLayers)?void 0:t.byId)&&Object.values(e.allLayers.byId).forEach((e=>{delete e.local_url}))}(o.studio),o}catch(a){return void console.error(a)}}(),vI="object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionsDenylist:["SET_STUDIO_TIME"]}):J,wI=[ee],bI="This item has been redacted from logged state to reduce sentry request size",SI=X({stateTransformer:e=>({...e,assets:bI,CMLFiles:bI,ffmpegReducer:bI,mediaCache:bI})});globalThis.globalStore=globalThis.globalStore||Q(((e,t)=>{let a={...e};switch(t.type){case"RESET_STATE_PRESERVE_USER":case"RESET_STUDIO":a={config:a.config,currentUser:a.currentUser,toasts:a.toasts,workspaces:a.workspaces,teams:a.teams,templates:a.templates,featureSupport:a.featureSupport,mediaCache:a.mediaCache,sessionId:a.sessionId,sessionValues:a.sessionValues,CMLFiles:a.CMLFiles,assets:a.assets,comments:a.comments,onboarding:a.onboarding,notifications:a.notifications,projects:a.projects,loadedFonts:a.loadedFonts};break;case"UPDATE_ENTIRE_STATE":Object.assign(a,t.newStateProperties);break;case"JEST_CLEAR_STORE":a=yI(void 0,t),a.isStudio=!0}const o=yI(a,t);return EI&&(window.state=o,window.scene=o.studio.scenes[o.studio.selectedSceneIndex]),o}),_I,vI(Z(...wI),SI));const TI=globalThis.globalStore,II="CMLDragPreview-module_item_uOVCl",kI=()=>{const{isDragging:e,item:t,sourceClientOffset:a,clientOffset:o}=te((e=>({isDragging:e.isDragging(),item:e.getItem(),sourceClientOffset:e.getSourceClientOffset(),clientOffset:e.getClientOffset()}))),{inTrackpadOrCanvas:r}=cn((e=>({inTrackpadOrCanvas:!!e.studioLocal.mediaItemDropLocation})),i.exports.shallowEqual),s=i.exports.useDispatch();return n.exports.useEffect((()=>{e||s(Zs(null))}),[e,s]),t&&e&&!r?m.createElement("div",{style:function(){if(!a)return{display:"none"};const e={left:a.x,top:a.y,width:120,height:100};switch(t.type){case Os.CML_FILE:t.thumbnailUrl&&(e.backgroundImage=`url(${t.thumbnailUrl})`);break;case Os.UPLOADING_LAYER:break;case Os.TRANSITION_TILE:o&&(e.left=o.x-60,e.top=o.y-50,e.width=60,e.height=50,e.backgroundImage=t.isCrossTransition?"url(https://cdn-useast1.kapwing.com/static/Fyi-crossTransitionIcon.png)":"url(https://cdn-useast1.kapwing.com/static/hjX-singleVideoTransitionIcon.png)");break;case Os.SIDEBAR_IMAGE:{const{url:a,imageRef:o}=t.image,n=null==o?void 0:o.current;if(a&&(e.backgroundImage=`url(${a})`),n){const t=n.getBoundingClientRect();e.width=t.width,e.height=t.height}break}case Os.SIDEBAR_VIDEO:{const{thumbnailUrl:a,videoRef:o}=t.video,n=null==o?void 0:o.current;if(a&&(e.backgroundImage=`url(${a})`),n){const t=n.getBoundingClientRect();e.width=t.width,e.height=t.height}break}}return e}(),className:II}):null},CI={loading:"loading",apiLoading:{}},NI=(e,t)=>{switch(t.type){case"UPDATE_GAPI_LOADING":return{...e,loading:t.loadingState};case"UPDATE_GAPI_API_LOADING":return{...e,apiLoading:{...e.apiLoading,[t.api]:t.loadingState}};default:return e}},AI=n.exports.createContext({state:CI,requestAPI:()=>{}}),xI=({children:e})=>{const[t,a]=n.exports.useState([]),[o,r]=n.exports.useReducer(NI,CI),i="loaded"===o.loading;n.exports.useEffect((function(){ae(PI,(e=>{r(e?{type:"UPDATE_GAPI_LOADING",loadingState:"error"}:{type:"UPDATE_GAPI_LOADING",loadingState:"loaded"})}))}),[]),n.exports.useEffect((function(){if(i)for(const e of t){o.apiLoading[e]||(r({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loading"}),gapi.load(e,(()=>{"client"===e&&(gapi.client.load("photoslibrary","v1"),gapi.client.load("oauth2","v2")),r({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loaded"})})))}}),[i,o.apiLoading,t]);const s=n.exports.useCallback((e=>{a((t=>t.includes(e)?t:[...t,e]))}),[]),l=n.exports.useMemo((()=>({state:o,requestAPI:s})),[o,s]);return m.createElement(AI.Provider,{value:l},e)},PI="https://apis.google.com/js/api.js";function RI(e){const{requestAPI:t,state:a}=n.exports.useContext(AI),o="error"===a.loading,r=!o&&("loaded"!==a.loading||"loaded"!==a.apiLoading[e]);return n.exports.useEffect((()=>{t(e)}),[e,t]),{loading:r,error:o}}const OI=n.exports.createContext({signIn:async(e,t)=>{},signOut:()=>{},wrapGAPICall:(e,t)=>e(),getUserinfo:async()=>null,email:""}),DI=({children:e})=>{const t=RI("client"),{client_id:a}=cn((e=>({client_id:e.config.GOOGLE_PLUGINS_CLIENT_ID})),dn),[o,r]=n.exports.useState(Ob.get("gisEmailHint",{disabled:""})||""),[i,s]=n.exports.useState(Ob.get("gapiAccessToken",{disabled:""})||"");n.exports.useEffect((function(){ae("https://accounts.google.com/gsi/client",(e=>{e&&console.error(e)}))}),[]);const l=n.exports.useCallback((async(e,o)=>{if(t.error||t.loading)return;await new Promise(((t,n)=>{window.google.accounts.oauth2.initTokenClient({client_id:a,scope:`email ${e}`,hint:o,prompt:"",callback:e=>{void 0!==e.error&&n(e),t(e)}}).requestAccessToken()}));const n=gapi.client.getToken().access_token;Ob.set("gapiAccessToken",n),s(n);try{const{result:{email:e}}=await gapi.client.request({path:"https://www.googleapis.com/oauth2/v3/userinfo",method:"GET"});Ob.set("gisEmailHint",e),r(e)}catch($ae){console.error("Attempt to set email hint failed unexpectedly:",$ae)}}),[a,t.error,t.loading]),c=n.exports.useCallback((()=>{Ob.remove("gisEmailHint"),Ob.remove("gapiAccessToken"),r("")}),[]),d=n.exports.useCallback((async function(e,a){var n;if(t.error||t.loading)return e();if(null==(n=gapi.client.getToken())?void 0:n.access_token)try{return await e()}catch($ae){if(401!==$ae.status)throw Error("Unexpected error from GAPI encountered:",$ae)}if(i)try{return gapi.client.setToken({access_token:i}),await e()}catch($ae){if(401!==$ae.status)throw Error("Unexpected error from GAPI encountered:",$ae)}return await l(a,o),e()}),[l,o,t.error,t.loading,i]),u=n.exports.useCallback((()=>d((async()=>await new Promise((e=>gapi.client.oauth2.userinfo.get().execute((({result:t})=>e(t)))))),"https://www.googleapis.com/auth/userinfo.profile")),[d]),p=n.exports.useMemo((()=>({signIn:l,signOut:c,wrapGAPICall:d,getUserinfo:u,email:o})),[l,c,d,u,o]);return m.createElement(OI.Provider,{value:p},e)};function LI(){const{signIn:e,signOut:t,wrapGAPICall:a,getUserinfo:o,email:r}=n.exports.useContext(OI);return{signIn:e,signOut:t,wrapGAPICall:a,getUserinfo:o,email:r}}window.clearEmailHint=()=>{localStorage.removeItem("gisEmailHint")},window.clearAccessToken=()=>{localStorage.removeItem("gapiAccessToken")};const UI="Switch-module_switch_GQQ33",MI="Switch-module_vertical_0vB47",FI="Switch-module_slider_lr-uK",BI="Switch-module_sliderVertical_--vRf",WI="Switch-module_icon_-cd-T",VI="Switch-module_disabledOption_bpP2R",jI=({toggled:e=!1,onChange:t=(()=>null),disabled:a=!1,vertical:o=!1,IconComponent:r=null,iconColor:i="black",backgroundColor:s,sliderColor:l="#101010",...c})=>{const[d,u]=n.exports.useState(e);n.exports.useEffect((()=>{u(e)}),[e]);const p={marginLeft:3,marginTop:4};return d||(o?p.marginTop=24:p.marginLeft=24),m.createElement("label",{...c,className:`\n        ${UI} \n        ${a?VI:""}\n        ${o?MI:""}    \n      `},m.createElement("input",{type:"checkbox",checked:d,onChange:e=>{u(e.target.checked),t&&t(!!e.target.checked)},disabled:a}),m.createElement("span",{className:o?BI:FI,style:{backgroundColor:s,"--sliderColor":l}}),!!r&&m.createElement(r,{className:WI,style:p,color:i,size:12}))},HI=m.createContext({darkMode:!1,toggleDarkMode:()=>null}),GI=({children:e})=>{const t=oe(),a=i.exports.useDispatch(),{_darkMode:o,user:r}=cn((e=>{var t;return{_darkMode:!!(null==(t=e.theme)?void 0:t.darkMode),user:e.currentUser.user}}),dn),[s,l]=m.useState(!!o);n.exports.useEffect((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");if(!(null==e?void 0:e.addEventListener))return()=>{};Sf(r._id,e.matches);const t=e=>{l(e.matches),Sf(r._id,e.matches)};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}),[r]),n.exports.useEffect((()=>{var e;const a=s&&!(e=>{const t=["/explore","/studio","/templates","/admin","/videos"];for(let a=0;a<t.length;a+=1)if(e.includes(t[a]))return!0;return!1})(t.pathname);null==(e=document.querySelector("body"))||e.setAttribute("data-theme",a?"dark":"light")}),[s,t.pathname]),n.exports.useEffect((()=>{o!==s&&a(hp(s))}),[o,s,a]);const c=n.exports.useCallback((()=>{l(!s),((e,t)=>{amplitude.getInstance().setUserId(e),amplitude.getInstance().setUserProperties({toggledDarkMode:t})})(r._id,!s)}),[r,s]),d=n.exports.useMemo((()=>({darkMode:s,toggleDarkMode:c})),[s,c]);return m.createElement(HI.Provider,{value:d},e)},$I=({vertical:e,darkColorsOnly:t})=>{const{darkMode:a,toggleDarkMode:o}=m.useContext(HI);return m.createElement(jI,{"data-cy":"theme-switch",toggled:a,onChange:o,vertical:e,IconComponent:a?ne:re,iconColor:a?"#ebf6ff":"#ffe899",backgroundColor:a||t?"#606060":"#e0e0e0",sliderColor:a||t?"#101010":"white"})},KI="ErrorBoundary-module_errorText_G7zgY";let YI=!1;class zI extends m.Component{static getDerivedStateFromError(){return{hasError:!0}}constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){console.error(e,t);const a=qI(e);if(YI||(fm("Error Boundary",{Error:a,"Full Refresh":this.props.refreshOnError}),function(e,t){const a={__FORCE_SAMPLE:!0,errorInfo:t};try{let o="Unknown";try{o=e.constructor.name}catch{o="Unknown "+typeof e}a.errorClassName=o;const{componentStack:n}=t||{};!JI(e.stack)&&JI(n)&&(a.originalStack=e.stack,e.stack=n)}catch(o){console.error(o)}j(e,{extra:a,tags:{errorBoundary:!0}})}(e,t),YI=!0),!this.props.refreshOnError)return;const o=new URLSearchParams(window.location.search);o.get("refresh")||(o.set("refresh","true"),window.location.search=o.toString())}render(){return this.state.hasError?this.props.refreshOnError?null:m.createElement("div",{className:KI},"An unexpected error occurred loading this section. Please try refreshing the page."):this.props.children}}function qI(e){var t;const a="object"==typeof e;let o=e.toString();if(null==(t=o.startsWith)?void 0:t.call(o,"[")){a&&"message"in e&&(o=e.message);const t=a&&e.constructor?e.constructor.name:"";t&&(o=`${t}: ${o}`)}return o}function JI(e){if("string"!=typeof e)return!1;return e.split("\n").filter((e=>e.includes("at ")&&e.includes("/assets/"))).some((e=>{const t=e.match(/\/assets\/(?!vendor).*\..*\.js/);return t&&t.length>0}))}class XI extends n.exports.Component{componentDidUpdate(e){this.props.location!==e.location&&window.scrollTo(0,0)}render(){return this.props.children}}const QI=ie(XI),ZI="Loading-module_loader_-f6I0",ek="Loading-module_loading-wrapper_-mT3i",tk="Loading-module_loading-description_Oh1HH",ak="Loading-module_full-screen-loading-description_BXaJ-",ok="Loading-module_loading-secondary_5AM-p",nk="Loading-module_loading-wrapper-full-screen_0cfsY",rk="Loading-module_loading-wrapper-full-screen-gray_nyq-0",ik=({gray:e=!1,title:t})=>m.createElement("div",{className:e?rk:nk},m.createElement("div",{className:ZI}),m.createElement("div",{className:ak,"data-cy":"loading-full-screen"},t||"Loading...")),sk={},lk={fallback:m.createElement(ik,{gray:!0,title:"Loading Kapwing..."})},ck=se((()=>Eb((()=>import("./Team.d3d402ef.js")),["assets/Team.d3d402ef.js","assets/vendor.6b80416b.js","assets/react-select.browser.esm.1050e726.js","assets/memoize-one.esm.7a54f149.js","assets/Navbar.68e9f160.js","assets/WorkspaceMobileMenu.4cc72803.js","assets/WorkspaceMobileMenu.15976684.css","assets/Navbar.4581d767.css","assets/Team.0bbaf30c.css"])),sk),dk=se((()=>Eb((()=>import("./Settings.4d72da33.js")),["assets/Settings.4d72da33.js","assets/vendor.6b80416b.js","assets/Settings.7b625cf6.css"])),sk),uk=se((()=>Eb((()=>import("./TemplateEditorContainer.7b0d6916.js")),["assets/TemplateEditorContainer.7b0d6916.js","assets/vendor.6b80416b.js"])),lk),mk=se((()=>Eb((()=>import("./Folder.e40a065a.js")),["assets/Folder.e40a065a.js","assets/vendor.6b80416b.js","assets/FolderMembersOverlay.module.0f65f9d8.js","assets/EllipsesAnimation.f83d9a2f.js","assets/EllipsesAnimation.b9e323fb.css","assets/FolderMembersOverlay.d45f56cc.css","assets/react-select.browser.esm.1050e726.js","assets/memoize-one.esm.7a54f149.js","assets/WorkspaceMobileMenu.4cc72803.js","assets/WorkspaceMobileMenu.15976684.css","assets/videos.101487e9.js","assets/videos.0f6bc57e.css","assets/Folder.ff2c81e0.css"])),sk),pk=se((()=>Eb((()=>import("./BrandkitEditor.782d4e2e.js")),["assets/BrandkitEditor.782d4e2e.js","assets/vendor.6b80416b.js","assets/videos.101487e9.js","assets/videos.0f6bc57e.css","assets/Navbar.68e9f160.js","assets/WorkspaceMobileMenu.4cc72803.js","assets/WorkspaceMobileMenu.15976684.css","assets/Navbar.4581d767.css","assets/CloudMediaLibraryTile.1462c8fa.js","assets/memoize-one.esm.7a54f149.js","assets/EllipsesAnimation.f83d9a2f.js","assets/EllipsesAnimation.b9e323fb.css","assets/CloudMediaLibraryTile.47b25867.css","assets/FontSelector.391972f6.js","assets/FontSelector.1ba1a03a.css","assets/BrandkitEditor.2aaa54ee.css"])),sk),hk=se((()=>Eb((()=>import("./Editor.07cdfe09.js")),["assets/Editor.07cdfe09.js","assets/vendor.6b80416b.js","assets/workspace.29ad5080.js","assets/react-select.browser.esm.1050e726.js","assets/memoize-one.esm.7a54f149.js","assets/CloudMediaLibraryTile.1462c8fa.js","assets/EllipsesAnimation.f83d9a2f.js","assets/EllipsesAnimation.b9e323fb.css","assets/CloudMediaLibraryTile.47b25867.css","assets/FolderMembersOverlay.module.0f65f9d8.js","assets/FolderMembersOverlay.d45f56cc.css","assets/throttle.f4b43e6e.js","assets/workspace.b3a8bf99.css","assets/Editor.44e6878a.css"])),lk),gk=se((()=>Eb((()=>import("./StudioEditor.2e98ae5b.js")),["assets/StudioEditor.2e98ae5b.js","assets/vendor.6b80416b.js","assets/workspace.29ad5080.js","assets/react-select.browser.esm.1050e726.js","assets/memoize-one.esm.7a54f149.js","assets/CloudMediaLibraryTile.1462c8fa.js","assets/EllipsesAnimation.f83d9a2f.js","assets/EllipsesAnimation.b9e323fb.css","assets/CloudMediaLibraryTile.47b25867.css","assets/FolderMembersOverlay.module.0f65f9d8.js","assets/FolderMembersOverlay.d45f56cc.css","assets/throttle.f4b43e6e.js","assets/workspace.b3a8bf99.css","assets/Text.2e0533ab.js","assets/Text.95b003f6.css","assets/FontSelector.391972f6.js","assets/FontSelector.1ba1a03a.css","assets/index.7fd267f4.js","assets/StudioEditor.a7a858fe.css"])),lk),fk=se((()=>Eb((()=>import("./AdminContainer.052f34b2.js")),["assets/AdminContainer.052f34b2.js","assets/vendor.6b80416b.js","assets/AdminOnly.20fc16a4.js","assets/AdminContainer.bf1acfdb.css"])),sk),yk=se((()=>Eb((()=>Promise.resolve().then((()=>aae))),void 0)),sk),Ek=se((()=>Eb((()=>Promise.resolve().then((()=>bb))),void 0)),sk),_k=se((()=>Eb((()=>import("./DebugContainer.12302382.js")),["assets/DebugContainer.12302382.js","assets/vendor.6b80416b.js","assets/AdminOnly.20fc16a4.js","assets/index.7fd267f4.js","assets/DebugContainer.695aebe3.css"])),sk);var vk=(e=>(e.account="account",e.accountChange="account/change",e))(vk||{});const wk=()=>{var e;if("undefined"!=typeof window)try{const t=(()=>{const e=TI.getState(),t={...e.studio,topFontsLoaded:!1},a={...e.workspaces,showUploadDialog:!1,showDragUploadDialog:!1},{activeBrandkit:o,...n}=e.teams;return{teams:n,workspaces:a,sourceVideo:e.sourceVideo,currentUser:{user:e.currentUser.user,token:e.currentUser.token,impersonatingAdminEmail:e.currentUser.impersonatingAdminEmail},currentVideo:e.currentVideo,privacy:e.privacy,duration:e.duration,resizeTemplate:e.resizeTemplate,resizeBackground:e.resizeBackground,startTime:e.startTime,endTime:e.endTime,editorPath:e.editorPath,isTranscribed:e.isTranscribed,transcriptionId:e.transcriptionId,finishedTranscribingAt:e.finishedTranscribingAt,subtitles:e.subtitles,subtitlesBackgroundColor:e.subtitlesBackgroundColor,subtitlesBackgroundStyle:e.subtitlesBackgroundStyle,subtitlesColor:e.subtitlesColor,subtitlesPosition:e.subtitlesPosition,subtitlesSize:e.subtitlesSize,translate:e.translate,translateLanguageCode:e.translateLanguageCode,isLooped:e.isLooped,numLoops:e.numLoops,watermarkText:e.watermarkText,watermarkPos:e.watermarkPos,watermarkFont:e.watermarkFont,watermarkColor:e.watermarkColor,withCustomWatermark:e.withCustomWatermark,watermarkImg:e.watermarkImg,filter:e.filter,contrast:e.contrast,saturation:e.saturation,brightness:e.brightness,vignette:e.vignette,opacity:e.opacity,paywall:{show:!1},isStudio:e.isStudio,studio:t,projectSessionSettings:e.projectSessionSettings,sessionId:e.sessionId,sessionValues:e.sessionValues,mediaCache:e.mediaCache,theme:e.theme}})();if(Ob.set("state",function(e){var t;delete e.studio.sharedDoc;const a=[];for(const n of e.studio.scenes){const e=c(n.layers);for(const t of e)delete t.base64_img,delete t.file,delete t.framesAndTimes,delete t.waveformData,delete t.optimizedPreviewFile,delete t.local_url;a.push({...n,layers:e})}let o={};return(null==(t=e.studio.allLayers)?void 0:t.byId)&&(o=c(e.studio.allLayers.byId),Object.values(o).forEach((e=>{delete e.local_url}))),{...e,studio:{...e.studio,allLayers:{byId:o},scenes:a}}}(t)),(null==(e=t.studio)?void 0:e.localId)&&t.projectSessionSettings){const e=`session_${t.studio.localId}`,a={...t.projectSessionSettings};null==t.projectSessionSettings.pendingOps?(console.error("Missing pending ops"),s("Missing pending ops")):a.offlineOps=t.projectSessionSettings.pendingOps.getAllPendingOps(),Ob.set(e,a)}}catch(t){console.error(t)}};const bk=({loaderStyles:e,secondaryText:t,text:a,textOnly:o=!1,textStyles:n,wrapperStyles:r})=>{let i="Loading ...";return null!=a&&(i=a),m.createElement("div",{className:ek,"data-cy":"loading-container","data-testid":"loading-container",style:r},!o&&m.createElement("div",{className:ZI,style:e}),m.createElement("div",null,m.createElement("div",{className:tk,style:n},i),t&&m.createElement("div",{className:ok,style:n},t)))},Sk="SignInButtons-module_resetContainer_-J8T0",Tk="SignInButtons-module_resetButtonContainer_k7B-5",Ik="SignInButtons-module_resetButton_Ga7Z0",kk="SignInButtons-module_googleIcon_KLAsx",Ck="SignInButtons-module_orText_fLjgk",Nk=e=>{const{dispatch:t}=io();t(wh(e))},Ak=e=>{const{dispatch:t}=io();t(Sh(e))},xk=()=>{const{dispatch:e}=io();e({type:"SHOW_VIEW_ONLY_MODE_TOAST"})};class Pk extends Error{constructor(e){super(e),this.name="ExtractValidationError"}}class Rk extends Error{constructor(e){super(),this.name="GetMediaInfoError",this.message=e}}const Ok=Eb((()=>import("./index.b391a78f.js").then((e=>e.i))),[]),Dk=()=>{};function Lk(e){let t="";const a=e.byteLength;for(let o=0;o<a;o+=1)t+=String.fromCharCode(e.getUint8(o));return`data:image/jpeg;base64,${window.btoa(t)}`}function Uk(e,t){let a=e;return e.indexOf(t)>-1&&(a=e.substring(0,e.indexOf(t)+t.length)),a}function Mk(e=""){return e?e.includes("youtube")||e.includes("youtu.be")?"youtube":e.includes("kapwing")||e.includes("kapwi.ng")?"kapwing":e.includes("tiktok")?"tiktok":e.includes("instagram")?"instagram":e.includes("twitter")?"twitter":e.includes("twitch")?"twitch":e.includes("vimeo")?"vimeo":e.includes("pinterest")?"pinterest":e.includes("dropbox")?"dropbox":e.includes("drive.google.com")?"google-drive":null:null}async function Fk(e){const t=await(async e=>await op("/api/v1/tiktokextract/tiktokurl",{body:{url:e}}))(e);return t.url}async function Bk({url:e,excludedMimes:t=[],analyticsCallback:a=Dk,doDuplicateHandling:o=!1}){let n=function(e){if(!e)return"";let t=e.trim();if(e.length>2e3)return;const a=[".jpeg",".jpg",".png",".gif",".mp4"];for(let o=0;o<a.length;o+=1)t=Uk(t,a[o]);return t}(e);const r=Mk(n);r&&a({platform:r}),Math.random()<.1&&fm("Extract Video Begins",{url:n,platform:r});try{let e="";try{e=await ip("extract",{body:{url:n,doDuplicateHandling:o},timeout:6e4})}catch(i){if((null==n?void 0:n.includes("tiktok"))&&!(null==n?void 0:n.includes("tiktokcdn"))){n=await Fk(n),e=await ip("extract",{body:{url:n,doDuplicateHandling:o},timeout:6e4})}}if(""!==e)return a({isDirectLink:e.isDirectLink,mimeType:e.mime,fileType:e.ext,stage:Ns.ExtractionValidation}),function(e,t){let a="";if(e.hasUploadedAssetDuplicate)return e;if(e.url?e.duration&&e.duration>10800?a="Videos from a link must be shorter than 3 hours.":e.mime&&(t||[]).length&&t.includes(e.mime)?a=`Format ${e.mime} currently unsupported.`:e.url&&e.url.includes("accounts.google.com/Captcha")&&(a="Content is not supported"):a="No content found for this URL.",a)throw new Pk(a)}(e,t),e;throw new Pk("extraction failed")}catch(i){const e=i.name||"ExtractError";throw fm("Extract Video Fails",{...i,url:n,name:e,platform:r,message:i.message||""}),i}}function Wk(e){const t=new Promise(((t,a)=>{const o=new FileReader;o.readAsText(e),o.onload=()=>{o.result?t(-1!==o.result.indexOf("ANMF")?"animated":"static"):a(new Error("Reader result was empty"))},o.onerror=e=>a(e)})),a=new Promise((e=>{setTimeout((()=>{console.error("Failed to load webp within timeout, defaulting to static"),e("static")}),1e4)}));return Promise.race([t,a])}function Vk(e,t){const a=function(e){const[t,a]=e.split(","),o=t.indexOf("base64")>-1?atob(a):unescape(a),n=t.split(":")[1].split(";")[0],r=new Uint8Array(o.length);for(let i=0;i<o.length;i+=1)r[i]=o.charCodeAt(i);return new Blob([r],{type:n})}(t);return new File([a],e.name||"",{type:a.type})}async function jk(e){var t;let a,o,n;"undefined"!=typeof window&&(a=await Eb((()=>import("./index.9f472170.js")),["assets/index.9f472170.js","assets/vendor.6b80416b.js"]));const r=Od(e);if(a&&r&&(n=await a.getAsset(r)),n&&"video"!==n.type&&!n.isOptimizedPreview)o=n.file;else if(n&&"video"===n.type&&(n.file_v2||n.file))o=n.file_v2.file||n.file;else{const a=k_(e,"url","original"),n=await fetch(a),r=await n.blob();o=new File([r],e.name||"",{type:null!=(t=e.mime)?t:void 0})}o.id=y(),o.local_url=URL.createObjectURL(o);return{file:o,fileData:{id:e.id,local_url:o.local_url}}}const Hk=async(e,t,a)=>{try{const{orientation:o,stripped:n}=await function(e){return new Promise(((t,a)=>{const o=new FileReader;o.onload=e=>{var a;const o=new DataView(null==(a=e.target)?void 0:a.result);if(65496!==o.getUint16(0,!1))return t({orientation:null});const n=o.byteLength;let r=2;for(;r<n;){if(o.getUint16(r+2,!1)<=8)return t({orientation:null});const e=o.getUint16(r,!1);if(r+=2,65505===e){if(1165519206!==o.getUint32(r+=2,!1))return t({orientation:null});const e=18761===o.getUint16(r+=6,!1);r+=o.getUint32(r+4,e);const a=o.getUint16(r,e);r+=2;for(let n=0;n<a;n+=1)if(274===o.getUint16(r+12*n,e)){const a=o.getUint16(r+12*n+8,e);return o.setUint16(r+12*n+8,0,e),t({orientation:a,stripped:Lk(o)})}}else{if(65280!=(65280&e))break;r+=o.getUint16(r,!1)}}return t({orientation:null})},o.addEventListener("error",(e=>{a(e)})),o.readAsArrayBuffer(e)}))}(e);return o?(t&&t("Processing content ..."),function(e,t,a,o){return new Promise((n=>{const r=new Image;r.onerror=()=>{o("Something went wrong. Please make sure your media is a compatible format.",e,"cleanUpImage")},r.onload=()=>{const{width:t}=r,{height:i}=r,s=document.createElement("canvas"),l=s.getContext("2d");if(l){switch(a>4&&a<9?(s.width=i,s.height=t):(s.width=t,s.height=i),a){case 2:l.transform(-1,0,0,1,t,0);break;case 3:l.transform(-1,0,0,-1,t,i);break;case 4:l.transform(1,0,0,-1,0,i);break;case 5:l.transform(0,1,1,0,0,0);break;case 6:l.transform(0,1,-1,0,i,0);break;case 7:l.transform(0,-1,-1,0,i,t);break;case 8:l.transform(0,-1,1,0,0,t)}l.drawImage(r,0,0),n(Vk(e,s.toDataURL("image/jpeg")))}else o("No ctx",e,"cleanUpImage")},r.src=t||""}))}(e,n,o,a)):e}catch($ae){return e}};function Gk(e=""){const t=e.split(".").pop();return t?t.split("?").shift():e}function $k(e,t){const a=e&&Gk(e);return"m3u8"===a?"hls-to-mp4":"3gp"===a||"video/3gpp"===t?"3gp-to-mp4":"mov"===a||"video/quicktime"===t?"mov-to-mp4":"mp4"===a||"video/mp4"===t?"mp4-to-mp4":"avi"===a||["video/avi","video/x-msvideo"].includes(t)?"avi-to-mp4":"flv"===a||"video/x-flv"===t?"flv-to-mp4":"wmv"===a||"video/x-ms-wmv"===t?"wmv-to-mp4":"m4a"===a||"audio/x-m4a"===t?"m4a-to-mp3":"mp3"===a||"audio/mpeg"===t?"mp3-to-mp3":"heic"===a||"image/heic"===t?"heic-to-jpeg":"heif"===a||"image/heif"===t?"heif-to-jpeg":"none"}function Kk(e){var t;const{name:a,type:o}=e;if(o)return o;switch(a?(null==(t=a.split(".").pop())?void 0:t.toLowerCase())||"":void 0){case"mkv":return"video/x-matroska";case"ttf":return"font/ttf";case"otf":return"font/otf";default:return null}}function Yk(e){return"mpd"===e.split(".").pop()}function zk(e){return["image/gif","image/jpg","image/jpeg","image/png","image/heic","image/heif","image/svg+xml","image/webp"].includes(e)}function qk(e,t=null){const a=["video/mp4","video/quicktime","video/webm","video/mpeg","video/ogg","video/3gpp","video/avi","video/x-ms-wmv","video/x-flv","video/x-matroska","video/x-msvideo","video"];return t&&a.push(...t),a.includes(e)}const Jk=e=>new Promise((t=>setTimeout((()=>t()),e))),Xk=async(e,t)=>(await(On()||Ln()?Jk(10):Jk(0)),new Promise((a=>{const o=document.createElement("video");o.preload="auto",o.src=e,(On()||Ln())&&(o.volume=0,o.muted=!0,o.autoplay=!0,o.pause());let n=null,r=null;const i=()=>{n&&r&&a({success:!0,properties:{...n,...r}})};o.onerror=n=>{a({success:!1,properties:{type:xr.Video},errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"string"==typeof n?n:n.type,htmlVideoError:o.error&&qI(o.error),htmlVideoErrorCode:o.error instanceof MediaError?o.error.code:0},errorEvent:n})},o.addEventListener("durationchange",(()=>{o.duration!==1/0?(r=Zk(o,t),i()):(console.error("getVideoInfo returned Infinity duration"),a({success:!1,properties:{type:xr.Video},errorEvent:"Infinite duration",errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"Infinite duration",htmlVideoError:o.error&&qI(o.error),htmlVideoErrorCode:o.error instanceof MediaError?o.error.code:0}}))})),Qk(o).then((e=>{n={hasAudio:e},i()}))}))),Qk=e=>new Promise((t=>{const a=On()||Ln()?"canplay":"loadeddata",o=()=>e.mozHasAudio||(e.audioTracks||[]).length>0||e.webkitAudioDecodedByteCount>0;e.readyState>1?t(o()):e.addEventListener(a,(()=>t(o())),{once:!0})})),Zk=(e,t)=>{let a=t.includes("audio")?xr.Audio:xr.Video;return(t.includes("/webm")||t.includes("/mpeg"))&&(e.videoHeight||e.videoWidth||(a=xr.Audio)),{duration:e.duration,height:e.videoHeight,type:a,width:e.videoWidth}};function eC(e,t,a){return new Promise((o=>{const n=new Image;n.onload=()=>{o({success:!0,properties:{height:n.height,type:xr.Image,width:n.width,...a&&{webpType:a}}})},n.onerror=a=>{o({success:!1,properties:{type:xr.Image},errorInfo:{fileType:t,mediaType:"image",url:e,htmlImageFailureEvent:"string"==typeof a?a:a.type}})},n.src=e}))}const tC=e=>e.split("?")[0],aC=[{mime:"audio/x-m4a",type:xr.Audio}];async function oC(e,t){fm("getMediaInfo Started");const a=Kk(t||{name:tC(e)})||"",o=qk(a),n=zk(a),r=le(e),i=!o&&(n||r);if(!i&&!o){const[o,n]=await Promise.all([eC(e,a),Xk(e,a)]);if(n.success)return n.properties;if(o.success)return o.properties;let r,i;if("size"in t){if([r,i]=await Promise.all([rC(t),nC(t)]),r.success)return r.properties;if(i.success)return i.properties}console.info("Failed to load unclear media type",n.errorInfo,o.errorInfo),sC({imageResErrorInfo:o.errorInfo,videoResErrorInfo:n.errorInfo,imageWasmRes:r,videoWasmRes:i,fileType:a,src:e});const s=aC.find((e=>e.mime===a));return s?{type:s.type}:null}if(i){let o;try{o=await Wk(t)}catch($ae){}const n=await eC(e,a,o);let r;if(!n.success){if("size"in t&&o&&(r=await rC(t,o),r.success))return r.properties;console.info("Failed to image video info",n.errorInfo),sC({imageResErrorInfo:n.errorInfo,imageWasmRes:r,fileType:a,src:e,layerType:xr.Image})}return n.properties}const s=await Xk(e,a);if("duration"in s.properties){const{duration:e}=s.properties;if(Number.isNaN(e)||e>43200)throw Error("Asset has invalid duration")}if(!s.success){let o;if("size"in t&&(o=await nC(t),o.success))return o.properties;const n=(null==o?void 0:o.properties.type)||xr.Video;console.info("Failed to load video info",s.errorInfo),sC({videoResErrorInfo:s.errorInfo,videoWasmRes:o,fileType:a,src:e,layerType:n})}return s.properties}async function nC(e){const t=await iC(e),a={hasAudio:!1};for(const o of t.media.track)"General"===o["@type"]?a.duration=parseFloat(o.Duration):"Video"===o["@type"]?(a.type=xr.Video,a.width=parseFloat(o.Width),a.height=parseFloat(o.Height)):"Audio"===o["@type"]&&(a.hasAudio=!0);return!a.type&&a.hasAudio&&(a.type=xr.Audio,a.height=0,a.width=0),a.duration&&a.type===xr.Audio&&a.hasAudio||a.duration&&a.type&&a.height&&a.width&&a.type===xr.Video?(a.didFailHtmlMediaCheck=!0,{success:!0,properties:a}):{success:!1,properties:{type:a.type}}}async function rC(e,t){const a=await iC(e),o={};o.webpType=t||await Wk(e);for(const n of a.media.track)"Image"===n["@type"]&&(o.type=xr.Image,o.width=parseFloat(n.Width),o.height=parseFloat(n.Height));return o.type&&o.height&&o.width&&o.webpType?(o.didFailHtmlMediaCheck=!0,{success:!0,properties:o}):{success:!1,properties:{type:o.type}}}async function iC(e){const t=await ce({format:"JSON",locateFile:()=>"/MediaInfoModule.wasm"});return JSON.parse(await t.analyzeData((()=>e.size),((t,a)=>new Promise(((o,n)=>{const r=new FileReader;r.onload=e=>{var t;(null==(t=e.target)?void 0:t.error)&&n(e.target.error),e.target&&e.target.result&&o(new Uint8Array(e.target.result)),n()},r.readAsArrayBuffer(e.slice(a,a+t))})))))}function sC({imageResErrorInfo:e,videoResErrorInfo:t,imageWasmRes:a,videoWasmRes:o,fileType:n,src:r,layerType:i}){const s=i||(null==a?void 0:a.properties.type)||(null==o?void 0:o.properties.type)||"unclear",l=!!a||!!o;j(new Rk("getMediaInfo failure"),{extra:{__FORCE_SAMPLE:!0,src:r},tags:{isFile:l,mediaType:s}}),fm("getMediaInfo failure",{fileType:n,mediaType:s,url:r,htmlImageFailureEvent:null==e?void 0:e.htmlImageFailureEvent,htmlVideoFailureEvent:null==t?void 0:t.htmlVideoFailureEvent,htmlVideoError:null==t?void 0:t.htmlVideoError,htmlVideoErrorCode:null==t?void 0:t.htmlVideoErrorCode,isFile:l})}const lC=["video/3gpp","video/avi","video/x-flv","video/x-ms-wmv","video/x-msvideo","audio/x-m4a","image/heif","image/heic"],cC=["m3u8","3gp","3gpp","mov","avi","flv","wmv","heic","heif"];async function dC(e,t){if(t.conversion_id)return!0;const a=e.type;if(lC.includes(a))return!0;if(!["audio/mpeg","video/quicktime","video/mp4"].includes(a))return!1;try{if((t.width||t.height)&&!t.didFailHtmlMediaCheck)return!1;if("video/quicktime"===a)return!0;if("audio/mpeg"===a){const t=await async function(e){var t;const a=await iC(e),o=null==(t=null==a?void 0:a.media)?void 0:t.track;for(const n of o)if("OverallBitRate_Mode"in n)return n.OverallBitRate_Mode;return"Unknown"}(e);return"VBR"===t}const o=await e.arrayBuffer(),n=new Uint8Array(o),r=await(await Ok).mp4.probe.tracks(n);if(!r.length)return!0;for(let e=0;e<r.length;e+=1)if("video"===r[e].type)return!0;return!1}catch(o){return console.error(o),!0}}function uC(e){return Bk({url:e,excludedMimes:["x-mpegurl"]})}function mC(e,t=null){const a=["audio/aac","audio/m4a","audio/mp3","audio/mp4","audio/mpeg","audio/ogg","audio/wav","audio/webm","audio/x-m4a","audio/x-wav","audio/flac"];return t&&a.push(...t),a.includes(e)}const pC=new Set([xr.Text,xr.Shape,xr.Subtitle]);function hC(e){if(pC.has(e.type))return!1;const{type:t,source:a,url:o,asset_id:n,uploadPending:r}=e;return r?"uploadPending":!n&&("local"===a?"localSource":!(!["image","video"].includes(t)||a||o)&&"noSourceOrURL")}function gC(e){return e.requireConversion||e.videoConvertedState&&"complete"!==e.videoConvertedState}function fC(e){const t=[];for(const a of e)if(a.layers)for(const e of a.layers)(hC(e)||gC(e))&&t.push(e);return t}function yC(e){const t="trim"===e.studio.origin;if(e.sourceVideo&&!e.isStudio&&"local"===e.sourceVideo.source)return{reason:"SOURCE_VIDEO"};if((e.isStudio||t)&&e.studio.scenes){const t=function(e){const t=[];for(const a of e)if(a.layers)for(const e of a.layers)hC(e)&&t.push(e);return t}(e.studio.scenes);if(t.length>0)return{reason:"LAYERS",layerNames:de(t.map((e=>e.userSetName||e.name||e.fontFamily||`Unnamed ${e.type} layer`)))}}return null}function EC(e){return!!yC(e)}function _C(e){let t=e;const a=e.split(".");return(a.pop()||"")in fb&&(t=a.join(".")),t}const vC=(e={})=>{const t="image/*,image/heic,image/heif",a="audio/mpeg,audio/wav,audio/aac,audio/ogg,audio/x-wav,audio/aac,audio/mp4,audio/x-m4a,audio/*",o="video/mp4,video/webm,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e.audiogramUpload?a:e.audioUpload?[a,o].join(","):e.disallowVideo?t:e.fontUpload?".ttf,.otf":[t,a,o].join(",")},wC="EmailSiginIn-module_emailSignInContainer_WB8HJ",bC="EmailSiginIn-module_input_NtVRB",SC="EmailSiginIn-module_submit_4HPJx",TC="EmailSiginIn-module_codeContainer_-q-Zo",IC="EmailSiginIn-module_codeSentNote_AhxL7",kC="EmailSiginIn-module_receivedNoCode_LdDMS",CC="EmailSiginIn-module_agreement_CX3m4",NC="EmailSiginIn-module_underlineLink_SnNj5",AC=({email:e,handleSuccess:t})=>{const a=i.exports.useDispatch(),[o,r]=n.exports.useState(!1),[s,l]=n.exports.useState(!1),[c,d]=n.exports.useState(!1),[u,p]=n.exports.useState(""),[h,g]=n.exports.useState(""),{executeRecaptcha:f}=ue(),y=me(),E=n.exports.useRef(null),_=cn((e=>e.sessionValues.onboarding)),v=cn((e=>e.config.RECAPTCHA_V3_SITEKEY)),w=cn((e=>e.config.RECAPTCHA_V2_SITEKEY));return n.exports.useEffect((()=>{p(e||"")}),[e]),m.createElement("form",{className:wC,onSubmit:e=>{e.preventDefault(),(async()=>{var e;if(s){try{r(!0);const e=await op("/api/v1/users/email/findUser",{body:{email:u,code:h}});e.newUser&&(a(gr({..._,newUser:!0})),a(ug([e.team])),a(Nf([e.workspace]))),e.emailInvitedUser&&a(gr({..._,newUser:!0})),a(Fm(e.user,e.token)),a(_g()),vm(e.user,e.newUser,"Email"),Rm(e.user,e.newUser,"Email",y.path),null==t||t()}catch(o){a(wh(o))}r(!1)}else if(Zg(u)){try{if(!f)throw new Error("Recaptcha loading ... please try again in a few seconds.");const t=await f("emailSignIn"),a=null==(e=E.current)?void 0:e.getValue();r(!0),await op("/api/v1/users/email/signin",{body:{email:u,v3CaptchaToken:t,v2CaptchaToken:a,recaptchaKeyV3:v}}),l(!0)}catch(o){a(wh(o)),cf(o)&&d(!0)}r(!1)}else a(wh("Please input a valid email address."))})()}},m.createElement("input",{className:bC,disabled:s,placeholder:"Enter your email",readOnly:s,type:"email",value:u,"data-testid":"email-input",onChange:e=>p(e.target.value)}),!s&&c&&m.createElement("div",{style:{marginBottom:"10px"}},m.createElement(pe,{sitekey:w,ref:E})),!s&&m.createElement(m.Fragment,null,m.createElement("button",{className:SC,disabled:o,type:"submit","data-testid":"submit-email-button"},o?"Loading...":"Continue with email"),m.createElement("div",{className:CC},"By using Kapwing, you agree to our"," ",m.createElement("a",{href:"/policies/terms-of-service",target:"_blank",className:NC},"Terms of Service")," ","and"," ",m.createElement("a",{href:"/policies/privacy",target:"_blank",className:NC},"Privacy Policy"),".")),s&&m.createElement("div",{className:TC},m.createElement("div",{className:IC},m.createElement("span",null,"Code sent!")," Check your email for a login code from Kapwing."),m.createElement("input",{className:bC,placeholder:"Paste Sign In Code",type:"text",value:h,onChange:e=>{return t=e.target.value,void g(t.toUpperCase());var t}}),m.createElement("button",{className:SC,disabled:o,type:"submit","data-testid":"submit-code-button"},o?"Loading...":"Continue with login code"),m.createElement("div",{className:kC},"If you didn't receive an email, please check your spam folder or try a different sign in option.")))};class xC extends n.exports.Component{constructor(e){super(e),t(this,"loadFB",(()=>{const{facebookAppId:e}=this.props;"undefined"!=typeof FB?(FB.init({appId:e,cookie:!0,xfbml:!0,version:"v5.0"}),this.setState({fbInitialized:!0})):setTimeout(this.loadFB,200)})),t(this,"handleError",((e,t="signIn",a="Sign In")=>{const{showError:o}=this.props;let n=e;e||(n="An error occurred during sign in. Please try again later."),fm("Sign In Error Occurred",{"Error Type":t,Details:a}),o(n),this.setState({loading:!1})})),t(this,"handleSignInWithFacebook",(async()=>{const{fbInitialized:e}=this.state;e?(this.setState({loading:!0}),FB.getLoginStatus((e=>{"connected"===e.status?this.handleFacebookResponse(e.authResponse):FB.login((e=>{if("connected"===e.status)this.handleFacebookResponse(e.authResponse);else{const t="Couldn't log in with Facebook right now. Please try again later.";console.error("Fb error:",e),this.handleError(t,"facebookResponse",e.error)}}),{scope:"public_profile,email"})}))):fm("Sign In Error Occurred",{"Error Type":"signIn",Details:"Facebook Not Initialized"})})),t(this,"handleFacebookResponse",(e=>{const{match:t,onSuccess:a,setOnboarding:o,onboarding:n}=this.props;(async function(e){const{dispatch:t}=io();t({type:"REQUEST_USER"});const a=await op("/api/v1/users/facebook/findUser",{body:{user:e}}),{user:o,token:n,newUser:r}=a;if(t(Fm(o,n)),vm(o,r,"Facebook"),r){const{team:e,workspace:o}=a;t(Nf([o])),t(ug([e]))}return a})(e).then((e=>{Rm(e.user,e.newUser,"Facebook",t.path),a&&a(),e.newUser&&o({...n,newUser:!0})})).catch((e=>{this.handleError(e.message,"fetchFacebookUser",e.message)}))})),t(this,"signInWithGoogle",(async()=>{const{location:e,uploadPending:t,showWarning:a,redirectToPathname:o,immediateRedirectPathname:n,mockSignIn:r,forceNavigationTo:i}=this.props;if(window.Cypress)return setTimeout((()=>{r(),wk()}),1e3),void this.setState({loading:!0});if(t)return void a("There is an in-progress upload in your project. Please wait until it completes to sign in.");this.setState({loading:!0});let s={pathname:n||e.pathname,goToNext:o||""};i&&(s={pathname:i,goToNext:""});const l=await ap("/api/v1/users/google/getOAuthURL",{params:s});wk();const{url:c}=l;window.location.assign(c)})),t(this,"renderResponseLoading",(()=>m.createElement(m.Fragment,null,m.createElement(bk,{text:""}),m.createElement("div",{className:Sk},"Use the OAuth dialog window to finish signing in.",m.createElement("div",null,"Having trouble signing in?"),m.createElement("div",{className:Tk},m.createElement("div",{className:Ik,onClick:()=>{this.setState({loading:!1})}},"Click here to try again")))))),this.state={fbInitialized:!1,loading:!1}}componentDidMount(){this.loadFB()}renderButtons(){const{email:e,smallTheme:t}=this.props;return m.createElement("div",{className:t?"small-theme":""},m.createElement("button",{type:"button",className:"sign-in-dialog-google-button",onClick:this.signInWithGoogle,"data-cy":"signin-google-button"},m.createElement("div",{className:kk},m.createElement(ge,null)),"Continue with Google"),m.createElement("div",{className:"sign-in-dialog-facebook-button",onClick:this.handleSignInWithFacebook,"data-cy":"signin-facebook-button"},m.createElement("div",{className:"sign-in-dialog-button-icon"},m.createElement(fe,null)),"Continue with Facebook"),m.createElement("div",{className:Ck},"or"),m.createElement(AC,{email:e,handleSuccess:this.props.onSuccess}))}render(){const{loading:e}=this.state;return e?this.renderResponseLoading():this.renderButtons()}}const PC=ie(i.exports.connect((e=>({currentUser:e.currentUser,facebookAppId:e.config.FACEBOOK_APP_ID,uploadPending:EC(e),onboarding:e.sessionValues.onboarding})),(e=>he({requestUser:Bm,showError:wh,showWarning:Sh,mockSignIn:Qg,setOnboarding:gr},e)))(xC)),RC="SignInDialog-module_dialogBackground_cjx59",OC="SignInDialog-module_dialogContainer_oIPd3",DC="SignInDialog-module_dialogHeader_3ttx-",LC="SignInDialog-module_description_LESgO",UC="SignInDialog-module_closeContainer_W-zyQ";class MC extends n.exports.Component{constructor(e){super(e),t(this,"handleSuccess",(async()=>{const{hideSignIn:e,onSuccess:t}=this.props;t&&t(),e&&e()})),this.handleSuccess=this.handleSuccess.bind(this)}render(){const{description:e,email:t,customTitle:a,hideSignIn:o,immediateRedirectPathname:n,redirectToPathname:r}=this.props;let i="Kapwing works better when you're signed in. Sign in to create without a watermark, save content to a workspace, and more.";e&&(i=e),window.Cypress&&setTimeout((()=>o()),1e3);const s=document.querySelector(".app-container");if(!s){const e="Couldn't find .app-container to mount SignInDialog to.";return sn()?console.error(`${e} ${ln}`):console.error(e),null}return ye.createPortal(m.createElement(m.Fragment,null,m.createElement("div",{className:RC,onClick:o}),m.createElement("div",{className:OC,"data-cy":"signin-dialog"},m.createElement("div",{className:DC},a||"Sign in to continue"),m.createElement("div",{className:UC,onClick:o},m.createElement(Ee,{style:{fontSize:24}})),m.createElement("div",{className:LC,"data-cy":"signin-dialog-description"},i),m.createElement(PC,{email:t,immediateRedirectPathname:n,onSuccess:this.handleSuccess,redirectToPathname:r}))),s)}}const FC="Footer-module_footerText_pSvVq",BC="Footer-module_companyHeader_3Btjq",WC="Footer-module_columnHeader_mYL-G",VC="Footer-module_footer-link-column-link_Av4m0";class jC extends n.exports.Component{constructor(e){super(e),t(this,"showSignIn",(e=>{e.preventDefault(),this.setState({showSignIn:!0})})),t(this,"hideSignIn",(()=>this.setState({showSignIn:!1}))),t(this,"goToAccount",(()=>{const{history:e}=this.props;e.push("/my")})),this.state={showSignIn:!1}}render(){const{currentUser:e,currentFolderId:t,signOut:a}=this.props,{showSignIn:o}=this.state,n=ao(),r=om(e);return m.createElement("div",{className:"footer-div"},m.createElement("div",{className:"footer-container"},m.createElement("div",{className:"footer-company"},m.createElement("div",{className:BC},m.createElement("img",{alt:"Kapwing Logo",height:50,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",width:50}),m.createElement("a",{href:"/"},"KAPWING")),m.createElement("a",{href:"https://twitter.com/KapwingApp",target:"_Blank",rel:"noopener noreferrer",className:"footer-follow-link",title:"Twitter"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/Uhr-twitter.webp",alt:"Twitter logo",className:"footer-instagram-image",width:"28px",height:"28px",loading:"lazy"})),m.createElement("a",{href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"_Blank",rel:"noopener noreferrer",className:"footer-follow-link",title:"Youtube"},m.createElement("div",{className:"footer-instagram-icon-container"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/wAA-youtube.webp",alt:"Youtube logo",className:"footer-instagram-image",width:"28px",height:"28px",loading:"lazy"}))),m.createElement("a",{href:"https://www.instagram.com/KapwingApp/",target:"_Blank",rel:"noopener noreferrer",className:"footer-follow-link",title:"Instagram"},m.createElement("div",{className:"footer-instagram-icon-container"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/zUv-instagram.webp",alt:"Instagram logo",className:"footer-instagram-image",width:"28px",height:"28px",loading:"lazy"}))),m.createElement("a",{href:"https://www.tiktok.com/@kapwing",target:"_Blank",rel:"noopener noreferrer",className:"footer-follow-link",title:"TikTok"},m.createElement("div",{className:"footer-instagram-icon-container"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/PKR-tiktok.webp",alt:"TikTok logo",className:"footer-instagram-image",width:"28px",height:"28px",loading:"lazy"}))),m.createElement("a",{href:"https://www.facebook.com/KapwingVideos",target:"_Blank",rel:"noopener noreferrer",className:"footer-follow-link",title:"Facebook"},m.createElement("div",{className:"footer-instagram-icon-container"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/OSz-facebook.webp",alt:"Facebook logo",className:"footer-instagram-image",width:"28px",height:"28px",loading:"lazy"})))),m.createElement("div",{className:"footer-link-column"},m.createElement("a",{href:"/tools",className:WC},"Tools"),m.createElement("div",{className:"footer-link-column-links-container"},m.createElement("a",{href:"/video-editor",className:VC},"Video Editor"),m.createElement("a",{href:"/meme-maker",className:VC},"Meme Generator"),m.createElement("a",{href:"/subtitles",className:VC},"Add Subtitles"),m.createElement("a",{href:"/tools/convert",className:VC},"Convert Video"),m.createElement("a",{href:"/tools/trim",className:VC},"Video Trimmer"),m.createElement("a",{href:"/tools/record/screen",className:VC},"Screen Recorder"),m.createElement("a",{href:"/tools/smart-cut",className:VC},"Smart Cut"),m.createElement("a",{href:"/tools",className:VC},"View all tools"))),m.createElement("div",{className:"footer-link-column"},m.createElement("a",{href:"/templates",className:WC},"Templates"),m.createElement("div",{className:"footer-link-column-links-container"},m.createElement("a",{href:"/templates",className:VC},"Video Templates"),m.createElement("a",{href:"/meme-templates",className:VC},"Meme Templates"),m.createElement("a",{href:"/templates/collage",className:VC},"Collage Templates"),m.createElement("a",{href:"/templates/instagram",className:VC},"Instagram Video"),m.createElement("a",{href:"/templates/popular",className:VC},"Popular Templates"),m.createElement("a",{href:"/templates/edu",className:VC},"EDU Templates"),m.createElement("a",{href:"/templates",className:VC},"View All"))),m.createElement("div",{className:"footer-link-column"},m.createElement("div",{className:WC},"Learn"),m.createElement("div",{className:"footer-link-column-links-container"},m.createElement("a",{href:"/about",className:VC},"About Us"),m.createElement("a",{href:"https://www.kapwing.com/resources",target:"_self",className:VC},"Resources"),m.createElement("a",{href:"https://www.kapwing.com/help",target:"_blank",rel:"noreferrer noopener",className:VC},"Help Center"),m.createElement("a",{href:"https://www.kapwing.com/blog",target:"_self",className:VC},"Blog"),m.createElement("a",{href:"/edu",target:"_self",className:VC},"EDU"),m.createElement("a",{href:"/explore",className:VC},"Explore"),m.createElement("a",{href:"/teams",className:VC},"Teams"),m.createElement("a",{href:"/contact-us",className:VC},"Contact Us"),r?m.createElement(m.Fragment,null,m.createElement(_e,{className:VC,to:`/folder/${t}`},"My Workspace"),m.createElement(_e,{className:VC,to:{pathname:`/folder/${t}`,state:{openModal:vk.account}}},"My Account"),m.createElement("div",{className:VC,onClick:a},"Sign out")):m.createElement("div",{className:VC,onClick:this.showSignIn},"Sign in"),o&&m.createElement(MC,{hideSignIn:this.hideSignIn,onSuccess:this.goToAccount}))),m.createElement("div",{className:"footer-link-column"},m.createElement("div",{className:WC},"Company"),m.createElement("div",{className:"footer-link-column-links-container"},m.createElement("a",{href:"/pricing",className:VC},"Pricing"),m.createElement("a",{href:"/careers",className:VC},"Careers"),m.createElement("a",{href:"/partnerships",className:VC},"Partnerships"),m.createElement("a",{href:"/affiliates",className:VC},"Affiliates"),m.createElement("a",{href:"/plugins",className:VC},"Plugins"),m.createElement("a",{className:VC,href:"https://www.kapwing.com/help/tag/release-notes/"},"Release Notes"),m.createElement("a",{href:"/creators-fund",className:VC},"Creators Fund"),m.createElement("a",{href:"/policies/refund",className:VC},"Refund Policy"),m.createElement("a",{href:"/policies/privacy",className:VC},"Privacy Policy"),m.createElement("a",{href:"/policies/terms-of-service",className:VC},"Terms of Service"))),m.createElement("div",{className:FC},"© ",(new Date).getFullYear()," Kapwing. Release ","v2023.02.22.2","—",n,".",m.createElement("br",null),"Made with love in San Francisco, California.")))}}const HC=ie(i.exports.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace})),(e=>he({signOut:Wm},e)))(jC));function GC(e){return xi({key:"pastedLinkError",params:{layerIds:e.map((e=>e.id))}})}function $C(e,t={}){return op("/api/v1/assets/create_v2",{body:e,params:t,retries:5})}function KC(e){return op("/api/v1/assets/createFromVideo_v2",{params:{id:e},retries:5})}function YC(e,t={},a={}){return op("/api/v1/assets/createFromLink_v2",{body:a,params:{url:e,...t},retries:5})}function zC(e,t){return ap(`/api/v1/assets/${e}/${t||""}`,{retries:5})}function qC(e,t){return rp(`/api/v1/assets/${e}`,{body:t})}function JC(e){return ap(`/api/v1/assets/${e}/split-scenes`,{timeout:75e3})}function XC(e){return op(`/api/v1/assets/${e}/split-scenes`)}function QC(e){if(!e)return void console.error("No Pasted URL provided.");const{scenes:t}=io().state.studio,a=[];for(const o of t)for(const t of o.layers)t.pastedUrl===e&&a.push(t);ZC(a,!0)}function ZC(e,t){if(0===e.length)return;const{dispatch:a}=io();let o=null;const[n]=e;if(n.url){const e=new URL(n.url).hostname.split(".");o=e.slice(Math.max(0,e.length-2)).join(".")}const r=Mk(n.pastedUrl);fm("Failed Preemptive Download Modal Shown",{url:n.pastedUrl,pathname:window.location.pathname,extractedHost:o,platform:r,fromPreemptiveDownload:t}),i.exports.batch((()=>{for(const t of e)a(ds(t,{preemptiveDownloadError:!0}));a(GC(e))}))}async function eN(e){if("complete"===(await op(`/api/v1/assets/${e}/initialize_metadata`)).status)return null;return await new Promise(((t,a)=>{const o=setInterval((async()=>{try{const a=await ap(`/api/v1/assets/${e}`);"metadata_init_in_progess"in a&&!a.metadata_init_in_progess&&(t(a),clearInterval(o))}catch(n){a(n),clearInterval(o)}}),5e3)}))}function tN(e){return e.content_type?e.content_type.startsWith("image")?xr.Image:e.content_type.startsWith("video")?xr.Video:e.content_type.startsWith("audio")?xr.Audio:null:null}function aN(e){const t=new Date;return{projectName:e.projectName,dimensions:e.dimensions,done:!1,duration:e.duration,editorPath:e.editorPath,isGif:e.sourceVideo&&e.sourceVideo.isGif,isImage:e.sourceVideo&&e.sourceVideo.isImage,lastSeen:t,parentId:e.parentId,pastedUrl:e.sourceVideo&&e.sourceVideo.pastedUrl?e.sourceVideo.pastedUrl:void 0,privacy:e.privacy,progressText:"Saved ...",sourceVideo:e.sourceVideo,submittedAt:t}}function oN(e,t){return(a,o)=>{const{currentUser:n}=o(),{token:r,user:i}=n||{},s={privacy:t,token:r,userId:i&&i._id};return np(`/api/v1/videos/${e}/privacy`,{params:s})}}function nN(e){return{type:"SET_PREVIEW_VIDEO",video:e}}function rN(){return{type:"MARK_AS_STUDIO"}}function iN(e){var t,a;let o=e||{};if((e.scenes||(null==(t=e.allLayers)?void 0:t.byId))&&(o=c(e),(null==(a=null==e?void 0:e.allLayers)?void 0:a.byId)&&Object.values(e.allLayers.byId).forEach((e=>{delete e.local_url})),e.scenes))for(const n in o.scenes)for(const e in o.scenes[n].layers)delete o.scenes[n].layers[e].local_url;return{...o,layersPendingUpload:{},deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}const sN=/^rgba?\((-?\d{1,3}), ?(-?\d{1,3}), ?(-?\d{1,3})(?:(?:, ?)([0,1](?:\.\d*)?|undefined))?\)$/i;function lN(e,t,a){e.studio.scenes=e.studio.scenes.map((t=>{const o={...t};return o.layers=o.layers.map((t=>{var n;const r={...t},i=null==(n=e.studio.canvasDimensions)?void 0:n.canvasWidth,s=e.studio.width,l=r.fontSizeRaw||o.subtitle.fontSizeRaw,c=r.fontSizeRatio||o.subtitle.fontSizeRatio;let d;if(a)d=r.fontSize||o.subtitle.fontSize;else if(null!=i&&null!=s)d=null!=l?l/i*s:c*s;else{const e=s||i;d=c&&null!=e?c*e:r.fontSize||o.subtitle.fontSize}return"subtitle"===r.type&&(r.background=function(e){const{backgroundColor:t,backgroundOpacity:a}=e,o=t.match(sN);return"undefined"!==(null==o?void 0:o[4])&&a?t:"rgba(0, 0, 0, 0.6)"}(o.subtitle),r.backgroundStyle=o.subtitle.backgroundStyle,r.color=r.textColor||o.subtitle.fontColor,r.duration=r.endTime-r.startTime,r.fontFamily=o.subtitle.font,r.hasCustomFont=o.subtitle.hasCustomFont,r.url=o.subtitle.url,r.fontType=o.subtitle.fontType,r.source=o.subtitle.source,r.fontSize=d,r.fontSizeRatio=c,r.fontSizeRaw=l,r.fontStyle=r.fontStyle||o.subtitle.fontStyle,r.fontWeight=r.fontWeight||o.subtitle.fontWeight,r.lineWidth=o.subtitle.lineWidth,r.textAlign=r.textAlign||o.subtitle.textAlign,r.textVerticalAlign=o.subtitle.textVerticalAlign,r.fixedPosition=o.subtitle.fixedPosition,r.textShadow=o.subtitle.textShadow,r.textDirection="rtl"===ve(r.text)?"rtl":"ltr",r.height=e.studio.height,r.width=e.studio.width,r.lineHeight=o.subtitle.lineHeight),r})),o.layers=xE(o.layers),o}));const o=NE(e.studio.scenes),{currentUser:{user:n},currentUser:r}=e||{},i=cN(r,o),s=om(r)?null==n?void 0:n._id:void 0,l=om(r)?null==n?void 0:n.email:void 0;if(t){const t="Studio Draft"===e.projectName||""===e.projectName?"Studio Project":e.projectName;e.projectName=t}return{isCreator:!0,isStudio:!0,...iN(e.studio),...aN(e),duration:o,creatorId:s,creatorEmail:l,watermark:i,sessionSettings:void 0,..."Cypress"in window&&{isCypress:!0}}}const cN=(e,t)=>{const a=Ou({team:Bu()});return!a.hasPermission(au.EXPORT_ALL_WITHOUT_WATERMARK)&&(!(t<=30&&a.hasPermission(au.EXPORT_30_SEC_WITHOUT_WATERMARK))&&!lf(e))};const dN=e=>{const{snapshotCreatedOn:t,video_id:a,id:o,...n}=e;return{version_number:0,created_on:t,snapshot_type:"legacy",export:!0,id:o,content:n,video_id:a}};async function uN(e){try{return(e=>{if(0===e.length)return[];const t=[];for(let a=0;a<e.length;a+=1){const o=e[a];"full_video"===o.snapshot_type?t.push({...o}):"patch"===o.snapshot_type?t.push({...o,content:we(be(t[a-1].content),o.diff).newDocument}):t.push(dN(e[a]))}return t})(await ap(`/api/v1/snapshots/${e}`))}catch($ae){throw console.error($ae),$ae}}async function mN({migrateToVersion:e,snapshot_id:t,video_id:a}){try{const o=e?{migrateToVersion:e}:{};return await ap(`/api/v1/snapshots/${a}/${t}`,{params:o})}catch($ae){throw console.error($ae),$ae}}async function pN(e,t){try{return await op(`/api/v1/snapshots/${e}/${t}/fork`)}catch($ae){throw console.error($ae),$ae}}async function hN(e,t=!1){if(!e._id)throw Error("No video id present");const a=await op(`/api/v1/snapshots/${e._id}`,{body:{video:e,exportSnapshot:t}});if(a.error)throw a;return a}async function gN(){var e;const{state:t}=io();if((null==t?void 0:t.currentVideo)&&(null==(e=null==t?void 0:t.currentUser)?void 0:e.user)){const e=await lN(t,!!t.currentVideo,!0);if(!e)throw Error("No video present");const{layers:a}=e.scenes[0];let o=0;for(;o<a.length&&"subtitle"!==a[o].type;)o+=1;o<a.length&&(e.scenes[0].layers=a.slice(0,o));const n=await op("/api/file-size-estimate",{body:{video:e}});if(n.error)throw n;return n.estimate}throw Error(" present")}async function fN(e){const{state:t,dispatch:a}=io(),o=t.studio._id,{asset_id:n,conversion_type:r,pastedUrl:i,resource:s,type:l,layer:c}=e,d={asset_id:n,resource:s,type:l,conversion_type:r,layer:c,video_id:o};i&&(d.pastedUrl=i);const u={asset_id:n,resource:s,type:l,conversion_type:r,video_id:o};fm("Conversion Begins",u);try{const e=await op("/api/v1/conversions",{body:d}),{conversion_id:t,asset:o}=e;return o&&a(Bb([o])),t}catch(m){throw console.error(m),fm("Conversion Fails",{...u,failureMessage:m}),m}}async function yN(e){if(!e)throw new Error("No conversion id present");const t=await ap(`/api/v1/conversions/${e}`).catch((e=>{throw console.error(e),e}));if(t.status===$o.failed){fm("Conversion Fails",{asset_id:t.asset_id,conversion_id:e,failureMessage:"conversion status === failed"})}return t}function EN(e,t=!0){return{type:"SET_SOURCE_VIDEO",video:e,updateSharedDoc:t}}function _N(e,t="sourceVideo"){return{type:"SET_UPLOAD_PROGRESS_TEXT",text:e,id:t}}function vN(){return{type:"RESET_EDITOR"}}function wN(){return{type:"RESET_EDITOR_FLAGS"}}const bN="OverlayWrapper-module_overlayBackground_IgN-u",SN="OverlayWrapper-module_overlayContainer_Dbxsu",TN="OverlayWrapper-module_overlayContainerPadding_acU1f",IN="OverlayWrapper-module_exit_qhRlo",kN="OverlayWrapper-module_overlayContent_0qiec",CN="OverlayWrapper-module_overlayInput_Vxuv0";class NN extends n.exports.Component{constructor(){super(...arguments),t(this,"escFunction",(e=>{27===e.keyCode&&this.handleClose()})),t(this,"handleClose",(()=>{const{dragUpload:e,hideDragUploadDialog:t,history:a}=this.props;e?t&&t():a.length<=1?a.push("/"):a.goBack()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?TN:SN}render(){const{showDragUploadDialog:e,handleDragUpload:t}=this.props;return m.createElement("div",null,m.createElement("div",{className:bN,onClick:this.handleClose,"data-cy":"overlay-background"}),e&&t&&m.createElement("input",{className:CN,accept:"image/*,video/mp4,video/*",onClick:e=>{this.handleClose(),e.preventDefault()},onChange:e=>{t(e.target&&e.target.files)},type:"file",multiple:!0}),m.createElement("div",{style:this.props.maxWidth?{maxWidth:`${this.props.maxWidth}px`}:void 0,className:this.getContainerStyle()},m.createElement("div",{className:IN,onClick:this.handleClose},m.createElement(Ee,null)),m.createElement("div",{className:kN},this.props.children)))}}const AN=ie(NN),xN="DragUpload-module_dragUploadButton_BJfl-",PN="DragUpload-module_dragUploadLabel_ex8yk",RN="DragUpload-module_uploadContainer_X-54s",ON="DragUpload-module_dragUploadLabelHeader_vnj-D";class DN extends n.exports.Component{componentDidUpdate(e){this.props.files!==e.files&&this.props.handleMultiFileUpload(this.props.files)}render(){const{multiple:e,inputClassNames:t,labelClassNames:a,handleMultiFileUpload:o}=this.props;let n=xN;t&&(n+=` ${t}`);let r=PN;return a&&(r+=` ${a}`),m.createElement("div",{className:RN,style:{height:"400px"}},m.createElement("input",{className:n,style:{height:"424px"},accept:this.props.returnAccepts(),onChange:e=>o(e.target&&e.target.files),type:"file",multiple:e?"multiple":null}),m.createElement("label",{htmlFor:"uploader-input",className:r},m.createElement("div",null,m.createElement("div",{className:ON},m.createElement(Se,{size:23,style:{marginRight:10,marginBottom:5}}),"Drag here to upload"))))}}function LN(e,t,a){const{dispatch:o,state:{mediaCache:{uploadIdToMediaCacheId:n},studio:{_id:r,thisProjectCMLFiles:s}}}=io();i.exports.batch((()=>{if(o(Bb([e])),t&&(o(oh([t])),t.teamId?o(fg((e=>({...e,cmlIds:[...e.cmlIds,t.id]})))):(o(ah([t.id])),(null==s?void 0:s[t.id])||o(mS(t,r))),t.duplicate&&o(ch({id:t.id,modified:new Date(t.modified)})),a)){o(ih({cmlFileId:t.id,uploadId:a}));const e=n[a];e&&o(Yc({assetId:t.asset_id,mediaCacheId:e}))}}))}function UN(e){if(!e)return!1;if(!e.startsWith("http"))return!1;try{return new URL(e),!0}catch($ae){return console.error($ae),!1}}async function MN({acceptAudio:e=!0,acceptImage:t=!0,acceptVideo:a=!0,additionalAssetParams:o,progressCallback:n,analyticsCallback:r,url:i,doDuplicateHandling:s=!1}){if(!i)throw Error("No url to extract");const l={...o||{}},c=await Bk({url:i,analyticsCallback:r,doDuplicateHandling:s}),{mime:d}=c,[u]=(d||"").split(";",2)[0].split("/",2);let m=!1;switch(u){case"audio":e||(m=!0);break;case"image":t||(m=!0);break;case"video":a||(m=!0)}if(m)throw new Error("Invalid mime type");n&&n("Just a second..."),r({stage:Ns.AssetCreation});const{asset:p,cmlFile:h}=await YC(i,l,c);LN(p,h),((null==h?void 0:h.duplicate)||c.hasUploadedAssetDuplicate)&&(c.url=p.url);const g=function(e){const t=Gk(e);return!!cC.includes(t||"")}(c.url);return r({requiresConversion:g}),g&&(c.requireConversion=!0,c.conversion_type=$k(c.url,c.type),c.conversion_id=await fN({asset_id:p._id,conversion_type:c.conversion_type,pastedUrl:i,resource:c.url,type:"pastedLink"})),{asset:p,cmlFile:h,extractInfo:c}}const FN=()=>{};class BN extends n.exports.Component{constructor(e){super(e),t(this,"handleChange",(async e=>{const{destination:t,disallowImages:a,disallowVideo:o,handleFinish:n,resetEditor:r,setProgressText:i,setSourceVideo:s,showError:l,startUpload:c,stopUpload:d,history:u}=this.props,{pathname:m}=u.location,p=e.target.value;if(!UN(p))return void l(`${p} is not a valid URL`);if(Yk(p))return void l("MPD files are not currently supported. Please try a different file format.");let h=p.substring(0,Math.min(50,p.length));p.length>50&&(h+=" ..."),c(),i(`Fetching ${h} ...`);try{const{asset:e,extractInfo:c}=await MN({acceptAudio:!o,acceptImage:!a,acceptVideo:!o,progressCallback:i,analyticsCallback:FN,url:p}),u=c.mime||"",g="image/gif"===u,f=!g&&u&&u.startsWith("image/"),E={_id:y(),conversion_id:e.conversion_id,isGif:g,isImage:f,pastedUrl:p,source:"pastedLink",uploadedAt:new Date,...c};E.requireConversion&&(i("Converting..."),await this.pollConversion(E)),i("Finalizing..."),r();const _=n(E),v=await(null==_?Promise.resolve(!0):_);if(s(E),d(),i(""),!v)return l(`Sorry, that URL (${h}) didn't work.`),void d();t&&!m.includes("/upgrade")&&Ml(t)}catch(g){console.error(g),l(`Sorry, that URL (${h}) didn't work. ${g.message}`),d()}})),this.state={pastedLink:""}}async pollConversion(e){return new Promise((t=>{const a=setInterval((async()=>{const o=await yN(e.conversion_id);o.status===$o.completed&&(e.url=o.output_url,e.asset_id=o.asset_id,delete e.local_url,clearInterval(a),t()),o.status===$o.failed&&clearInterval(a)}),5e3)}))}render(){const{pastedLink:e}=this.state,t=`upload-link-input-${y()}`;return m.createElement("div",{className:"upload-link-container"},m.createElement("label",{htmlFor:t},m.createElement("input",{id:t,className:"primary-text-field upload-link-input",placeholder:"Paste a URL",value:e,onChange:this.handleChange,type:"url"})))}}const WN=ie(i.exports.connect(void 0,(e=>he({extractAsset:MN,resetEditor:vN,setSourceVideo:EN,showError:wh},e)))(BN)),VN=ie((e=>{const{handleFileUpload:t,returnAccepts:a}=e,o=`upload-button-input-${y()}`;return m.createElement("div",{className:"upload-button-container"},m.createElement("label",{htmlFor:o,className:"upload-button"},"Upload",m.createElement("input",{"data-cy":"upload-input",id:o,className:"upload-button-input",accept:a(),onChange:t,type:"file"})))}));class jN extends n.exports.Component{constructor(e){super(e),this.state={loading:!1},this.saveRandom=this.saveRandom.bind(this)}async saveRandom(){const{setSourceVideo:e,destination:t,handleFinish:a,resetEditor:o,useImage:n,allowAudio:r,history:i}=this.props,{pathname:s}=i.location;this.setState({loading:!0});let l={_id:F.v4(),asset_id:"5cb6720fbb291826f269a84d",lastModified:1511336812e3,name:"samples/GElVraM.mp4",size:594982,type:"video/mp4",uploadedAt:new Date,isGif:!1,isImage:!1,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/GElVraM.mp4",mime:"video/mp4"};this.props.sample&&(l=this.props.sample),n&&(l={_id:F.v4(),asset_id:"5cb77af3f3efea242e375232",lastModified:1511336812e3,name:"samples/DiRXHpj.jpg",size:46354,type:"image/jpg",uploadedAt:new Date,isGif:!1,isImage:!0,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/DiRXHpj.jpg",mime:"image/jpg"}),e(l),r&&!this.props.sample&&(l={asset_id:"5cb6720fbb291826f269a84e",name:"samples/Summer_Love_trim.mp3",url:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3",size:1172125,mime:"audio/mp3",source:"upload",uri:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3"}),o(),this.setState({loading:!1});const c=await a(l);await(null==c?Promise.resolve(!0):c)&&t&&!s.includes("/upgrade")&&Ml(t)}render(){const{loading:e}=this.state;return e?m.createElement("div",{className:"upload-separator"},"just a second..."):m.createElement("div",{className:"upload-separator"},"or"," ",m.createElement("span",{className:"upload-test-link",onClick:this.saveRandom,"data-cy":"non-studio-sample-link"},"try a sample!"))}}const HN=ie(i.exports.connect(void 0,(e=>he({setSourceVideo:EN,showError:wh,resetEditor:vN},e)))(jN)),GN="NonStudioUploadContainer-module_cancel_g6boc",$N="NonStudioUploadContainer-module_cancelIcon_9WNYy";class KN extends n.exports.Component{constructor(e){super(e),t(this,"numRetries"),t(this,"unmounted"),t(this,"uploadAndConvertData"),t(this,"fileInfo"),t(this,"startUpload",(()=>{this.unmounted||this.setState({uploading:!0})})),t(this,"stopUpload",(()=>{this.unmounted||this.setState({uploading:!1})})),t(this,"setProgressText",(e=>{const{setUploadProgressText:t}=this.props;t(e),this.unmounted||this.setState({progressText:e})})),t(this,"returnAccepts",(()=>{const{allowAudio:e,disallowImages:t}=this.props;let a="video/mp4,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e&&(a+=",.mp3,.wav"),t||(a+=",image/*"),a})),t(this,"handleError",((e,t="",a=!0)=>{const{showError:o,resetEditor:n,history:r}=this.props;let i=e;e||(i="An error occurred while uploading. Please try again later."),n(),this.setProgressText(""),o(i),this.stopUpload(),a&&r.goBack()})),t(this,"loadMetadataBeforeUpload",(e=>{const{isSubtitler:t,isAddAudioToVideo:a}=this.props,o=document.createElement("video");o.src=e.local_url||"",o.onloadedmetadata=()=>{e.duration=o.duration;const n=((e,t=!1,a=!1)=>{const{state:o}=io();let n=!0;return!Du({team:Bu(o)},au.UNLIMITED_EXPORT_DURATION_LIMIT)&&(e.duration||0)>420?t&&(e.duration||0)>7200?Nk("You cannot export videos longer than 2 hour, but you can upgrade to download the SRT file."):t?Ak("Your file is longer than 7 minutes. Upgrade to export videos longer than 7 minutes."):a?(Nk("Your content must be under 7 minutes."),n=!1):Ak("Your file is longer than 7 minutes. Trim or upgrade to export videos longer than 7 minutes."):(e.duration||0)>7200&&(t?Nk("You cannot export videos longer than 2 hour, but you can download the SRT file."):a?(Nk("Your content must be under 2 hour."),n=!1):Ak("Your file is longer than 2 hour. You must trim your video to publish.")),n})(e,t,a);n?this.preProcessAndUpload(e):this.stopUpload()}})),t(this,"handleResumableUpload",(e=>{const{resetEditor:t,setSourceVideo:a,showError:o,setProjectName:n,projectName:r,editorPath:i,isCartoonify:s}=this.props;if(""===r)if(e.name){let t=e.name;const a=t.split("."),o=a.pop();fb[o]&&(t=a.join(".")),n(t)}else null!=gb[i]&&n(gb[i]);this.setProgressText("Uploading ..."),Yw({files:[{file:e}]}).then((o=>{const{read_uri:n,upload_uri:r}=o.uris[0],i=new URLSearchParams(r.split("?").slice(1).join("?"));let l=!1,c=!1;"image/gif"===e.type?l=!0:e.type.match(/.(jpg|jpeg|png)$/i)&&(c=!0);const d={_id:y(),lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,size:e.size,type:e.type,uploadedAt:new Date,extension:Te.extension(e.type),url:n,isGif:l,isImage:c,bucket:co,name:i.get("name"),blob_name:i.get("name"),source:"upload",local_url:e.local_url,testFileKey:!0};this.fileInfo=d,s&&(t(),a(d)),this.uploadToGCS(r,e)})).catch((e=>{o(e.message),this.stopUpload()}))})),t(this,"uploadToGCS",((e,t,a={})=>{const o=new XMLHttpRequest;o.open("PUT",e,!0),o.onload=()=>{this.onUploadFinish(o,t)},o.upload.onprogress=this.onUploadProgress,o.setRequestHeader("Content-Type",t.type),Object.entries(a).forEach((([e,t])=>{o.setRequestHeader(e,t)})),o.send(t),o.onerror=()=>{this.onUploadError(e,t,o.status)}})),t(this,"resumeUploadToGCS",((e,t)=>{const a=new XMLHttpRequest;a.open("PUT",e,!0),a.onload=o=>{if(308===o.target.status){const o=a.getResponseHeader("Range");if(!o)return void this.onUploadError(e,t,a.status);const n=parseInt(o.split("-").pop(),10);if(n<0)return void this.onUploadError(e,t,a.status);const r=n+1,i=t.size-1,s={"Content-Range":`bytes ${r}-${i}/${t.size}`};this.uploadToGCS(e,t.slice(r,i+1),s)}},a.upload.onprogress=e=>this.onUploadProgress(e),a.onerror=()=>{this.onUploadError(e,t,a.status)},a.setRequestHeader("Content-Range",`bytes */${t.size}`),a.send(t)})),t(this,"handleFileUpload",(async e=>{const{disallowImages:t,disallowVideo:a,showError:o,allowedTypes:n,allowAudio:r,isCartoonify:i}=this.props,s=Du({team:Bu()},au.UNLIMITED_UPLOAD_SIZE_LIMIT);let l;if(this.startUpload(),this.setProgressText("Starting upload..."),e.target?[l]=e.target.files:[l]=e,i||(l.local_url=URL.createObjectURL(l)),!l)return o("Please choose a file to upload."),void this.stopUpload();const c=Kk(l);if(!i)try{const e=await oC(l.local_url,l);Object.assign(l,e)}catch(d){console.error(d)}c?r||!t||qk(c,n)?r||!a||zk(l.type)?r&&!["video/quicktime","audio/mp3","audio/mpeg","audio/wav","video/3gpp","video/avi","video/mp4","video/mpeg","video/ogg","video/webm","video/x-flv","video/x-matroska","video/x-ms-wmv"].includes(c)?(o("Your audio file format is not currently supported. Currently we only support .mp3 and .wav formats."),this.stopUpload()):r||zk(l.type)||qk(c,n)?await dC(l,l)?(l.conversion_type=$k(l.url,l.type),this.processConversion(l)):(l.size>6442450944?(Ak("Your content must be under 6GB"),this.stopUpload()):l.size>262144e3&&!s&&Ak("Your upload is over 250MB. You may need to upgrade to use some Kapwing features."),l.type.includes("video")||l.type.includes("audio")?this.loadMetadataBeforeUpload(l):this.preProcessAndUpload(l)):(o("Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, .ogg, .mpeg formats."),this.stopUpload()):(o("You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats."),this.stopUpload()):(o("You must choose a video to use this feature. Currently we support .mp4, .mov, .webm, .ogg, and .mpeg formats."),this.stopUpload()):(o("Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension."),this.stopUpload())})),t(this,"preProcessAndUpload",(e=>{const{resetEditor:t,isCartoonify:a}=this.props;a||(t(),e.source="local",this.handleFinish(e,!0,!0));try{Hk(e,this.setProgressText,this.handleError).then((e=>{this.handleResumableUpload(e)}))}catch($ae){console.error("error during upload ",$ae),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload")}})),t(this,"onUploadProgress",(e=>{if(e.lengthComputable){const t=`Uploading ... ${Math.round(e.loaded/e.total*100).toString()}%`;this.setProgressText(t)}})),t(this,"onUploadError",((e,t,a)=>{if(this.numRetries<3&&a>=500)return this.resumeUploadToGCS(e,t),void(this.numRetries+=1);this.handleError("An network error occurred during upload. Please check your internet connection and try again.","onUploadError")})),t(this,"onUploadFinish",(async(e,t)=>{200===e.status?await dC(t,t)?$C(this.fileInfo).then((async({asset:e,cmlFile:a})=>{LN(e,a),await dC(t,t)&&await fN({asset_id:e._id,resource:this.fileInfo.name,type:"blob",conversion_type:t.conversion_type}).then((e=>{this.fileInfo.conversion_id=e,this.setProgressText("Converting file to mp4 ...")}));const o=setInterval((async()=>{var e;const t=await yN(this.fileInfo.conversion_id),a=`Converting file to mp4 ... ${null==(e=t.progress)?void 0:e.conversion}%`;if(this.setProgressText(a),$o.completed===t.status){const e={...this.fileInfo,url:t.output_url,conversion_id:this.fileInfo.conversion_id,asset_id:t.asset_id};delete e.local_url,this.handleFinish(e,!0,!0),clearInterval(o),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,fm("Upload and convert, one-off",this.uploadAndConvertData),this.uploadAndConvertData={}}$o.failed===t.status&&(clearInterval(o),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,this.uploadAndConvertData.failed=!0,fm("Upload and convert, one-off",this.uploadAndConvertData),this.uploadAndConvertData={},this.setProgressText("Failed to convert"),setTimeout(this.stopUpload,1e3))}),5e3)})):(this.stopUpload(),this.setProgressText(""),$C(this.fileInfo).then((({asset:e,cmlFile:t})=>{this.fileInfo.asset_id=e._id,LN(e,t),this.handleFinish(this.fileInfo,!0,!0)}))):this.handleError(e.statusText||"An error occurred during upload. Please try again.","onUploadFinish")})),t(this,"handleFinish",(async(e,t=!1,a=!1)=>{const{destination:o,handleFinish:n,history:r,setSourceVideo:i}=this.props,{pathname:s}=r.location;try{return null!=n&&n(e),t&&o&&!s.includes("/upgrade")&&Ml(o),a&&i(e),!0}catch($ae){return console.error("error during upload ",$ae),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","handleFinish",!1),!1}})),this.state={uploading:!1,progressText:""},this.numRetries=0,this.uploadAndConvertData={},this.unmounted=!1}componentWillUnmount(){this.unmounted=!0}async processConversion(e,t){e.id=y();const{destination:a,ffmpegTranscode:o}=this.props;try{this.uploadAndConvertData.size=e.size,this.uploadAndConvertData.conversionType=e.conversion_type,this.uploadAndConvertData.startTime=Date.now(),this.handleResumableUpload(e)}catch($ae){console.error("error during upload ",$ae),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload"),t&&Ml(t)}if((new MS).isSupportedByClient()&&"/editor/convert"===a)try{o({file:e})}catch($ae){console.error($ae)}}renderUploading(){const{progressText:e}=this.state;return m.createElement("div",{className:"upload-container"},m.createElement("div",{className:"upload-loading"},m.createElement("div",{className:"loader upload-loader"}),m.createElement("span",null,e||"Loading...")),m.createElement("div",{className:GN,onClick:this.stopUpload},m.createElement("span",null,"Cancel"),m.createElement(Ie,{className:$N})))}renderDragUpload(){const{hideDragUploadDialog:e}=this.props;return m.createElement(AN,{hideDragUploadDialog:e,handleDragUpload:this.handleFileUpload,showDragUploadDialog:!0,dragUpload:!0},m.createElement("div",{className:"drag-header"},"Upload video or image"),m.createElement(DN,{returnAccepts:this.returnAccepts,handleMultiFileUpload:this.handleFileUpload,multiple:!0}))}renderNormalUpload(){const{destination:e,disallowImages:t,disallowVideo:a,sample:o,allowAudio:n,helperText:r,isOverlay:i=!1}=this.props,s=id({"upload-container":!0,"upload-overlay":i});return m.createElement("div",{className:s},m.createElement(VN,{handleFileUpload:this.handleFileUpload,returnAccepts:this.returnAccepts}),m.createElement(WN,{destination:e,disallowImages:t,disallowVideo:a,handleFinish:this.handleFinish,setProgressText:this.setProgressText,startUpload:this.startUpload,stopUpload:this.stopUpload}),m.createElement(HN,{allowAudio:n,destination:e,handleFinish:this.handleFinish,sample:o,useImage:a}),m.createElement("div",{className:"upload-subtext"},r))}render(){const{uploading:e}=this.state,{showDragUploadDialog:t,ffmpegReducer:a}=this.props;if("FULFILLED"===a.ffmpegStatus&&void 0!==a.outputFile&&this.fileInfo){const e={...this.fileInfo};e.source="local",e.local_url=a.outputFileUrl,this.handleFinish(e,!1,!0)}return e?this.renderUploading():t?this.renderDragUpload():this.renderNormalUpload()}}const YN=ie(i.exports.connect((e=>({currentUser:e.currentUser,projectName:e.projectName,editorPath:e.editorPath,ffmpegReducer:e.ffmpegReducer})),(e=>he({setSourceVideo:EN,showError:wh,resetEditor:vN,setProjectName:rS,setUploadProgressText:_N,ffmpegTranscode:FS},e)))(KN));function zN(){return(e,t)=>{const{currentUser:a,sourceVideo:o}=t(),{token:n,user:r}=a||{},{_id:i}=r||{};return op("/api/v1/videos",{body:{publish:!0,token:n,userId:i,video:{creatorId:i,done:!1,isCartoonify:!0,isImage:!0,lastSeen:new Date,progressText:"Loading ...",sourceVideo:o,submittedAt:new Date,watermark:!1}}})}}const qN=(e,t)=>io().dispatch(Tr({font:e,status:t})),JN=new Map;function XN({name:e,onError:t,onSuccess:a,url:o}){const n=`${e}_${o}`;let r=JN.get(n);r||(r=new Promise(((t,a)=>{const n=new window.FontFace(e,`url(${o})`);document.fonts.add(n),n.load().then((()=>{qN(e,"success"),t()})).catch((t=>{qN(e,"failed"),console.error(t),a(t)}))})),JN.set(n,r)),r.then((()=>a())).catch((e=>t(String(e))))}const QN=(e,t,a=(()=>{}),o=(()=>{}))=>{var n,r,i;const s="string"==typeof e?e:e.fontFamily;if(!s)return void o("Was not passed a font to load");const l=(c=s,io().state.loadedFonts[c]);var c;if(l)return void("success"===l?a():o("Font load already failed"));if(Er.has(s))return void a();if("object"==typeof e&&e.url)return void XN({name:s,onError:o,onSuccess:a,url:e.url});if(wr.has(s)||ke.has(s))return window.WebFont?void function({name:e,onError:t,onSuccess:a,withWeights:o}){if(!window.WebFont)return void t("WebFont API not supported");const n=o?`${e}:300,300i,400,400i,700,700i,800,800i`:e,r=n;let i=JN.get(r);i||(i=new Promise(((t,a)=>{let o=!1;window.WebFont.load({google:{families:[n]},fontactive:()=>{o||(qN(e,"success"),o=!0),t()},fontinactive:()=>{o||(qN(e,"failed"),o=!0),a(new Error("WebFont loader failed"))}})})),JN.set(r,i)),i.then((()=>a())).catch((e=>t(String(e))))}({name:s,onError:o,onSuccess:a,withWeights:t}):void o("WebFont API not supported");if(s in _r){return void XN({name:s,onError:o,onSuccess:a,url:`https://cdn-useast1.kapwing.com/defaultFonts/${_r[s]}`})}const{state:d}=io(),u=d.workspaces.selectedWorkspace,{allWorkspaces:m}=d.workspaces,p=m.find((e=>e._id===u)),h=null==(n=null==p?void 0:p.customFonts)?void 0:n.find((e=>e.fontFamily===s));if(h)return void XN({name:s,onError:o,onSuccess:a,url:h.url});const g=null==(i=null==(r=d.teams.activeBrandkit)?void 0:r.fonts)?void 0:i.find((e=>e.fontFamily===s&&"custom"===e.type));g?XN({name:s,onError:o,onSuccess:a,url:g.url}):(qN(s,"failed"),o("Don't know where to load font from"))},ZN=(e=[])=>{for(const t of e)QN(t,!0)},eA=(e,t=0,a=null,o=!0)=>{const n="top"===e.toLowerCase()?yr:vr,r=n.slice(t,t+(a||n.length));for(const i of r)QN(i,o)},tA=(e,t=(()=>{}),a=(()=>{}))=>{"undefined"!=typeof document?QN(e,!0,t,a):t()},aA=e=>new Promise(((t,a)=>tA(e,t,a))),oA=async e=>{try{return await Xc(8e3,new Promise(((t,a)=>{XN({name:e.fontFamily,onError:a,onSuccess:t,url:e.url})}))),!0}catch(t){console.error(t)}return!1};class nA extends n.exports.Component{constructor(e){super(e),t(this,"handleFinish",(()=>{const{createCartoonifyImage:e,history:t}=this.props;this.setState({submitting:!0}),console.debug("Finished uploading"),e().then((e=>{this.setState({submitting:!1}),t.push(`/videos/${e._id}`)})).catch((e=>{console.error(e),wh(e.message),this.setState({submitting:!1})}))})),this.state={submitting:!1}}componentDidMount(){tA("Just Me Again Down Here")}render(){const{submitting:e}=this.state;return m.createElement("div",null,m.createElement("div",{className:"startup-videos-wrapper"},m.createElement(Ce,null,m.createElement("title",null,"Cartoonify Your Images Online – Kapwing"),m.createElement("meta",{name:"description",content:"Use Kapwing's cartoonify AI generator to turn your photo into a cartoon drawing. Upload any image to get your cartoon."}),m.createElement("meta",{name:"keywords",content:"cartoonify, cartoon image"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/cartoonify"}))),m.createElement("div",{className:"cartoonify-container"},m.createElement("div",{className:"cartoonify-main-actions"},m.createElement("div",{className:"cartoonify-header"},"What happens when artificial intelligence tries to draw your photo?"),m.createElement("div",{className:"cartoonify-description"},m.createElement("b",null,"Cartoonify")," turns your photo into a cartoon drawing, powered by"," ",m.createElement("a",{href:"https://github.com/danmacnish/cartoonify",target:"_blank",rel:"noopener noreferrer"},"Draw This")," ","by"," ",m.createElement("a",{href:"http://danmacnish.com/2018/07/01/draw-this/",target:"_blank",rel:"noopener noreferrer"},"Dan Macnish")," ","and the Google"," ",m.createElement("a",{href:"https://github.com/googlecreativelab/quickdraw-dataset",target:"_blank",rel:"noopener noreferrer"},"QuickDraw dataset"),". Upload any image below to try it out!"),e?m.createElement("div",{className:"cartoonify-upload-loading"},m.createElement(bk,null)):m.createElement("div",{className:"cartoonify-upload"},m.createElement(YN,{disallowVideo:!0,handleFinish:this.handleFinish,isCartoonify:!0})))),m.createElement("div",{className:"cartoonify-samples"},m.createElement("div",{className:"cartoonify-samples-header"},"Gallery"),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/LXZP7Gm.jpg",alt:"married couple",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/F83jS5G.png",alt:"married couple cartoon",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/L5hSdaH.jpg",alt:"dog with ball",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/F4xVyJP.png",alt:"dog with ball cartoon",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/TXbUKFV.png",alt:"dinner setting cartoon",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/zqrSkcL.jpg",alt:"dinner setting",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/cmbzJD2.png",alt:"cake cartoon",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/a38OHga.jpg",alt:"cake",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/boD9cbO.jpg",alt:"couple",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/yGA2WrC.png",alt:"couple cartoon",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/6cQPGMG.jpg",alt:"cat",className:"cartoonify-sample-image"})),m.createElement("div",{className:"cartoonify-sample-image-container"},m.createElement("img",{src:"https://i.imgur.com/5RWBf1S.png",alt:"cat",className:"cartoonify-sample-image"}))),m.createElement("div",{className:"cartoonify-container"},m.createElement("div",{className:"cartoonify-samples-header"},"About this project"),m.createElement("div",{className:"cartoonify-description"},m.createElement("b",null,"Cartoonify")," uses a neural network to turn your uploaded photo into a unique cartoon. This project was based off of Dan Macnish's"," ",m.createElement("a",{href:"http://danmacnish.com/2018/07/01/draw-this/"},"Draw This project"),", which was a camera that turned the images it took into cartoons.",m.createElement("p",null,"Instead of requiring a Raspberry Pi based camera, this site allows anyone to try cartooning any image."),m.createElement("p",null,"For best results, try using images with clear objects on a solid background."),m.createElement("p",{className:"cartoonify-bottom-hero-image-container"},m.createElement("img",{src:"https://i.imgur.com/vyiDq0y.png",alt:"bicycles",className:"cartoonify-bottom-hero-image"})))),m.createElement("div",{className:"share-footer"},m.createElement(Ne,{url:"https://www.kapwing.com/cartoonify",quote:"Cartoonify - can a neural network turn your photo into a simple cartoon?",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/cartoonify",title:"Cartoonify - can a neural network turn your photo into a simple cartoon?",via:"kapwingapp",hashtags:["cartoon","ai"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0})),m.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),m.createElement(HC,null))}}const rA=ie(i.exports.connect((e=>({sourceVideo:e.sourceVideo})),(e=>he({showError:wh,createCartoonifyImage:zN},e)))(nA));function iA(){const e={};if(window.Rewardful){const{affiliate:t,referral:a}=window.Rewardful||{},{name:o}=t||{};o&&(e.affiliate=o),a&&(e.referral=a)}return E(e)?void 0:e}const sA=(e,t,a,o,n)=>(r,i)=>{const{token:s,user:l}=i().currentUser||{},c={userId:l._id,teamId:e,planTier:t,paymentTerm:a,stripeToken:o,token:s,chargeOptions:n},d=iA();return d&&(c.chargeOptions.rewardful=d),op("/api/v2/payment/updatePlan",{body:c}).then((e=>(r(_g()),console.info(e),e)))},lA=(e,t,a,o,n,r)=>(i,s)=>{const{currentUser:l}=s(),{token:c,user:d}=l||{},u={userId:d._id,teamId:e,planTier:t,paymentTerm:a,stripeToken:o,token:c,chargeOptions:n,...r},m=iA();return m&&(u.chargeOptions.rewardful=m),op("/api/v2/payment/chargePlan",{body:u}).then((e=>(om(l)&&(i(_g()),Og()),console.info(e),e))).catch((e=>{throw console.error(e.message),new Error(e)}))};function cA(e){return{type:"SHOW_PAYWALL",...e}}function dA(e,t){return(a,o)=>{const{token:n}=o().currentUser||{};return op("/api/v2/payment/updateInfo",{body:{stripeToken:e,token:n,stripeId:t}})}}const uA="PaymentFormDiscountCode-module_container_FvgvU",mA="PaymentFormDiscountCode-module_havePromoCodeContainer_RTHe0",pA="PaymentFormDiscountCode-module_showInputButton_Cx0xB",hA="PaymentFormDiscountCode-module_inputError_ZPZV9",gA="PaymentFormDiscountCode-module_successMsg_PiTSi",fA="PaymentFormDiscountCode-module_errorMsg_vOG57",yA="PaymentFormDiscountCode-module_applyButton_navg9",EA="PaymentFormDiscountCode-module_clearButton_bHgfZ",_A="PaymentFormDiscountCode-module_discountCodeInputContainer_rfKCb",vA="PaymentFormDiscountCode-module_discountCodeInput_KkTow";const wA=({discountCode:e,onChange:t,discountAmount:a,discountErrorMsg:o,validateCode:r,successMessage:i})=>{const[s,l]=n.exports.useState(!1);let c=a;c.includes("$")&&(c=a.replace("$",""),c=`$${c}`);const d=(()=>{const{search:e}=oe();return m.useMemo((()=>new URLSearchParams(e)),[e])})();if(n.exports.useEffect((()=>{const e=d.get("promo");e&&(l(!0),r(e))}),[d,r]),a)return m.createElement("span",{className:gA},"Code applied!"," ",i||m.createElement(m.Fragment,null,"You save ",c,"."));if(!s)return m.createElement("div",{className:mA},m.createElement("div",null),m.createElement("button",{type:"button",onClick:()=>l(!0),className:pA},"Have a promo code?"));return m.createElement(m.Fragment,null,m.createElement("div",{className:uA},m.createElement("div",{className:_A},m.createElement("input",{className:`${vA} ${o?hA:""}`,id:"kapwing-discount-code",value:e,placeholder:"Enter Promo Code",onChange:e=>t(e.target.value)}),m.createElement("button",{type:"button",onClick:()=>r(),className:yA},"Apply"),m.createElement("button",{type:"button",onClick:()=>{t(""),l(!1)},className:EA},"Cancel"))),o&&m.createElement("span",{className:fA},o))},bA="ModalPaymentForm-module_emailInput_0WzbI",SA="ModalPaymentForm-module_nameInput_niDqo",TA="ModalPaymentForm-module_expressCheckoutContainter_BI3PL",IA="ModalPaymentForm-module_expressCheckoutButton_5WE1O",kA="ModalPaymentForm-module_expressCheckoutText_H8RCF",CA="ModalPaymentForm-module_loading_7KB5J",NA="ModalPaymentForm-module_stripeInput_9kht2",AA="ModalPaymentForm-module_stripeInputFocused_zlIki",xA="ModalPaymentForm-module_paymentFormContainer_w29Zf",PA="ModalPaymentForm-module_separator_60Yo6",RA="ModalPaymentForm-module_upgradeButton_9DDLp",OA="ModalPaymentForm-module_paymentFormLabel_G5-tL",DA="ModalPaymentForm-module_stripeForm_-i2k-",LA="Disclaimer-module_disclaimer_5eE9b",UA="Disclaimer-module_underlineLink_v-1C8",MA=({email:e,planTier:t})=>m.createElement("div",{className:LA},"By upgrading, you understand the subscription will auto renew until cancelled. You agree to Kapwing's"," ",m.createElement("a",{href:"/policies/terms-of-service",target:"_blank",rel:"noopener",className:UA},"Terms of Service")," ","and"," ",m.createElement("a",{href:"/policies/refund",target:"_blank",rel:"noopener",className:UA},"Refund Policy"),". Learn more about Kapwing ",Eu(t).displayTier," ",m.createElement("a",{href:"/pricing",target:"_blank",rel:"noopener",className:UA},"pricing here"),". Upon payment, your team will be upgraded and a receipt will be emailed",e&&` to ${e}`,".");function FA(e){if(!e)return;const{createdAt:t}=e;if(!t)return;const a=new Date(t),o=vo.find((e=>function(e,t){const a=(Date.now()-t.getTime())/864e5,{activeOnDay:o,expiresOnDay:n}=_o[e];return!(a<o||a>n)}(e,a)));return o}const BA="DripPromo-module_promoContainer_JW-94",WA="DripPromo-module_safetySpan_1e-RD",VA=({hide:e,setDiscountCode:t,paymentTerm:a})=>{const o=cn((e=>e.currentUser));if(!om(o))return null;const{user:n}=o,r=FA(n);if(!r||e)return null;const i=Math.floor(function(e,t){if(!t)return 0;const{createdAt:a}=t,o=new Date(a),n=(Date.now()-o.getTime())/864e5,{expiresOnDay:r}=_o[e],i=r-n;return i<0?0:i}(r,n));return m.createElement("div",{className:BA,onClick:()=>t(r)},"Click to get ",_o[r].discountPercentage,"% off for your first"," ",m.createElement("span",{className:WA},a===Vd.MONTHLY?"month":"year"),", valid for ",i," more day",m.createElement("span",{className:WA},1===i?"":"s"),"!")};class jA{constructor(){t(this,"discountAmount"),t(this,"discountedPrice"),t(this,"discountErrorMsg"),t(this,"discountSuccessMsg"),t(this,"validating"),this.discountAmount="",this.discountedPrice="",this.discountErrorMsg="",this.discountSuccessMsg="",this.validating=!1}getDiscountPrice(e){return this.discountAmount&&this.discountedPrice?parseFloat(this.discountedPrice):e}}const HA=({elements:e,name:t,email:a,onCharged:o=(()=>{}),stripe:r,setEmail:s,setName:l,setSubmitting:c,submitText:d="",submitting:u,upgradeTier:p,upgradeTerm:h,setTelemetryDiscountAmount:g,setTelemetryDiscountCode:f,setFinalPrice:y,team:E})=>{const _=i.exports.useDispatch(),v=cn((e=>e.currentUser)),w=cn((e=>e.theme.darkMode)),b=Ru(),{executeRecaptcha:S}=ue(),T=n.exports.useRef(null),[I,k]=n.exports.useState(""),[C,N]=n.exports.useState(new jA),[A,x]=n.exports.useState(null),[P,R]=n.exports.useState("dark"),[O,D]=n.exports.useState(ru.SAVED_CARD),L=Iu(p,{paymentTerm:h}),U=L.getPriceForTeam(E),M=cn((e=>{var t;return(null==(t=e.checkoutStore[E._id])?void 0:t.prorationDiscount)||0})),F=Math.min(M,U),B=U-F,W=C.getDiscountPrice(B);n.exports.useEffect((function(){y(W)}),[W,y]);const V=cn((e=>e.config.RECAPTCHA_V3_SITEKEY)),j=cn((e=>e.config.RECAPTCHA_V2_SITEKEY)),H=n.exports.useCallback((async(e,t)=>{var a;if(!S)throw new Error("Recaptcha loading ... please try again in a few seconds.");const o={v3CaptchaToken:await S("paywallModal"),v2CaptchaToken:null==(a=T.current)?void 0:a.getValue(),recaptchaKeyV3:V};if(!e)return _(lA(E._id,L.planTier,L.paymentTerm,e,{},o));const n={email:t};C.discountedPrice&&I&&(n.discountCode=I);try{return await _(lA(E._id,L.planTier,L.paymentTerm,e,n,o))}catch($ae){return setTimeout((()=>{throw _({type:"HIDE_PAYWALL"}),_(_g()),Error("Something went wrong. Please refresh the page and try again.")}),5e3),null}}),[I,C.discountedPrice,_,L,S,V,E._id]),G=(e,t)=>`Kapwing ${e} ${t} Plan`,$=n.exports.useCallback((async e=>{c(!0);try{const t=await H(e.token,e.payerEmail),a=null==t?void 0:t.sentEmail,n=null==t?void 0:t.alreadyUpgraded;a&&_(bh("We've sent you an email explaining how to claim your account.")),n&&_(bh("You already have a Pro account and your card was not charged. Please sign in to access your account.")),s(e.payerEmail||""),o(n,O),e.complete("success")}catch(t){console.error(t),cf(t)&&z(!0),_(wh(t.message)),e.complete("fail")}c(!1)}),[H,_,o,c,s,O]),K=n.exports.useRef($);n.exports.useEffect((()=>{K.current=$}),[$]),n.exports.useEffect((()=>{if(r&&!A){const e=r.paymentRequest({country:"US",currency:"usd",total:{label:G(L.planTier,L.paymentTerm),amount:Math.round(100*(U||0))},requestPayerName:!1,requestPayerEmail:!om(v)});e.canMakePayment().then((t=>{t&&(t.applePay?D(ru.APPLE_PAY):t.googlePay?D(ru.GOOGLE_PAY):R("light-outline"),e.on("token",(e=>K.current(e))),x(e))}))}}),[r,U,L.planTier,L.paymentTerm,A,v]),n.exports.useEffect((()=>{const e=G(L.planTier,L.paymentTerm);null==A||A.update({total:{label:e,amount:Math.round(100*W)}})}),[A,L.planTier,L.paymentTerm,W]);const[Y,z]=n.exports.useState(!1),[q,J]=n.exports.useState(!1),X=n.exports.useCallback((async(e=I)=>{const t=new jA;t.validating=!0,N(t),null==f||f(void 0),null==g||g(void 0);try{if(!e){const e=new jA;return e.discountErrorMsg="Please enter a valid promo code.",N(e),null==f||f(void 0),void(null==g||g(void 0))}const{discountAmount:t,discountedPrice:a,successMessage:o}=await async function(e,t,a){const{state:o}=io(),{user:n}=o.currentUser||{};return op("/api/v2/payment/validateDiscountCode",{body:{code:e,planTier:t,paymentTerm:a,userId:n._id}})}(e,L.planTier,L.paymentTerm),n=new jA;n.discountAmount=t,n.discountedPrice=a,n.discountSuccessMsg=o,N(n),null==f||f(e),null==g||g(t)}catch($ae){console.error($ae);const t=new jA;t.discountErrorMsg=$ae.message||"That discount code is invalid.",N(t)}}),[I,g,f,L.planTier,L.paymentTerm]);n.exports.useEffect((()=>{k(""),N(new jA)}),[L.planTier,L.paymentTerm]);const Q=async()=>{if(!u){c(!0);try{const i=await(async()=>{if(!e||!r)throw new Error("Payment elements loading ... please try again in a few seconds.");const a=e.getElement(De);if(!a)throw new Error("Could not find card element ... please try again in a few seconds.");if(!t)throw new Error("Please enter the full name on your card.");const{error:o,token:n}=await r.createToken(a,{name:t});if(o)throw new Error(o.message);return n})();if(!i&&!E.stripeId)throw new Error("No Stripe payment token found.");if(window.Cypress){try{await _(lA("62d05502e52697c80ee71204",jd.PRO,Vd.ANNUALLY,i,{})),await o()}catch(n){console.error(n)}return void c(!1)}if(!Uu(b.planTier,E)&&b.planTier===L.planTier)return c(!1),void wh(`You already have a license to the ${L.displayPlanTier}`);try{const{sentEmail:e,alreadyUpgraded:t,stripeCustomerId:n,stripeOrderAmountInDollars:r,stripeChargeId:s}=await H(i,a);e&&_(bh("We've sent you an email explaining how to claim your account.")),t&&_(bh("You already have a Pro account and your card was not charged. Please sign in to access your account.")),o(t),t||((e,t,a)=>{window&&window.Tapfiliate&&a&&t&&a&&window.Tapfiliate("conversion",e,t,{customer_id:a})})(s,r,n)}catch(n){console.error(n),_(wh(n.message)),cf(n)&&z(!0)}}catch($ae){_(wh($ae.message))}}};return m.createElement("div",{className:xA},A&&m.createElement("div",null,m.createElement("div",{className:TA},m.createElement("div",{className:kA},"Express Checkout"),m.createElement("div",{className:`${IA} expressCheckout`},m.createElement(Oe,{options:{paymentRequest:A,style:{paymentRequestButton:{type:"default",theme:P,height:"34px"}}}}))),m.createElement("div",{className:PA},"OR")),m.createElement("form",{onSubmit:e=>{e.preventDefault(),Q()},className:DA},m.createElement(m.Fragment,null,!om(v)&&m.createElement("label",{className:OA},"Email Address",m.createElement("input",{className:bA,onChange:e=>{s(e.target.value)},placeholder:"email@example.com",type:"email",value:a})),m.createElement("label",{className:OA},"Name on card",m.createElement("input",{className:SA,onChange:e=>{l(e.target.value)},placeholder:"Full Name",type:"text",value:t})),m.createElement("label",{className:OA},"Card Info",m.createElement(De,{className:q?AA:NA,onFocus:()=>J(!0),onBlur:()=>J(!1),options:{style:{base:{fontFamily:"monospace",fontSmoothing:"antialiased",letterSpacing:"0.025em",fontWeight:"500",color:w&&!q?"white":"#424770","::placeholder":{color:"#aab7c4"},":focus":{color:"#424770"}}}}}))),!L.isMultiUser&&!E.stripeId&&m.createElement(m.Fragment,null,m.createElement(wA,{discountCode:I,onChange:k,discountErrorMsg:C.discountErrorMsg,discountAmount:C.discountAmount,validateCode:X,successMessage:C.discountSuccessMsg}),m.createElement(VA,{hide:!!C.discountAmount||L.planTier===jd.BASIC,setDiscountCode:e=>{k(e),X(e)},paymentTerm:L.paymentTerm})),m.createElement(m.Fragment,null,Y&&m.createElement("div",{style:{marginBottom:"10px"}},m.createElement(pe,{sitekey:j,ref:T})),m.createElement("button",{className:RA,"data-cy":"submit-payment-button",type:"submit",disabled:u},u?m.createElement("div",{className:CA},"Submitting payment ... please wait"):d),m.createElement(MA,{email:a,planTier:p}))))},GA=e=>m.createElement(Re,null,(({elements:t,stripe:a})=>m.createElement(HA,{...e,elements:t,stripe:a})));function $A(){return e=>op("/api/v1/users/token/refresh").then((t=>{e({type:"SET_TOKEN",token:t.token})}))}var KA=(e=>(e[e.basicPlan=0]="basicPlan",e))(KA||{});const YA={0:{hide:["US","UK","CA","GB"],show:"all",fallback:"hide"}},zA=async(e,t,a,o)=>{const{fallback:n,hide:r=[],show:i=[]}=YA[e],s="show"===n,l=await(async(e,t,a=!1)=>{if(!sessionStorage)return null;if(a)return(null==t?void 0:t.country)?t.country:null;const o=sessionStorage.getItem("GEOLOCATION_LOCAL_STORAGE_KEY");if(o&&!t)return o;if(o&&(null==t?void 0:t.country)===o)return o;const{country:n}=await e();return sessionStorage.setItem("GEOLOCATION_LOCAL_STORAGE_KEY",n),n})(t,a,o);return l?["T1","XX"].includes(l)?s:!r.includes(l)&&"all"!==r&&(!("all"!==i&&!i.includes(l))||s):s},qA=(JA=n.exports.useEffect,XA=n.exports.useState,QA=async()=>{const e=await op("/api/v1/users/location");return Og(),e},ZA=()=>cn((e=>e.currentUser.user)),ex=()=>Xg(cn((e=>e.currentUser))),e=>{const[t,a]=XA("show"===YA[e].fallback),o=null==ZA?void 0:ZA(),n=null==ex?void 0:ex();return JA((function(){(async()=>{a(await zA(e,QA,o,n))})()}),[o,e,n,QA]),t});var JA,XA,QA,ZA,ex;let tx=()=>{};function ax(e){tx=e}function ox(){ax((()=>{}))}const nx="ModalConfirmButtons-module_disabled_fcnTC",rx="ModalConfirmButtons-module_primaryButton_61ELD",ix="ModalConfirmButtons-module_secondaryAction_7nwCf",sx="ModalConfirmButtons-module_secondaryActionNoTransparency_dTMhw",lx="ModalConfirmButtons-module_loading_8AeVe",cx="ModalConfirmButtons-module_innerWrapper_4HFB8",dx="ModalConfirmButtons-module_leftOnMobile_DeJ03",ux=({cancelFn:e,confirmFn:t,loadingMsg:a,disabled:o,confirmText:n,cancelText:r,cancelStyle:i,cancelButtonNoTransparency:s,stayRightOnMobile:l,stopClickPropogation:c=!1,confirmButtonClassName:d})=>{if(a)return m.createElement("div",{className:lx},a);const u=e=>{c&&e.stopPropagation(),o||null==t||t()},p=t=>{c&&t.stopPropagation(),null==e||e()};return Rn()&&!l?m.createElement("div",{className:cx}," ",m.createElement("div",{className:`${rx} ${o?nx:""} ${d}`,onClick:u,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button"},n||"Confirm"),e&&m.createElement("div",{onClick:p,className:ix,"data-testid":"workspace-modal-cancel-button"},r||"Never mind")):m.createElement("div",{className:cx},e&&m.createElement("div",{onClick:p,className:`${ix} ${s?sx:""} ${l?"":dx}`,"data-testid":"workspace-modal-cancel-button",style:i},r||"Never mind"),m.createElement("div",{className:`${rx} ${o?nx:""} ${l?"":dx} ${d}`,onClick:u,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button"},n||"Confirm"))},mx="OverlayWrapper-module_noScrollBar_X1p-e",px="OverlayWrapper-module_overlayBackground_yJQ-2",hx="OverlayWrapper-module_overlayContainer_-eKQr",gx="OverlayWrapper-module_overlayContainerPadding_YKOn9",fx="OverlayWrapper-module_overlayContainerSmall_F4IKo",yx="OverlayWrapper-module_overlayContainerSmaller_-TigE",Ex="OverlayWrapper-module_exit_huBkG",_x="OverlayWrapper-module_overlayContent_o-zKg",vx="OverlayWrapper-module_header_Eoz17",wx="OverlayWrapper-module_buttonsContainer_9lDny",bx="OverlayWrapper-module_dark_Buyxp",Sx="OverlayWrapper-module_noPadding_kYio9",Tx=i.exports.connect((e=>({overlay:e.projectSessionSettings.overlay})),(e=>he({hideOverlay:yi},e)));class Ix extends n.exports.Component{constructor(){super(...arguments),t(this,"escFunction",(e=>{const{unsetCancelModal:t}=this.props;"Escape"===e.key&&t&&t()})),t(this,"hide",(()=>{const{unsetCancelModal:e,overlay:t,hideOverlay:a}=this.props;e?e():t&&t.key&&a()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?gx:this.props.overlayContainerSmall?fx:this.props.overlayContainerSmaller?yx:hx}get showCloseButton(){const{noCloseButton:e,unsetCancelModal:t,overlay:a}=this.props;return!e&&(t||(null==a?void 0:a.key))}renderContent(){const{afterElement:e,children:t,confirmButtonOptions:a,className:o,dark:r,id:i,onClick:s,style:l,onDrop:c,onDragOver:d,onDragEnter:u,cypressName:m,noScrollBar:p,noPadding:h}=this.props;return n.exports.createElement("div",{id:i,onClick:e=>null==s?void 0:s(e)},n.exports.createElement("div",{className:px,onClick:this.hide,"data-cy":`${m||"overlay"}-background`,onDrop:c,onDragOver:d,onDragEnter:u}),n.exports.createElement("div",{className:`${this.getContainerStyle()} ${r?bx:""} ${o||""} ${p?mx:""}`,style:l,onDrop:c,onDragOver:d,onDragEnter:u},n.exports.createElement("div",{className:`${_x} ${h?Sx:""}`},t,a&&n.exports.createElement("div",{className:wx},n.exports.createElement(ux,{cancelFn:this.hide,...a}))),this.showCloseButton&&n.exports.createElement("div",{className:Ex,onClick:this.hide,"data-cy":`${m||"overlay"}-close`},n.exports.createElement(Ee,null))),e)}render(){const{usePortal:e}=this.props;if(!e)return this.renderContent();const t=".app-container",a=document.querySelector(t);return a?ye.createPortal(this.renderContent(),a):(console.error(`Expected ${t} to exist in the DOM`),this.renderContent())}}t(Ix,"Header",(({children:e})=>n.exports.createElement("div",{className:vx},e)));const kx=Tx(Ix),Cx="OverlayWrapper-module_overlayHeader_14EqT",Nx="OverlayWrapper-module_overlayBackground_tYQaR",Ax="OverlayWrapper-module_overlayInput_pNrjg",xx="OverlayWrapper-module_overlayContainer_LErTM",Px="OverlayWrapper-module_videoPreviewOverlayContainer_DzSZ1",Rx="OverlayWrapper-module_overlayContainerNoPadding_pO7Nr",Ox="OverlayWrapper-module_overlayContainerNoScrollbar_KZ1yE",Dx="OverlayWrapper-module_smallOverlayContainer_N3-vX",Lx="OverlayWrapper-module_miniOverlayContainer_y8m-s",Ux="OverlayWrapper-module_miniLightOverlayContainer_Vjyth",Mx="OverlayWrapper-module_versionHistoryOverlayContainer_Wjnrx",Fx="OverlayWrapper-module_lightThemeOverlayContainer_u9XTJ",Bx="OverlayWrapper-module_smallLightThemeOverlayContainer_eCk5q",Wx="OverlayWrapper-module_replaceOverlayContainer_g1EYo",Vx="OverlayWrapper-module_uploadOverlayContainer_49dxN",jx="OverlayWrapper-module_fontOverlayContainer_o0-nD",Hx="OverlayWrapper-module_uploadOverlayResultsContainer_9PTJo",Gx="OverlayWrapper-module_signInOverlayContainer_ZMa78",$x="OverlayWrapper-module_exit_IbZ9z",Kx="OverlayWrapper-module_darkExit_eBe8W",Yx="OverlayWrapper-module_exportPanelOverlayContainer_GhIQF",zx="OverlayWrapper-module_overlayContent_IyJac",qx="OverlayWrapper-module_overlayContentNoFlex_yhAX8",Jx="OverlayWrapper-module_description_tB4Y9",Xx="OverlayWrapper-module_buttonRow_02CMd",Qx="OverlayWrapper-module_primaryButton_cMla-";class Zx extends n.exports.Component{constructor(e){super(e),t(this,"uploaderMounted",(()=>{const{location:e}=this.props;return e.pathname.includes("drag-upload")})),t(this,"setFiles",(e=>{var t,a;this.setState({uploadInProgress:!0}),null==(a=(t=this.props).onFilesChanged)||a.call(t,e)})),t(this,"handleDragUpload",(e=>{var t,a;this.setState({uploadInProgress:!0}),null==(a=(t=this.props).onFilesChanged)||a.call(t,e.target.files)})),t(this,"handleClick",(()=>{const{history:e,goBackToSelectedLayer:t,goBackToEditor:a,editorPath:o,selectedLayerId:n,overlay:r,hideOverlay:i,onClose:s}=this.props;s?s():r&&r.key?i():t&&n?e.goBack():a?Ml(o):e.goBack()})),t(this,"handleFileDrop",(e=>{this.setFiles(e.dataTransfer.files),e.preventDefault(),e.stopPropagation()})),t(this,"handleDragOver",(e=>{e.preventDefault(),e.stopPropagation()})),t(this,"handleDragEnter",(e=>{e.preventDefault(),e.stopPropagation()})),t(this,"renderDragInput",(()=>this.uploaderMounted()&&!this.state.uploadInProgress&&m.createElement("input",{"data-cy":"upload-input",className:Ax,accept:this.props.accept||"image/*,video/mp4,video/*",onChange:this.handleDragUpload,type:"file",multiple:!0,onDragLeave:Fl}))),this.state={videoPlayingOnMount:!1}}componentDidMount(){const{subtitleVideo:e,previewVideo:t}=this.props;this.setState({videoPlayingOnMount:!this.props.studioPaused}),this.props.pauseStudio(),e&&e.pause(),t&&t.pause(),ow()}componentDidUpdate(){this.props.studioPaused||this.props.pauseStudio()}componentWillUnmount(){this.state.videoPlayingOnMount&&Gb(),nw()}render(){const{children:e,keepScrollbar:t}=this.props;let a=xx,o=$x;this.props.small?a=Dx:this.props.lightTheme?(a=Fx,o+=` ${Kx}`):this.props.smallLightTheme?(a=Bx,o+=` ${Kx}`):this.props.uploadOverlayResultsTheme?a=Hx:this.props.replace?a=Wx:this.props.uploadOverlayTheme?a=Vx:this.props.fontOverlayTheme?a=jx:this.props.signInDialog?(a=Gx,o+=` ${Kx}`):this.props.mini?a=Lx:this.props.miniLight?a=Ux:this.props.versionHistory?a=Mx:this.props.useExportPanelStyle?a=Yx:this.props.noPadding?a=Rx:this.props.videoPreview&&(a=Px),t||(a=`${a} ${Ox}`);const n=document.querySelector(".app-container");if(!n){const e="Couldn't find .app-container to mount OverlayWrapper to.";return sn()?console.error(`${e} ${ln}`):console.error(e),null}return ye.createPortal(m.createElement("div",{onDrop:this.handleFileDrop,onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter},m.createElement("div",{className:Nx,onClick:this.handleClick,"data-cy":"overlay-background"}),this.renderDragInput(),m.createElement("div",{className:a,"data-cy":"overlay-container",style:(()=>{const{width:e,backgroundColor:t,noMaxWidth:a,maxWidth:o}=this.props;let n={};return e&&(n={...n,width:e}),t&&(n={...n,backgroundColor:t}),o?n={...n,maxWidth:o}:a||o||(n={...n,maxWidth:800}),n})()},!this.props.hideClose&&m.createElement("div",{"data-cy":"overlay-close",className:o,onClick:this.handleClick},m.createElement(Ee,null)),m.createElement("div",{className:(()=>this.props.overlayContentNoFlex?qx:zx)()},e))),n)}}const eP=ie(i.exports.connect((e=>{var t;return{editorPath:e.editorPath,overlay:e.projectSessionSettings.overlay,previewVideo:e.previewVideo,selectedLayerId:(null==(t=e.studio.selectedItem)?void 0:t.id)||"",studioPaused:e.studio.studioPaused,subtitleVideo:e.subtitleVideo}}),(e=>he({hideOverlay:yi,pauseStudio:i_,updateClipboard:ps},e)))(Zx)),tP={modalBackground:"UpgradeModal-module_modalBackground_Ow9-8",paywallTitle:"UpgradeModal-module_paywallTitle_zsuH0",bgImgLeft:"UpgradeModal-module_bgImgLeft_BDFCm",paywallContainer:"UpgradeModal-module_paywallContainer_66aIt",bgImgRight:"UpgradeModal-module_bgImgRight_CptAh",paywallColumns:"UpgradeModal-module_paywallColumns_zVAmJ",paywallLeft:"UpgradeModal-module_paywallLeft_fAgXB",paywallRight:"UpgradeModal-module_paywallRight_68LcA",flexRight:"UpgradeModal-module_flexRight_WXjFi",flexLeft:"UpgradeModal-module_flexLeft_mqEHL",returnLink:"UpgradeModal-module_returnLink_jTS-W",tierWrapper:"UpgradeModal-module_tierWrapper_sEQBj",tierColumn:"UpgradeModal-module_tierColumn_wkBJm"};var aP=(e=>(e[e.Track=1]="Track",e[e.Trimmer=4]="Trimmer",e[e.DraggedTrack=5]="DraggedTrack",e[e.TimelineRowColumn=6]="TimelineRowColumn",e[e.TimeLabel=10]="TimeLabel",e[e.Comment=10]="Comment",e[e.SelectedComment=11]="SelectedComment",e[e.Seeker=12]="Seeker",e[e.DraggedSeeker=13]="DraggedSeeker",e[e.DraggedTrackTrimmer=13]="DraggedTrackTrimmer",e[e.InvisibleTrimmerHandle=14]="InvisibleTrimmerHandle",e[e.RowHighlight=22]="RowHighlight",e))(aP||{});const oP=30,nP=60,rP=30,iP=25,sP=10,lP=20,cP=30,dP=30,uP=25,mP=.01,pP=5,hP=.001,gP=25,fP=20;var yP=(e=>(e.TrimEnd="TrimEnd",e.TrimStart="TrimStart",e.Drag="Drag",e.None="None",e))(yP||{});const EP=(e,t)=>t/e,_P=(e,t)=>t*e,vP=(e,t)=>{let a=(t-25)/e;return a<0&&(a=0),a},wP=(e,t)=>{let a=t*e+25;return a<0&&(a=25),a};function bP(e,t){const a=io().state.studio.allLayers.byId[t];if(!a)return[];if("subtitle"===a.type){let t=0;return e.every(((e,a)=>"subtitle"!==e.type||(t=a,!1))),e.slice(t)}const o=[];return e.every((e=>"subtitle"!==e.type&&(e.timelineRow===a.timelineRow&&o.push(e),!0))),o}const SP=e=>{const t=new Map;return e.forEach((e=>{const{timelineRow:a}=e;if(void 0!==a){const o=t.get(a);o?(o.push(e),t.set(a,o)):t.set(a,[e])}})),t},TP=e=>{const t=SP(e);for(const[a,o]of t){const e=o.sort(((e,t)=>Vv(e,0)[0]-Vv(t,0)[0]));for(let t=0;t<e.length-1;t+=1){const a=e[t],o=e[t+1];if(!$r(a)&&!Hr(a)||!$r(o)&&!Hr(o))continue;if(Vv(a,0)[1]+.01>=Vv(o,0)[0])return!0}}return!1},IP=e=>e.some((e=>$r(e)||Hr(e))),kP=.25,CP=(e,t,a)=>{var o,n;const{timelineContainerWidth:r}=e.studioLocal,i=null!=(n=null==(o=e.projectSessionSettings.timelinePosition)?void 0:o.timelineScrollLeft)?n:0,s=Hn(e);return s?t.filter((e=>{const[t,o]=Vv(e,0),n=wP(s,t);return!(wP(s,o)<=(a?i:i-.25*r)||(a?i+r:i+r+.25*r)<=n)})):[]},NP=(e,t)=>{var a,o;const{timelineContainerWidth:n}=e.studioLocal,r=null!=(o=null==(a=e.projectSessionSettings.timelinePosition)?void 0:a.timelineScrollLeft)?o:0,i=Hn(e);return i?t.filter((e=>{const[t,a]=Vv(e,0),o=wP(i,t),s=wP(i,a),l=r+n;return r<=o&&o<=l||r<=s&&s<=l})):[]},AP=new Map([["linear",{displayName:"Linear",x1:0,y1:0,x2:1,y2:1}],["ease-in",{displayName:"Ease In",x1:.42,y1:0,x2:1,y2:1}],["ease-out",{displayName:"Ease Out",x1:0,y1:0,x2:.58,y2:1}],["ease-in-out",{displayName:"Ease In & Out",x1:.25,y1:.1,x2:.25,y2:1}]]),xP=(e,t)=>{if(!e)return null;const{startValues:a,endValues:o}=e,{topLeft:{x:n,y:r},bottomRight:{x:i}}=a,{topLeft:{x:s,y:l},bottomRight:{x:c}}=o,d=((e,t)=>{const{startTime:a,duration:o}=e,n=t-a,r=Math.min(n/o,1),i=AP.get(e.easingFuncID),{x1:s,y1:l,x2:c,y2:d}=i;return O(s,l,c,d)(r)})(e,t),u=[s-n,l-r].map((e=>e*d)),m={x:u[0]+n,y:u[1]+r},p=Math.abs(i-n),h=(Math.abs(c-s)-p)*d+p;return{topLeft:m,bottomRight:{x:m.x+h,y:m.y+h}}},PP=(e,t)=>{let a=e?{...e}:void 0;if(t){const{topLeft:{x:e,y:o},bottomRight:{x:n,y:r}}=t,i=100*(n-e),s=100*(r-o),l=100*e,c=100*o;if(a){const{x:e,y:t,width:o,height:n}=a;a={x:e+l/100*o,y:t+c/100*n,width:o*(i/100),height:n*(s/100)}}else a={x:l,y:c,width:i,height:s}}return a},RP=e=>!(!e||!e.keyframeAnimation)&&"moving-zoom"===e.keyframeAnimation.id,OP=e=>{var t;if(!RP(e))return null;const a=null==(t=e.keyframeAnimation)?void 0:t.transitions[0];return a?{...a}:null},DP={name:"Moving Zoom",id:"moving-zoom",transitions:[{id:"moving-zoom-transition",easingFuncID:"linear",startValues:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},endValues:{topLeft:{x:.15,y:.15},bottomRight:{x:.85,y:.85}}}]},LP=[DP],UP=(e,t,a)=>{const o=OP(e),n=xP(o,t);if(a)return e.crop;return PP(e.crop,n)},MP=(e,t)=>{const{keyframeAnimation:a}=e,o=null==a?void 0:a.transitions[0];if(!a||!o)return null;const n={...o,...t};return{keyframeAnimation:{...e.keyframeAnimation,transitions:[n]}}},FP=(e,t,a,o)=>{var n;const{state:r}=io(),i=r.studio.allLayers.byId[e];if(!i)return;const s=(null==(n=r.studioLocal.layerTempValues[i.id])?void 0:n.inlineCropAspectRatio)||null;tr.withUndoBatch((()=>{tr.add({undo:Ms(i.id,{inlineCropAspectRatio:o}),redo:Ms(i.id,{inlineCropAspectRatio:s})}),tr.add({undo:ds(i,{crop:t,position:a}),redo:ds(i,{crop:i.crop,position:i.position})})}))()},BP=(e=null)=>{var t,a,o,n,r,i;const{state:s}=io(),l=oS(s)[0],c=e||l,d=s.studioLocal.layerTempValues[c.id].crop,u=c.width,m=c.height;return+((null!=(o=null!=(a=null==d?void 0:d.width)?a:null==(t=c.crop)?void 0:t.width)?o:100)*u/100/((null!=(i=null!=(r=null==d?void 0:d.height)?r:null==(n=c.crop)?void 0:n.height)?i:100)*m/100)).toFixed(2)},WP=e=>{const{state:t}=io(),a=oS(t)[0];if(!e||!a)return;const o=Vc(a);if(!o)return;const{width:n,height:r}=o,i=a.width||n,s=a.height||r;if(BP(a)===e)return;let l,c;const d=e>1||1===e&&i<=s;d?(l=i,c=l/e):(c=s,l=c*e),l>i&&!d&&(l=i,c=l/e),c>s&&d&&(c=s,l=c*e);const u=c/s*100,m=l/i*100;let p=0,h=0;if(u<100){h=(s-c)/2}if(m<100){p=(i-l)/2}const g={x:p/i*100,y:h/s*100,height:u,width:m};zl(a.id,{crop:g}),VP()},VP=(e=!1)=>{var t,a;const{state:o,dispatch:n}=io(),r=oS(o)[0];if(!r)return;const i=o.studioLocal.layerTempValues[r.id].crop,s=null==(t=o.studioLocal.layerTempValues[r.id])?void 0:t.positionTemp,l=o.studio.width||100,c=o.studio.height||100,d=s||r.position,u=i;if(!u||!d)return;const{crop:m}=r,{height:p,width:h,x:g,y:f}=m||{height:100,width:100,x:0,y:0},y=Vc(r);if(!y)return;const{height:E,width:_}=y,v=u.height/p,w=p-u.height,b=u.width/h,S=u.width-h,T=_/l,I=E/c,k=_*h/200+g*_/100-l/2,C=E*p/200+f/100*E-c/2,N={x:_*u.width/200+_*u.x/100-l/2-k,y:E*u.height/200+E*u.y/100-c/2-C},{x:A,y:x}=N,[P,R]=((e,t)=>{const{state:a}=io(),o=oS(a)[0],n=xc(o);if(!n)return[];const{rotation:r=0}=n,i=(r+90)*Math.PI/180,s=e*Math.cos(i)-t*Math.sin(i);return[-(e*Math.sin(i)+t*Math.cos(i)),s]})(A,x),O=parseFloat(d.x),D=parseFloat(d.y),L={crop:u},U={...d};U.height=parseFloat(d.height)*v+"%",U.width=parseFloat(d.width)*b+"%",U.x=O-100*P/l-S*T/2+"%",U.y=D-100*R/c+w*I/2+"%",L.position=U,(null==(a=r.keyframeAnimation)?void 0:a.id)===DP.id&&(r.keyframeAnimation=null),n(ds(r,L,e)),zl(r.id,{crop:void 0,positionTemp:null})},jP=tr.withUndoBatch(((e,t)=>{var a;const{dispatch:o,state:n}=io(),r=t.type;if("none"===r)return;const i=IE(e,n.studio);if(!i)return;const s=y(),l={...i.animation,[r]:[s]},c={animationName:t.id,id:s,layerId:i.id,speed:t.speed||"default",isCrossTransition:!1};((null==(a=i.animation)?void 0:a[r])||[]).forEach((e=>o(Ji(e)))),o(zi(c,!0));const d={animation:l};"constant"===r&&(d.keyframeAnimation=null),o(ds(i,d,!0))})),HP=tr.withUndoBatch(((e,t)=>{var a;const{dispatch:o,state:n}=io(),r=IE(e,n.studio);if(!r)return;const i={...r.animation,[t]:[]};o(ds(r,{animation:i},!0));((null==(a=r.animation)?void 0:a[t])||[]).forEach((e=>o(Ji(e))))}));function GP(e){return r((e=>e.studio.scenes[0].layers),(t=>{var a;const o={};for(const n of t){const t=null==(a=n.animation)?void 0:a[e];if(t)for(const e of t)o[e]=n}return o}))}const $P=GP("intro"),KP=GP("outro"),YP=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=io();let r,i;if(a||t?(r=t,i=a):(r=KP(n)[e],i=$P(n)[e]),r){const{animation:t}=r;if(!t)return;const a={...t};a.outro=(a.outro||[]).filter((t=>t!==e)),o(ds(r,{animation:a},!0))}if(i){const{animation:t}=i;if(!t)return;const a={...t};a.intro=(a.intro||[]).filter((t=>t!==e)),o(ds(i,{animation:a},!0))}if(r&&i){const e=fv(i,"intro");zP({introLayer:i,newAnimation:null,oldAnimation:e})}o(Ji(e,!0))})),zP=({introLayer:e,oldAnimation:t,newAnimation:a})=>{const{dispatch:o,state:n}=io(),{layers:r}=n.studio.scenes[n.studio.selectedSceneIndex],s=bP(r,e.id),l=(t&&0!==t.duration?H_(t,n.studio.animations):0)-(a?H_(a,n.studio.animations):0);if(!l)return;const{start:c}=ei(e);i.exports.batch((()=>{s.forEach((e=>{const{start:t}=ei(e);if(!(t>=c))return;const a=Nd(e)?{startTime:(e.startTime||0)+l,endTime:(e.endTime||0)+l}:{videoDelay:(e.videoDelay||0)+l};o(ds(e,a,!0))}))}))},qP=tr.withUndoBatch(((e,t,a,o="default")=>{const{state:n}=io(),r=IE(e,n.studio);if(!r)return void console.error("Could not find layer to add cross transition to");const i=yv(r),s="intro"===t?i.introTransition:i.outroTransition;if((null==s?void 0:s.transitionId)===a.id)return;const{introAnimation:l,outroAnimation:c}=Ev(a);l.speed=o,c.speed=o;const d="intro"===t?l:c;let u,m;if(s){let e;e=r.id===s.introLayerId?IE(s.outroLayerId,n.studio):IE(s.introLayerId,n.studio),e&&([u,m]="intro"===t?[r,e]:[e,r])}if(!u||!m){const{layers:e}=n.studio.scenes[n.studio.selectedSceneIndex],a=n.studio.scenes[n.studio.selectedSceneIndex].duration,{nextLayer:o,prevLayer:i}=aR(r,e,r.id,a);[u,m]="intro"===t?[r,i]:[o,r]}u&&m&&(zP({introLayer:u,newAnimation:d,oldAnimation:s}),(({introLayer:e,outroLayer:t,newAnimation:a,newTransitionId:o,undoable:n=!0})=>{var r,i;const{dispatch:s}=io(),l=y(),c=[...(null==(r=e.animation)?void 0:r.intro)||[],...(null==(i=t.animation)?void 0:i.outro)||[]],d=[l];s(ds(e,{animation:{...e.animation,intro:d}},n));const u=[l];s(ds(t,{animation:{...t.animation,outro:u}},n)),s(zi({id:l,animationName:o,speed:a.speed,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id},n));for(const m of c)s(Ji(m))})({introLayer:u,outroLayer:m,newAnimation:d,newTransitionId:a.id}))})),JP=tr.withUndoBatch(((e,t)=>{const{dispatch:a}=io();a(qi(e,{speed:t}))})),XP=tr.withUndoBatch(((e,t)=>{const{dispatch:a,state:o}=io(),n=cv(e);if(!n)return void console.error("Could not find animation to change transition speed on");if(!n.isCrossTransition)return void console.error("Cannot change transition speed on non transition");const r=IE(n.introLayerId,o.studio);if(!r)return void console.error("Could not find intro layer for transition");const i=X_(n.animationName),{introAnimation:s}=Ev(i),l={...s,speed:n.speed},c={...s,speed:t};zP({introLayer:r,newAnimation:c,oldAnimation:l}),a(qi(e,{speed:t}))})),QP=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o}=io(),n=e.animation,r=null==n?void 0:n[t];if(!r)return;o(qi(r[0],{animationName:a}))})),ZP=tr.withUndoBatch(((e,t)=>{const{dispatch:a,state:o}=io(),n=IE(e,o.studio);if(!n)return void console.error("Could not find layer to add cross transition to");const{duration:r}=o.studio.scenes[o.studio.selectedSceneIndex],i=fv(n,"constant",o.studio.animations);i&&(i.transitionId?i.animationStateMapId&&YP(i.animationStateMapId):HP(n.id,"constant"));const s={},l={...t.transitions[0]};if(Nd(n)&&!r)s.isTrimmed=!0,s.startTime=0,s.endTime=5,l.startTime=0,l.duration=5;else{const{start:e,end:t}=ei(n),a=t-e;l.startTime=e,l.duration=a}s.keyframeAnimation={...t,transitions:[l]},DP.id===t.id&&(zl(n.id,{crop:{x:0,y:0,width:100,height:100},positionTemp:null}),VP()),a(ds(n,s));const c=bw(),{duration:d}=kw(c);Tw(c,d,!0),Kb(n),a(r_(!0))})),eR=e=>{const{dispatch:t,state:a}=io(),o=a.studio.scenes[a.studio.selectedSceneIndex].duration,n=[];if(e.forEach((e=>{const t=IE(e,a.studio);if(!t)return;const r=gv(t),{start:i,end:s}=ei(t,o);r.forEach((e=>{if(e.id!==Pr.None)if("intro"===e.type||"constant"===e.type)n.push(i);else if("outro"===e.type){const t=H_(e,a.studio.animations);n.push(s-t)}})),t.keyframeAnimation&&n.push(i)})),0===n.length)return;n.sort(((e,t)=>e-t));$b(n[0]),t(ZE(!0)),t({type:"PLAY_STUDIO"})},tR=(e,t)=>{const{dispatch:a,state:o}=io(),n=o.studio.scenes[o.studio.selectedSceneIndex].duration,r=IE(e,o.studio);if(!r)return;let i;const{start:s,end:l}=ei(r,n);if("intro"===t||"constant"===t)i=s;else{const e=fv(r,t);i=l-(e?H_(e,o.studio.animations):.5)}$b(i),a({type:"PLAY_STUDIO"})},aR=(e,t,a,o)=>{if(!e)return{};let{start:n,end:r}=ei(e,o);const{introTransition:i,outroTransition:s}=yv(e),l=null==i?void 0:i.introLayerId,c=null==s?void 0:s.outroLayerId;let d,u;const m=bP(t,a);for(const p of m){let{start:e,end:t}=ei(p,o);n=parseFloat(n.toFixed(2)),r=parseFloat(r.toFixed(2)),e=parseFloat(e.toFixed(2)),t=parseFloat(t.toFixed(2));const a=Z_.includes(p.type);if((a&&e===r||c===p.id)&&(u=p,d))break;if((a&&t===n||l===p.id)&&(d=p,u))break}return{prevLayer:d,nextLayer:u}};function oR(e,t,a){if(!t||!a)return!0;const o=e.studio.scenes[0].duration,{start:n,end:r}=ei(t,o),{start:i,end:s}=ei(a,o);return null==t.timelineRow||t.timelineRow!==a.timelineRow||(n>=s||i>=r)}const nR=tr.withUndoBatch((e=>{const{state:t}=io(),a=e?[e]:t.studio.scenes[0].layers;for(const o of a){const{animation:e}=o;if(e){if(e.intro)for(const a of e.intro){const e=cv(a,t.studio.animations);if(!e||!e.isCrossTransition)continue;const n=KP(t)[a];oR(t,n,o)&&YP(a,n,o)}if(e.outro)for(const a of e.outro){const e=cv(a,t.studio.animations);if(!e||!e.isCrossTransition)continue;const n=$P(t)[a];oR(t,o,n)&&YP(a,o,n)}}}})),rR=e=>{const t=new Set,a=ei(e),o=a.end-a.start;return 0===o?(t.add("fast"),t.add("default"),t.add("slow"),t):(o>.5&&t.add("fast"),o>1&&t.add("default"),o>2&&t.add("slow"),t)},iR=(e,t=!1)=>{const{state:a}=io(),{scenes:o,allLayers:n}=a.studio,r=ic();if(Bn(a))return;if(n.byId[e.id]&&!t)return;const{duration:i}=o[0];if(r>i||!i)return;const{type:s,isTrimmed:l,startTime:c=0,endTime:d=0}=e;switch(s){case"video":case"audio":e.videoDelay=r;break;case"image":case"shape":case"text":case"placeholder":{const o=Hn(a),n=Math.max(o?128/o:3,2);e.isTrimmed=!0,e.startTime=r,e.endTime=r+n,t&&(l?e.endTime=r+d-c:r===i&&(e.endTime=2*i));break}}},sR=e=>{const{state:{studio:t}}=io(),a=IE(e,t);return(null==a?void 0:a.type)?a:null},lR=()=>{const{state:{studio:e}}=io(),{byId:t}=e.allLayers;return Object.values(t)},cR=(e,t)=>{const a=Vv(e,0);return t>=a[0]&&t<=a[1]},dR=e=>{const{state:{studio:t}}=io();let a=t.scenes[0].layers;return t.scenes[0].duration>0&&(a=a.filter((t=>cR(t,e)))),a},uR=e=>{const t=e.findIndex((e=>"subtitle"===e.type));return t>=0?e.slice(t):[]},mR=(e,t)=>{const a=jr(e)||$r(e),o=jr(t)||$r(t),n=a&&o,r=e.type===t.type;return n||r};function pR(e){if(e.type===xr.Subtitle)return-1;const{start:t}=ei(e),a=new Set;for(const o of function*(e){const{state:t}=io(),{selectedTimelineRows:a,scenes:o}=t.studio,{layers:n}=o[0];for(const l of a)yield l;const r=new Set,i=new Set;for(const l of n){if(l.type===xr.Subtitle)break;null!=l.timelineRow&&l.timelineRow>=0&&!isNaN(l.timelineRow)&&(mR(l,e)&&r.add(l.timelineRow),i.add(l.timelineRow))}for(const l of[...r].sort())yield l;const s=[...i].sort();if(i.size>0){s.length===s[s.length-1]+1&&(yield s.length);for(let e=0;e<s.length;e+=1)s[e]!==e&&(yield e>0?s[e-1]+1:0)}yield s.length}(e))if(!a.has(o)){if(_R(e,t,o))return o;a.add(o)}console.error("couldn't determine timeline row, this should never happen")}function hR(e,{sceneId:t="",undoable:a=!1,layerIndex:o,isReplacing:n=!1,isUndo:r=!1,knownTimelineRow:s=!1,newTimeline:l=!1}={}){var c;a&&tr.beginBatch();try{const{dispatch:d,state:u}=io(),{projectId:m,duration:p,hasCustomOutput:h,showCanvas:g}=u.studio,{isAdding:f}=u.studioLocal,{projectName:y}=u,E=t;!e.startTime&&0!==e.startTime&&iR(e);if(["video","audio","image"].includes(e.type)&&(["pastedLink","local"].includes(null!=(c=e.source)?c:"")||!e.local_url||!e.metadataGathered||IR(e))){if(!g&&"width"in e&&e.width&&!n){let t=`${e.width}:${e.height}`;"resize"===e.uploadLocation&&(t="400:400"),e.isMediaLibraryUpload||i.exports.batch((()=>{d(QE(t)),d({type:"SHOW_STUDIO_CANVAS"})}))}l&&vR(e),"resize"===e.uploadLocation&&(e.lockAspectRatio=!0),(n&&!e.position||!n)&&(e.position=Pc(e)),e.position&&!e.position.rotation&&(e.position.rotation=0),e.metadataGathered=!0,h&&SR(e);const{currentUser:t}=u;m&&e.name&&1===u.studio.scenes.length&&0===u.studio.scenes[0].layers.length&&(""===y||"Studio Draft"===y)&&(d(rS(_C(e.name))),Lf(m,{name:e.name},t))}0===p&&!jr(e)&&!$r(e)||s&&null!=e.timelineRow||(e.timelineRow=pR(e)),d(Xi({layers:[e],isUndoable:a,layerIndex:o,fromUndo:r})),e.asset_id&&f[e.asset_id]&&d(Il(e.asset_id));const{scenes:_,selectedSceneIndex:v,videoType:w,videoTypeSetting:b}=io().state.studio,S=E?_.find((e=>e.id===E)):_[v],{duration:T}=kw(S);S.layers.some((e=>!Nd(e)&&!fR(e)))||!(e.mime&&(e.mime.includes("gif")||e.mime.includes("webp"))||e.url&&("gif"===Wu(e.url)||"webp"===Wu(e.url)))||b||d(Ny("gif")),"gif"!==w||Nd(e)||b||e.conversion_type&&e.conversion_type.includes("gif")||d(Ny("mp4")),Tw(S,T,a)}catch($ae){console.error($ae)}finally{a&&tr.endBatch()}}const gR=(e,t,{knownTimelineRow:a,newTimeline:o,sceneId:n,undoable:r})=>{((e=!1)=>{fm("Replace Layer",{"Replaced Placeholder":e})})(t.type===xr.Placeholder);try{r&&tr.beginBatch();const{state:{studio:i},dispatch:s}=io(),{layers:l}=i.scenes[i.selectedSceneIndex],c=l.findIndex((e=>e.id===t.id)),{groups:d}=i,u=Object.entries(d).filter((e=>e[1].layers.some((e=>e.id===t.id))));if(u.length>0){const a=u[0][0];s(gs(e.id,a,!0,r)),s(ys(t.id,a,r)),s(Es(a,!0,r))}kR(t.id),hR(e,{sceneId:n,undoable:r,knownTimelineRow:a,layerIndex:c>=0?c:void 0,isReplacing:!0,newTimeline:o})}catch($ae){console.error($ae)}finally{r&&tr.endBatch()}},fR=e=>e.conversion_type&&e.conversion_type.includes("gif-to"),yR=r((e=>e.studio.scenes[0].layers),(e=>e.filter((e=>!(e.requireConversion&&!e.preview&&null==e.duration))))),ER=r(yR,((e,t)=>t),((e,t)=>{const a=[];for(const o of e)o.timelineRow===t&&a.push(o);return a}));function _R(e,t,a){const{state:o}=io();if(-1===a&&e.type!==xr.Subtitle||a>-1&&e.type===xr.Subtitle)return!1;const n=ER(o,a),[r,i]=Vv(e,0),s=t+(i-r);for(const l of n){const[e,a]=Vv(l,0);if(!(a<=t)&&!(e>=s))return!1}return!0}const vR=e=>{const{state:t}=io(),{width:a,height:o}=wR(e.width,e.height),{x:n,y:r}=__(t.studio.width,t.studio.height,t.studio.canvasX,t.studio.canvasY,a,o);bR(e,{x:n,y:r,width:a,height:o,rotation:0,flip:{x:!1,y:!1}})},wR=(e,t)=>{const{state:a}=io(),o=[e,t],{width:n,height:r}=E_(o,{width:a.studio.width,height:a.studio.height});return{width:n,height:r}},bR=(e,t,a=!1)=>{const{dispatch:o}=io(),n=Nc(t.x,t.y),r=Tc(t.width,t.height);zl(e.id,{positionTemp:null}),o(es(e,n.xPercent,n.yPercent,r.widthPercent,r.heightPercent,a)),o(os(e,t.rotation,a))},SR=e=>{const{state:t}=io(),{customOutputWidth:a}=t.studio,{customOutputHeight:o}=t.studio;(a>1920||o>1920)&&("video"===e.type||e.mime&&"gif"===e.mime.split("/")[1])&&rw()},TR=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=io(),{ratio:r}=n.studio,{ratioWidth:i,ratioHeight:s}=T_(r),{scenes:l,width:c,height:d}=n.studio,u={w:gc(100*i/s),h:gc(100*s/i)},m={x:gc((c-d)/2/d*-100),y:gc((d-c)/2/c*-100)},p=1===l.length&&1===l[0].layers.length;a.forEach((a=>{var n,r,l,c;const d={x:gc(null==(n=a.position)?void 0:n.x),y:gc(null==(r=a.position)?void 0:r.y),width:gc(null==(l=a.position)?void 0:l.width),height:gc(null==(c=a.position)?void 0:c.height),x90:gc(m.x),y90:gc(m.y),width90:gc(u.w),height90:gc(u.h)};p&&a.position.rotation%90==0&&(100===Math.round(d.width)&&100===Math.round(d.height)&&0===Math.round(d.x)&&0===Math.round(d.y)||d.width===d.height90&&d.height===d.width90&&d.x===d.y90&&d.y===d.x90)&&e%90==0&&(yw(s,i),rw(),90!==e&&270!==e||(zl(a.id,{positionTemp:null}),o(es(a,`${d.x90}%`,`${d.y90}%`,`${d.width90}%`,`${d.height90}%`))),0!==e&&180!==e||(zl(a.id,{positionTemp:null}),o(es(a,"0%","0%","100%","100%")))),o(os(a,e,t))}))})),IR=e=>{const{state:t}=io(),a=IE(e.id,t.studio);return null==a||!a.position||Object.keys(a.position).some((e=>{const t=e,o=a.position[t];return"string"==typeof o&&o.includes("NaN")}))},kR=tr.withUndoBatch(((e,t=!0,a=!1)=>{var o,n,r;const{dispatch:i,state:s}=io(),{byId:l}=s.studio.allLayers;if(e){const s=l[e];if(Object.values(l).some((e=>{var t;return(null==(t=e.mime)?void 0:t.includes("gif"))||e.url&&"gif"===Wu(e.url)}))||i(Ny("mp4")),s){a&&s.type;[...(null==(o=null==s?void 0:s.animation)?void 0:o.intro)||[],...(null==(n=null==s?void 0:s.animation)?void 0:n.outro)||[],...(null==(r=null==s?void 0:s.animation)?void 0:r.constant)||[]].forEach((e=>{const t=cv(e);t&&(t.isCrossTransition?YP(e):i(Ji(e,!0)))})),i(Zi(s,"studioDeleteLayerById",t))}}i(Is(null))})),CR=e=>{const{dispatch:t}=io();t(Il(e))},NR=tr.withUndoBatch((e=>{const{dispatch:t}=io();e.forEach((e=>t(ns(e,"x",!0))))})),AR=tr.withUndoBatch((e=>{const{dispatch:t}=io();e.forEach((e=>t(ns(e,"y",!0))))})),xR=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o}=io();i.exports.batch((()=>{e.forEach((e=>{const n={relative:`${t}%`};a?(zl(e.id,{borderRadiusTemp:null}),o(ds(e,{borderRadius:n},!0))):zl(e.id,{borderRadiusTemp:n})}))}))})),PR=tr.withUndoBatch(((e,t,a)=>{const{dispatch:o}=io();i.exports.batch((()=>{e.forEach((e=>{a?(zl(e.id,{textPaddingTemp:null}),o(ds(e,{textPadding:t},!0))):zl(e.id,{textPaddingTemp:t})}))}))})),RR=(e,t=0,a=0)=>{const{state:o}=io(),n=o.studioLocal.layerTempValues[e.id]||{},{borderRadiusTemp:r}=n,{relative:i=0}=r||e.borderRadius||{};return t<a?parseFloat(i)/100*t:parseFloat(i)/100*a},OR=({layer:e,color:t,isBackground:a=!1,outlineType:o=null,colorType:n=null,undoable:r=!0})=>{const{dispatch:i,state:s}=io(),{selectedSceneIndex:l}=s.studio;if(a&&"rgba(-255,-255,-255,0)"===t&&fm("Transparent Background Selected",{"background color":t}),a)return void i($E(t,l,r));const c=t;let d=n||"color";switch(e.type){case"audio":i(ds(e,{color:c},!0));break;case"text":{const{textShadow:t}=e;i("color"===d?LT({ids:[e.id],value:c}):ds(e,{textShadow:t,[d]:c},r));break}case"shape":if("progressBar"===e.shapeType){const a={[o?"stroke":"background"]:t};i(ds(e,"rgba(-255,-255,-255,0)"===t?a:{...a,gradientStyleColor:Le(t,.2),glowingStyleColor:Le(t,.9),backgroundStyleColor:Le(t,.2)},r))}else e.shapeType&&["line","arrow"].includes(e.shapeType)&&"background"===d&&(d="stroke"),i(ds(e,{[d]:c},!0));break;case"video":i(ds(e,{[d]:c},!0));break;case"image":{d=d||"color";let{imageShadow:a}=e;"color"===d&&(a=Sy(t,e)),i(ds(e,{[d]:c,imageShadow:a},r));break}case"subtitle":i(ds(e,{textColor:c},r));break;case"placeholder":i(ds(e,{...{[o?"stroke":"background"]:t}},r));break}},DR=({group:e,color:t,isBackground:a=!1,outlineType:o=null,colorType:n=null,undoable:r=!0,savedSceneBackgrounds:i=[]})=>{const{scenes:s,selectedSceneIndex:l}=io().state.studio,{layers:c}=s[l],d=e.layers.map((e=>e.id)),u=()=>{c.filter((e=>d.includes(e.id))).forEach((e=>{OR({layer:e,color:t,isBackground:a,outlineType:o,colorType:n,undoable:r,savedSceneBackgrounds:i})}))};r?tr.withUndoBatch(u)():u()},LR=({selectedId:e,color:t,isBackground:a=!1,outlineType:o=null,colorType:n=null,undoable:r=!0,savedSceneBackgrounds:i=[]})=>{const{groups:s,allLayers:{byId:l}}=io().state.studio,c=s[e];if(c)DR({group:c,color:t,isBackground:a,outlineType:o,colorType:n,undoable:r,savedSceneBackgrounds:i});else{const s=l[e];OR({layer:s,color:t,isBackground:a,outlineType:o,colorType:n,undoable:r,savedSceneBackgrounds:i})}},UR=e=>{const{dispatch:t}=io(),a=sR(e);t(ds(a,{locked:!a.locked},!0)),a.locked||t(Is(null))},MR=(e,t)=>{var a;const{dispatch:o,state:n}=io(),r=[];Object.keys(null==(a=n.studio.allLayers)?void 0:a.byId).forEach((t=>{var a;const o=null==(a=n.studio.allLayers)?void 0:a.byId[t];o&&o.type!==xr.Subtitle&&Od(o)===e&&r.push(o.id)}));const{localUrl:i,trackPreviewLocalUrl:s}=t;if(s){const e={};r.forEach((t=>{e[t]={trackPreviewLocalUrl:s}})),ql(e)}const l={};r.forEach((e=>{l[e]={local_url:i}})),o({type:"UPDATE_LAYERS_NO_SYNC",updates:l})},FR=(e,t=!0)=>{const{dispatch:a,state:o}=io(),{byId:n}=o.studio.allLayers,r=n[e];let{position:i}=r;if(i){let e=50-dd(i.width)/2,o=50-dd(i.height)/2,n=dd(i.width),s=dd(i.height);n>100&&(n=100,s=dd(i.height)*n/dd(i.width),e=0,o=50-s/2),s>100&&(s=100,n=dd(i.width)*s/dd(i.height),e=0,o=50-n/2),i={...i,x:cd(e),y:cd(o),width:cd(n),height:cd(s)},a(ds(r,{position:i},t))}};function BR(e){return C().startOf("day").milliseconds(1e3*e).format("HH:mm:ss,SSS")}function WR(e){return C().startOf("day").milliseconds(1e3*e).format("mm:ss.SSS")}function VR(e){let t="";return e.sort(((e,t)=>e.startTime-t.startTime)).forEach(((e,a)=>{const o=BR(e.startTime),n=BR(e.endTime),r=a+1,i=e.text.replace(/^\s*$(?:\r\n?|\n)/gm,"");t=`${t+r}\n${o} --\x3e ${n}\n${i}\n\n`})),t=t.replace(/\n+$/,""),t}function jR(e){let t="WEBVTT\n\n";return t+=function(e){let t="";const[a]=e;return a.type===xr.Text&&a.color?(t+="STYLE\n",t+="::cue {\n",t+=`  color: ${a.color};\n`,t+="}\n\n",t):t}(e),e.sort(((e,t)=>e.startTime-t.startTime)).forEach((e=>{const a=WR(e.startTime),o=WR(e.endTime),n=e.text.replace(/^\s*$(?:\r\n?|\n)/gm,""),r=function(e,t){let a=!1,o=!1,n=!1;e.type===xr.Subtitle?(a="bold"===e.fontWeight,o="italic"===e.fontStyle):(a=e.bold,o=e.italic,n=e.underline);let r=t;return n&&(r=`<u>${r}</u>`),o&&(r=`<i>${r}</i>`),a&&(r=`<b>${r}</b>`),r}(e,n);t+=`${a} --\x3e ${o}\n${r}\n\n`})),t=t.replace(/\n+$/,""),t}function HR(e,t){const a=document.createElement("a");a.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(t)}`),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function GR(){const{state:e}=io(),{scenes:t}=e.studio;HR("subtitles.srt",VR(uR(t[0].layers)))}function $R(){const{state:e}=io(),{scenes:t}=e.studio;HR("subtitles.vtt",jR(uR(t[0].layers)))}function KR(){const{state:e}=io(),{scenes:t}=e.studio;HR("transcript.txt",uR(t[0].layers).map((e=>e.text)).join(" "))}const YR="paywall-id",zR={paymentOptionsContainer:"PaymentOptions-module_paymentOptionsContainer_3CZMA",option:"PaymentOptions-module_option_-cEVo",selected:"PaymentOptions-module_selected_qfb5b",disabled:"PaymentOptions-module_disabled_GLJv-",infoContainer:"PaymentOptions-module_infoContainer_m-Q6H",info:"PaymentOptions-module_info_lA-8Y",head:"PaymentOptions-module_head_CD2da",body:"PaymentOptions-module_body_TVFSZ",price:"PaymentOptions-module_price_Kuygt",radio:"PaymentOptions-module_radio_ANFRw",override:"PaymentOptions-module_override_ef4NC",paymentTotalContainer:"PaymentOptions-module_paymentTotalContainer_MkybM",planDetails:"PaymentOptions-module_planDetails_rwN2G",costExplanation:"PaymentOptions-module_costExplanation_XLQMY",totalPrice:"PaymentOptions-module_totalPrice_K5H0l",legacyPriceDiscount:"PaymentOptions-module_legacyPriceDiscount_-WcCe",totalContainer:"PaymentOptions-module_totalContainer_weJTF",preDiscountPrice:"PaymentOptions-module_preDiscountPrice_VXqx9",prorationDiscount:"PaymentOptions-module_prorationDiscount_ONZ-b",infoIcon:"PaymentOptions-module_infoIcon_51mDK",largeTooltip:"PaymentOptions-module_largeTooltip_-rPW3",prorationTooltip:"PaymentOptions-module_prorationTooltip_Cb4fk"},qR=e=>{const t=ed(),a=cn((t=>{var a;return(null==(a=t.checkoutStore[e.team._id])?void 0:a.prorationDiscount)||0})),o=e.team.users.length,r=(i=e.team).planTier!==jd.PRO&&i.planTier!==jd.BASIC||i.paymentTerm!==Vd.NO_TERM?e.team.users.filter((e=>e.isLegacy)).length:e.team.users.length;var i;const[s,l]=n.exports.useState(!1),c=Eu(e.planTier),d=c.getBasePrice()[e.paymentTerm],u=d/(e.paymentTerm===Vd.ANNUALLY?12:1),p=Iu(e.planTier,{paymentTerm:e.paymentTerm}).getPriceForTeam(e.team),h=Math.min(p,a);return m.createElement(m.Fragment,null,m.createElement("div",{className:zR.paymentTotalContainer},m.createElement("div",null,m.createElement("div",{className:zR.planDetails},c.displayPlan.toUpperCase()," ",m.createElement("span",null,c.isMultiUser?`(${o} ${hu("workspace member","workspace members",o)})`:"(1 person only)")),m.createElement("div",{className:zR.costExplanation},m.createElement("div",null,m.createElement("div",null,(()=>{let t=`$${u} / month`;return c.isMultiUser&&(t+=` x ${o} ${hu("member","members",o)}`),e.paymentTerm===Vd.ANNUALLY?t+=" x 12 months":t+=" x 1 month",t})()),m.createElement("div",{className:zR.legacyPriceDiscount},!!r&&m.createElement("div",null,r," legacy"," ",hu("member","members",r)))),m.createElement("div",{className:zR.totalPrice},r?m.createElement(m.Fragment,null,m.createElement("div",null,"$",d*o),m.createElement("div",{className:zR.legacyPriceDiscount},"-$",d*r)):m.createElement("div",{className:zR.totalPrice},"$",p))))),h>0&&m.createElement("div",{className:zR.prorationDiscount},m.createElement("div",{className:zR.largeTooltip},"Prorated discount  ",m.createElement(Ue,{className:zR.infoIcon,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1)}),s&&!t&&m.createElement("div",{className:zR.prorationTooltip},"A discount for the unused time remaining on your existing plan billing cycle")),m.createElement("div",null,"-",gu(h))),m.createElement("div",{className:zR.totalContainer},e.finalPrice&&Math.abs(e.finalPrice-(p-h))>.01?m.createElement(m.Fragment,null,m.createElement("div",null,"Total Due Today"),m.createElement("div",null,m.createElement("span",{className:zR.preDiscountPrice},gu(p-h)),m.createElement("br",null),gu(e.finalPrice))):m.createElement(m.Fragment,null,m.createElement("span",null,"Total Due Today"),gu(p-h))))},JR={termWrapper:"ChoosePaymentTerm-module_termWrapper_25JAG",termChooser:"ChoosePaymentTerm-module_termChooser_IbJky",paymentTerm:"ChoosePaymentTerm-module_paymentTerm_-YTs-",selected:"ChoosePaymentTerm-module_selected_gdyd8"},XR=e=>m.createElement("div",{className:JR.termWrapper},m.createElement("div",{className:JR.termChooser},e.upgradeTerms.map((t=>m.createElement("div",{key:t,className:[JR.paymentTerm,e.selectedTerm===t?JR.selected:null].join(" "),onClick:()=>e.setSelectedTerm(t)},"Pay ",t))))),QR={kapwingButton:"KapwingButton-module_kapwingButton_OIGXh",disabled:"KapwingButton-module_disabled_tv63Q",smallButton:"KapwingButton-module_smallButton_vgohY",largeButton:"KapwingButton-module_largeButton_I1pYU",lightBlueColor:"KapwingButton-module_lightBlueColor_WIEgE",blueColor:"KapwingButton-module_blueColor_SAh6B",blackColor:"KapwingButton-module_blackColor_hR2Ff",redColor:"KapwingButton-module_redColor_VKTCX",inverseColor:"KapwingButton-module_inverseColor_QxahF",loading:"KapwingButton-module_loading_nSP6k",spin:"KapwingButton-module_spin_EnC9K",buttonsContainer:"KapwingButton-module_buttonsContainer_08lgq",header:"KapwingButton-module_header_S9MxU"},ZR=e=>{const t=[QR.kapwingButton,e.small?QR.smallButton:QR.largeButton];return e.disabled&&t.push(QR.disabled),t.push(e.overrideColor?QR[`${e.overrideColor}Color`]:QR.blueColor),m.createElement("button",{type:"button",disabled:e.disabled,onClick:e.onClick,className:t.join(" ")},e.children,e.loading&&m.createElement("div",{className:QR.loading}))},eO="ReasonsList-module_details_Vqg11",tO="ReasonsList-module_reasonsWrapper_-6BCA",aO="ReasonsList-module_detailCheck_YyPx6",oO="ReasonsList-module_everythingIn_penCH",nO="ReasonsList-module_reasonBox_QLW9g",rO=({planTier:e,andMuchMore:t,allTiers:a})=>{const o=Eu(e),n=iO(e,a),r=n&&o.planData.chooseModalReasons||o.planData.modalReasons;return m.createElement("div",{className:eO},n&&m.createElement("div",{className:oO},"Everything in ",m.createElement("b",null,n.displayTier),", plus:"),m.createElement("div",{className:1===(null==a?void 0:a.length)?tO:void 0},r.slice(0,a&&(null==a?void 0:a.length)>2?5:7).map(((e,a,n)=>m.createElement("div",{className:nO,key:a},m.createElement("div",null,m.createElement(Me,{className:aO})),m.createElement("div",null,e,o.planData.andMuchMore&&a===n.length-1&&(t?m.createElement("a",{target:"_blank",href:"/pricing"},", and much more"):", and much more")))))))},iO=(e,t)=>{if(!t)return;const a=Eu(e).planData,o=t.concat([jd.FREE]).filter((t=>t!==e)).map((e=>nu[e])).filter((e=>a.everythingIn&&a.everythingIn.includes(e.planTier))).sort(((e,t)=>t.basePrice.monthly-e.basePrice.monthly));return o.length?Eu(o[0].planTier):void 0},sO={planTier:"UpgradeModalColumn-module_planTier_6-Dj7",planHeaderWrapper:"UpgradeModalColumn-module_planHeaderWrapper_rKVUV",planHeader:"UpgradeModalColumn-module_planHeader_bWH-n",planName:"UpgradeModalColumn-module_planName_Kv5gr",subHeader:"UpgradeModalColumn-module_subHeader_fvIiT",priceSection:"UpgradeModalColumn-module_priceSection_dpszT",price:"UpgradeModalColumn-module_price_HPn8g",buttonWrapper:"UpgradeModalColumn-module_buttonWrapper_F3FrZ",detailCheck:"UpgradeModalColumn-module_detailCheck_2bIrX",selected:"UpgradeModalColumn-module_selected_8rR--"},lO=e=>{const t=Eu(e.tier);return m.createElement("div",{className:[sO.planTier,e.allTiers.length>1&&e.selectedTier===e.tier?sO.selected:null].join(" "),onClick:()=>e.setSelectedTier(e.tier)},m.createElement("div",{className:sO.planHeaderWrapper},m.createElement("div",{className:sO.planHeader},m.createElement("div",{className:sO.planName},t.displayPlan),m.createElement("div",{className:sO.subHeader},t.isMultiUser?"(for 1 or more people)":"(for 1 person)"),m.createElement("div",{className:sO.priceSection},m.createElement("span",{className:sO.price},"$",t.getBasePrice()[e.selectedTerm]/(e.selectedTerm===Vd.ANNUALLY?12:1)),m.createElement("span",null,t.isMultiUser?`/ member / month billed ${e.selectedTerm}`:`/ month billed ${e.selectedTerm}`))),m.createElement("div",null,m.createElement(rO,{allTiers:e.allTiers,planTier:e.tier}))),e.allTiers.length>1&&m.createElement("div",{className:sO.buttonWrapper},m.createElement("div",null,m.createElement(ZR,{overrideColor:e.selectedTier!==e.tier?"black":void 0,onClick:()=>e.setSelectedTier(e.tier)},e.allTiers.length>1&&e.selectedTier===e.tier&&m.createElement(Me,{className:sO.detailCheck}),m.createElement("span",null,e.allTiers.length>1&&e.selectedTier===e.tier?"Selected Plan":`Choose ${t.displayPlan}`)))))},cO=e=>{var t,a;const o=".app-container",n=document.querySelector(o),r=Pu(),i=(null==(t=e.team)?void 0:t._id)&&Yh(null==(a=e.team)?void 0:a._id)||r,s={team:i,upgradeTiers:((e,t=Gd)=>{const a=qA(KA.basicPlan);return Lu(e,{upgradeTiers:t,basicAvailable:a})})(i,e.upgradeTiers),action:e.action,onClose:e.onClose,closeable:e.closeable,extraAmplitudeEventProperties:e.extraAmplitudeEventProperties};return n?ye.createPortal(m.createElement(dO,{...s}),n):(console.error(`Expected ${o} to exist in the DOM`),m.createElement(dO,{...s}))},dO=({team:e,upgradeTiers:t,onClose:a=(()=>Fl()),closeable:o=!0,action:r,extraAmplitudeEventProperties:s={}})=>{const l=i.exports.useDispatch(),{currentUser:c,editorPath:d}=cn((e=>({currentUser:e.currentUser,editorPath:e.editorPath})),i.exports.shallowEqual),u=oe(),p=Ru(),{user:h}=c||{},[g,f]=n.exports.useState(""),[y,E]=n.exports.useState(""),[_,v]=n.exports.useState(!1),[w,b]=n.exports.useState(!1),[S,T]=n.exports.useState(Vd.ANNUALLY),I=t[0],[k,C]=n.exports.useState(I),[N,A]=n.exports.useState(),x=h?FA(h):void 0,P=(u.pathname.includes("/studio/editor")||u.pathname.includes("/videos/"))&&!(()=>{const{state:e}=io();return!e.studio.teamId||e.teams.allTeams.some((t=>t._id===e.studio.teamId))})(),R=om(c);n.exports.useEffect((function(){R&&l(_g())}),[l,R]),n.exports.useEffect((function(){(null==e?void 0:e._id)&&e.stripeId&&l(up(e._id,!0))}),[null==e?void 0:e._id,l,null==e?void 0:e.stripeId]),n.exports.useEffect((function(){C(I)}),[I,C]);const{title:O,upgradeSubmitText:D}=((e,t,a,o)=>{let n=`Submit payment and upgrade to ${Eu(t).displayPlan}`,r=Eu(t).isMultiUser?"to create together":"to access all premium features on Kapwing";if(o){const{permission:e,metadata:t}=lu[o];if(null==t?void 0:t.upgradeSubmitText)n=t.upgradeSubmitText;else if(e){const t=su[e].upgradeSubmitText;t&&(n=t)}if(null==t?void 0:t.upgradeReason)r=t.upgradeReason;else if(e){const t=su[e].upgradeReason;t&&(r=t)}}return{title:1===e.length?m.createElement("span",null,"Upgrade ",m.createElement("strong",null,a.name)," to the"," ",Eu(t).displayPlan," ",r):m.createElement("span",null,"Upgrade",a._id?m.createElement("strong",null," ",a.name):m.createElement("span",null," ")," to one of our premium plans ",r),upgradeSubmitText:n}})(t,k,e,r),L=Iu(k,{paymentTerm:S}),U=x&&_o[x]&&_o[x].discountPercentage?_o[x].discountPercentage.toString():void 0;n.exports.useEffect((function(){Tm(r||"",{dripDiscount:U})}),[r,U]);const M=async(t,a=ru.REGULAR)=>{var o;const n=!!(null==(o=null==c?void 0:c.user)?void 0:o._id);U&&(s["Discount Value"]=U),wm({couponId:null,isAnonUpgrade:!n,paymentTerm:S,planTier:k,paymentProcessor:"Stripe",checkoutType:a,upgradeSource:r||"",extraAmplitudeEventProperties:s,currentPlan:p.planTier,upgradePlan:L.planTier,teamId:e._id,quantity:e.users.length}),Ir("Upgrade Workspace"),n||t||l(bh(`Your account has been updated. Now sign into ${y} to access all your Kapwing ${L.displayPlanTier} features.`)),n?await F():v(!0)},F=async()=>{await l($A()),tx(),ox(),l(up(e._id,!0)),l(bh(((e,t)=>{const a=Eu(e);switch(t){case"default-privacy":return`You have upgraded to Kapwing ${a.displayTier} and can now change the default privacy for your videos.`;case"high-quality":return"You have successfully upgraded and you can now select high quality";case"privacy":return"You have successfully upgraded and your content has been set to private";case"subtitler":return"Your workspace has been successfully upgraded. You can now download the SRT file.";case"upload-limit":case"single-video-duration-limit":return"Your workspace has been upgraded. You may now publish your project.";case"upload-fonts":return"Your workspace has been upgraded. You can now upload custom fonts.";case"remove-watermark":return"Your workspace has been upgraded. Your videos will no longer be watermarked.";case"magic-transcribe":case"transcribe":return`Congratulations! Your workspace has been successfully upgraded to ${a.displayTier}. You can now generate unlimited subtitles and transcriptions.`;case"brandkit":return`Your workspace has been succesfully upgraded to ${a.displayTier}. You can now save assets to Brand Kit and use them in the studio.`;default:return`Your workspace has been successfully upgraded to ${a.displayTier}.`}})(k,r))),"subtitler"===r&&GR(),"upload-fonts"===r&&(await l($A()),Ml(`${d}/fonts/upload`)),a()};if(_)return m.createElement(MC,{email:y,hideSignIn:()=>v(!1),onSuccess:()=>{(async()=>{await l($A()),await F()})()}});const B=1!==t.length;return P?m.createElement(eP,{keepScrollbar:!0,onClose:a},m.createElement("div",{className:Cx},"You don't have access to manage this workspace subscription"),m.createElement("div",{className:Jx},"Contact the project owner to add you to this workspace."),m.createElement("div",{className:Xx},m.createElement("div",{onClick:a,className:Qx},"Got It"))):m.createElement(kx,{afterElement:!o&&m.createElement("div",{className:tP.returnLink},m.createElement("a",{href:"/"},"No thanks, return to Kapwing home")),className:[tP.modalBackground,!B&&tP.bgImgLeft].join(" "),id:"paywall-id",onClick:e=>e.stopPropagation(),noCloseButton:!1===o,unsetCancelModal:()=>{o&&!w&&a()},cypressName:"paywall-modal"},m.createElement("div",{"data-testid":"studio-paywall-modal","data-cy":"studio-paywall-modal",className:tP.paywallContainer},m.createElement("h3",{className:tP.paywallTitle,"data-cy":"paywall-title"},O),m.createElement("div",{className:tP.paywallColumns},m.createElement("div",{className:[tP.paywallLeft,B?tP.flexLeft:""].join(" ")},m.createElement(m.Fragment,null,2===t.length&&m.createElement(XR,{selectedTerm:S,setSelectedTerm:T,upgradeTerms:[Vd.ANNUALLY,Vd.MONTHLY]}),m.createElement("div",{className:tP.tierWrapper},t.map((e=>m.createElement("div",{key:e,className:tP.tierColumn},m.createElement(lO,{tier:e,allTiers:t,selectedTier:k,setSelectedTier:C,selectedTerm:S}))))))),m.createElement("div",{className:[tP.paywallRight,B?tP.flexRight:""].join(" ")},m.createElement("div",null,m.createElement(m.Fragment,null,2!==t.length&&m.createElement(XR,{selectedTerm:S,setSelectedTerm:T,upgradeTerms:[Vd.ANNUALLY,Vd.MONTHLY]}),m.createElement(qR,{paymentTerm:S,planTier:k,team:e,finalPrice:N}),m.createElement(GA,{email:y,name:g,onCharged:M,setEmail:E,setName:f,setSubmitting:b,submitText:D,submitting:w,upgradeTier:k,upgradeTerm:S,team:e,setFinalPrice:A}),B&&m.createElement("div",{className:tP.bgImgRight},m.createElement("img",{alt:"",src:"https://cdn-useast1.kapwing.com/static/BM--hcm094oK-image.webp"}))))))))},uO=()=>{const{show:e,options:t}=cn((e=>e.paywall)),{if:a,...o}=t||{action:ou.DEFAULT},n=i.exports.useDispatch(),r=Pu(),s=cu(o.action),l=qA(KA.basicPlan);if(!e)return null;const c={...o,onClose:()=>{ox(),n({type:"HIDE_PAYWALL"})}};o.team||(o.team=r);const d=Lu(o.team,{upgradePermission:s,basicAvailable:l});return m.createElement(cO,{...c,upgradeTiers:d})},mO=(e,t,a)=>(...o)=>{const{team:n,action:r,if:i=!0}=e,s=Eu(n.planTier),l=cu(r),c=s.hasPermission(l),d=su[l].requiresPaymentMethod&&s.isPaid&&!n.stripeId;!i||c&&!d?t(...o):(a(cA({options:e})),ax((()=>t(...o))))},pO=()=>{const e=i.exports.useDispatch(),t=Pu();return(a,o)=>mO({...o,team:o.team||t},a,e)},hO=(e,t)=>{const{dispatch:a,state:o}=io(),n=Bu(o);if(!n)throw new Error("Paywall used without a team");return mO({...t,team:t.team||n},e,a)},gO="ProSparkle-module_proSparkle_I0j5q",fO=({className:e=""})=>m.createElement("svg",{viewBox:"0 0 13 13",className:`${gO} ${e}`},m.createElement("g",null,m.createElement("path",{d:"M4.63007 7.7206C4.63007 7.7206 6.69155 7.47571 7.37872 6.74119C8.06586 6.00663 8.2949 3.80298 8.2949 3.80298C8.2949 3.80298 8.52399 6.00663 9.21112 6.74119C9.8983 7.47571 11.9598 7.7206 11.9598 7.7206C11.9598 7.7206 9.8983 7.96544 9.21112 8.69996C8.52399 9.43453 8.2949 11.6382 8.2949 11.6382C8.2949 11.6382 8.06586 9.43453 7.37872 8.69996C6.69155 7.96544 4.63007 7.7206 4.63007 7.7206Z"}),m.createElement("path",{d:"M1.89838 3.53465C1.89838 3.53465 3.2938 3.36891 3.75894 2.87169C4.22409 2.37447 4.37912 0.882812 4.37912 0.882812C4.37912 0.882812 4.53415 2.37447 4.99933 2.87169C5.46446 3.36891 6.85987 3.53465 6.85987 3.53465C6.85987 3.53465 5.46446 3.70039 4.99933 4.19761C4.53415 4.69482 4.37912 6.18649 4.37912 6.18649C4.37912 6.18649 4.22409 4.69482 3.75894 4.19761C3.2938 3.70039 1.89838 3.53465 1.89838 3.53465Z"}),m.createElement("path",{d:"M0.278259 10.1277C0.278259 10.1277 1.67368 9.9619 2.13882 9.46469C2.60396 8.96747 2.75901 7.47583 2.75901 7.47583C2.75901 7.47583 2.91406 8.96747 3.37919 9.46469C3.84433 9.9619 5.23976 10.1277 5.23976 10.1277C5.23976 10.1277 3.84433 10.2934 3.37919 10.7906C2.91406 11.2878 2.75901 12.7795 2.75901 12.7795C2.75901 12.7795 2.60396 11.2878 2.13882 10.7906C1.67368 10.2934 0.278259 10.1277 0.278259 10.1277Z"}))),yO="UpgradePill-module_upgradePill_xkjUA",EO="UpgradePill-module_proSparkle_-APHJ",_O=({action:e=ou.HEADER,className:t=""})=>{const a=pO();return m.createElement("div",{className:`${yO} ${t}`,onClick:t=>{t.stopPropagation(),a((()=>{}),{action:e})()},"data-testid":"upgrade-pill","data-cy":"upgrade-pill"},"Upgrade",m.createElement(fO,{className:EO}))},vO=(e,t)=>{const a=i.exports.useDispatch(),o=cn((e=>e.teams.selectedTeamId)),r=t||o,s=(e=>cn((t=>t.teams.allTeams.find((t=>t._id===e))))||Kh)(r),l=cn((e=>{var t;return null==(t=e.checkoutStore[r])?void 0:t.subscription})),c=cn((t=>{var a;const o=Object.keys(t.checkoutStore).find((a=>{var o;return(null==(o=t.checkoutStore[a].subscription)?void 0:o.customer)===e}));return o?null==(a=t.checkoutStore[o])?void 0:a.subscription:void 0}))||l;return n.exports.useEffect((()=>{if(o)if(e&&(null==s?void 0:s.stripeId)!==e)a(dp());else if(!(null==c?void 0:c.id)&&!e)try{a(up(r))}catch(t){console.error("Error",t)}}),[a,null==c?void 0:c.id,r,e,null==s?void 0:s.stripeId,o,null==s?void 0:s.cancellationPending]),c},wO={home:"common-module_home_uI41u",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_8UM2G",largeButton:"common-module_largeButton_p7Gns",sectionContent:"common-module_sectionContent_k2dPa",sectionHeader:"common-module_sectionHeader_H-KXC",spacer:"common-module_spacer_yYUpj",chevron:"common-module_chevron_7Ev2U",splashText:"common-module_splashText_TK2YT",splashSubtext:"common-module_splashSubtext_Th1nP",aboutSection:"common-module_aboutSection_1O1aS",mobile:"common-module_mobile_1-7JB",desktop:"common-module_desktop_huzNx",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_DAtuZ",disabled:"common-module_disabled_BZ35g",noScrollBar:"common-module_noScrollBar_O0bo-",textOverflowEllipsis:"common-module_textOverflowEllipsis_otHNm",genericButtonBlue:"common-module_genericButtonBlue_ciLXG",contentContainer:"common-module_contentContainer_7JZnB",header:"common-module_header_7L2I9",description:"common-module_description_yOSmt",buttonsContainer:"common-module_buttonsContainer_HADpi",secondaryAction:"common-module_secondaryAction_zXhTk",loadingContainer:"common-module_loadingContainer_EgQgk",primaryButton:"common-module_primaryButton_vrshj",form:"common-module_form_zOSI-",formLabel:"common-module_formLabel_nwdAd",resettableFormInput:"common-module_resettableFormInput_uDaAw",formTextInput:"common-module_formTextInput_-qAp-",clearInputButton:"common-module_clearInputButton_YY9XV",formInputGroupFlex:"common-module_formInputGroupFlex_iyhy3"},bO="PaymentInfoForm-module_buttonContainer_Hdoci",SO="PaymentInfoForm-module_loadingContainer_ylEd8",TO="PaymentInfoForm-module_loadingButton_teRRh",IO="PaymentInfoForm-module_paymentsFormContainer_M8534",kO="PaymentInfoForm-module_stripeLabel_GLs0R",CO="PaymentInfoForm-module_stripeTextField_U3DNY",NO="PaymentInfoForm-module_stripeTextFieldFocused_L0ZBW";class AO extends n.exports.Component{constructor(e){super(e),t(this,"clearElements",(()=>{this.setState({name:""}),this.cardElt.clear()})),t(this,"handleNameChange",(e=>{this.setState({name:e.target.value})})),t(this,"handleSubmit",(e=>{const{stripe:t,elements:a,showError:o,showSuccess:n,updatePaymentInfo:r,exitOverlay:i,stripeId:s,entryPoint:l}=this.props,{name:c}=this.state;e.preventDefault(),this.setState({submitting:!0});const d=a.getElement(De);t.createToken(d,{name:c}).then((e=>{if(e.error)throw new Error(e.error.message);return r(e.token,s)})).then((()=>{Ef(l,yf.UPDATE),n("Your payment information has been updated and will be used for your next billing cycle."),this.clearElements(),this.setState({submitting:!1}),i()})).catch((e=>{o(e.message),this.setState({submitting:!1})}))})),this.state={name:"",submitting:!1,stripeInputFocused:!1}}componentDidMount(){Ef(this.props.entryPoint,yf.INITIATE)}render(){const{name:e,submitting:t}=this.state;return m.createElement("div",{className:IO},m.createElement("form",{onSubmit:this.handleSubmit,className:wO.form},m.createElement("label",{className:kO,htmlFor:"stripe-name-field"},"Name on card",m.createElement("input",{id:"stripe-name-field",className:CO,placeholder:"Name on card",value:e,onChange:this.handleNameChange})),m.createElement("label",{className:kO,htmlFor:"stripe-cc-number"},"Credit / Debit Card",m.createElement(De,{id:"stripe-cc-number",onFocus:()=>this.setState({stripeInputFocused:!0}),onBlur:()=>this.setState({stripeInputFocused:!1}),className:this.state.stripeInputFocused?NO:CO,onReady:e=>{this.cardElt=e},options:(a=this.props.darkMode,o=this.state.stripeInputFocused,{style:{base:{fontSmoothing:"antialiased",letterSpacing:"0.025em",fontFamily:"monospace",fontWeight:"500",color:a&&!o?"white":"#424770","::placeholder":{color:"#aab7c4"},":focus":{color:"#424770"}},invalid:{color:"red"}}})})),m.createElement("div",{className:"clear"}),t?m.createElement("div",{className:SO},m.createElement("div",{className:TO},"Updating info...")):m.createElement("div",{className:bO},m.createElement("button",{type:"submit",className:wO.primaryButton},"Update payment info"))));var a,o}}const xO=ie(i.exports.connect((e=>({darkMode:e.theme.darkMode})),(e=>he({showError:wh,showSuccess:bh,updatePaymentInfo:dA},e)))(AO)),PO=e=>{const{exitOverlay:t,stripeId:a,entryPoint:o}=e,n=vO(a),r=(null==n?void 0:n.status)===Mr.PAST_DUE;return m.createElement(kx,{unsetCancelModal:t,overlayContainerSmall:!0,usePortal:!0},m.createElement("div",{className:wO.contentContainer,"data-testid":"update-payment-overlay-container"},m.createElement("div",{className:wO.header},"Update Payment Information"),m.createElement("div",{className:wO.description},!r&&m.createElement(m.Fragment,null,"You will ",m.createElement("b",null,"not")," be billed after submitting this form. This is for updating your payment details only.")),m.createElement(Re,null,(({stripe:e,elements:n})=>m.createElement(xO,{stripe:e,elements:n,stripeId:a,entryPoint:o,exitOverlay:t}))),m.createElement("div",{className:wO.buttonsContainer},m.createElement("div",{onClick:t,className:wO.secondaryAction},"Never mind"))))},RO=ie(PO),OO="SubscriptionStatePill-module_reactivatePill_3CQxI",DO="SubscriptionStatePill-module_proSparkle_9cSXz",LO="SubscriptionStatePill-module_pastDuePill_XQCI0",UO={home:"Modal-module_home_4JMQJ",homeHowBackgroundWhite:"Modal-module_homeHowBackgroundWhite_8TCy1",largeButton:"Modal-module_largeButton_s6TVh",sectionContent:"Modal-module_sectionContent_oVv0S",sectionHeader:"Modal-module_sectionHeader_OOdDr",spacer:"Modal-module_spacer_Scsus",chevron:"Modal-module_chevron_V4qbo",splashText:"Modal-module_splashText_KNYtI",splashSubtext:"Modal-module_splashSubtext_f5BhF",aboutSection:"Modal-module_aboutSection_hvla1",mobile:"Modal-module_mobile_wYOc2",desktop:"Modal-module_desktop_G7Esl",screenReaderOnlyLabel:"Modal-module_screenReaderOnlyLabel_rpv-L",disabled:"Modal-module_disabled_THaXg",noScrollBar:"Modal-module_noScrollBar_GuuPP",textOverflowEllipsis:"Modal-module_textOverflowEllipsis_0JTtf",genericButtonBlue:"Modal-module_genericButtonBlue_jktwV",background:"Modal-module_background_AyKkN",contentContainer:"Modal-module_contentContainer_GaQSZ",mainContent:"Modal-module_mainContent_0KWDi",inputLabel:"Modal-module_inputLabel_b07lz",container:"Modal-module_container_GfihW",header:"Modal-module_header_ioGmE",description:"Modal-module_description_SwK-3",closeContainer:"Modal-module_closeContainer_cLsYb",logoPreview:"Modal-module_logoPreview_z2kQp",removeLogo:"Modal-module_removeLogo_unzw-",uploadLogoContainer:"Modal-module_uploadLogoContainer_Q4RgM",uploadLogoInput:"Modal-module_uploadLogoInput_WXliW",uploadLabelHeader:"Modal-module_uploadLabelHeader_IwwPS",buttonsContainer:"Modal-module_buttonsContainer_XBJne",textInput:"Modal-module_textInput_--jAO",form:"Modal-module_form_SuMGf",disabledConfirmButtonMessage:"Modal-module_disabledConfirmButtonMessage_GXt0q"},MO=({hide:e})=>{const t=()=>m.createElement(m.Fragment,null,m.createElement("div",{className:UO.background,onClick:()=>{e()}}),m.createElement("div",{"data-testid":"","data-cy":"",onDragEnter:e=>e.stopPropagation(),onDragOver:e=>e.stopPropagation(),onDrop:e=>e.stopPropagation()},m.createElement("div",{className:UO.contentContainer},m.createElement("div",{className:UO.mainContent},m.createElement("div",{className:UO.header},"You don't have permission to manage this workspace.",m.createElement("div",{className:UO.closeContainer,onClick:e},m.createElement(Ee,null))),m.createElement("div",{className:UO.description},"Contact a workspace admin to make changes to this workspace.")),m.createElement("div",{className:UO.buttonsContainer},m.createElement(ux,{confirmFn:e,confirmText:"Got it"}))))),a=document.querySelector(".app-container");return a?ye.createPortal(t(),a):t()},FO=({className:e="",entryPoint:t=""})=>{const a=Fe(),o=Pu(),r=vO(),i=Ru(),s=cn((e=>e.currentUser)),l=Zw(s.user._id),[c,d]=n.exports.useState(!1),[u,p]=n.exports.useState(!1),h=()=>{eb(null==l?void 0:l.role)?d(!0):p(!0)},g=e=>{var t;return Mu(o,null==(t=s.user)?void 0:t.stripeId)?(e=>{e.stopPropagation(),a.push("/settings/account")})(e):(e=>{e.stopPropagation(),a.push(`/team/${o._id}/billing`)})(e)};return(null==r?void 0:r.cancel_at_period_end)&&i.showReactivate(r)?m.createElement("div",{className:`${OO} ${e}`,onClick:g,"data-testid":"reactivate-pill","data-cy":"reactivate-pill"},"Reactivate",m.createElement(fO,{className:DO})):(null==r?void 0:r.status)===Mr.PAST_DUE?m.createElement(m.Fragment,null,c&&m.createElement(PO,{stripeId:o.stripeId,exitOverlay:()=>d(!1),entryPoint:t}),u&&m.createElement(MO,{hide:()=>p(!1)}),m.createElement("div",{className:`${LO} ${e}`,onClick:h,"data-testid":"past-due-pill","data-cy":"past-due-pill"},"Payment Failed")):null},BO=(e,t,a)=>{const o=t||200,n=a||200,{fb_id:r,loggedInWith:i,picture:s,customPicture:l}=e||{};let c;switch((i||"").toLowerCase()){case"facebook":c=`https://graph.facebook.com/${r}/picture?width=${o}&height=${n}`;break;case"google":c=s?`${s}?sz=${o}`:void 0;break;default:c=s||void 0}var d;return l&&(c=(d=l).startsWith("https://cdn.kapwing.com")?d.replace("https://cdn.kapwing.com",po):d),c},WO=({height:e,letter:t,width:a})=>{const o=document.createElement("canvas");o.width=a,o.height=e;const n=o.getContext("2d");if(n)return n.fillStyle="#78909C",n.fillRect(0,0,a,e),n.font=`normal ${a/2}px sans-serif`,n.textAlign="center",n.textBaseline="middle",n.fillStyle="white",n.fillText(t,a/2,e/2),o.toDataURL("image/png")};class VO extends n.exports.Component{constructor(e){super(e),t(this,"onImageError",(()=>{this.setState({error:!0})})),this.state={error:!1}}render(){const{currentUser:e,custom:t,suggestedWidth:a,suggestedHeight:o,absoluteWidth:n,absoluteHeight:r,className:i,team:s}=this.props,{error:l}=this.state;let c={};const d=!(!this.props.user||!("pending"in this.props.user))&&this.props.user.pending;c=this.props.user&&!E(this.props.user)?this.props.user:e.user;const u=a||300,p=o||300;let h;if(l||this.props.user&&d||t||s)if(!l&&s&&"personal"!==s._id&&s.picture)h=s.picture;else{let a="";if(t&&t.name)a=t.name.charAt(0).toUpperCase();else if(s&&s.name)a=s.name.charAt(0).toUpperCase();else if(d&&c.name)a=c.name.charAt(0).toUpperCase();else if(this.props.user&&!E(this.props.user)){const{firstName:e}=c;e&&(a=e.charAt(0).toUpperCase())}else{const t=dm(e);t&&(a=t.charAt(0).toUpperCase())}h=WO({height:p,letter:a,width:u})}else h=BO(c,u,p);return n&&r?m.createElement("img",{width:n,height:r,src:h,alt:"",className:i,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError}):m.createElement("img",{src:h,alt:"",className:i,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError})}}const jO=i.exports.connect((e=>({currentUser:e.currentUser})))(VO),HO=({children:e,...t})=>{const[a,o]=m.useState(!1);return n.exports.useEffect((()=>{o(!0)}),[]),a?m.createElement(m.Fragment,{...t},e):null};class GO extends n.exports.Component{constructor(){super(...arguments),t(this,"handleError",((e,t="signIn",a="Sign In")=>{const{showError:o}=this.props;let n=e;e||(n="An error occurred during sign in with One Tap. Please try again later."),fm("Sign In Error Occurred",{"Error Type":t,Details:a,"One-Tap":!0}),o(n)})),t(this,"handleGoogleSuccessResponse",(e=>{const{fetchGoogleUser:t}=this.props;t(e,!0).catch((e=>{this.handleError(e.message,"fetchGoogleUser")}))}))}componentDidMount(){"undefined"!=typeof window&&(window.oneTapHandleSuccess=e=>{this.handleGoogleSuccessResponse(e)})}render(){var e,t,a;const{user:o}=this.props;return E(o)?m.createElement("div",{id:"g_id_onload","data-client_id":"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com","data-callback":"oneTapHandleSuccess","data-itp_support":"true","data-cancel_on_tap_outside":"false"}):(null==(a=null==(t=null==(e=window.google)?void 0:e.accounts)?void 0:t.id)||a.cancel(),null)}}const $O=ie(i.exports.connect((e=>({user:e.currentUser.user})),(e=>he({fetchGoogleUser:Vm,showError:wh},e)))(GO)),KO={upsellButton:"HeaderBar-module_upsellButton_-TB89",headerLinksLeft:"HeaderBar-module_headerLinksLeft_FvuJV",workspaceLink:"HeaderBar-module_workspaceLink_J1fiZ",divider:"HeaderBar-module_divider_r-sB3",workspaceDropDown:"HeaderBar-module_workspaceDropDown_d9WUp",plusIcon:"HeaderBar-module_plusIcon_dHLMZ",workspaceSwitcher:"HeaderBar-module_workspaceSwitcher_0qJrS",profileImage:"HeaderBar-module_profileImage_esu87",profileImageWithEmail:"HeaderBar-module_profileImageWithEmail_BzRZo",userName:"HeaderBar-module_userName_USIud",menuIcon:"HeaderBar-module_menuIcon_U0IHM",menu:"HeaderBar-module_menu_IWxm0",headerLinkText:"HeaderBar-module_headerLinkText_2leOT",headerActiveLinkText:"HeaderBar-module_headerActiveLinkText_h-inP",headerBar:"HeaderBar-module_headerBar_bSCyV",impersonating:"HeaderBar-module_impersonating_aKakH",headerBarEmpty:"HeaderBar-module_headerBarEmpty_7xuJg",headerRight:"HeaderBar-module_headerRight_8gDQm",headerLeft:"HeaderBar-module_headerLeft_UbvUw",menuLogoImage:"HeaderBar-module_menuLogoImage_bbzDs",headerBarLogoText:"HeaderBar-module_headerBarLogoText_-wwuS",headerBarLogoImage:"HeaderBar-module_headerBarLogoImage_ZwwLj",hideMobile:"HeaderBar-module_hideMobile_YKjEF",hideDesktop:"HeaderBar-module_hideDesktop_xJuMZ",signedInContainer:"HeaderBar-module_signedInContainer_-giip",accountName:"HeaderBar-module_accountName_rI-4h",accountNameWithEmail:"HeaderBar-module_accountNameWithEmail_EeiGe",email:"HeaderBar-module_email_KPhaQ",accountLink:"HeaderBar-module_accountLink_3r30W",proLabel:"HeaderBar-module_proLabel_-pF20",planLabel:"HeaderBar-module_planLabel_8mUnY",basicLabel:"HeaderBar-module_basicLabel_mRaDf",freeLabel:"HeaderBar-module_freeLabel_sYx10",pill:"HeaderBar-module_pill_3sGIa",badges:"HeaderBar-module_badges_8PPmC"},YO=async(e="",t="")=>{const{history:a,dispatch:o}=io(),n=await o(IS(t,e))||"";await o(Eg());const{paymentPlan:r,teamSubscription:i,currentTeam:s}=sg();zh(e,r.planTier,r.paymentTerm,ig(i),Hh(s).length),a.push(`/folder/${n}`)},zO=async(e="")=>{const{history:t,dispatch:a,state:o}=io(),{teams:{allTeams:n},workspaces:{allWorkspaces:r}}=o;let i="",s="";const l=n.find((e=>e.primary));if(l){i=l._id;const e=r.find((e=>e.teamId===i));s=null==e?void 0:e._id}s||(s=await a(IS(e,i))),s?t.push(`/folder/${s}`):t.push("/home")},qO=e=>{const{history:t,dispatch:a}=io();a(Af(e)),t.push(`/folder/${e}`)},JO=e=>{const{history:t,dispatch:a}=io();fm("Open Shared with Me",{location:e}),a(Af("shared-with-me")),t.push("/shared-with-me")},XO=e=>{const t=ob(e);return t&&!!(null==t?void 0:t.sharedAt)},QO=e=>{const{history:t,dispatch:a}=io();a(Af(e)),t.push(`/folder/${e}`)},ZO=(e,t)=>{const{history:a,dispatch:o}=io(),n=function(e,t){const{allWorkspaces:a}=io().state.workspaces,o=Qw(a,e).find((e=>e._id!==t));return(null==o?void 0:o._id)||""}(t,e);o(Af(n)),a.push(`/folder/${n}`)};function eD(e){const{state:t}=io(),{token:a,user:o}=t.currentUser||{};return op(`/api/v1/admin/users/${e}`,{body:{token:a,userId:o._id}})}function tD(e){const{state:t}=io(),{token:a,user:o}=t.currentUser||{},{_id:n}=o;return op("/api/v1/admin/fetchUserByEmail",{body:{email:e,token:a,userId:n}})}function aD(e,t){const{state:a}=io(),{token:o,user:n}=a.currentUser||{};return op("/api/v1/admin/fetchContentByEmail",{body:{targetUserEmail:e,pageNum:t,token:o,userId:n._id}})}function oD(e,t){return op("/api/v2/admin/addStripeId",{body:{targetTeamId:t,stripeId:e}})}function nD(e){const{state:t}=io(),{user:a}=t.currentUser||{};return op("/api/v2/admin/removeStripeId",{body:{targetTeamId:e,userId:a._id}})}function rD(e){return op("/api/v2/admin/removeStripeId",{body:{userId:e}})}function iD(e,t,a){const{state:o}=io(),{token:n,user:r}=o.currentUser||{};return op("/api/v2/admin/upgradeTeam",{body:{targetTeamId:e,planTier:t,paymentTerm:a,token:n,userId:r._id}})}function sD(e,t){const{state:a}=io(),{token:o,user:n}=a.currentUser||{};return op("/api/v1/admin/updateAccountType",{body:{targetUserId:e,newAccountType:t,token:o,userId:n._id}})}function lD(){return()=>ip("stripe_stats",{timeout:6e4,includeAuth:!0})}function cD(e){return async(t,a)=>{const{token:o,user:n,impersonatingAdminEmail:r}=a().currentUser;t(dg(""));const i=await op("/api/v1/admin/impersonateUser",{parseJSON:!0,body:{token:o,userId:n._id,userToImpersonateId:e}});await t(Fm(i.user,i.token,r||n.email)),await t(_g()),await t(IS()),wk()}}function dD(){return async(e,t)=>{const{token:a,user:o}=t().currentUser,{history:n}=io();e(dg(""));const r=await op("/api/v1/admin/revertImpersonation",{parseJSON:!0,body:{token:a,userId:o._id}});await e(Fm(r.user,r.token)),await e(_g()),await e(wg());const i=await e(IS());i?QO(i):n.push("/home"),wk()}}const uD="AdminImpersonationWarning-module_spacer_VCvul",mD="AdminImpersonationWarning-module_contentBox_oZsGS",pD="AdminImpersonationWarning-module_warningText_ugxIc",hD="AdminImpersonationWarning-module_dangerIcon_BMphk",gD=i.exports.connect((e=>({currentUser:e.currentUser})),(e=>he({revertUserImpersonation:dD},e)))((({className:e,currentUser:t,revertUserImpersonation:a})=>{const{user:o,impersonatingAdminEmail:r}=t,{email:i}=o;if(!r)return null;return n.exports.createElement("div",{className:`${uD} ${e||""}`},n.exports.createElement("span",{className:hD,style:{left:"4px"}},"⚠"),n.exports.createElement("div",{className:mD},n.exports.createElement("span",{className:pD},"Admin - You are acting as ",n.exports.createElement("b",null,i),"."),n.exports.createElement("button",{type:"button",onClick:async()=>{await a()}},"Revert to ",r)),n.exports.createElement("span",{className:hD,style:{right:"4px"}},"⚠"))})),fD=({currentUser:e,isMobile:t})=>{const a=dm(e),o=um(e),n=Ru();return m.createElement("div",{className:KO.signedInContainer},m.createElement("div",{className:KO.badges},m.createElement(FO,{className:KO.pill,entryPoint:"Workspace Header Pill"}),n.showUpgrades&&m.createElement(m.Fragment,null,m.createElement("div",{className:KO[`${n.planTier.toLowerCase()}Label`]},n.displayPlanTier," Plan"),m.createElement("div",{"data-cy":"upgrade-label-header"},m.createElement(_O,{className:KO.pill})))),m.createElement(Be,{to:{pathname:"/home",state:{openModal:vk.account}},className:KO.headerLinkText,activeClassName:KO.headerActiveLinkText,"data-cy":"account-nav-link"},m.createElement("div",{className:KO.accountLink},m.createElement("div",null,m.createElement("div",{className:o?KO.accountNameWithEmail:KO.accountName},a||"My Account"),!t&&o&&m.createElement("div",{className:KO.email},o)),m.createElement("div",null,m.createElement(jO,{suggestedWidth:300,suggestedHeight:300,className:o?KO.profileImageWithEmail:KO.profileImage})))))},yD=ie(i.exports.connect((e=>({currentUser:e.currentUser,workspaces:e.workspaces,allWorkspaces:e.workspaces.allWorkspaces,currentFolderId:e.workspaces.selectedWorkspace})))((e=>{const{currentUser:t,history:a,location:o}=e,r=om(t),[i,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!1),[d,u]=n.exports.useState(!1),p=ed(),h=n.exports.useRef(null);n.exports.useEffect((()=>{c(!1)}),[o]);const g=e=>{h&&h.current&&h.current.contains(e.target)||c(!1)};n.exports.useEffect((()=>(document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)})),[]);const f=()=>om(t)?e.currentFolderId?`/folder/${e.currentFolderId}`:"/home":"/",y=()=>{const{currentUser:t}=e;return m.createElement(m.Fragment,null,m.createElement(HO,null,om(t)?m.createElement(Be,{className:KO.headerLinkText,activeClassName:KO.headerActiveLinkText,to:f(),"data-cy":"workspace-nav-link"},"Workspace"):null),m.createElement("a",{className:KO.headerLinkText,href:"/tools","data-cy":"tools-nav-link"},"Tools"),m.createElement("a",{className:KO.headerLinkText,href:"/templates","data-cy":"templates-nav-link"},"Templates"),m.createElement("a",{className:KO.headerLinkText,href:"/pricing","data-cy":"pricing-nav-link"},"Pricing"),m.createElement("a",{className:KO.headerLinkText,target:"_self",href:"https://www.kapwing.com/resources"},"Resources"),m.createElement("a",{className:KO.headerLinkText,href:"/teams","data-cy":"teams-nav-link"},"Teams"))};return m.createElement("div",{className:KO.headerBar+(Xg(t)?` ${KO.impersonating}`:"")},m.createElement(gD,null),m.createElement("div",{className:KO.headerLeft},p?m.createElement(m.Fragment,null,m.createElement("a",{href:f()},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",alt:"Kapwing Logo",className:KO.menuLogoImage,"data-cy":"header-logo",width:36,height:36})),l?m.createElement(Ee,{"data-cy":"mobile-nav-menu-toggle",className:KO.menuIcon,onClick:()=>{c(!l)}}):m.createElement(We,{"data-cy":"mobile-nav-menu-toggle",className:KO.menuIcon,onClick:()=>{c(!l)}}),l?m.createElement("div",{className:KO.menu,ref:h},m.createElement("a",{className:KO.headerBarLogoText,href:f()},"KAPWING"),y()):null):m.createElement(m.Fragment,null,m.createElement("a",{href:f()},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:KO.headerBarLogoImage,alt:"Kapwing Logo","data-cy":"header-logo",width:36,height:36})),m.createElement("a",{className:`${KO.headerBarLogoText} ${KO.hideMobile}`,href:f()},"KAPWING"),m.createElement("div",{className:KO.headerLinksLeft},y())),m.createElement($O,null)),m.createElement(HO,null,m.createElement("div",{className:KO.headerRight},r&&Bu()?m.createElement(fD,{currentUser:t,isMobile:p,showPaywall:d,setShowPaywall:u}):m.createElement("div",{className:KO.headerLinkText,onClick:()=>{s(!0)},"data-cy":"signin-nav-link"},"Sign In")),i?m.createElement(MC,{hideSignIn:()=>{s(!1)},onSuccess:()=>{a.push(f())}}):null))}))),ED="Checkout-module_wrapper_WNgrn",_D="Checkout-module_container_JW3Np",vD="Checkout-module_header_cezgS",wD="Checkout-module_description_LoRcJ",bD="Checkout-module_contentRight_sAefT",SD="Checkout-module_contentLeft_5xkFK",TD="Checkout-module_paymentForm_gUKy8",ID="Checkout-module_subtitleVideo_qCfjc",kD="Checkout-module_subtitleImage_-XgNJ",CD="Checkout-module_sectionHeader_BBI0Q",ND="Checkout-module_sectionDescription_rvhYS",AD="Checkout-module_spaceP_2ZOq3",xD="Checkout-module_skipCheckout_Mzp7h",PD=()=>{var e;const t=Pu(),a=oe(),o=new URLSearchParams(a.search),r=o.get("tier"),s=Ru(),l=qA(KA.basicPlan),c=Eu(((e,t)=>{if(!e)return jd.PRO;const a=Eu(e);return a.planTier===jd.FREE?jd.PRO:a.planTier===jd.BASIC?t?jd.BASIC:jd.PRO:a.planTier})(r,l)),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(""),[g,f]=n.exports.useState(!1),[y,E]=n.exports.useState(),_=i.exports.useDispatch(),v=Fe(),[w,b]=n.exports.useState(!1),[S,T]=n.exports.useState((I=o.get("subscription"))?"annual"===I||I===Vd.ANNUALLY?Vd.ANNUALLY:Vd.MONTHLY:Vd.ANNUALLY);var I;const{currentUser:k}=cn((e=>({currentUser:e.currentUser})),i.exports.shallowEqual),C=cn((e=>e.currentUser.user)),N=C?FA(C):void 0,A=N?_o[N].discountPercentage.toString():void 0;n.exports.useEffect((()=>{Ob.get("amplitudeFlag",{disabled:null})?(Tm(ou.PRICING,{extraProperties:{Page:"Pricing"}}),Ob.remove("amplitudeFlag")):Tm(ou.LINK)}),[]),n.exports.useEffect((function(){var e;(null==(e=null==k?void 0:k.user)?void 0:e._id)&&v.push({pathname:"/home"})}),[null==(e=null==k?void 0:k.user)?void 0:e._id,v]);const x=async()=>{await _($A()),_(bh(`Thanks for upgrading to Kapwing ${c.displayPlan}`)),v.push("/studio/editor")};return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement("div",{className:ED},m.createElement("div",{className:_D},m.createElement("div",{className:SD},m.createElement("div",{className:vD},"Upgrade and take advantage of all the features and benefits of Kapwing ",c.displayTier),m.createElement("div",{className:wD},"Take your videos to the next level. Upgrade now to",m.createElement("span",null,c.hasPermission(au.EXPORT_ALL_WITHOUT_WATERMARK)?" create, edit, and repurpose videos without any restrictions.":" export images and short videos (30s or shorter) without a Kapwing watermark.")),m.createElement(XR,{selectedTerm:S,setSelectedTerm:T,upgradeTerms:[Vd.ANNUALLY,Vd.MONTHLY]}),m.createElement(qR,{paymentTerm:S,planTier:c.planTier,team:t,finalPrice:y}),m.createElement("div",{className:TD},m.createElement(GA,{email:p,name:d,onCharged:async(e,a=ru.REGULAR)=>{var o;const n={Page:"Checkout"};A&&(n["Discount Value"]=A);const r=!!(null==(o=null==k?void 0:k.user)?void 0:o._id);wm({couponId:null,isAnonUpgrade:!r,paymentTerm:S,planTier:c.planTier,paymentProcessor:"Stripe",checkoutType:a,upgradeSource:ou.PRICING_PAGE,extraAmplitudeEventProperties:n,currentPlan:s.planTier,upgradePlan:c.planTier,teamId:t._id,quantity:t.users.length}),Ir("Upgrade Workspace"),r||e||_(bh(`Your account has been updated. Now sign into ${p} to access all your Kapwing Pro features.`)),r?await x():b(!0)},setEmail:h,setName:u,setSubmitting:f,submitText:`Checkout and start using ${c.displayTier}`,submitting:g,upgradeTier:c.planTier,upgradeTerm:S,team:t,setFinalPrice:E}),w?m.createElement(MC,{email:p,description:`Thanks for upgrading to Kapwing ${c.displayTier}. To get started, sign in with your email ${p} to access your subscription.`,hideSignIn:()=>{_(bh(`Your ${c.displayTier} account is ready and waiting. Sign in with your email ${p} to access Pro, edit videos, and manage your subscription.`))},immediateRedirectPathname:"/studio/editor",onSuccess:()=>{(async()=>{await _($A()),await x()})()}}):null)),m.createElement("div",{className:bD},m.createElement("div",null,m.createElement("div",{className:CD},"How do I edit a video with Kapwing?"),m.createElement("div",{className:ND},m.createElement("p",null,"Editing in Kapwing works right in your browser, without any need for downloads or installations. Simply upload your video and start making edits right away. Kapwing allows you to trim, resize, add text, split clips, and much more."," ",c.hasPermission(au.SMART_CUT)?`If that's not\n                    enough, Kapwing ${c.displayTier} also includes a collection of smart\n                    features, from automatic splitting to remove background.`:""),m.createElement("div",{className:AD},m.createElement("video",{src:"https://cdn-useast1.kapwing.com/static/kapwing-demo.mp4",className:ID,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,poster:"https://cdn-useast1.kapwing.com/static/yqK-kapwing-demo-poster-min.webp"}))),m.createElement("div",{className:CD},"Why choose Kapwing for editing videos?"),m.createElement("div",{className:ND},m.createElement("p",null,"Millions of creators each month trust Kapwing with their video editing workflow. Join a community just like you who want to create and share more accessible videos in the browser. Rated 4.8 with 3000+ reviews, you can rest assured that your videos will export exactly how you need. Kapwing is a trusted solution for millions of entreprenuers, professors, marketers, and video professionals all over the world."),m.createElement("div",{className:AD},m.createElement("img",{src:"https://i.imgur.com/I2Q76aA.png",className:kD,alt:"Screenshot of Kapwing Reviews"}))),m.createElement("div",{className:CD},"How much of my video editing workflow does Kapwing support?"),m.createElement("div",{className:ND},m.createElement("p",null,"Kapwing is a non-linear video editing software, meaning that creators can add multiple formats of files to a traditional video editing timeline. Using the timeline, clips can be split, trimmed, and adjusted to best fit your story. Kapwing also allows for powerful audio editing as well as adding visual elements to the timeline."),m.createElement("div",{className:AD},m.createElement("video",{src:"https://cdn-useast1.kapwing.com/static/checkout/video-editor/timeline.mp4",className:ID,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}))),m.createElement("div",{className:CD},"Tell me about your privacy policy and terms of service."),m.createElement("div",{className:ND},m.createElement("p",null,"Kapwing has a strict confidentiality policy and serves all data over encrypted requests. Kapwing is also COPPA and FERPA compliant and we take customer data and privacy seriously. Your payment and account information is securely transmitted and encrypted end to end."),m.createElement("div",{className:AD},m.createElement("img",{src:"https://i.imgur.com/QvAvtkC.png",className:kD,alt:"Kapwing Kitten"}))),m.createElement("div",{className:CD},"Is it easy to cancel Kapwing ",c.displayTier," if I don't need it?"),m.createElement("div",{className:ND},m.createElement("p",null,"Yes, cancelling your Kapwing ",c.displayTier," ","subscription is customer-friendly and takes just two clicks. You can cancel your plan at any point if you don't need it. Your plan will still continue to stay active until the end of the billing period even if cancelled."),m.createElement("div",{className:AD},m.createElement("img",{src:"https://i.imgur.com/WJG6HR7.png",className:kD,alt:"Screenshot of Kapwing cancellation process"}))),m.createElement("div",{className:CD},"Do you offer a free trial?"),m.createElement("div",{className:ND},m.createElement("p",null,"We encourage you to upgrade to Kapwing"," ",c.displayTier," now, as this will enable you to use all of the features of Kapwing without any restrictions or interruptions in your service. However, we do offer a free trial of our tools for those interested in trying them out."," ",m.createElement("span",{className:xD,onClick:()=>{fm("Skip Checkout",{Page:"Checkout"}),v.push("/studio/editor")}},"Click here to skip Kapwing ",c.displayTier," for now →"))))))))},RD="EduLogin-module_background_Uy-3-",OD="EduLogin-module_backgroundImage_mlfkY",DD="EduLogin-module_signInContainer_MyMim",LD="EduLogin-module_signInHeader_60jiv",UD="EduLogin-module_signInText_-ZNvH",MD="EduLogin-module_text_ss9wC",FD="EduLogin-module_signInBox_zT-YJ",BD=()=>{const e="EDU Program Sign In — Kapwing",t="Sign in to apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement(Ce,null,m.createElement("title",null,e),m.createElement("meta",{name:"description",content:t}),m.createElement("meta",{property:"og:title",content:e}),m.createElement("meta",{property:"og:description",content:t}),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement("div",{className:RD},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/U90-Kit-Bob-Background.webp",alt:"student kit and bob",className:OD}),m.createElement("div",{className:DD},m.createElement("div",{className:LD},"Sign in to get started with Kapwing for Education"),m.createElement("div",{className:UD},m.createElement("div",{className:MD},"Please sign in with your official school email address.")),m.createElement("div",{className:FD},m.createElement(PC,{immediateRedirectPathname:"/edu/signup"})))),m.createElement(HC,null))},WD="EduSignup-module_container_8iB8J",VD="EduSignup-module_typeformBackground_zAuBk",jD="EduSignup-module_typeformWidget_Woiw9",HD=()=>{const e=cn((e=>e.currentUser)),t=cm(e),a=um(e),o=om(e);if(n.exports.useEffect((()=>{o||Ml("/edu/login")})),!o||void 0===o)return null;const r="EDU Program Sign up — Kapwing",i="Sign up and apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement(Ce,null,m.createElement("title",null,r),m.createElement("meta",{name:"description",content:i}),m.createElement("meta",{property:"og:title",content:r}),m.createElement("meta",{property:"og:description",content:i}),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement("div",{className:WD},m.createElement("div",{className:VD},m.createElement(Ve.exports.Widget,{id:"yz2hQIEC",hidden:{kapwing_name:t,kapwing_email:a},onSubmit:e=>{(async e=>{await op("/api/v1/edu/submit",{body:{userID:t,userEmail:a,responseID:e}})})(e.responseId)},className:jD}))),m.createElement(HC,null))},GD=()=>{const e="EDU Program Sign Up — Kapwing",t="Sign up as a district admin and apply for the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement(Ce,null,m.createElement("title",null,e),m.createElement("meta",{name:"description",content:t}),m.createElement("meta",{property:"og:title",content:e}),m.createElement("meta",{property:"og:description",content:t}),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement("div",{className:WD},m.createElement("div",{className:VD},m.createElement(Ve.exports.Widget,{id:"agzKsq7v",className:jD}))),m.createElement(HC,null))},$D="Error-module_errorMessage_nDpUL",KD="Error-module_errorSnackbar_oLWHu",YD="Error-module_errorCloseSnackbar_1Y662",zD="Error-module_warningSnackbar_3oXjX",qD=()=>{const e=i.exports.useDispatch(),{showError:t,errorMessage:a,errorType:o}=cn((e=>({showError:e.toasts.showError,errorMessage:e.toasts.errorMessage,errorType:e.toasts.errorType})),dn);if(t){const n=()=>e({type:"HIDE_ERROR"});return setTimeout((()=>{t&&o!==Yo&&n()}),1e4),m.createElement("div",{className:o===Yo?zD:KD,"data-cy":"error-toast"},m.createElement("div",{className:YD,onClick:n},"×"),m.createElement("span",{className:$D},a||"An error occurred. Please try again later."))}return null};function JD(e,t){return()=>op("/api/v1/email/add",{body:{email:e,source:t,submittedAt:new Date}})}const XD={home:"common-module_home_1RmXS",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_tmS3r",largeButton:"common-module_largeButton_mqeEp",sectionContent:"common-module_sectionContent_oGtD5",sectionHeader:"common-module_sectionHeader_lqs-I",spacer:"common-module_spacer_4jJEN",chevron:"common-module_chevron_ue8Fs",splashText:"common-module_splashText_XxRuH",splashSubtext:"common-module_splashSubtext_doe31",aboutSection:"common-module_aboutSection_67WbE",mobile:"common-module_mobile_xYfSm",desktop:"common-module_desktop_r-fmO",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_W-yva",disabled:"common-module_disabled_qze4D",noScrollBar:"common-module_noScrollBar_rA8Ld",textOverflowEllipsis:"common-module_textOverflowEllipsis_eFSw-",genericButtonBlue:"common-module_genericButtonBlue_2nvue"};class QD extends n.exports.Component{constructor(e){super(e),t(this,"renderSubmitted",(()=>m.createElement("div",{className:"youre-in"},"You're in! Thanks for signing up!"))),this.state={emailValue:"",loading:!1,submitted:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){this.setState({emailValue:e.target.value})}handleSubmit(e){e.preventDefault();const{emailValue:t}=this.state,{addEmail:a,source:o,showError:n}=this.props;this.setState({loading:!0}),a(t,o).then((()=>{this.setState({loading:!1,submitted:!0})})).catch((e=>{n(e.message),this.setState({loading:!1})}))}renderCollection(){const{emailValue:e,loading:t}=this.state;return m.createElement("form",{onSubmit:this.handleSubmit,className:"subscribe-form"},m.createElement("label",{htmlFor:"email-subscribe"},m.createElement("span",{className:XD.screenReaderOnlyLabel},"Email"),m.createElement("input",{id:"email-subscribe",placeholder:"youremail@gmail.com",type:"text",className:"primary-text-field email-subscribe-input",value:e,onChange:this.handleChange})),t?m.createElement("button",{type:"submit",className:"primary-button email-subscribe-button"},"Loading..."):m.createElement("button",{type:"submit",className:"primary-button email-subscribe-button"},"Sign up"))}render(){const{submitted:e}=this.state;return m.createElement("div",null,e?this.renderSubmitted():this.renderCollection())}}const ZD=i.exports.connect(void 0,(e=>he({addEmail:JD,showError:wh},e)))(QD),eL=[{id:"google",name:"Google",image:"https://i.imgur.com/qvCOvDE.jpg",logo:"https://i.imgur.com/RUYUxk0.jpg",date:"1998",description:"See the evolution of Google from the early days at Stanford to the iconic company it is today.",states:[{year:"1998",description:"The early days of Google, when Larry and Sergey still were at Stanford.",image:"https://i.imgur.com/gesKoOF.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2000",description:"Google implements its iconic, simple homepage, but still is focused on search, not any other products.",image:"https://i.imgur.com/yhmmQvJ.png",link:"https://web.archive.org/web/20000301214819/http://google.com:80/"},{year:"2002",description:"Google introduces image search, groups, and some other search features.",image:"https://i.imgur.com/Ws1RiTX.png",link:"https://web.archive.org/web/20020222232203/http://www.google.com:80/"},{year:"2004",image:"https://i.imgur.com/CuNRKyh.png",link:"https://web.archive.org/web/20040221050042/http://www.google.com:80/"},{year:"2006",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/vMmprt2.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"2012",description:"Fast forward another 6 years, and Google simplifies its homepage further, and shifts to a header bar UI.",image:"https://i.imgur.com/WPJR94n.png",link:"https://web.archive.org/web/20120227195823/http://www.google.com/"},{year:"2016",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/f8LQfDv.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"Today",description:"Google introduces a new, flatter logo, but still maintains its simple, uncluttered homepage.",image:"https://i.imgur.com/UnQhOkQ.png",link:"https://www.google.com/"}]},{id:"amazon",name:"Amazon",image:"https://i.imgur.com/rPSZBZY.jpg",logo:"https://i.imgur.com/g8O5Sur.jpg",date:"1999",description:"Bookseller to electronics to personalization and content creation to everything else. Here's how an ecommerce trickle turned into the Amazon",states:[{year:"1999",description:"Books take center stage on the original Amazon landing page.",image:"https://i.imgur.com/jwJsUEZ.png",link:"https://web.archive.org/web/19990828014913/http://www.amazon.com:80/"},{year:"2001",description:"Early on, Amazon prominently advertises personalized recommendations on the home page.",image:"https://i.imgur.com/XX7upff.png",link:"https://web.archive.org/web/20010630235838/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2005",description:"Introducing Amazon Prime! Two-day shipping makes its debut.",image:"https://i.imgur.com/q22junf.png",link:"https://web.archive.org/web/20050531233632/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2008",description:"Introducing Kindle. Amazon pivots towards electronics. Also, where did the search bar go?",image:"https://i.imgur.com/DsMabM8.png",link:"https://web.archive.org/web/20080301234936/http://www.amazon.com:80/"},{year:"2011",description:"The categories on the left show a clear shift towards electronics and TV.",image:"https://i.imgur.com/5nWXqaD.png",link:"https://web.archive.org/web/20110715002059/http://www.amazon.com/"},{year:"2013",description:"Amazon launches a more mobile-friendly version of the site with personalized recommendations and extended vertical scroll",image:"https://i.imgur.com/jppfbI9.png",link:"https://web.archive.org/web/20130531235338/http://www.amazon.com/"},{year:"Today",description:"Today, Amazon shows off their inventory with more visuals, less text. and bold colors.",image:"https://i.imgur.com/yqZ4QkK.png",link:"https://www.amazon.com/"}]},{id:"pinterest",name:"Pinterest",image:"https://i.imgur.com/b75lGep.png",logo:"https://i.imgur.com/OfE2Yh1.jpg",date:"2010",description:"Pinterest started with small groups of enthusiastic users, wanting to pin their favorite images from across the web.",meta:{title:"Evolution of Pinterest – Kapwing",description:"See how Pinterest evolved from an invite-only website for users to pin images to the online destination for visual inspiration for everyone."},states:[{year:"2010",description:"For a long time, joining Pinterest was by invite only. But the content was available for everyone.",image:"https://i.imgur.com/o7Xy4Jl.png",link:"https://web.archive.org/web/20110131073434/http://pinterest.com:80/"},{year:"2012",description:"By 2012, Pinterest introduced its iconic red color.",image:"https://i.imgur.com/FqL1q5v.png",link:"https://web.archive.org/web/20120131141949/https://www.pinterest.com/"},{year:"2014",description:"Pinterest quickly gained popularity for its quirky images and high quality content.",image:"https://i.imgur.com/fBs78Gv.png",link:"https://web.archive.org/web/20140812045916/http://www.pinterest.com/all/animals/"},{year:"Today",description:"Today Pinterest is a destination for ideas, especially those that involve highliy visual content.",image:"https://i.imgur.com/HvgP6fy.png ",link:"https://www.pinterest.com/"}]},{id:"facebook",name:"Facebook",image:"https://i.imgur.com/jGnmW6z.png",logo:"https://i.imgur.com/ZaZkeBt.jpg",date:"2004",description:"Watch one of the most popular websites in the world grow up!",states:[{year:"2004",description:'Facebook started as a social network for college students. You can see on their home page their claim as a "Mark Zuckerberg Production".',image:"https://i.imgur.com/8bM2yqy.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2008",description:"Facebook's landing page changes to reflect a more globally appealing service",image:"https://i.imgur.com/MnV886O.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/"},{year:"2009",description:"Facebook's famous Wall is used by millions to communicate with each other",image:"https://i.imgur.com/IX05Lyd.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/zuck"},{year:"2012",description:"Facebook turns its attention to mobile.",image:"https://i.imgur.com/5AoFmRV.png",link:"https://web.archive.org/web/20120722140441/https://www.facebook.com/"},{year:"Today",description:"The Facebook homepage has not changed much, but the product and its services definitely have",image:"https://i.imgur.com/eN3eGRb.png",link:"https://www.facebook.com/"}]},{id:"youtube",name:"YouTube",image:"https://i.imgur.com/JqulZ1O.png",logo:"https://i.imgur.com/4gegwsM.jpg",date:"2005",description:"YouTube was started by three former Paypal employees - Chad Hurley, Steve Chen, and Jawed Karim - who went on to sell the company to Google.",states:[{year:"2006",description:"In the early days of YouTube, there was a single feed that everyone consumed of popular videos on the site.",image:"https://i.imgur.com/GPZH7Z0.png",link:"https://web.archive.org/web/20060303064630/http://www.youtube.com/"},{year:"2008",description:"By 2008, Youtube had developed its iconic player and started surfacing trending video content on the web.",image:"https://i.imgur.com/Oohhd1Q.pngg",link:"https://web.archive.org/web/20080306015406/http://www.youtube.com/"},{year:"2010",description:"Youtube's integration with Google brought changes, some popular and others not so much.",image:"https://i.imgur.com/RSrULXl.png",link:"https://web.archive.org/web/20100306024813/http://www.youtube.com:80/"},{year:"2012",description:"YouTube relied heavily on Flash, and also began showing ads alongside content.",image:"https://i.imgur.com/7gXP0Vu.png",link:"https://web.archive.org/web/20120731224216/http://www.youtube.com/"},{year:"2016",description:"By 2016, YouTube had a very similar look and feel to the content today, with many popular channels for users to choose from.",image:"https://i.imgur.com/Bj3Tgy9.png",link:"https://web.archive.org/web/20160731223744/https://www.youtube.com/"},{year:"Today",description:"Today YouTube is one of the most popular video sharing sites out there!",image:"https://i.imgur.com/RwuvuZL.png",link:"https://www.youtube.com/"}]},{id:"reddit",name:"Reddit",image:"https://i.imgur.com/jUDALgT.jpg",logo:"https://i.imgur.com/bbDAN5t.jpg",date:"2005",description:"Not much has changed about Reddit's design over the last decade, until very recently. But, the community has grown to be one of the most vibrant on the internet.",states:[{year:"2005",description:"In the beginning, Reddit was just an interesting collection of links on the homepage.",image:"https://i.imgur.com/SkvHFAC.png",link:"https://web.archive.org/web/20051128021349/http://reddit.com:80/"},{year:"2007",description:"As more and more people joined the community, sub-reddits started emerging around different topics.",image:"https://i.imgur.com/2GJUO1u.png",link:"https://web.archive.org/web/20071128120627/http://reddit.com:80/"},{year:"2009",description:"Reddit's design from 2009 looks very similar to the homepage today, but note the lower number of upvotes on the homepage.",image:"https://i.imgur.com/tP2S7ug.png",link:"https://web.archive.org/web/20091125194850/http://www.reddit.com/"},{year:"2015",description:"Five years later, Reddit introduces new features like Reddit Gold, but the links remain the same.",image:"https://i.imgur.com/4d80yc7.png",link:"https://web.archive.org/web/20151125194114/https://www.reddit.com/"},{year:"Today",description:"New Reddit was just introduced, marking a shift away from its blue link design. What do you think?",image:"https://i.imgur.com/fs3zSEg.png",link:"https://www.reddit.com/"}]},{id:"airbnb",name:"Airbnb",image:"https://i.imgur.com/fBoKbXA.png",logo:"https://i.imgur.com/ncRM7O9.jpg",date:"2008",description:"From hustling on Craigslist to Unicorn status, Airbnb has grown exponentially since in lauched in 2008. Watch it become the largest hotel chain in the world.",states:[{year:"2008",description:"TechCrunch covers a YC travel startup called 'AirBed&Breakfast'. This is the screenshot from the first article.",image:"https://i.imgur.com/v7T7hej.png",link:"https://techcrunch.com/2008/08/11/airbed-and-breakfast-takes-pad-crashing-to-a-whole-new-level/"},{year:"2010",description:"The basic home page lets users search for available listings and features a few homes. The counter shows a few thousand homes available.",image:"https://i.imgur.com/2bti8rK.png",link:"https://web.archive.org/web/20100701085507/http://www.airbnb.com:80/"},{year:"2012",description:"Big, beautiful splash photos dominate the home page. Users can search for listings and discover.",image:"https://i.imgur.com/NTqW0f5.png",link:"https://web.archive.org/web/20120629225044/https://www.airbnb.com/"},{year:"2014",description:"AirBnb overlays the search UI on a gallery of featured photos. Airbnb also publishes content on cities and travel planning.",image:"https://i.imgur.com/uly4OER.png",link:"https://web.archive.org/web/20140629193814/https://www.airbnb.com/"},{year:"2016",description:"AirBnb updates their logo. Landing page full of beautiful photos to explore and inspire.",image:"https://i.imgur.com/iz8vZwk.png",link:"https://web.archive.org/web/20160602025743/https://www.airbnb.com/"},{year:"2018",description:"In the last few years, AirBnb has moved into travel experiences. The home page showcases photos of people rather than homes.",image:"https://i.imgur.com/inwtiDB.png",link:"https://www.airbnb.com"}]},{id:"twitter",name:"Twitter",image:"https://i.imgur.com/GSV165q.png",logo:"https://i.imgur.com/80f3Fb2.jpg",date:"2006",description:"The platform for short, real-time communication didn't always have it's full domain. When it started, it was known as Twttr.",meta:{title:"Evolution of Twitter – Kapwing",description:"Explore the museum of websites to see how Twitter evolved from a small community to the online destination for short, real-time communication."},states:[{year:"2006",description:"Just like any other startup, Twitter began as a small community.",image:"https://i.imgur.com/8xhyyf3.png",link:"https://web.archive.org/web/20061109073453/http://twitter.com:80/"},{year:"2008",description:"It took a while for folks to learn what Twitter was all about.",image:"https://i.imgur.com/cum4mXe.png",link:"https://web.archive.org/web/20080731045131/http://twitter.com/"},{year:"2010",description:"By 2010, the world learned about the hashtag and Twitter handles. And the service was growing, fast.",image:"https://i.imgur.com/PczLnvV.png",link:"https://web.archive.org/web/20100731060657/http://twitter.com/"},{year:"2012",description:"The basic profile that we recognize today was coming together by 2012.",image:"https://i.imgur.com/Vpv19cB.png",link:"https://web.archive.org/web/20120804170203/http://twitter.com/jack"},{year:"2015",description:"Twitter embraces flat design and creates a cleaner interface.",image:"https://i.imgur.com/BpqxxxP.png",link:"https://web.archive.org/web/20150803233857/https://twitter.com/jack"},{year:"Today",description:"It's clear that the world is becoming more and more visual, as posts on Twitter have less text and more media.",image:"https://i.imgur.com/H7foyal.png",link:"https://www.twitter.com/jack"}]},{id:"yelp",name:"Yelp",image:"https://i.imgur.com/4YN5brG.png",logo:"https://i.imgur.com/IN0Hphi.png",date:"2004",description:"Check out how Yelp soared from a dud to IPO in 7 years to became the leading platform for reviewing local businesses.",states:[{year:"2004",description:"In October, Yelp debuts as a an email-based referral network.",image:"https://i.imgur.com/csMuwiZ.jpg",link:"https://web.archive.org/web/20041014015116/http://www.yelp.com:80/home"},{year:"2005",description:"Yelp revamps its site to showcase reviews from 'real' people and motivate people to leave more reviews. Yelp receives $5M Series B in November.",image:"https://i.imgur.com/fDjMvuw.png",link:"https://web.archive.org/web/20051014001110/http://www.yelp.com:80/home"},{year:"2009",description:"Yelp goes international! The review site covers more cities, verticals, and features.",image:"https://i.imgur.com/tPeZBV5.png",link:"https://web.archive.org/web/20090226093725/http://www.yelp.com/"},{year:"2013",description:"Yelp showcases photos and enables mobile reviewing for the first time. The home page emphasizes fresh reviews and new businesses.",image:"https://i.imgur.com/u9GBTit.png",link:"https://web.archive.org/web/20130308045039/http://www.yelp.com/c/sf/food"},{year:"Today",description:"The mobile-friendly modern Yelp landing page has lots to browse and discover.",image:"https://i.imgur.com/yzQwf5h.png",link:"https://www.yelp.com"}]},{id:"yahoo",name:"Yahoo",image:"https://i.imgur.com/6D5x6zo.jpg",logo:"https://i.imgur.com/L4MA3H5.jpg",date:"1995",description:"Yahoo was the starting page for many in the earliest days of the internet.",states:[{year:"1997",description:"In the very beginning, Yahoo was a hand-curated collection of links to the most interesting pages on the web.",image:"https://i.imgur.com/T4zRjSr.png",link:"https://web.archive.org/web/19970109130853/http://www9.yahoo.com:80/"},{year:"2001",description:"Over time, the collection grew, as well as the services that Yahoo offered.",image:"https://i.imgur.com/alWc6FJ.png",link:"https://web.archive.org/web/20010614222934/http://www.yahoo.com:80/"},{year:"2003",description:"By 2003, Yahoo was the portal to the rest of the internet. It's homepage had news, sports, email, and more.",image:"https://i.imgur.com/jxycn9G.png",link:"https://web.archive.org/web/20030618011248/http://www.yahoo.com:80/"},{year:"2005",image:"https://i.imgur.com/95mqTZx.png",link:"https://web.archive.org/web/20050616111951/http://www.yahoo.com/"},{year:"2010",description:"By 2010, Yahoo had rebranded to embrace larger screens, as well as change their logo to the iconic purple color.",image:"https://i.imgur.com/o8LBSCS.png",link:"https://web.archive.org/web/20100616094317/http://www.yahoo.com/"},{year:"2014",description:"Yahoo embraces a more modern design and also struggles to find its identity in the world of social media and Google.",image:"https://i.imgur.com/gkel5vv.png",link:"https://web.archive.org/web/20140616095746/https://www.yahoo.com/"},{year:"Today",description:"The original web portal that Yahoo once was almost seems irrelevant today. But Yahoo was the original internet services pioneer.",image:"https://i.imgur.com/6LbyyXf.png",link:"https://www.yahoo.com"}]},{id:"new-york-times",name:"The New York Times",image:"https://i.imgur.com/aeJ0xx8.jpg",logo:"https://i.imgur.com/Gym4mbz.jpg",date:"2001",description:"Of course, the NYT has been around much longer than any internet company, but their online presence began around 2001.",states:[{year:"2001",description:"In the early 2000s, publishers like the NYT were still trying to find their identity online.",image:"https://i.imgur.com/k0fsABv.png",link:"https://web.archive.org/web/20010124140244/http://www2.nytimes.com:80/"},{year:"2003",description:"Over time, images became more important, and there was an increasing amount of digital content produced.",image:"https://i.imgur.com/U80nb2L.png",link:"https://web.archive.org/web/20030124140244/http://www2.nytimes.com:80/"},{year:"2008",description:"The New York Times brings its iconic print design to the web.",image:"https://i.imgur.com/Z3dkhaN.png",link:"https://web.archive.org/web/20080126085449/http://www.nytimes.com:80/"},{year:"2012",description:"By 2012, the Times has started pushing digital subscriptions amidst declinging print revenues.",image:"https://i.imgur.com/XZfD6ak.png",link:"https://web.archive.org/web/20120126092410/http://www.nytimes.com/"},{year:"2016",description:"In 2016, the Times website was simplified and looked to as an example of good journalism design on the web",image:"https://i.imgur.com/6y4HHdr.png",link:"https://web.archive.org/web/20160914235337/http://www.nytimes.com/"},{year:"Today",description:"Today's times embraces large screens, bold imagery, and eye-catching media.",image:"https://i.imgur.com/CM4KGrM.png",link:"https://www.nytimes.com"}]},{id:"product-hunt",name:"Product Hunt",image:"https://i.imgur.com/yP7Pzk9.png",logo:"https://i.imgur.com/3PeWAOV.jpg",date:"2014",description:"This go-to site for discovering new products started as a simple email list, but then grew quickly to become a large community of founders, entrepreneurs, and tech enthusiasts.",states:[{year:"2014",description:"Product Hunt was lean from the beginning, starting out as a simple list of products to upvote.",image:"https://i.imgur.com/ZlORgvU.png",link:"https://web.archive.org/web/20141001005151/http://www.producthunt.com/"},{year:"2016",description:"Product Hunt continued to grow, adding new categories and topics and expanding beyond the usual tech products.",image:"https://i.imgur.com/IubDg1T.png",link:"https://web.archive.org/web/20160731192941/https://www.producthunt.com/"},{year:"2017",description:"By 2017 Product Hunt's kitten becomes iconic in the tech community and beyond.",image:"https://i.imgur.com/fZGsprA.png",link:"https://web.archive.org/web/20170731212954/https://www.producthunt.com/"},{year:"Today",description:"Today, Product Hunt is a vibrant community that goes beyond a simple list of products. There are Q&A forums, discussions, job boards, and more that takes place on the site.",image:"https://i.imgur.com/yuAgMDi.png",link:"https://www.producthunt.com"}]},{id:"netflix",name:"Netflix",image:"https://i.imgur.com/r2nbum1.png",logo:"https://i.imgur.com/Kqrbs65.png",date:"1999",description:"Check out how Netflix grew up from a monthly DVD subscription service to a video streaming site to a content powerhouse.",meta:{title:"Evolution of Netflix – Kapwing",description:"Explore the museum of websites to see how Netflix evolved from a monthly DVD subscription service to a content powerhouse."},states:[{year:"1999",description:"Netflix launches their monthly subscription model: unlimited DVD rentals for a monthly fee.",image:"https://i.imgur.com/aR7DLVr.png",link:"https://web.archive.org/web/19990117011532/http://www.netflix.com:80/"},{year:"2003",description:"Netflix continues selling DVD subscriptions, building up their recommendations algorithm over time.",image:"https://i.imgur.com/usqc2ZB.png",link:"https://web.archive.org/web/20031003021435/http://www.netflix.com:80/Default?mqso=60141305"},{year:"2007",description:"Now the world's largest DVD rental company, Netflix launches a streaming service so that members can watch video direclty on their computer or TV.",image:"https://i.imgur.com/fNQbP8g.png",link:"https://web.archive.org/web/20071001023739/http://www.netflix.com:80/"},{year:"2010",description:"The company grows fast and acquires more than 20 million subscribers.",image:"https://i.imgur.com/Ca6sM1p.png",link:"https://web.archive.org/web/20100702101138/https://www.netflix.com/"},{year:"2013",description:'In February, Netflix debuts "House of Cards," an original TV series that earned 8 Emmy nominations.',image:"https://i.imgur.com/hdaURms.png",link:"https://web.archive.org/web/20130303055138/https://signup.netflix.com/#do-login"},{year:"2018",description:"With dozens of original shows and more than 50 Million subscribers, Netflix stock has gone up more than 10x since 2010.",image:"https://i.imgur.com/0FS9hBP.png",link:"https://www.netflix.com"}]}];class tL extends n.exports.Component{constructor(){super(...arguments),t(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/museum-of-websites/${e.id}`)})),t(this,"renderVideoItem",(e=>m.createElement("div",{key:F.v4(),className:"startup-demo-videos-item-container"},m.createElement("div",{className:"evolution-of-products-image-container",onClick:()=>this.playVideo(e)},m.createElement("img",{alt:e.name,src:e.logo,className:"evolution-of-products-image"}),m.createElement("div",{className:"startup-demo-videos-image-play-button"},m.createElement("span",{className:"evolution-of-products-go-button"},"View gallery"),m.createElement("div",{className:"evolution-of-products-overlay"}))),m.createElement("div",{className:"startup-demo-videos-item-metadata"},m.createElement("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),m.createElement("div",{className:"startup-demo-videos-item-name"},e.name),m.createElement("div",{className:"startup-demo-videos-item-date"},e.date),m.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){return m.createElement("div",null,m.createElement("div",{className:"startup-videos-wrapper"},m.createElement(Ce,null,m.createElement("title",null,"Museum of Websites – Kapwing"),m.createElement("meta",{name:"description",content:"Explore this hand-curated gallery featuring the evolution of famous internet companies. See the evolution of Google, Amazon, Pinterest, Reddit, and more!"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/museum-of-websites"})),m.createElement("div",{className:"evolution-of-products-header-container"},m.createElement("div",null,m.createElement("div",{className:"evolution-of-products-header"},"Museum of Websites",m.createElement("img",{src:"https://i.imgur.com/cfD5uhb.png",alt:"Museum of Websites Logo",className:"museum-of-websites-logo"})),m.createElement("div",{className:"evolution-of-products-description"},"A hand-curated gallery of how famous internet companies have changed over time."),m.createElement("div",{className:"startup-demo-videos-share"},m.createElement(Ne,{url:"https://www.kapwing.com/museum-of-websites",quote:"Museum of Websites - Kapwing",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/museum-of-websites",title:"🦖 Museum of Websites - Kapwing",via:"kapwingapp",hashtags:["startups","museum","gallery"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0}))),m.createElement("div",{className:"evolution-of-products-text"},"Curated with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com",className:"evolution-of-products-header-link"},"Kapwing")))),m.createElement("div",{className:"evolution-of-products-background"},m.createElement("div",{className:"startup-demo-videos-list-container"},eL.map((e=>this.renderVideoItem(e))),m.createElement("div",{className:"startup-demo-videos-item-container"},m.createElement("div",{className:"startup-demo-videos-image-container"},m.createElement("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})))),m.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},m.createElement("div",{className:"startup-demo-videos-email-subscribe"},m.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),m.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),m.createElement(ZD,{source:"evolution-of-products"})),m.createElement("div",{className:"startup-demo-videos-footer-text"},"We're adding to the collection on a regular basis! Have a submission for a gallery? Contact us at"," ",m.createElement("a",{href:"mailto:hello@kapwing.com"},"hello@kapwing.com"),"!")))),m.createElement(HC,null))}}const aL=ie(tL);class oL extends n.exports.Component{constructor(e){super(e),t(this,"imgNode",null),this.state={loaded:!1,isLightBoxOpen:!1},this.onImageLoad=this.onImageLoad.bind(this),this.openLightbox=this.openLightbox.bind(this),this.closeLightbox=this.closeLightbox.bind(this)}componentDidMount(){var e;const t=new window.Image;t.onload=this.onImageLoad,t.src=null==(e=this.imgNode)?void 0:e.getAttribute("src")}onImageLoad(){this.imgNode&&this.setState({loaded:!0})}openLightbox(){this.setState({isLightBoxOpen:!0})}closeLightbox(){this.setState({isLightBoxOpen:!1})}render(){const{className:e,lightBoxSrc:t,src:a}=this.props,{loaded:o,isLightBoxOpen:n}=this.state,r=["image"];e&&r.splice(0,0,e),o&&r.push("image-loaded");const i=m.createElement("img",{alt:"Click to expand",ref:e=>{this.imgNode=e},src:a,className:r.join(" "),onClick:this.openLightbox});return m.createElement("div",null,i,m.createElement(je,{images:[{src:t||a}],isOpen:n,onClose:this.closeLightbox,backdropClosesModal:!0,enableKeyboardInpu:!0,showImageCount:!1}))}}class nL extends n.exports.Component{constructor(e){super(e),this.state={currentProduct:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const a=eL.find((t=>t.id===e.params.id));a?this.setState({currentProduct:a}):t.push("/museum-of-websites")}else t.push("/museum-of-websites")}renderTimeline(){const{currentProduct:e}=this.state;return m.createElement("div",{className:"evolution-of-products-item-timeline"},e.states.map((e=>m.createElement("div",{className:"evolution-of-products-item-state",key:e.link},m.createElement("div",{className:"evolution-of-products-item-state-image-container"},m.createElement(oL,{src:e.image,className:"evolution-of-products-item-state-image"})),m.createElement("div",{className:"evolution-of-products-item-state-info"},m.createElement("div",{className:"evolution-of-products-item-state-year"},e.year),e.description&&m.createElement("div",{className:"evolution-of-products-item-state-description"},e.description),e.link&&m.createElement("div",{className:"evolution-of-products-item-state-link-container"},m.createElement("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},"Visit Page")))))))}renderProduct(){const{currentProduct:e}=this.state,{meta:{title:t,description:a}={}}=e,{history:o}=this.props;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,t),m.createElement("meta",{name:"description",content:a}),m.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/museum-of-websites/${e.id}`})),m.createElement("div",{className:"evolution-of-products-item-wrapper"},m.createElement("div",{className:"evolution-of-products-item-header"},m.createElement("div",{className:"evolution-of-products-item-back",onClick:()=>o.push("/museum-of-websites")},"← Back to all companies"),m.createElement("div",{className:"evolution-of-products-item-logo-container"},m.createElement("img",{alt:`${e.name} Logo`,className:"evolution-of-products-item-logo",src:e.image})),m.createElement("div",{className:"evolution-of-products-header"},e.name),m.createElement("div",{className:"evolution-of-products-item-date"},e.date),m.createElement("div",{className:"evolution-of-products-item-description"},e.description)),this.renderTimeline()))}render(){const{currentProduct:e}=this.state;return e?this.renderProduct():null}}const rL=ie(nL),iL="MapContainer-module_spacer_4NUeL",sL="MapContainer-module_footerLink_Hjx3w",lL="MapContainer-module_mapContainer_s-E1u",cL="MapContainer-module_mapTextContainer_rgv2o",dL="MapContainer-module_mapTextHeader_zQJAI",uL="MapContainer-module_mapTextDescription_2BurH",mL="MapContainer-module_mapPreviewImage_czzLc",pL="MapContainer-module_mapPreview_7vsiG",hL=ie((()=>m.createElement("div",{className:lL},m.createElement(Ce,null,m.createElement("title",null,"Sonoma County Fire Satellite Map — Kapwing"),m.createElement("meta",{name:"description",content:"The Sonoma County Fire map allowed residents to see the status of their homes using satellite imagery after the Tubbs fire in November 2017."}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sonoma-county-fire-map"}),m.createElement("meta",{property:"og:title",content:"Sonoma County Fire Satellite Map"}),m.createElement("meta",{property:"og:description",content:"This map compares the before and after of the Sonoma County fire. The imagery was taken on 10/11/2017 and is courtesy of Digital Globe."}),m.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),m.createElement("meta",{property:"og:image:url",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),m.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sonoma-county-fire-map"})),m.createElement("div",{className:cL},m.createElement("div",{className:dL},"Sonoma County Fire Map"),m.createElement("div",{className:uL},m.createElement("p",null,"The Sonoma County Fire Map was a project created by Eric Lu after the Tubbs Fire in November 2017. The map allowed residents to see the status of their homes after the fires using satellite imagery, before the roads reopened."),m.createElement("p",null,"Eric, a long time Santa Rosa resident, created the map to help other residents see their homes."),m.createElement("p",null,"The map was featured in various news outlets including the"," ",m.createElement("a",{href:"https://www.mercurynews.com/2017/10/13/before-and-after-the-fire-satellite-photos-of-santa-rosa-neighborhoods/"},"Mercury Times"),", the"," ",m.createElement("a",{href:"https://www.huffingtonpost.com/entry/santa-rosa-fire-3-angelsnot-in-disguise_us_59e65b00e4b0e60c4aa365d2"},"Huffington Post"),", and"," ",m.createElement("a",{href:"https://www.kqed.org/news/11623382/map-santa-rosa-residents-see-your-home-after-the-fires"},"KQED"),".")),m.createElement("div",{className:iL}),m.createElement("div",{className:pL},m.createElement("img",{src:"https://i.imgur.com/zZELAYl.png",alt:"Map Preview",className:mL})),m.createElement("div",{className:pL},m.createElement("img",{src:"https://i.imgur.com/hfOM9Le.png",alt:"Map Preview",className:mL})),m.createElement("div",{className:iL}),m.createElement("div",{className:uL},m.createElement("p",null,"My heart goes out to those families who lost loved ones in the fire, and prayers for all others who were devastatingly affected."),m.createElement("p",null,"I am thankful for our local firefighters for risking their lives to save lives and property that night. I am so grateful for many other community members who worked tirelessly to help affected residents get back on their feet."),m.createElement("p",null,"Thanks for visiting the Sonoma County Fire Map and have a nice day."),m.createElement("div",{className:sL},m.createElement("a",{href:"/"},"← Return to Kapwing.com"))))))),gL=[{title:"This Page is Lost in Space",url:"https://i.imgur.com/A040Lxr.png",description:"You thought this mission to the moon would be a quick six month thing. Your neighbor offered to look after your dog. Your high school math teacher was impressed. He once said you wouldn’t amount to anything.You sure showed him. But now here you are, fifty feet from your spaceship with no way to get back. Your dog will be so sad. Your math teacher will be so smug. Pretty devastating.",containerStyles:{backgroundColor:"#83D9C8",color:"#5C77AC"}},{title:"This Page is Lost in the Wind",url:"https://i.imgur.com/oCkEbrA.png",description:"The child had looked so excited when the clown had presented a large red balloon. You had seen this, but in the throes of your morning commute you didn’t register it until it was too late. Who asked the government to support a fair right through Main Street during a week day anyway? Your bike barrelled right between the child and the clown and sent the balloon on its merry way. You didn’t turn back to see the damage you had done. Later you saw the balloon floating outside your office window.",containerStyles:{backgroundColor:"#D5E9F6",color:"#4E43FA"}},{title:"This Page is Buried in the Sand",url:"https://i.imgur.com/FOeYt4E.png",description:"You have never seen an ostrich head. Whenever you’re around it seems ostriches are avoiding your gaze. You came on this trip specifically to see an ostrich head, but here is this ostrich right in front of you, head invisible. You may never see an ostrich head.",containerStyles:{backgroundColor:"#EFEDFA",color:"#9F6C66"}},{title:"This Page is Broken",url:"https://i.imgur.com/g3hgqe8.png",description:"A broken clock is right twice a day. But if you just have one clock, it’s impossible to tell exactly when the clock is right. So it could be right at any moment. And that brings you to the crux of the conceptualization. What is time? Nothing but an abyss. Clocks are just false attempts to harness its power. It’s cruel really.",containerStyles:{backgroundColor:"#FFE4EA",color:"#709BFA"}},{title:"Caution! This Page is Cordoned Off",url:"https://i.imgur.com/qIufhof.png",description:"The earthquake was not good to the bike lane on your way to work. A large gap in the pavement (too big to be called a pothole) had swallowed three oblivious bikers whole. So the city had put up two pylons and yellow caution tape. Pretty frustrating for you given your propensity to do 360 jumps over the gap.",containerStyles:{backgroundColor:"#83D9C8",color:"#965418"}},{title:"This Page is Broken",url:"https://i.imgur.com/yW2W9SC.png",description:"This mug was a family heirloom. Of your neighbor. Your neighbor always loved the color, shape, and quantity of coffee held by this mug. But your neighbor moved out and left it on their porch, no explanation, no repair materials, no nothing. So you have this broken mug.",containerStyles:{backgroundColor:"#D5E9F6",color:"#2F8E89"}},{title:"This Page is Burnt to a Crisp",url:"https://i.imgur.com/WvEu0cO.png",description:"Toast takes so long to make. You stare at the toaster tapping your feet. Your laundry is in the dryer and it just dinged. Maybe you’ll take it out. After all, you have time. You take out your laundry. You fold your underwear. You think about folding your socks. You remember your toast! It is too late. It’s burnt to a crisp. The process repeats itself. You should probably figure out your toasting settings.",containerStyles:{backgroundColor:"#FFF4BB",color:"#4376C0"}},{title:"A Dog Ate this Page",url:"https://i.imgur.com/lKJiT77.png",description:"Your dog is cute but honestly a menace. Where are my shoes? Where is my graduation certificate? Where is the chocolate cake I baked for my Aunt’s birthday? And why did you take your dog to the vet on that same Thursday?!",containerStyles:{backgroundColor:"#FFE4EA",color:"#824B2"}},{title:"Don’t Cry Over Spilled Page",url:"https://i.imgur.com/oEUksmz.png",description:"Gulp. You hold back tears as the white liquid spreads across the floor from your sad looking carton. You should have bought the chocolate milk, it was clearly the better choice. And then maybe you wouldn’t have so carelessly smacked it across the room when you emphatically pointed at a bird outside. Too late now. You wipe the single tear from your eye and go fetch the mop.",containerStyles:{backgroundColor:"#FFE4EA",color:"#673164"}},{title:"Oh no! We tripped up!",url:"https://i.imgur.com/3suxlvm.png",description:"You had been told you should always check your shoes before getting up from the bleachers. Freshman were known to walk under them and tie peoples’ shoes together.",containerStyles:{backgroundColor:"#FFF4BB",color:"#180AD8"}},{title:"This Page is Wrong",url:"https://i.imgur.com/DWO5Hzg.png",description:"You have been trying for ten minutes. It’s pretty late at night and pretty dark in your room. You reach over and flick on a lamp. You feel oh so stupid. The gap in the toy is a triangle and you only have the cylinder and cube pieces. In dismay you toss the toy aside. Curse your five year old’s inability to keep track of the triangle!",containerStyles:{backgroundColor:"#D5E9F6",color:"#DF245D"}},{title:"This Page is Not on the Map",url:"https://i.imgur.com/Q2BAOd2.png",description:"You told your friends you weren’t bringing your phone, to try and experience what travel was like back in the day. You bought a map and a bottle of water and carried your camera for the money shot. But the map was from 2005 and the landscape had changed. So here you are, in the middle of a large field, that the map continues to claim is a local grocer.",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"There’s a Leak in the Website",url:"https://i.imgur.com/U3vTGjX.png",description:"The boat had looked good to the naked eye. But you wear a very strong prescription and should have been wearing glasses. As you cling on to the bouey the coast guard had thrown at you, you watch the water rush into you beloved dingy. The leak sprays water higher and higher. Then the boat was swallowed and sunk into the abyss.",containerStyles:{backgroundColor:"#EFEDFA",color:"#684CFF"}},{title:"This Page is a Ghost",url:"https://i.imgur.com/QIxIKBH.png",description:"Once alive and now dead, this ghost appears to have some unfinished business. Could it be with you? Or the treasure hidden under the floorboards of the old mansion in the hills that may never reach its rightful owner, a compassionate school teacher in Brooklyn.",containerStyles:{backgroundColor:"#D5E9F6",color:"#5F749C"}},{title:"This Page Contains Nothing but Scraps",url:"https://i.imgur.com/kZNTPqI.png",description:"A perfectly enticing pizza box sitting on a table. You open it filled with anticipation. And find… nothing but scraps. Perhaps a half eaten crust. And a lot of grease. The anticipation turns to deep disappointment and despair. There’s nothing left!",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"This Page is Lost",url:"https://i.imgur.com/flHudHE.png",description:"You bought a little bracelet for the express purpose of not losing your keys. You put a hook on your door specifically meant for keeping your keys. You briefly attempted to attach your keys to your phone. But here they are. In the dirt. In the park across the street from that bar you used to like but decided the last time you went that you probably wouldn’t go again. You’ll never find them.",containerStyles:{backgroundColor:"#FFF4BB",color:"#226FAB"}},{title:"This Page is in the Garbage",url:"https://i.imgur.com/Oqnene0.png",description:"When the king of racoons approached you during the fall of 2005, you were taken aback by the generosity of the offer he made and also his ability to talk. You’ve been living in harmony ever since. They pay 50% of your rent and you “forget” to take out the garbage every other week.",containerStyles:{backgroundColor:"#FFE4EA",color:"#4C76EC"}},{title:"This Page is Not Real",url:"https://i.imgur.com/hkRuanu.png",description:"The imposing figure with the trenchcoat shows you the two polaroids. One appears to show the Loch Ness monster herself in the middle of a stretch of dark water. The other shows a sasquatch picking it’s way through a dark forest. You look closer. The animal shapes are drawn on with ink. “This isn’t real!” You scream and throw the polaroids to the floor, sobbing.",containerStyles:{backgroundColor:"#EFEDFA",color:"#092048"}},{title:"This Page is Melted in the Sun",url:"https://i.imgur.com/O0DCcQy.png",description:"People questioned your desire to get strawberry. “That’s the worst flavor,” they said. But you are strong and independent so you got it anyway. And honestly, it wasn’t great. Luckily, two licks in a bike whizzed past you and knocked the cone out of your hand. “Oh no!” you yelled as the creamy pink became a mess in the dirt. But really you were happy.",containerStyles:{backgroundColor:"#FFF4BB",color:"#E896ED"}},{title:"More illustrations to come",url:"https://i.imgur.com/iRjGBZj.png",description:"We're working hard to put out new illustrations for your lost URLs. There will be many more stories and trendy images to come in the future. Stay tuned for new 404 illustrations!",containerStyles:{backgroundColor:"white",color:"black"}}],fL="FourOFour-module_container_0yyqP",yL="FourOFour-module_headerContainer_trv8C",EL="FourOFour-module_headerText_iaNQl",_L="FourOFour-module_headerH1_zUrvB",vL="FourOFour-module_headerH2_g-T7o",wL="FourOFour-module_downloadAllButton_z9qN3",bL="FourOFour-module_headerImageContainer_hNc6c",SL="FourOFour-module_headerImage_uYdq3",TL="FourOFour-module_headerFooter_yvR9K",IL="FourOFour-module_shareButton_h-oGz",kL="FourOFour-module_headerFooterText_9XanJ",CL="FourOFour-module_illustrationWrapper_lyyun",NL="FourOFour-module_illustrationRow_ZBtsm",AL="FourOFour-module_illustrationContainer_8bYmu",xL="FourOFour-module_illustrationHeader_U8Flw",PL="FourOFour-module_illustrationDescription_SngMr",RL="FourOFour-module_illustration_DfJFt",OL="FourOFour-module_illustrationImage_VkzOT",DL="FourOFour-module_illustrationDownloadButton_M2z5D",LL="FourOFour-module_emailWrapper_Bh6j6";class UL extends n.exports.Component{renderImage(e){return m.createElement("div",{className:AL,style:e.containerStyles},m.createElement("a",{href:e.url,className:DL,target:"_blank",rel:"noopener noreferrer"},"View full image"),m.createElement("div",{className:RL},m.createElement("img",{src:e.url,alt:e.title,className:OL})),m.createElement("div",{className:xL},e.title),m.createElement("div",{className:PL},e.description))}render(){const e=[];for(let t=0;t<gL.length;t+=2)e.push(m.createElement(m.Fragment,{key:t},this.renderImage(gL[t]),this.renderImage(gL[t+1])));return m.createElement("div",{className:fL},m.createElement(Ce,null,m.createElement("title",null,"404 Illustrations – Trendy 404 Images – Kapwing"),m.createElement("meta",{name:"description",content:"Explore this collection of free trendy illustrations to make an eye-catching 404 error page on your website. Many more 404 error illustrations to come!"}),m.createElement("meta",{name:"keywords",content:"404 illustrations"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/404-illustrations"}),m.createElement("meta",{property:"og:title",content:"404 Illustrations - Trendy 404 page images for your next project"}),m.createElement("meta",{property:"og:description",content:"This website is a hand-crafted collection of illustrations that you can use for your website's 404 (Not Found) page. Your URL might not be found, but your user can still have a delightful experience. Many more illustrations to come!"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/2HLc0dN.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/404-illustrations"})),m.createElement("div",{className:yL},m.createElement("div",{className:EL},m.createElement("div",{className:_L},"404 Illustrations"),m.createElement("div",{className:vL},"Trendy, ready to use images for your 404 page"),m.createElement("a",{href:"https://drive.google.com/drive/folders/1yFKI9f9-R_WUhAMZnrxzATPHKaOVdCkl?usp=sharing",target:"_blank",rel:"noopener noreferrer"},m.createElement("div",{className:wL},"Download All")),m.createElement("div",{className:TL},m.createElement("div",null,m.createElement(Ne,{url:"https://www.kapwing.com/404-illustrations",quote:"404 Illustrations - trendy, ready to use images for your 404 page",className:IL},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/404-illustrations",title:"404 Illustrations - trendy, ready to use images for your 404 page",hashtags:["404","illustrations"],className:IL},m.createElement(Pe,{size:40,round:!0}))),m.createElement("div",{className:kL},"Curated with love by the team at Kapwing"))),m.createElement("div",{className:bL},m.createElement("img",{src:"https://i.imgur.com/QUC2CyX.png",alt:"Ice Cream Cone Melting",className:SL}))),m.createElement("div",{className:CL},e.map(((e,t)=>m.createElement("div",{className:NL,key:t},e)))),m.createElement("div",{className:LL},m.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},m.createElement("div",{className:"startup-demo-videos-email-subscribe"},m.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),m.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),m.createElement(ZD,{source:"404-illustrations"})))),m.createElement(HC,null))}}const ML=ie(UL);var FL=(e=>(e.videoOptimizationMessage="videoOptimizationMessage",e.safariVolumeMessage="safariVolumeMessage",e))(FL||{});const BL={[FL.videoOptimizationMessage]:()=>m.createElement(m.Fragment,null,"Video looking fuzzy? Kapwing converts to a lower resolution for quicker editing and playback."," ",m.createElement("b",null,m.createElement("br",null),"Don't worry, the video's original resolution will be used on Export.")," "),[FL.safariVolumeMessage]:()=>m.createElement(m.Fragment,null,"Audio playback is currently limited to 100% volume on Safari. Any layer with volume greater than 100% will preview at 100% before Export",m.createElement("b",null," but will be Exported with the correct volume levels. "),"We recommend using Kapwing on Chrome for the best editing experience.")},WL="InfoToast-module_infoMessage_-gwSW",VL="InfoToast-module_infoSnackbar_O3abO",jL="InfoToast-module_blue_-f31K",HL="InfoToast-module_yellow_-LNAd",GL="InfoToast-module_infoLeftContent_-uGyV",$L="InfoToast-module_infoIconContainer_0QRbC",KL="InfoToast-module_infoIcon_x87AX",YL="InfoToast-module_infoCloseButtonContainer_9-Rhv",zL="InfoToast-module_infoCloseButton_e0uHY",qL="InfoToast-module_buttonBlue_ah-El",JL="InfoToast-module_buttonYellow_foUkp",XL=()=>{const e=i.exports.useDispatch(),{showInfo:t,infoMessageName:a,theme:o}=cn((e=>({showInfo:e.toasts.showInfo,infoMessageName:e.toasts.infoMessageName,theme:e.toasts.theme})),dn),n=ed();if(!t)return null;if(void 0===a||!(a in BL))return null;if(n&&a===FL.videoOptimizationMessage)return null;const r=BL[a];return m.createElement("div",{className:(()=>{let e="";return"blue"===o&&(e=jL),"yellow"===o&&(e=HL),`${VL} ${e}`})()},m.createElement("div",{className:GL},m.createElement("div",{className:$L},m.createElement(He,{className:KL})),m.createElement("div",{className:WL},"function"==typeof r?r():m.createElement(r.Component,null))),("function"==typeof r||r.showHideButton)&&m.createElement("div",{className:YL},m.createElement("span",{className:(()=>{let e=" ";return"blue"===o&&(e=qL),"yellow"===o&&(e=JL),`${zL} ${e}`})(),onClick:()=>{e({type:"HIDE_INFO"}),e(cl(!0))}},"Got it")))};function QL(e,t,a,o,n,r,i,s){let l=a,c=o,d=r,u=n;2===arguments.length&&(l=0,c=0,d=e.canvas.height,u=e.canvas.width);let m="number"==typeof i?i:.5,p="number"==typeof s?s:.5;m<0&&(m=0),p<0&&(p=0),m>1&&(m=1),p>1&&(p=1);const h=t.width,g=t.height,f=Math.min(u/h,d/g);let y,E,_,v,w=h*f,b=g*f,S=1;w<u&&(S=u/w),Math.abs(S-1)<1e-14&&b<d&&(S=d/b),w*=S,b*=S,_=h/(w/u),v=g/(b/d),y=(h-_)*m,E=(g-v)*p,y<0&&(y=0),E<0&&(E=0),_>h&&(_=h),v>g&&(v=g),e.drawImage(t,y,E,_,v,l,c,u,d)}function ZL(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}const eU=se((async()=>(await Eb((()=>import("./index.ba20f2f0.js").then((e=>e.i))),["assets/index.ba20f2f0.js","assets/vendor.6b80416b.js","assets/throttle.f4b43e6e.js"])).TwitterPicker));class tU extends n.exports.Component{constructor(e){super(e),t(this,"handleBackgroundColorChange",(e=>{this.setState({canvasBackground:e.hex},(()=>{this.drawMockup()}))})),t(this,"handlePhoneColorChange",(e=>{this.setState({phoneColor:e.hex},(()=>{this.drawMockup()}))})),t(this,"changeImageFit",(e=>{this.setState({imageFit:e},(()=>{this.drawMockup()}))})),t(this,"downloadImage",(()=>{const{mostRecentImage:e}=this.state,t=function(e){const t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),n=new Uint8Array(o);for(let r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return new Blob([o],{type:a})}(e);Ge.saveAs(t,`mobile-mockup-${Date.now()}.png`)})),t(this,"drawMockup",(()=>{const{img:e,imageFit:t,phoneColor:a,canvasBackground:o}=this.state,n=document.getElementById("mobile-mockup-canvas"),r=n.getContext("2d");r.clearRect(0,0,n.width,n.height),n.width=1024,n.height=1024,r.fillStyle=o||"rgba(1,22,39,.08)",r.fillRect(0,0,n.width,n.height);const i=n.width/2-200,s=n.height/2-414;r.fillStyle=a||"#001323",r.strokeStyle=a||"#001323",r.shadowColor=function(e){const t=ZL(e);if(!t)return"rgba(5,23,39,.5)";const{r:a,g:o,b:n}=t,r=[a,o,n];return Math.round((299*r[0]+587*r[1]+114*r[2])/1e3)>125?"rgba(5,23,39,.5)":"rgba(255, 255, 255,.7)"}(o),r.shadowBlur=100,r.shadowOffsetX=0,r.shadowOffsetY=0,function(e,t,a,o,n,r,i,s){const l={tl:0,tr:0,br:0,bl:0};"number"==typeof r?(l.br=r,l.bl=r,l.tl=r,l.tr=r):Object.assign(l,r),e.beginPath(),e.moveTo(t+l.tl,a),e.lineTo(t+o-l.tr,a),e.quadraticCurveTo(t+o,a,t+o,a+l.tr),e.lineTo(t+o,a+n-l.br),e.quadraticCurveTo(t+o,a+n,t+o-l.br,a+n),e.lineTo(t+l.bl,a+n),e.quadraticCurveTo(t,a+n,t,a+n-l.bl),e.lineTo(t,a+l.tl),e.quadraticCurveTo(t,a,t+l.tl,a),e.closePath(),i&&e.fill(),(s||null==s)&&e.stroke()}(r,i,s,400,828,60,!0,!0);const l=i+20,c=s+80,d=360,u=668;console.debug(d,u),r.shadowColor="transparent",r.shadowBlur=0,r.beginPath(),r.lineWidth="1",r.strokeStyle="#888",r.rect(l,c,d,u),r.stroke(),r.fillStyle="#ddd",r.fillRect(l,c,d,u),e&&("crop"===t?QL(r,e,l,c,d,u):"fit"===t?function(e,t,a,o,n,r){const i=n/t.width,s=r/t.height,l=Math.min(i,s),c=(n-t.width*l)/2,d=(r-t.height*l)/2;n>=r?e.drawImage(t,0,0,t.width,t.height,a-c,o+d,t.width*l,t.height*l):e.drawImage(t,0,0,t.width,t.height,a+c,o+d,t.width*l,t.height*l)}(r,e,l,c,d,u):"stretch"===t?r.drawImage(e,0,0,e.width,e.height,l,c,d,u):QL(r,e,l,c,d,u));const m=n.toDataURL("image/png");this.setState({mostRecentImage:m})})),t(this,"stopUpload",(()=>{this.setState({loading:!1})})),t(this,"handleFileUpload",(e=>{const{showError:t}=this.props;this.setState({loading:!0});const a=e.target.files[0];if(!a)return void t("Please choose a file to upload.");if(a.type)if(["image/gif","image/jpg","image/jpeg","image/png"].includes(a.type))if(a.size>8e7)t("Your content must be under 80MB"),this.stopUpload();else{const e=new FileReader;e.onload=e=>{const t=new Image;t.onload=()=>{this.setState({img:t}),this.drawMockup(),this.stopUpload()},t.src=e.target.result},e.readAsDataURL(a)}else t("You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats."),this.stopUpload();else t("Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension."),this.stopUpload()})),this.state={loading:!1,img:void 0,imageFit:"crop",phoneColor:"#001323",canvasBackground:"#FFFFFF"}}componentDidMount(){this.drawMockup()}render(){const{loading:e,mostRecentImage:t,canvasBackground:a,phoneColor:o,imageFit:n}=this.state,r=function(e){const t=ZL(e);if(!t)return"#242F40";const{r:a,g:o,b:n}=t,r=[a,o,n];return Math.round((299*r[0]+587*r[1]+114*r[2])/1e3)>125?"#242F40":"#EBECED"}(a);return m.createElement(m.Fragment,null,m.createElement("div",{className:"startup-videos-wrapper"},m.createElement(Ce,null,m.createElement("title",null,"Mobile Mockup Generator – Kapwing"),m.createElement("meta",{name:"description",content:"Create a beautiful mobile mockup with a custom color, screenshot, and background color in just a few clicks. After customizing, save the final mockup."}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/mobile-mockup"}),m.createElement("meta",{property:"og:title",content:"Mobile Mockup - Kapwing"}),m.createElement("meta",{property:"og:description",content:"The simplest way to create a beautiful mobile mockup. In just three clicks, choose a screenshot and download your mockup!"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/6SDNZse.png"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/6SDNZse.png"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/6SDNZse.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/mobile-mockup"})),m.createElement("div",{className:"mobile-mockup-editor-container",style:{background:a}},m.createElement("div",{className:"mobile-mockup-left"},m.createElement("div",{className:"mobile-mockup-left-content"},m.createElement("div",{className:"mobile-mockup-header",style:{color:r}},"Mobile Mockup"),m.createElement("div",{className:"mobile-mockup-description",style:{color:r}},"The simplest way to create a beautiful mobile mockup"),e?m.createElement("div",{className:"mobile-mockup-upload-button-container"},m.createElement("div",{className:"loader upload-loader"})):m.createElement("div",{className:"mobile-mockup-upload-button-container"},m.createElement("label",{htmlFor:"mobile-mockup-uploader-input"},m.createElement("div",{className:"mobile-mockup-upload-button"},m.createElement("div",{className:"mobile-mockup-download-button-header"},"Choose screenshot")),m.createElement("input",{id:"mobile-mockup-uploader-input",accept:"image/jpg,image/png,image/jpeg",onChange:this.handleFileUpload,type:"file"}))),m.createElement("div",{className:"mobile-mockup-controls-container"},["crop","fit","stretch"].map((e=>{let t="mobile-mockup-position-selector";return e===n&&(t+=" mobile-mockup-position-selector-selected"),m.createElement("div",{key:F.v4(),className:t,onClick:()=>this.changeImageFit(e)},e)}))),m.createElement(eU,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handleBackgroundColorChange,color:a,colors:["#EB144C","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#FFFFFF","#000000","#c9ba93"]}),m.createElement(eU,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handlePhoneColorChange,color:o,colors:["#001323","#FFFFFF","#c9ba93"]}),m.createElement("div",{className:"mobile-mockup-download-button-container"},m.createElement("div",{className:"mobile-mockup-download-button"},m.createElement("div",{className:"mobile-mockup-download-button-header",onClick:this.downloadImage},"Download mockup"))))),m.createElement("div",{className:"mobile-mockup-right"},m.createElement("div",{className:"mobile-mockup-canvas-container"},m.createElement("canvas",{id:"mobile-mockup-canvas"}),t?m.createElement("img",{src:t,className:"mobile-mockup-most-recent-image",alt:"Generated Mobile Screenshot"}):m.createElement("div",{className:"loader upload-loader"})))),m.createElement("div",{className:"mobile-mockup-sample-container"},m.createElement("img",{src:"https://i.imgur.com/Z15LwSm.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),m.createElement("img",{src:"https://i.imgur.com/eADTxZ4.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),m.createElement("img",{src:"https://i.imgur.com/LQoQlnI.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),m.createElement("img",{src:"https://i.imgur.com/c364bfG.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"})),m.createElement("div",{className:"mobile-mockup-demo-container"},m.createElement("div",{className:"mobile-mockup-demo-header"},"How it works"),m.createElement("div",{className:"mobile-mockup-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/dKGqVMt.jpg",alt:"Choose a screenshot to use",className:"mobile-mockup-demo-image"})),m.createElement("div",{className:"mobile-mockup-demo-right"},m.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 1"),m.createElement("div",{className:"mobile-mockup-demo-step-description"},"Choose a screenshot to use as your mockup. The most ideal size is 360x668, but any image will work!"))),m.createElement("div",{className:"mobile-mockup-demo-container"},m.createElement("div",{className:"mobile-mockup-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/sxxfufO.jpg",alt:"Choose a background color",className:"mobile-mockup-demo-image"})),m.createElement("div",{className:"mobile-mockup-demo-right"},m.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 2"),m.createElement("div",{className:"mobile-mockup-demo-step-description"},"Select the color of the background and the phone frame, in order to customize your mockup. You can also enter a custom color!"))),m.createElement("div",{className:"mobile-mockup-demo-container"},m.createElement("div",{className:"mobile-mockup-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/vcit8Ji.png",alt:"Download your final mockup!",className:"mobile-mockup-demo-image"})),m.createElement("div",{className:"mobile-mockup-demo-right"},m.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 3"),m.createElement("div",{className:"mobile-mockup-demo-step-description"},'Your mockup will be generated in real time. You can either right click the phone and save as, or you can click "Download" to save the final mockup!')))),m.createElement("div",{className:XD.spacer}),m.createElement("div",{className:XD.spacer}),m.createElement("div",{className:XD.spacer}),m.createElement("div",{className:XD.spacer}),m.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},m.createElement("div",{className:"startup-demo-videos-email-subscribe"},m.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),m.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),m.createElement(ZD,{source:"mobile-mockup"}))),m.createElement("div",{className:"mobile-mockup-share"},m.createElement(Ne,{url:"https://www.kapwing.com/mobile-mockup",quote:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/mobile-mockup",title:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",via:"kapwingapp",hashtags:["mockup","design"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0})),m.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),m.createElement(HC,null))}}const aU=ie(i.exports.connect(void 0,(e=>he({showError:wh},e)))(tU)),oU="OverlayWrapper-module_overlayBackground_-tLeA",nU="OverlayWrapper-module_overlayContainer_695xA",rU="OverlayWrapper-module_exit_chpXg",iU="OverlayWrapper-module_overlayContent_520T1";class sU extends n.exports.Component{render(){return m.createElement("div",null,m.createElement("div",{className:oU,onClick:()=>{this.props.history.goBack()},"data-cy":"overlay-background"}),m.createElement("div",{className:nU},m.createElement("div",{className:rU,onClick:()=>{this.props.history.goBack()}},m.createElement(Ee,null)),m.createElement("div",{className:iU},this.props.children)))}}const lU=ie(sU),cU="CreateOverlay-module_header_olnUM",dU="CreateOverlay-module_description_cHmlQ",uU=ie((()=>m.createElement(lU,null,m.createElement("div",{className:cU},"Create MOTION"),m.createElement("p",{className:dU},"Sadly, creating a custom Motion is no longer available as of Feb 2020. Motion was a project launched in 2019 with the goal of making geometric animations from still images. You can see examples of the animations created on the ",m.createElement(_e,{to:"/motion"},"Motion homepage")," as well as on the"," ",m.createElement("a",{href:"https://www.producthunt.com/posts/motion",target:"_blank",rel:"noopener noreferrer"},"Product Hunt launch"),"."),m.createElement("p",{className:dU},"We're happy to have brought joyful Motions to thousands of visitors over the years. Thanks for visiting our site!"),m.createElement("p",{className:dU},m.createElement("a",{href:"/"},"Visit Kapwing.com →"))))),mU=ie((()=>m.createElement($e,null,m.createElement(Ke,{path:"/motion/create",component:uU})))),pU="Gallery-module_container_DvCaF",hU="Gallery-module_header_0bS-A",gU="Gallery-module_gallery_NWA9Q",fU="Gallery-module_previewContainer_V10gW",yU="Gallery-module_sourceContainer_wDBk-",EU="Gallery-module_outputContainer_Bss-j",_U="Gallery-module_sourceImage_J-uY0",vU="Gallery-module_outputImage_RuZBo",wU=[{sourceUrl:"https://i.imgur.com/4FA6dDr.jpg",outputUrl:"https://i.imgur.com/5nBce1A.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_409RSJ.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1af2514fc10e43a2d25fcb.gif"},{sourceUrl:"https://i.imgur.com/rHFKIj4.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1afa39c6ae472dfe9db7.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_OMGSU0.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1ae61da0208b3eee521d0d.gif"},{sourceUrl:"https://i.imgur.com/G0Ntbe7.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1bd3cab1a1474b9fdfc5.gif"}],bU=ie((()=>m.createElement("div",{className:pU},m.createElement("div",{className:hU},"Or, browse the gallery:"),m.createElement("div",{className:gU},wU.map((e=>m.createElement("div",{key:e.sourceUrl,className:fU},m.createElement("div",{className:yU},m.createElement(oL,{src:e.sourceUrl,className:_U,alt:"Source Input"})),m.createElement("div",{className:EU},m.createElement(oL,{src:e.outputUrl,className:vU,alt:"Ouput"}))))))))),SU="Motion-module_spacer_F62TB",TU="Motion-module_aboutSection_ypDHd",IU="Motion-module_header_y0sAj",kU="Motion-module_section_Xd66Q",CU="Motion-module_aboutHeader_9dwPo",NU="Motion-module_aboutSubheader_tMYQE",AU="Motion-module_aboutP_kYZls",xU="Motion-module_wrapper_YCnsy",PU="Motion-module_headerLeft_KYpQR",RU="Motion-module_headerRight_2oVEu",OU="Motion-module_headerLogoText_gX3Z7",DU="Motion-module_headerButton_MxGnJ",LU="Motion-module_heroContainer_KIWOp",UU="Motion-module_heroText_BGpAs",MU="Motion-module_heroDescription_8OqNL",FU="Motion-module_heroAction_8Qla-",BU="Motion-module_footerButton_hRgDY",WU=ie((()=>m.createElement("div",null,m.createElement(Ce,null,m.createElement("title",null,"Motion – Create Geometric Animations – Kapwing"),m.createElement("meta",{name:"description",content:"Motion – Create Geometric Animations – Kapwing"}),m.createElement("meta",{name:"keywords",content:"watermark photo, watermark video online, add watermark, brand video, add image to video, add text to video"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/motion"}),m.createElement("meta",{property:"og:title",content:"Motion - Create Geometric Animations"}),m.createElement("meta",{property:"og:description",content:"Create stunning geometric GIFs and images from a still image. Using machine learning, this tool with recreate images with geometric shapes for a vector image effect."}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/Fxt1FYb.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/motion"})),m.createElement("div",{className:xU},m.createElement("div",{className:IU},m.createElement("div",{className:PU},m.createElement("div",{className:OU},"MOTION")),m.createElement("div",{className:RU},m.createElement(_e,{to:"/motion/create"},m.createElement("div",{className:DU},"CREATE")))),m.createElement("div",{className:LU},m.createElement("h1",{className:UU},"Create Geometric Animations"),m.createElement("h2",{className:MU},m.createElement("b",null,"Motion")," uses machine learning to create stunning GIFs using geometric shapes. Get started below or see the"," ",m.createElement("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer"},"code on Github"),"."),m.createElement("div",{className:FU},m.createElement(_e,{to:"/motion/create"},m.createElement("div",{className:BU},"Get Started")))),m.createElement(bU,null),m.createElement("div",{className:`${kU} ${TU}`},m.createElement("h3",{className:CU},"More about ",m.createElement("b",null,"Motion")),m.createElement("div",{className:NU},"Create beautiful geometric animations from your images"),m.createElement("div",{className:AU},m.createElement("b",null,"MOTION")," is an exploration of geometry, video, and machine learning. By using ML techniques, the tool generates shapes to fit the lines and colors of your image."),m.createElement("div",{className:AU},"We wanted to create a tool that could make short looping videos from still images, and the abstract effect created by geomatric shapes has always been a source of inspiration. With a unique hill-climbing algorithm, we were able to convert still photographs into beautiful, moving GIFs."),m.createElement("div",{className:AU},m.createElement("b",null,"About the options:")," Choose from a variety of shapes to create different outputs from a single image. Because there is a component of randomness, each output will be unique."),m.createElement("div",{className:AU},"The project was inspired by"," ",m.createElement("a",{href:"https://primitive.lol/",target:"_blank",rel:"noopener noreferrer"},"Primitive")," ","as well as"," ",m.createElement("a",{href:"https://github.com/Tw1ddle/geometrize",target:"_blank",rel:"noopener noreferrer"},"Geometrize"),". The stitching of frames into GIFs is made possible by"," ",m.createElement("a",{href:"https://www.ffmpeg.org/",target:"_blank",rel:"noopener noreferrer"},"FFMPEG")," ","and"," ",m.createElement("a",{href:"https://www.imagemagick.org/script/index.php",target:"_blank",rel:"noopener noreferrer"},"ImageMagick"),". For the full repo, check out the"," ",m.createElement("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer"},"code on Github"),"."))),m.createElement("div",{className:LU},m.createElement("div",{className:FU},m.createElement(_e,{to:"/motion/create"},m.createElement("div",{className:BU},"Create MOTION")))),m.createElement("div",{className:SU}),m.createElement("div",{className:SU}),m.createElement("div",{className:"share-footer"},m.createElement(Ne,{url:"https://www.kapwing.com/motion",quote:"Motion - turn your photo into a geometric GIF, powered by machine learning.",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/motion",title:"Motion - turn your photo into a geometric GIF, powered by machine learning",via:"kapwingapp",hashtags:["motion","gif"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0})),m.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),m.createElement(mU,null),m.createElement(HC,null)))),VU=()=>{const e=i.exports.useDispatch(),t=Fe();return n.exports.useEffect((()=>{!async function(){const a=Ob.get("GOOGLE_ONE_TAP_RESPONSE",{disabled:""})||"";a?(Ob.remove("GOOGLE_ONE_TAP_RESPONSE"),await e(Vm(a,!0)).catch((t=>{((t,a="signIn",o="Sign In")=>{let n=t;t||(n="An error occurred during sign in with One Tap. Please try again later."),fm("Sign In Error Occurred",{"Error Type":a,Details:o,"One-Tap":!0}),e(wh(n))})(t.message,"fetchGoogleUser")})),t.push("/")):t.push("/signin")}()}),[e,t]),m.createElement(ik,null)},jU="NewTabStretches-module_container_kt8At",HU="NewTabStretches-module_content_89ftM",GU="NewTabStretches-module_header_ERNeR",$U="NewTabStretches-module_icon_Ru5CL",KU="NewTabStretches-module_share_1gUqo",YU="NewTabStretches-module_shareButton_jErDV",zU="NewTabStretches-module_title_AynMX",qU="NewTabStretches-module_subtitle_6sxPV",JU="NewTabStretches-module_video_xprXb",XU="NewTabStretches-module_downloadButton_pva4g",QU="NewTabStretches-module_buttonLabel_HlqCe",ZU="NewTabStretches-module_buttonChromeLogo_m76Jy",eM="NewTabStretches-module_body_ncn9O",tM="NewTabStretches-module_explainer_r8Rbh",aM="NewTabStretches-module_photo_tqx23",oM="NewTabStretches-module_coverImage_pGyim",nM=()=>m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"New Tab Stretches - Chrome Extension – Kapwing"),m.createElement("meta",{name:"description",content:"Use the New Tab Stretches Chrome extension to improve your flexibility while working from home. Start getting reminders to stretch right after installing!"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/new-tab-stretches"}),m.createElement("meta",{property:"og:title",content:"New Tab Stretches — Kapwing"}),m.createElement("meta",{property:"og:description",content:"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk. Just follow the graphic and the on screen instructions and start stretching more throughout the day!"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/BQ0WNy7.png"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/BQ0WNy7.png"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/BQ0WNy7.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/new-tab-stretches"})),m.createElement("div",{className:jU},m.createElement("header",{className:GU},m.createElement("img",{src:"https://i.imgur.com/1HWhtMo.jpg",alt:"New Tab Stretches Icon",width:"40",height:"40",className:$U}),m.createElement("div",{className:KU},m.createElement(Ne,{url:"https://www.kapwing.com/new-tab-stretches",quote:"New Tab Stretches - Improve your flexibility with every new tab",className:YU},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/new-tab-stretches",title:"New Tab Stretches - Improve your flexibility with every new tab",via:"kapwingapp",hashtags:["stretch","yoga","working from home"],className:YU},m.createElement(Pe,{size:40,round:!0})))),m.createElement("main",{className:HU},m.createElement("h1",{className:zU},"New Tab Stretches"),m.createElement("div",{className:qU},"Improve your flexibility with every new tab."),m.createElement("div",{className:oM},m.createElement("video",{src:"https://cdn-useast1.kapwing.com/static/new-tab-stretches.mp4",alt:"stretch",autoPlay:!0,muted:!0,className:JU,controls:!0,loop:!0})),m.createElement("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer"},m.createElement("button",{type:"button",className:XU},m.createElement("div",{className:ZU},m.createElement(Ye,null)),m.createElement("div",{className:QU},"Add New Tab Stretches to Chrome"))),m.createElement("div",{className:eM},m.createElement("div",{className:tM},m.createElement("p",null,"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk."),m.createElement("p",null,"The current COVID-19 situation has our whole team working from home. Gyms and many public areas are all closed. Since it's hard to get moving, we end up sitting at our desk for hours at a time."),m.createElement("div",null,m.createElement("img",{src:"https://i.imgur.com/NAtTr6Q.jpg",className:aM,alt:"Quad stretch"})),m.createElement("p",null,"New Tab Stretches is a small way to remind yourself to stay healthy and active throughout the day. Whether you're working intensely on a new project or just spending time browsing the web, the set of illustrations in your new tab can serve as a small reminder to move around. Many of the stretches can be done without having to get up from your computer, and all of the stretches can be done right near your desk."),m.createElement("p",null,"There's nothing special that you need to do in order to get set up and get started with this extension. Just install it directly from the Chrome extension store, and it will start working on your next new tab. You don't even need to restart your browser."),m.createElement("div",null,m.createElement("img",{src:"https://i.imgur.com/glTpHA6.jpg",className:aM,alt:"Neck stretch"})),m.createElement("p",null,"We worked with a professional illustrator to create original drawings of a diverse set of models who represent the many different types of people who could benefit from stretching throughout the day. We're also trying to improve the number of stretches in the extension as we create more illustrations and learn more stretches!"),m.createElement("div",null,m.createElement("img",{src:"https://i.imgur.com/bGdcmpS.jpg",className:aM,alt:"Calf stretch"})),m.createElement("p",null,"We hope that this extension can be a way to help in a small way throughout this pandemic. Thanks for sharing it with your friends!"),m.createElement("p",null,m.createElement("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer"},m.createElement("button",{type:"button",className:XU},m.createElement("div",{className:ZU},m.createElement(Ye,null)),m.createElement("div",{className:QU},"Add New Tab Stretches to Chrome")))),m.createElement("p",null,"Made with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),".")))))),rM="NotFound-module_notFoundContainer_FbIpq",iM="NotFound-module_notFoundImageContainer_3O6EM",sM="NotFound-module_notFoundImage_RU2Pw",lM="NotFound-module_link_MCVdM",cM="NotFound-module_bigTitle_hjw-2",dM="NotFound-module_title_qFNuj",uM=()=>{const e="Page Not Found — 404 — Kapwing",t="Sorry, the page you were looking for cannot be found. Our team at Kapwing is investigating this 404 error. In the meantime, please return to Kapwing.com to continue browsing.";return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement(Ce,null,m.createElement("title",null,e),m.createElement("meta",{name:"description",content:t}),m.createElement("meta",{name:"keywords",content:"404, Page Not Found"}),m.createElement("meta",{property:"og:title",content:e}),m.createElement("meta",{property:"og:description",content:t}),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement("div",{className:rM},m.createElement("div",null,m.createElement("div",{className:iM},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/MHZ-404.webp",alt:"Not Found Kitten",className:sM})),m.createElement("h1",{className:cM},"404 — Page Not Found"),m.createElement("div",{className:dM},"Sorry, the page you were looking for cannot be found."),m.createElement("div",{className:dM},m.createElement("a",{href:"/",className:lM},"Click here to return home.")))),m.createElement(HC,null))},mM=ie(i.exports.connect(void 0,(e=>he({showError:wh,receiveUserAndSetToken:Fm,getUserTeams:_g,setOnboarding:gr,setWorkspaces:Nf,setTeams:ug},e)))((e=>{const{showError:t,receiveUserAndSetToken:a,setOnboarding:o,setWorkspaces:r,setTeams:i}=e,s=Fe(),l=oe(),c=cn((e=>e.sessionValues.onboarding));return n.exports.useEffect((()=>{!async function(){const e=new URLSearchParams(l.search||""),n=e.get("code"),d=new URLSearchParams(e.get("state")||""),u=d.get("pathname")||"/",m=d.get("goToNext"),p=e=>{s.replace(u),t(e),fm("Sign In Error Occurred",{"Error Type":"googleResponse",Details:e})};if(n)try{const e=await op("/api/v1/users/google/loginWithOAuth",{body:{code:n}});a(e.user,e.token),vm(e.user,e.newUser,"Google",!1),Rm(e.user,e.newUser,"Google",u),wk(),e.newUser&&o({...c,newUser:!0}),e.workspace&&r([e.workspace]),e.team?i([e.team]):await _g(),s.replace(u),m&&s.push(m)}catch($ae){p((null==$ae?void 0:$ae.message)||"An error occured while confirming Google authorization.")}else p("Missing Google authorization code.")}()}),[]),m.createElement(ik,null)})));class pM extends n.exports.Component{constructor(){super(...arguments),t(this,"installRickRoller",(()=>{window.open("https://chrome.google.com/webstore/detail/mjklaailjabbidpmbngdceejclkbikib","_blank")}))}render(){return m.createElement("div",null,m.createElement("div",{className:"startup-videos-wrapper"},m.createElement(Ce,null,m.createElement("title",null,"Rick Roller – Kapwing"),m.createElement("meta",{name:"description",content:"Use this free Chrome extension to Rick Roll friends who forget to lock their computer or leave their computer unattended. Let the rick-rolling begin!"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/rick-roller"}),m.createElement("meta",{property:"og:title",content:"Rick Roller - Kapwing"}),m.createElement("meta",{property:"og:description",content:"A Chrome extension to Rick Roll friends who forget to lock their computer"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/HWgjbJ0.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/rick-roller"})),m.createElement("div",{className:"startup-demo-videos-header-container"},m.createElement("div",null,m.createElement("div",null,m.createElement("img",{src:"https://i.imgur.com/wU6NJAI.jpg",alt:"Rick Roller Logo",className:"rick-roller-logo"})),m.createElement("div",{className:"rick-roller-header"},"Rick Roller"),m.createElement("div",{className:"rick-roller-description"},"A Chrome extension to Rick Roll friends who forget to lock their computer"),m.createElement("div",{className:"rick-roller-download-container"},m.createElement("button",{type:"button",className:"rick-roller-download-button",onClick:this.installRickRoller},m.createElement("div",{className:"rick-roller-download-button-chrome-logo"},m.createElement(Ye,null)),m.createElement("div",{className:"rick-roller-download-button-header"},"Add to Chrome"),m.createElement("div",{className:"rick-roller-download-button-description"},"(do it on your friend's computer)"))),m.createElement("div",{className:"rick-roller-demo-container"},m.createElement("div",{className:"rick-roller-demo-header"},"How it works"),m.createElement("div",{className:"rick-roller-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/j8DZRFK.png",alt:"Download the extension screenshot",className:"rick-roller-demo-image"})),m.createElement("div",{className:"rick-roller-demo-right"},m.createElement("div",{className:"rick-roller-demo-step-header"},"Step 1"),m.createElement("div",{className:"rick-roller-demo-step-description"},"When your friend leaves their computer unlocked, install the Rick Roller extension on the Chrome browser on their computer."))),m.createElement("div",{className:"rick-roller-demo-container"},m.createElement("div",{className:"rick-roller-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/H9yF65L.jpg",alt:"Watch your friend click a link",className:"rick-roller-demo-image"})),m.createElement("div",{className:"rick-roller-demo-right"},m.createElement("div",{className:"rick-roller-demo-step-header"},"Step 2"),m.createElement("div",{className:"rick-roller-demo-step-description"},"Once the extension is installed, wait for your friend to click some links for the fun to begin!"))),m.createElement("div",{className:"rick-roller-demo-container"},m.createElement("div",{className:"rick-roller-demo-left"},m.createElement(oL,{src:"https://i.imgur.com/NEXyAsU.jpg",alt:"Wait and watch them get rick rolled!",className:"rick-roller-demo-image"})),m.createElement("div",{className:"rick-roller-demo-right"},m.createElement("div",{className:"rick-roller-demo-step-header"},"Step 3"),m.createElement("div",{className:"rick-roller-demo-step-description"},"Your friend gets randomly rick roll'd while browsing the web. Have fun!"))))),m.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},m.createElement("div",{className:"startup-demo-videos-email-subscribe"},m.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),m.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),m.createElement(ZD,{source:"rick-roll"}))),m.createElement("div",{className:"rick-roller-share"},m.createElement(Ne,{url:"https://www.kapwing.com/rick-roller",quote:"Rick Roller - an extension to Rick Roll your friends",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/rick-roller",title:"Rick Roller - an extension to Rick Roll your friends",via:"kapwingapp",hashtags:["rickroll","aprilfools"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0})),m.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")))),m.createElement(HC,null))}}const hM=ie(pM),gM="Sidedoor-module_container_yhbWF",fM="Sidedoor-module_headerBar_6X8wc",yM="Sidedoor-module_hero_hGi0x",EM="Sidedoor-module_heroHeader_osl7K",_M="Sidedoor-module_heroSubheader_3nDYp",vM="Sidedoor-module_heroButtons_tiMDO",wM="Sidedoor-module_heroButton_EaauJ",bM="Sidedoor-module_sectionLight_6Phc-",SM="Sidedoor-module_sectionSmall_np57A",TM="Sidedoor-module_sectionLarge_-3HOX",IM="Sidedoor-module_sectionRight_sxdyH",kM="Sidedoor-module_sectionHeader_Yi-eu",CM="Sidedoor-module_sectionSubheader_6IRjK",NM="Sidedoor-module_sectionLeft_5SXGj",AM="Sidedoor-module_sectionImage_9C-og",xM="Sidedoor-module_sectionButtons_ulfEY",PM="Sidedoor-module_sectionButton_j3tAp",RM="Sidedoor-module_howItWorks_rzT-d",OM="Sidedoor-module_howItWorksBullet_kws9z",DM="Sidedoor-module_howItWorksBulletNumber_9995R",LM="Sidedoor-module_howItWorksBulletDescription_Ifyb-",UM="Sidedoor-module_testimonials_kmFJr",MM="Sidedoor-module_testimonialsHeader_Ruz6u",FM="Sidedoor-module_testimonial_PqYY8",BM="Sidedoor-module_testimonialImageContainer_8IbSI",WM="Sidedoor-module_testimonialImage_ET-jj",VM="Sidedoor-module_testimonialName_xdK1r",jM="Sidedoor-module_footer_Ac-fS",HM="Sidedoor-module_footerHeader_88hLa",GM="Sidedoor-module_footerDescription_qsFZR",$M="Sidedoor-module_bestsellers_Rsgso",KM="Sidedoor-module_bestsellersItem_cXYcg",YM="Sidedoor-module_bestsellersItemInner_XuSa-",zM="Sidedoor-module_bestsellersHeader_Hs36r",qM="Sidedoor-module_bestsellersLeft_K-kFT",JM="Sidedoor-module_bestsellersRight_DOVYN",XM="Sidedoor-module_bestsellersImageContainer_IuzNS",QM="Sidedoor-module_bestsellersImage_WPOlQ",ZM="Sidedoor-module_bestsellersName_XZkP-",eF="Sidedoor-module_bestsellersDescription_pwM7-",tF="Sidedoor-module_bestsellersButtonContainer_SGLx9",aF="Sidedoor-module_bestsellersButton_hlZkZ",oF="Sidedoor-module_returnContainer_8tbxt",nF="Sidedoor-module_startupDemoShareButton_uxH4S";class rF extends n.exports.Component{render(){return m.createElement("div",{className:jM},m.createElement("div",{className:HM},"About Sidedoor"),m.createElement("div",{className:GM},"Sidedoor is a side-business created with love by the team at"," ",m.createElement("a",{href:"/"},"Kapwing"),". If you find it useful, please help spread the love with a share!"),m.createElement("div",{className:GM},m.createElement(Ne,{url:"https://www.kapwing.com/sidedoor",quote:"Sidedoor - College acceptance simplified",className:nF},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/sidedoor",title:"Sidedoor - College acceptance simplified",hashtags:["college","accepted"],className:nF},m.createElement(Pe,{size:40,round:!0}))))}}const iF=ie(rF);class sF extends n.exports.Component{render(){return m.createElement("div",{className:fM},m.createElement(_e,{to:"/sidedoor"},"Sidedoor"))}}const lF=ie(sF),cF=[{name:"Lori Loughlin",image:"https://i.imgur.com/BAa9OWe.jpg",description:"American actress"},{name:"Bill McGlashan",image:"https://i.imgur.com/422a6G7.png",description:"Founder of TGP Growth"},{name:"Chris Schaepe",image:"https://i.imgur.com/rIVdoFX.png",description:"Co-founder of Lightspeed Venture Partners"},{name:"Gamal Aziz",image:"https://i.imgur.com/dnChPbR.jpg",description:"President of Wynn Resorts"},{name:"Felicity Huffman",image:"https://i.imgur.com/KjioaI2.png",description:"American Actress"},{name:"You?",image:"https://i.imgur.com/u7fAmA2.png",description:"Our next happy partner!"}];class dF extends n.exports.Component{constructor(e){super(e),tA("Rubik")}render(){return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Sidedoor - College Acceptance Simplified"),m.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),m.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),m.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor"})),m.createElement("div",{className:gM},m.createElement(lF,null),m.createElement("div",{className:yM},m.createElement("div",{className:EM},"College acceptance simplified"),m.createElement("div",{className:_M},"Somewhere along the way, getting into college became too hard. We thought, there must be a better way. Introducing ",m.createElement("b",null,"Sidedoor"),"."),m.createElement("div",{className:vM},m.createElement(_e,{to:"/sidedoor/ivy-league"},m.createElement("div",{className:wM},"Shop Ivy League")),m.createElement(_e,{to:"/sidedoor/west-coast"},m.createElement("div",{className:wM},"Shop West Coast")))),m.createElement("div",{className:bM},m.createElement("div",{className:SM},"Trusted, easy, and affordable"),m.createElement("div",{className:TM},"Your acceptance, guaranteed.")),m.createElement("div",null,m.createElement("div",{className:NM},m.createElement("div",{className:kM},"Ivy League"),m.createElement("div",{className:CM},"You've always forged your own path. You're not the kind to run with the crowd. So why apply just like everyone else?"),m.createElement("div",{className:xM},m.createElement(_e,{to:"/sidedoor/ivy-league"},m.createElement("div",{className:PM},"Shop Ivy League")))),m.createElement("div",{className:IM},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/0a963c_c7763f3a5bc54773b082bf24cf22c6cd_mv2_d_2048_1365_s_2.jpg",className:AM,alt:"college boys"}))),m.createElement("div",null,m.createElement("div",{className:NM},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",className:AM,alt:"stanford"})),m.createElement("div",{className:IM},m.createElement("div",{className:kM},"West Coast"),m.createElement("div",{className:CM},"Sunshine, startups, and surfing. Home to burritos and the Warriors. Your golden future awaits."),m.createElement("div",{className:xM},m.createElement(_e,{to:"/sidedoor/west-coast"},m.createElement("div",{className:PM},"Shop West Coast"))))),m.createElement("div",{className:RM},m.createElement("div",{className:kM},"How it works"),m.createElement("div",{className:OM},m.createElement("div",{className:DM},"1"),m.createElement("div",{className:LM},"Take your SATs with one of our trusted proctors. They'll make sure you get the scores you need.")),m.createElement("div",{className:OM},m.createElement("div",{className:DM},"2"),m.createElement("div",{className:LM},"Fill out an athletic profile. Don't worry - you don't need to have any actual athletic background.")),m.createElement("div",{className:OM},m.createElement("div",{className:DM},"3"),m.createElement("div",{className:LM},"Sidedoor works directly with coaches to make sure that your acceptance is guaranteed. No legacy status required!"))),m.createElement("div",{className:UM},m.createElement("div",{className:MM},"Serving thousands of happy customers"),cF.map((e=>m.createElement("div",{className:FM,key:e.name},m.createElement("div",{className:BM},m.createElement("img",{src:e.image,className:WM,alt:e.name})),m.createElement("div",{className:VM},e.name),m.createElement("div",null,e.description))))),m.createElement("div",{className:$M},m.createElement("div",{className:SM},"You're going to like what you find"),m.createElement("div",{className:zM},"Our Bestsellers"),m.createElement("div",{className:qM,onClick:()=>{this.props.history.push("/sidedoor/ivy-league/yale")}},m.createElement("div",{className:XM},m.createElement("img",{src:"https://i.imgur.com/qhYSTIj.jpg",className:QM,alt:"Yale"})),m.createElement("div",{className:ZM},"Yale University"),m.createElement("div",{className:eF},"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations."),m.createElement("div",{className:tF},m.createElement("div",{className:aF},"Shop Yale - from $630k"))),m.createElement("div",{className:JM,onClick:()=>{this.props.history.push("/sidedoor/west-coast/usc")}},m.createElement("div",{className:XM},m.createElement("img",{src:"https://i.imgur.com/vJPoRZ7.jpg",className:QM,alt:"USC"})),m.createElement("div",{className:ZM},"University of Southern California"),m.createElement("div",{className:eF},"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study."),m.createElement("div",{className:tF},m.createElement("div",{className:aF},"Shop USC - from $200k")))),m.createElement(iF,null)))}}const uF=ie(dF),mF=[{name:"Yale University",shortname:"Yale",image:"https://i.imgur.com/qhYSTIj.jpg",description:"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations.",link:"/sidedoor/ivy-league/yale",borderColor:"#DFDFDE",price:"630k"},{name:"Harvard University",shortname:"Harvard",image:"https://i.imgur.com/Rj2ee8c.jpg",description:"Established in 1636, Harvard is the oldest institution of higher education in the United States. The University, which is based in Cambridge and Boston, Massachusetts, has an enrollment of over 20,000 degree candidates.",link:"/sidedoor/ivy-league/harvard",price:"1.3m"},{name:"Georgetown University",shortname:"Georgetown",image:"https://i.imgur.com/R9zjl1J.jpg",description:"Located in the nation's capitol, Georgetown is home to a vibrant community of accomplished students, distinguished faculty members and committed professional staff.",link:"/sidedoor/ivy-league/georgetown",price:"350k"}];class pF extends n.exports.Component{render(){const{history:e}=this.props;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Sidedoor - Ivy League"),m.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),m.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),m.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/ivy-league"})),m.createElement("div",{className:gM},m.createElement(lF,null),m.createElement("div",{className:$M,style:{paddingTop:"40px"}},m.createElement("div",{className:zM},"Ivy League"),mF.map((t=>m.createElement("div",{className:KM,key:t.name,onClick:()=>{e.push(t.link)}},m.createElement("div",{className:YM,style:{borderColor:t.borderColor}},m.createElement("div",{className:XM},m.createElement("img",{src:t.image,className:QM,alt:t.name})),m.createElement("div",{className:ZM},t.name),m.createElement("div",{className:eF},t.description),m.createElement("div",{className:tF},m.createElement(_e,{to:t.link},m.createElement("div",{className:aF},"Shop ",t.shortname," - from $",t.price))))))),m.createElement("div",{className:KM},m.createElement("div",{className:YM,style:{borderColor:"#DFDFDE"}},m.createElement("div",{className:XM},m.createElement("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:QM,alt:"More coming soon"})),m.createElement("div",{className:ZM},"Stay tuned..."),m.createElement("div",{className:eF},"We're constantly building relationships and adding new schools. Stay tuned for more schools in Ivy League!"),m.createElement("div",null))),m.createElement("div",{className:oF},m.createElement(_e,{to:"/sidedoor"},m.createElement("div",{className:aF},"Return home")))),m.createElement(iF,null)))}}const hF=ie(pF),gF=[{name:"Stanford University",shortname:"Stanford",image:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",description:"Stanford University is one of the world’s leading research universities. It is known for its entrepreneurial character, drawn from the legacy of its founders, Jane and Leland Stanford, and its relationship to Silicon Valley",link:"/sidedoor/west-coast/stanford",borderColor:"#DFDFDE",price:"800k"},{name:"University of Southern California",shortname:"USC",image:"https://i.imgur.com/vJPoRZ7.jpg",description:"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study.",link:"/sidedoor/west-coast/usc",price:"75k"},{name:"University of California, Los Angeles",shortname:"UCLA",image:"https://i.imgur.com/zhdlPwy.jpg",description:"For nearly 100 years, UCLA has been a pioneer, persevering through impossibility, turning the futile into the attainable.",link:"/sidedoor/west-coast/ucla",price:"240k"}];class fF extends n.exports.Component{render(){const{history:e}=this.props;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Sidedoor - West Coast"),m.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),m.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),m.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/west-coast"})),m.createElement("div",{className:gM},m.createElement(lF,null),m.createElement("div",{className:$M,style:{paddingTop:"40px"}},m.createElement("div",{className:zM},"West Coast"),gF.map((t=>m.createElement("div",{className:KM,key:t.name,onClick:()=>{e.push(t.link)}},m.createElement("div",{className:YM,style:{borderColor:t.borderColor}},m.createElement("div",{className:XM},m.createElement("img",{src:t.image,className:QM,alt:t.name})),m.createElement("div",{className:ZM},t.name),m.createElement("div",{className:eF},t.description),m.createElement("div",{className:tF},m.createElement(_e,{to:t.link},m.createElement("div",{className:aF},"Shop ",t.shortname," - from $",t.price))))))),m.createElement("div",{className:KM},m.createElement("div",{className:YM,style:{borderColor:"#DFDFDE"}},m.createElement("div",{className:XM},m.createElement("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:QM,alt:"More coming soon"})),m.createElement("div",{className:ZM},"Stay tuned..."),m.createElement("div",{className:eF},"We're constantly building relationships and adding new schools. Stay tuned for more schools on the west coast!"),m.createElement("div",null))),m.createElement("div",{className:oF},m.createElement(_e,{to:"/sidedoor"},m.createElement("div",{className:aF},"Return home")))),m.createElement(iF,null)))}}const yF=ie(fF),EF={yale:{image:"https://i.imgur.com/jiHsYEp.jpg",name:"Yale University",description:"Admission to the school will be granted through the soccer team.",price:"630k"},harvard:{image:"https://i.imgur.com/75CICnw.jpg",name:"Harvard University",description:"Goodbye Z-list. Hello Sidedoor list.",price:"1.3m"},georgetown:{image:"https://i.imgur.com/ncwsxVU.jpg",name:"Georgetown University",description:'"Play" on the storied Georgetown tennis team.',price:"350k"},stanford:{image:"https://i.imgur.com/Ca5ft4n.jpg",name:"Stanford University",description:"Admittance through the sailing team. You can sail if you want to, too!",price:"800k"},usc:{image:"https://i.imgur.com/0PGHt5k.jpg",name:"University of Southern California",description:"Play on the storied football team. You could probably be a kicker, anyways.",price:"75k"},ucla:{image:"https://i.imgur.com/r6ydn22.jpg",name:"University of California, Los Angeles",description:"Play on the soccer team at UCLA. Don't worry, you won't have to start.",price:"240k"}};const _F="OverlayWrapper-module_overlayBackground_3fnyE",vF="OverlayWrapper-module_overlayContainer_iI6Ae",wF="OverlayWrapper-module_exit_um-2i",bF="OverlayWrapper-module_overlayContent_HdbWH";class SF extends n.exports.Component{render(){return m.createElement("div",null,m.createElement("div",{className:_F,onClick:()=>{this.props.onClose()},"data-cy":"overlay-background"}),m.createElement("div",{className:vF},m.createElement("div",{className:wF,onClick:()=>{this.props.onClose()}},m.createElement(Ee,null)),m.createElement("div",{className:bF},this.props.children)))}}const TF=ie(SF),IF="School-module_background_CSIry",kF="School-module_tile_ySOVO",CF="School-module_tileHeader_HWaHu",NF="School-module_tileDescription_zai3l",AF="School-module_tileSteps_ZKHiI",xF="School-module_tileStep_Jl2Dw",PF="School-module_tileStepHeader_SRwjE",RF="School-module_tileStepSubheader_2hvzJ",OF="School-module_button_FL67u",DF="School-module_buttonHelper_K9NBt",LF="School-module_disclaimer_1dSDk",UF="School-module_overlayHeader_LXt9h",MF="School-module_overlayDescription_lEzDs";class FF extends n.exports.Component{constructor(e){super(e),this.state={showOverlay:!1}}render(){const{school:e}=this.props.match.params,{history:t}=this.props,{showOverlay:a}=this.state,o=function(e){if(e in EF)return EF[e]}(e);if(!o)return t.push("/sidedoor"),null;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,o.name," - Sidedoor"),m.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),m.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),m.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),m.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/sidedoor/${"harvard"===e||"georgetown"===e||"yale"===e?"ivy-league":"west-coast"}/${e}`})),m.createElement(lF,null),m.createElement("div",{className:IF,style:{width:"100vw",height:"100vh",backgroundColor:"#333333",backgroundImage:`url("${o.image}")`}},m.createElement("div",{className:kF},m.createElement("div",{className:CF},o.name),m.createElement("div",{className:NF},o.description),m.createElement("div",{className:AF},m.createElement("div",{className:xF},m.createElement("span",{className:PF},"1. Purchase upfront"),m.createElement("span",{className:RF},"Refundable for 30 days")),m.createElement("div",{className:xF},m.createElement("span",{className:PF},"2. Take our SAT"),m.createElement("span",{className:RF},"Location and proctor provided")),m.createElement("div",{className:xF},m.createElement("span",{className:PF},"3. Submit photos"),m.createElement("span",{className:RF},"Wearing athletic clothes")),m.createElement("div",{className:xF},m.createElement("span",{className:PF},"4. Enjoy senior year"),m.createElement("span",{className:RF},"Don't worry like everyone else"))),m.createElement("div",{className:OF,onClick:()=>{this.setState({showOverlay:!0})}},"Purchase now - $",o.price," ",m.createElement("span",{className:DF},"One time payment")),m.createElement("div",{className:LF},"* No legacy status required for purchase. Admissions are 100% legitimate and legal. Confidentiality guaranteed."),a?m.createElement(TF,{onClose:()=>this.setState({showOverlay:!1})},m.createElement("div",{className:UF},"Happy April Fools' Day!"),m.createElement("div",{className:MF},m.createElement("p",null,"Unfortunately, if you're trying to buy admission on this website, you probably can't afford it."),m.createElement("p",null,"Enjoy Sidedoor? Please help use spread the word on Facebook, Twitter, or your social network of choice!"),m.createElement("p",null,"Built with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),"."),m.createElement("p",null,m.createElement(_e,{to:"/sidedoor"},"Return to Sidedoor →")))):null)))}}const BF=ie(FF);class WF extends n.exports.Component{constructor(e){super(e),tA("Rubik")}render(){return m.createElement($e,null,m.createElement(Ke,{path:"/sidedoor",exact:!0,component:uF}),m.createElement(Ke,{path:"/sidedoor/ivy-league",exact:!0,component:hF}),m.createElement(Ke,{path:"/sidedoor/ivy-league/:school",component:BF}),m.createElement(Ke,{path:"/sidedoor/west-coast",exact:!0,component:yF}),m.createElement(Ke,{path:"/sidedoor/west-coast/:school",component:BF}))}}const VF=ie(WF),jF="SignIn-module_signInWrapper_lkskh",HF="SignIn-module_signInLeft_KfIRn",GF="SignIn-module_signInContainer_FS7-R",$F="SignIn-module_signInImage_n-oku",KF="SignIn-module_image_mhEPP";var YF=(e=>(e.TEAMS="teams",e))(YF||{});const zF=()=>{const e=Fe(),t=cn((e=>e.currentUser)),{search:a}=oe(),o=n.exports.useMemo((()=>new URLSearchParams(a)),[a]),r=o.get("next");n.exports.useEffect((()=>{var a;if(om(t))if(r)e.push({pathname:r});else{const n=null==(a=e.location.state)?void 0:a.pathname;e.push({pathname:null!=n?n:"/",state:{redirectSource:o.get("from")}}),"teams"===o.get("from")&&fm("Clicked Create a Team",{Email:t.user.email})}}),[t,e,o,r]);const i=async()=>{var t;if(r)e.push({pathname:r});else{const a=null==(t=e.location.state)?void 0:t.pathname;e.push({pathname:null!=a?a:"/",state:{redirectSource:o.get("from")}})}},s="Sign In or Sign Up — Kapwing",l="Kapwing works better if you sign in. Sign in to access your projects, save content to your workspace, preview beta features, and much more.";return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement(Ce,null,m.createElement("title",null,s),m.createElement("meta",{name:"description",content:l}),m.createElement("meta",{name:"keywords",content:"sign in, login, signup, sign in to Kapwing"}),m.createElement("meta",{property:"og:title",content:s}),m.createElement("meta",{property:"og:description",content:l})),m.createElement("div",{className:jF},m.createElement("div",{className:HF},m.createElement("div",{className:GF},m.createElement("div",{className:DC},"Sign in to continue"),m.createElement("div",{className:LC},"Kapwing works better when you’re signed in. Sign in to save content to a workspace, share with others, and more."),r?m.createElement(PC,{onSuccess:i,immediateRedirectPathname:e.location.pathname+e.location.search,forceNavigationTo:r}):m.createElement(PC,{onSuccess:i,immediateRedirectPathname:e.location.pathname+e.location.search}))),m.createElement("div",{className:$F},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/7ne-sign-in-illustration.webp",className:KF,alt:"Benefits to signing in to Kapwing"}))),m.createElement(HC,null))},qF="common-module_textContainer_D7NvK",JF="common-module_textHeader_W1lwT",XF="common-module_textDescription_VC-uV",QF="common-module_previewImage_7xj-G",ZF="common-module_preview_v9ycp";class eB extends n.exports.Component{render(){return m.createElement("div",null,m.createElement(Ce,null,m.createElement("title",null,"Free Sound Effects for Video Editing – Kapwing"),m.createElement("meta",{name:"description",content:"Use Kapwing's trendy sound effects generator to add emphasis to a video in a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),m.createElement("meta",{name:"keywords",content:"sound effects, sound effect generator"}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sound-effects"}),m.createElement("meta",{property:"og:title",content:"Trendy Sound Effects Editor - Kapwing"}),m.createElement("meta",{property:"og:description",content:"Add trendy sound effects directly to your video in just a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/SN2lyIK.png"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/SN2lyIK.png"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/SN2lyIK.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sound-effects"})),m.createElement(yD,null),m.createElement("div",{className:qF},m.createElement("div",{className:JF},"Trendy Sound Effects Editor"),m.createElement("div",{className:XF},m.createElement("p",null,"The Trendy Sound Effects Editor was a fun project that allowed users to add, well, trendy sound effects to their videos."),m.createElement("p",null,"We created the app after watching many fun videos with funny sound effects, like a snap of fingers, or an explosion effect for extra emphasis."),m.createElement("p",null,"The sound effects editor was featured in various places online including"," ",m.createElement("a",{href:"https://www.producthunt.com/posts/trendy-sound-effect-editor/"},"Product Hunt")," ","as well as"," ",m.createElement("a",{href:"https://www.thewindowsclub.com/kapwing-meme-maker-generator"},"The Windows Club"),".")),m.createElement("div",null),m.createElement("div",{className:ZF},m.createElement("img",{src:"https://i.imgur.com/VXAqJZW.png",alt:"Sound Effects Editor Home Page",className:QF})),m.createElement("div",{className:ZF},m.createElement("img",{src:"https://i.imgur.com/iHjfHSa.png",alt:"Sound Effects Editor Preview",className:QF})),m.createElement("div",null),m.createElement("div",{className:XF},m.createElement("p",null,"The feature included a large variety of sounds that could be added to the video, including the Mario Power-up sound, iMessage sending, mouse clicking, and many more.")),m.createElement("div",{className:ZF},m.createElement("img",{src:"https://i.imgur.com/QZR9LIc.png",alt:"Sound Effects Sounds Preview",className:QF})),m.createElement("div",{className:XF},m.createElement("p",null,"The feature was deprecated in October of 2018 due to a lack of maintainence. If you're looking to add sound to your video, you can use the ",m.createElement("a",{href:"/tools/add-audio"},"Add Sound to Video")," ","feature on ",m.createElement("a",{href:"/"},"Kapwing"),"."),m.createElement("p",null,"Thanks for visiting the Trendy Sound Effects Editor and have a nice day."))),m.createElement(HC,null))}}const tB=[{id:"dropbox",name:"Dropbox",image:"https://i.imgur.com/z8sgVnv.png",logo:"https://i.imgur.com/YxDJLc6.png",date:"Sep 15, 2008",description:"A 24 year old Drew Houston gives the first introduction to Dropbox, in a video that responated with hackers.",youtubeLink:"https://www.youtube.com/watch?v=7QmCUDHpNzE",embedLink:"https://www.youtube.com/embed/7QmCUDHpNzE"},{id:"robinhood",name:"Robinhood",image:"https://i.imgur.com/tdMnozF.png",logo:"https://i.imgur.com/qV8t8BY.png",date:"Dec 10, 2014",description:"Watch the video that made Robinhood go viral on the internet, with the (at the time) revolutionary idea that stock trading could be free.",youtubeLink:"https://www.youtube.com/watch?v=Z_nsrcnwHQc",embedLink:"https://www.youtube.com/embed/Z_nsrcnwHQc"},{id:"uber",name:"Uber",image:"https://i.imgur.com/D9AB0t9.png",logo:"https://i.imgur.com/fiwh2Em.png",date:"May 10, 2010",description:"A demonstration of the UberCab app in 2010, when it was still focused on limousines.",youtubeLink:"https://youtu.be/k3wk4kem54k",embedLink:"https://www.youtube.com/embed/k3wk4kem54k"},{id:"google",name:"Google Street View",image:"https://i.imgur.com/XV8VL1t.png",logo:"https://i.imgur.com/0ABT4tR.png",date:"May 29, 2007",description:"Google's famous quirky-ness comes in full force in this fun introduction to Street View.",youtubeLink:"https://youtu.be/91wuBqlny50",embedLink:"https://www.youtube.com/embed/91wuBqlny50"},{id:"lyft",name:"Lyft (aka Zimride)",image:"https://i.imgur.com/QcL2jX1.png",logo:"https://i.imgur.com/WXputgn.png",date:"Sep 6, 2010",description:"Before Lyft, the founders created a ride share website for students called Zimride. Watch them walk through this product that led to much more.",youtubeLink:"https://youtu.be/ei5woMwH6vM",embedLink:"https://www.youtube.com/embed/ei5woMwH6vM"},{id:"linkedin",name:"LinkedIn",image:"https://i.imgur.com/zhea8VL.png",logo:"https://i.imgur.com/znK6zTR.png",date:"Apr 5, 2010",description:"LinkedIn wasn't super new when they put out this marketing video, but it's still interesting to watch and see how far they've come.",youtubeLink:"https://youtu.be/ZVlUwwgOfKw",embedLink:"https://www.youtube.com/embed/ZVlUwwgOfKw"},{id:"snapchat",name:"Snapchat Video",image:"https://i.imgur.com/o6IasQ7.png",logo:"https://i.imgur.com/jSPUZGJ.png",date:"Dec 13, 2012",description:"Looking at this old launch video for Snapchat video makes it seem crazy just how far the app has come.",youtubeLink:"https://youtu.be/r4237MZIb8g",embedLink:"https://www.youtube.com/embed/r4237MZIb8g"},{id:"apple",name:"Apple iPhone",image:"https://i.imgur.com/lx76CKr.png",logo:"https://i.imgur.com/s5aT8PJ.png",date:"Jan 10, 2007",description:"The original presentation by Steve Jobs that would change humanity in a real way.",youtubeLink:"https://youtu.be/ftf4riVJyqw",embedLink:"https://www.youtube.com/embed/ftf4riVJyqw"},{id:"twilio",name:"Twilio",image:"https://i.imgur.com/vPd1O46.png",logo:"https://i.imgur.com/uHkKO1v.png",date:"Mar 10, 2009",description:"Watch Evan Cooke, a co-founder of Twilio, give a basic whiteboard demonstration of their early service.",youtubeLink:"https://youtu.be/P4KaV3eiH3s",embedLink:"https://www.youtube.com/embed/P4KaV3eiH3s"},{id:"coinbase",name:"Coinbase Vault",image:"https://i.imgur.com/THA5PR9.png",logo:"https://i.imgur.com/l5M2lab.png",date:"Jul 2, 2014",description:"One of the early demos of Coinbase which set the stage for its latest success.",youtubeLink:"https://youtu.be/GX_c566xYcQ",embedLink:"https://www.youtube.com/embed/GX_c566xYcQ"},{id:"instacart",name:"Instacart",image:"https://i.imgur.com/jmLBfV2.png",logo:"https://i.imgur.com/KolJdHX.png",date:"Aug 24, 2012",description:"Apoorva Mehta gives an honest interview about his journey with Instacart during his time at Y Combinator, when no one knew about it.",meta:{title:"Evolution of Instacart – Kapwing",description:"Watch Apoorva Mehta share insight on his journey at Instacart as well as videos from other founders in the Startup demo video collection by Kapwing."},youtubeLink:"https://youtu.be/b5llwmsHXkw",embedLink:"https://www.youtube.com/embed/b5llwmsHXkw"},{id:"zenefits",name:"Zenefits",image:"https://i.imgur.com/RHknkvP.png",logo:"https://i.imgur.com/ywASlen.png",date:"Feb 10, 2013",description:"Watch a younger Parker Conrad, the founder of Zenefits, give the pitch in his application video to Y Combinator.",meta:{title:"Evolution of Zenefits – Kapwing",description:"Watch Parker Conrad, the founder of Zenefits, give his pitch in an application video. Explore more demo videos from the early days of successful startups."},youtubeLink:"https://youtu.be/-S83fysRwn4",embedLink:"https://www.youtube.com/embed/-S83fysRwn4"},{id:"docker",name:"Docker",image:"https://i.imgur.com/wtM1lus.png",logo:"https://i.imgur.com/hz8Wfd2.png",date:"May 10, 2010",description:"Docker seems like a no-brainer for developers today, but back when they first started, the idea of a container left many skeptical.",youtubeLink:"https://youtu.be/Q5POuMHxW-0",embedLink:"https://www.youtube.com/embed/Q5POuMHxW-0"},{id:"twitch",name:"Twitch (aka Justin.tv)",image:"https://i.imgur.com/zBrockk.png",logo:"https://i.imgur.com/L11W3bk.png",date:"Feb 4, 2010",description:"Before Twitch, was Justin.tv. Take a look at this authentic demo of their early live streaming technology on the web.",youtubeLink:"https://youtu.be/kfDBxa65m_A",embedLink:"https://www.youtube.com/embed/kfDBxa65m_A"}];class aB extends n.exports.Component{constructor(e){super(e),this.state={currentVideo:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const a=tB.find((t=>t.id===e.params.id));a?this.setState({currentVideo:a}):t.push("/startup-demo-videos")}else t.push("/startup-demo-videos")}renderVideo(){const{currentVideo:e}=this.state,{meta:{title:t,description:a}={}}=e,{history:o}=this.props;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,t),m.createElement("meta",{name:"description",content:a}),m.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/startup-demo-videos/${e.id}`})),m.createElement("div",{className:"startup-video-player-wrapper"},m.createElement("div",{className:"startup-video-player-container"},m.createElement("div",{className:"startup-video-player-back",onClick:()=>o.push("/startup-demo-videos")},"< Back to all videos"),m.createElement("div",{className:"splash-youtube-video"},m.createElement("iframe",{title:`${e.name} Video`,src:`${e.embedLink}?autoplay=1&showinfo=0&modestbranding=0`,frameBorder:"0"})),m.createElement("div",{className:"startup-video-player-metadata"},m.createElement("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-logo"}),m.createElement("div",{className:"startup-demo-videos-item-name"},e.name),m.createElement("div",{className:"startup-video-player-date"},e.date),m.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){const{currentVideo:e}=this.state;return e?this.renderVideo():null}}const oB=ie(aB);class nB extends n.exports.Component{constructor(){super(...arguments),t(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/startup-demo-videos/${e.id}`)})),t(this,"renderVideoItem",(e=>m.createElement("div",{key:e.id,className:"startup-demo-videos-item-container"},m.createElement("div",{className:"startup-demo-videos-image-container",onClick:()=>this.playVideo(e)},m.createElement("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-image"}),m.createElement("div",{className:"startup-demo-videos-image-play-button"},m.createElement("span",{className:"startup-demo-videos-play"},"►"),m.createElement("div",{className:"startup-demo-videos-overlay"}))),m.createElement("div",{className:"startup-demo-videos-item-metadata"},m.createElement("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),m.createElement("div",{className:"startup-demo-videos-item-name"},e.name),m.createElement("div",{className:"startup-demo-videos-item-date"},e.date),m.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){return m.createElement("div",null,m.createElement("div",{className:"startup-videos-wrapper"},m.createElement(Ce,null,m.createElement("title",null,"Startup Demo Videos – Kapwing"),m.createElement("meta",{name:"description",content:"Explore a collection of demo videos from the early days of successful startups such as Dropbox, LinkedIn, Robinhood, and more curated by the Kapwing team."}),m.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/startup-demo-videos"}),m.createElement("meta",{property:"og:title",content:"Startup Demo Videos - Kapwing"}),m.createElement("meta",{property:"og:description",content:"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/nnvE6Bf.png"}),m.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/nnvE6Bf.png"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/nnvE6Bf.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/startup-demo-videos"})),m.createElement("div",{className:"startup-demo-videos-header-container"},m.createElement("div",null,m.createElement("div",{className:"startup-demo-videos-header"},"Startup Demo Videos"," ",m.createElement("span",{role:"img","aria-label":"Lightbult Emoji"},"💡")),m.createElement("div",{className:"startup-demo-videos-description"},"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."),m.createElement("div",{className:"startup-demo-videos-share"},m.createElement(Ne,{url:"https://www.kapwing.com/startup-demo-videos",quote:"Startup Demo Videos - Kapwing",className:"startup-demo-share-button"},m.createElement(Ae,{size:40,round:!0})),m.createElement(xe,{url:"https://www.kapwing.com/startup-demo-videos",title:"💡 Startup Demo Videos - Kapwing",via:"kapwingapp",hashtags:["startups","videos"],className:"startup-demo-share-button"},m.createElement(Pe,{size:40,round:!0}))),m.createElement("div",{className:"startup-demo-videos-text"},"Curated with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")))),m.createElement("div",{className:"startup-demo-videos-background"},m.createElement("div",{className:"startup-demo-videos-list-container"},tB.map((e=>this.renderVideoItem(e))),m.createElement("div",{className:"startup-demo-videos-item-container"},m.createElement("div",{className:"startup-demo-videos-image-container"},m.createElement("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})))),m.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},m.createElement("div",{className:"startup-demo-videos-email-subscribe"},m.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),m.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),m.createElement(ZD,{source:"startup-demo-videos"})),m.createElement("div",{className:"startup-demo-videos-footer-text"},"We're adding new videos to the collection on a regular basis! Have a submission for a video? Contact us at"," ",m.createElement("a",{href:"mailto:hello@kapwing.com"},"hello@kapwing.com"),"!")))),m.createElement(HC,null))}}const rB=ie(nB),iB="Success-module_successMessage_BAkpG",sB="Success-module_successSnackbar_Z1eao",lB="Success-module_successCloseSnackbar_igNMK",cB=()=>{const e=i.exports.useDispatch(),{showSuccess:t,successMessage:a}=cn((e=>({showSuccess:e.toasts.showSuccess,successMessage:e.toasts.successMessage})),dn);if(!t)return null;const o=()=>e({type:"HIDE_SUCCESS"});return setTimeout((()=>{t&&o()}),1e4),m.createElement("div",{className:sB},m.createElement("div",{className:lB,onClick:o},"×"),m.createElement("span",{className:iB},a||"Success! Woot!"))};function dB(e){return{type:"SET_PARENT_ID",parentId:e}}function uB(e){return{type:"SET_CURRENT_TEMPLATE",currentTemplate:e}}function mB(e){return{type:"SET_TEMPLATES",templates:e}}function pB(e){return t=>ap("/api/v1/templates/getTemplate",{params:{slug:e}}).then((e=>(t(uB(e)),e)))}function hB(e){return()=>ap("/api/v1/templates/getTemplateFromId",{params:{_id:e}}).then((e=>e))}let gB=Date.now();function fB(e={},t){return a=>{gB=Date.now(),t&&(e.pattern={key:t.key,value:t.value});return ap("/api/v1/templates/getTemplates",{params:{args:JSON.stringify({...e,timeOfRequest:gB}),parseJson:!0}}).then((e=>{e.timeOfRequest===gB&&a(mB(e.templates))}))}}async function yB(e,t){const a=await Promise.all(e.map((async e=>{if("Trending Now"===e)return await ap("/api/v1/templates/getNewestNonMemeTemplates/1");const a={searchTerm:e};t&&(a.pattern={key:t.key,value:t.value});const o={params:{args:JSON.stringify(a)}};return(await ap("/api/v1/templates/getTemplates",o)).templates}))),o=new Map;return e.forEach(((e,t)=>{o.set(e,a[t])})),o}function EB(e=1){return t=>ap(`/api/v1/templates/getNewestTemplates/${e}`).then((e=>(t(mB(e)),e)))}function _B(e,t=null){return a=>ap(`/api/v1/templates/${e}/children`,{params:{lastId:t}}).then((e=>(a({type:"SET_RECENT_VIDEOS",videos:e}),e)))}function vB(e){return t=>ap(`/api/v1/templates/${e}/examples`).then((e=>(t((()=>({type:"SET_TEMPLATE_EXAMPLE_VIDEOS",exampleVideos:e}))),e)))}function wB(e){const{currentUser:t}=io().state,{token:a,user:o}=t||{},{_id:n}=o||{};return op("/api/v1/templates/upsertTemplate",{body:e,params:{token:a,userId:n}})}function bB(e){return(t,a)=>{const{currentUser:o}=a(),{token:n,user:r}=o||{},{_id:i}=r||{};return tp("/api/v1/templates/deleteTemplate",{body:e,params:{token:n,userId:i}})}}function SB(e,t,a){return(o,n)=>{const{currentUser:r}=n(),{user:i}=r||{},{_id:s}=i||{};return("ADD"===e?np:tp)(`/api/v1/templates/${t}/example`,{params:{_id:a,userId:s}}).then((t=>(o((()=>({type:"ADD"===e?"ADD_TEMPLATE_EXAMPLE":"REMOVE_TEMPLATE_EXAMPLE",example:a}))),t)))}}function TB(e){return{type:"SET_TEMPLATE_SOURCE",source:e}}const IB="AddRemoveExamples-module_actionButton_UlQDA",kB="AddRemoveExamples-module_container_DSqg7",CB="AddRemoveExamples-module_header_HPzwW",NB="AddRemoveExamples-module_description_V-4Xd";class AB extends n.exports.Component{constructor(e){super(e),t(this,"fetchParentTemplate",(()=>{const{currentVideo:e,getTemplateFromId:t,showError:a}=this.props;t(e.parentId).then((e=>{this.setState({parentTemplate:e,loadingParentTemplate:!1})})).catch((e=>{console.error(e),a(e),this.setState({loadingParentTemplate:!1})}))})),t(this,"addToExamples",(()=>{const{currentVideo:e,updateTemplateExamples:t}=this.props,{parentTemplate:a}=this.state;this.setState({loadingTemplateExamples:!0}),t("ADD",a._id,e._id).then((e=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{console.error("an error occurred when updating examples"),wh(e),this.setState({loadingTemplateExamples:!1})}))})),t(this,"removeFromExamples",(()=>{const{currentVideo:e,updateTemplateExamples:t}=this.props,{parentTemplate:a}=this.state;this.setState({loadingTemplateExamples:!0}),t("REMOVE",a._id,e._id).then((e=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{console.error("an error occurred when removing from examples"),wh(e),this.setState({loadingTemplateExamples:!1})}))})),t(this,"currentVideoIsAlreadyExample",(()=>{const{currentVideo:e}=this.props,{parentTemplate:t}=this.state;return t&&t.examples&&t.examples.includes(e._id)})),this.state={loadingParentTemplate:!0,loadingTemplateExamples:!1,parentTemplate:{}}}componentDidMount(){const{currentVideo:e}=this.props;e&&e.parentId&&this.fetchParentTemplate()}renderExampleActions(){const{loadingTemplateExamples:e,parentTemplate:t}=this.state,a=this.currentVideoIsAlreadyExample();return e?m.createElement("div",{className:IB},"Loading ..."):a?m.createElement("div",{className:IB,onClick:this.removeFromExamples},"Remove from examples"):m.createElement("div",{className:IB,onClick:this.addToExamples},"Add to examples for ",t.title)}render(){const{loadingParentTemplate:e,parentTemplate:t}=this.state;if(e||E(t))return null;const a=this.currentVideoIsAlreadyExample();return console.info(t),m.createElement("div",{className:kB},m.createElement("div",{className:CB},"Example actions"),m.createElement("div",{className:NB},"This content is a child of template"," ",m.createElement(_e,{to:`/explore/${t.slug}`},t.title?t.title:"Error: template has no title"),"."," ",m.createElement("span",null,a?"Content already added as an example.":null)),this.renderExampleActions())}}const xB=ie(i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser})),(e=>he({getTemplateFromId:hB,updateTemplateExamples:SB,showError:wh},e)))(AB)),PB="VideoAdminActions-module_container_4MuJr",RB="VideoAdminActions-module_commentingContainer_XWbs5",OB="VideoAdminActions-module_header_bI4cD",DB="VideoAdminActions-module_description_S2wc7",LB="VideoAdminActions-module_actionButton_bYMFj";const UB=ie(i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName})),(e=>he({setCurrentTemplate:uB},e)))((({history:e,currentVideo:t,projectName:a="",setCurrentTemplate:o,commentingView:n=!1})=>m.createElement("div",{className:n?RB:PB},m.createElement("div",{className:OB},"Admin actions"),m.createElement("div",{className:DB},"This section is visible only to admin accounts."),m.createElement("div",{className:LB,onClick:()=>{const{_id:n}=t,r={title:a,description:a,slug:(i=a,i.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")),video_id:n};var i;o(r);e.push("/admin/templates/update")}},"Make template"),m.createElement("div",{className:LB,onClick:()=>{const e=`/videos/${t._id}/debug`;window.open(e)}},"Visit debug page ",m.createElement(ze,null)),m.createElement("div",{className:LB,onClick:async()=>{const{readonly:e}=t;await rp(`/api/v1/videos/${t._id}`,{body:{readonly:!e}}),window.location.reload()}},"Make video"," ",m.createElement("span",null,t.readonly?"writable":"readonly")),m.createElement(xB,null))))),MB="Tabs-module_disabled_3hlv9",BB="Tabs-module_tabContainer_sBadm",WB="Tabs-module_tabHolder_tJE-a",VB="Tabs-module_tabContent_Uom4r",jB="Tabs-module_noTopPadding_WDGcj",HB="Tabs-module_tabHolderTight_Ppsr-",GB="Tabs-module_mobileCommentsTabHolder_msAg-",$B="Tabs-module_tab_HQZWB",KB="Tabs-module_selected_ZDqaU",YB="Tabs-module_tabTight_wn7EO",zB="Tabs-module_noBottomPadding_yGGq6",qB="Tabs-module_tabHeader_qEy-m",JB="Tabs-module_mobileMultiTabHeader_wMYzG",XB="Tabs-module_mobileCommentsTabHeader_CpzwJ",QB="Tabs-module_scrollShadowBottom_g315I",ZB="Tabs-module_scrollShadowTop_h0Fax",eW="Tabs-module_shadowVisible_TpuMa",tW="Tabs-module_shadowHidden_KEwuu",aW="Tabs-module_positionDefault_sYnG6",oW="Tabs-module_constrained_E4yLC",nW="Tabs-module_bottomSpacer_526LR",rW=({children:e})=>m.createElement(m.Fragment,null,e),iW=({children:e,cyPrefix:t,id:a,showOnlySelectedHeader:o=!1,tabTitles:r,disabled:s=!1,tightPadding:l=!1,mobileCommentsView:c=!1,addBottomPadding:d=!1,className:u})=>{const p=i.exports.useDispatch(),h=ed(),{selectedTabs:g,toolTip:f}=cn((e=>({selectedTabs:e.selectedTabs,toolTip:e.toolTip})),i.exports.shallowEqual),y=(null==g?void 0:g[a])||"",E=r.findIndex((e=>e===y)),_=-1===E?0:E;n.exports.useEffect((()=>{_>=r.length&&p(XS({tabId:(null==r?void 0:r[0])||"",tabContainerId:a}))}),[r,_,a,p]);const[v,w]=n.exports.useState(null),[b,S]=n.exports.useState(null),[T,I]=n.exports.useState(null),[k,C]=n.exports.useState(null);n.exports.useEffect((()=>{if(k){const e=new qe.ResizeSensor(k,(({height:e})=>{S(e),w(k.scrollTop),I(k.scrollHeight)}));return()=>{e.detach()}}return()=>{}}),[k]);let N=!1,A=!1;if(null!==v&&null!==b&&null!==T){const e=3;v+b+e<T&&(A=!0),v>e&&(N=!0)}const x=[ZB,N?eW:tW],P=[QB,A?eW:tW],R=[WB];h&&!c&&R.push(aW),l&&R.push(HB),c&&R.push(GB);const O="Subtitles"===r[_];return m.createElement("div",{className:`${BB} ${h?oW:""}`},m.createElement("div",{className:`${R.join(" ")} ${u}`},o?m.createElement("div",{className:`${$B} ${qB}`},r[_]):m.createElement(m.Fragment,null,r.map(((e,o)=>{const n=[$B];return o===_&&n.push(KB),s&&n.push(MB),l&&n.push(YB),h&&n.push(JB),c&&n.push(XB),m.createElement("div",{key:e,className:n.join(" "),onClick:()=>{s||p(XS({tabId:r[o],tabContainerId:a}))},"data-cy":`${t}-tab-${e}`},e)})))),m.createElement("div",{className:`${VB} ${c?jB:""} ${O?zB:""}`,onScroll:({currentTarget:e})=>{w(e.scrollTop),I(e.scrollHeight),f&&p(u_(""))},ref:e=>C(e)},m.Children.map(e,((e,t)=>t===_?e:null)),d?m.createElement("div",{className:nW}):null),m.createElement("div",{className:x.join(" ")}),m.createElement("div",{className:P.join(" ")}))},sW=(e,t,a,o)=>{var n;const r=e.startTime||0,i=(null==(n=e.animation)?void 0:n.duration)||e.endTime;let s;s=a?(a-r)/(i-r):0,function(e,t){if("background"!=t.progressBarStyle)return;e.fillStyle=t.backgroundStyleColor||0,e.fillRect(0,0,t.position.pixel_width,t.position.pixel_height)}(t,e),function(e,t){if("glowing"!=t.progressBarStyle)return;e.shadowColor=t.glowingStyleColor||0,e.shadowBlur=70}(t,e),function(e,t,a){switch(e.progressBarStyle){case"gradient":{const o=t.createLinearGradient(0,0,e.position.pixel_width*a,e.position.pixel_height);o.addColorStop(0,e.gradientStyleColor||0),o.addColorStop(1,e.background),t.fillStyle=o;break}default:t.fillStyle=e.background}}(e,t,s),t.fillRect(0,0,e.position.pixel_width*s,e.position.pixel_height),function(e,t,a,o){if(parseFloat(e)<=0)return;t.lineWidth=e,t.strokeStyle=a.stoke,t.beginPath(),t.moveTo(0,0),t.lineTo(a.position.pixel_width*o,0),t.stroke(),t.moveTo(0,0),t.lineTo(0,a.position.pixel_height),t.lineTo(a.position.pixel_width*o,a.position.pixel_height),t.stroke()}(o,t,e,s)};const lW=(e,t,a,o,n=D[0],r,i,s)=>{const l=e.getContext("webgl")||e.getContext("experimental-webgl");l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);const c=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,c),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,-1,4,4,-1]),l.STATIC_DRAW),l.viewport(0,0,e.width,e.height);const d=Je(l,t);d.minFilter=l.LINEAR,d.magFilter=l.LINEAR;const u=Je(l,a);u.minFilter=l.LINEAR,u.magFilter=l.LINEAR,Xe(l,n).draw(o,d,u,r,i,s)},cW=(e,t)=>!(e<0||e>64)&&(e<8?Boolean(t[0]&1<<e):e<16?Boolean(t[1]&1<<e-8):e<24?Boolean(t[2]&1<<e-16):Boolean(t[3]&1<<e-24)),dW=({blurPixels:e,image:t,createCanvas:a=((e,t)=>{const a=document.createElement("canvas");return a.width=e,a.height=t,a}),width:o,height:n})=>{if("number"!=typeof t.width||"number"!=typeof t.height)throw Error("Unexpected SVG image");const[r,i]=[o||t.width,n||t.height],s=3*e,l=a(r+2*s,i+2*s),c=l.getContext("2d");if(!c)throw Error("Failed to create canvas ctx");const[d,u,m,p,h,g,f]=[t.width,t.height,r,i,s,r+s,i+s];return c.drawImage(t,0,0,d,1,h,0,m,h),c.drawImage(t,0,u-1,d,1,h,f,m,h),c.drawImage(t,0,0,1,u,0,h,h,p),c.drawImage(t,d-1,0,1,u,g,h,h,p),c.drawImage(t,0,0,1,1,0,0,h,h),c.drawImage(t,d-1,0,1,1,g,0,h,h),c.drawImage(t,0,u-1,1,1,0,f,h,h),c.drawImage(t,d-1,u-1,1,1,g,f,h,h),c.drawImage(t,h,h,m,p),[l,s]},uW=(e,t,a,o,n,r,i,s=1)=>{e.save();let l=0;let c=a;r>1&&(c=a*r),n&&(l=t,c=a),e.globalAlpha=s||1,i&&(e.globalCompositeOperation=i);const d=e.createLinearGradient(l,0,0,c);for(let u=0;u<o.length;u+=1){const e=o[u];d.addColorStop(e.start,e.color)}e.fillStyle=d,e.fillRect(0,0,t,a),e.restore()},mW=50,pW=50,hW=159,gW=830,fW=async(e,t=0,a=null,o=[],n=!1,r="original",i=6,s=!1,l=0,c)=>{let d,u;if(c)d=c.Image,u=c.createCanvas;else{if("undefined"==typeof Image)throw Error("CanvasInterface not set.");d=Image,u=(e,t)=>{const a=document.createElement("canvas");return a.width=e,a.height=t,a}}const m="rgba(-255,-255,-255,0)",p="string"!=typeof r;try{const n=(e,t,a,o)=>{let n;if("top"===o)n=a;else n=e.height-t-a;return n},c=t=>{const a=parseFloat(Math.min(1,Math.max(t.height,t.width)/3160)),o=hW*a,r=gW*a,i=mW*a,s=pW*a,l=t.width-r-i,c=e.alignWatermark||"bottom";return[l,n(t,o,s,c),r,o]},h=async(t,a)=>{t.save();const[o,n,r,i]=c(a),s=await x(e.watermark_img,!0,r,i);t.imageSmoothingEnabled=!0,t.drawImage(s,o,n,r,i),t.restore()},g=(e,t,a)=>{let o,n;switch(e){case"wrap":o=parseInt(.7*t,10),n=a;break;case"full":o=0,n=0;break;default:o=t,n=a}return[o,t-o,n,a-n]},f=(e,t,a,o)=>{let n;switch(a){case"center":n=.5*(e.width-t);break;case"right":n=e.width-o-t;break;default:n=o}return n},y=(e,t,a)=>"wrap"===e?t-a:0,E=(e,t,a,o,n,r)=>{let i;if(["top","middle","bottom"].includes(t)){switch(t){case"top":i=r;break;case"middle":i=.5*(e.height-n);break;default:i=e.height-n-r}return i}switch(o){case"bottom":i=a*e.height-n;break;case"middle":i=a*e.height-n/2;break;default:i=a*e.height}return i<0&&(i=0),e.height-i-n<0&&(i=e.height-n),i},_=(e,t,a,o,n,r,i,s,l,c)=>{const{backgroundStyle:d,textAlign:u,textHeight:m}=t;let p,h=m,g=n+.5*m;switch(d){case"none":p=0;break;case"wrap":p=o+2*l;break;default:p=e.width}r&&(h+=c,g+=c),i&&(h+=c);const E=f(e,o,u,s+l),_=y(d,E,l),v=p||o;return{...t,position:{adjusted_x:_,adjusted_y:n,adjusted_height:h,adjusted_width:v,pixel_height:h,pixel_width:v},text:a,textWidth:o,textX:E,textY:g}},v=(t,a,o)=>{let{text:n}=o;n=n||"";let r=parseInt((o.fontSize||"18px").toString().replace("px",""),10);if(0===r){const t="9:16"===e.subtitleVideoRatio?236:320,a=e.sceneWidth/t;r=parseInt(parseInt(e.subtitlesSize,10)*a,10)}const i=r*HT(a,e,o),s="default"!==o.fontStyle?o.fontStyle:null,l="default"!==o.fontWeight?o.fontWeight:null,c=`"${o.fontFamily}", Noto Sans, Apple Color Emoji, Noto Color Emoji`,d="none"===o.textShadow?null:o.textShadow;let u=parseFloat(o.lineWidth)||0;if(d&&u){const e=.004*(t.canvas.clientHeight||t.canvas.height);u=Math.max(2,e)}const m=u?d:null,p=`${s||"normal"} normal ${l||"normal"} ${i}px/1.2 ${c}`,h=1.2*i;Object.assign(o,{font:p,textHeight:h,lineWidth:u,textShadow:m}),t.font=p,t.lineWidth=u,t.textBaseline="middle",m&&(t.strokeStyle=m);const f=.06*a.width,y=i;let[v,w,b,S]=g(o.backgroundStyle,f,y);"full"===o.backgroundStyle&&(S=.8*i);const T=a.width-2*f,I=YT({ctx:t,lines:(n||"").match(/[^\r\n]+/g)||[],pxCap:T}),k=h*I.length+2*S;let C=E(a,e.subtitlesPosition,o.fixedPosition,o.textVerticalAlign,k,b);return I.map((([e,t],n)=>{const r=_(a,o,e,t,C,0===n,n===I.length-1,v,w,S);return C+=r.position.adjusted_height,r}))},w=(e,t)=>{const{background:a,backgroundStyle:o,position:n}=t;!a||o&&!["full","wrap"].includes(o)||(e.fillStyle=a,e.fillRect(n.adjusted_x,n.adjusted_y,n.pixel_width,n.pixel_height))},b=(e,t,a)=>{const{color:o,text:n,textDirection:r}=a,{font:i,lineWidth:s,textShadow:l,textX:c,textY:d}=a;e.fillStyle=o,e.font=i,e.lineWidth=s,e.textAlign="left",e.textBaseline="middle",r&&t.setAttribute("dir",r),l&&(e.lineJoin="round",e.strokeStyle=l,e.strokeText(n,c,d)),e.fillText(n,c,d)},S=(e,t,a,o)=>{let n="";const r=t.filters,i=e.canvas.clientWidth||e.canvas.width,s=e.canvas.clientHeight||e.canvas.height;if(r)for(const l in r){switch(l){case"contrast":case"brightness":case"saturate":n+=`${l}(${r[l]/100})`;break;case"opacity":n+=`opacity(${r[l]}%)`;break;case"blur":void 0===r.blurPercent&&(n+=`blur(${parseFloat(r[l])/1e3*Math.max(i,s)}px)`);break;case"blurPercent":n+=`blur(${Math.min(a,o)*r[l]/100}px)`;break;case"blurBackground":n+=`blur(${Math.min(a,o)*r[l]/100}px)`;break}n+=" "}e.filter=n},T=(e,t,a)=>{if(a.filters.blur){const e=t.width+500,o=t.height+500,n=u(e,o),r=n.getContext("2d");S(r,a,t.width,t.height),r.drawImage(t,0,0,t.width,t.height,e/2-t.width/2,o/2-t.height/2,t.width,t.height);const i=u(t.width,t.height);i.getContext("2d").drawImage(n,e/2-t.width/2,o/2-t.height/2,t.width,t.height,0,0,t.width,t.height),t=i}else if(a.filters.blurBackground){const e=Math.min(t.width,t.height),o=a.filters.blurBackground*e/100,n=u(t.width,t.height),r=n.getContext("2d"),[i,s]=dW({blurPixels:o,image:t,createCanvas:u});S(r,a,t.width,t.height),r.drawImage(i,-s,-s,i.width,i.height),t=n}else S(e,a,t.width,t.height);return t},I=(e,t,a)=>{const{crop_x:o,crop_y:n,crop_width:r,crop_height:i,file_width:s,file_height:l,pixel_width:c,pixel_height:d,adjusted_width:u,adjusted_height:m}=t.position;if(!t.crop&&!RP(t))return{x:o,y:n,width:r,height:i};if(!RP(t))return{x:o+t.crop.x/100*e.width,y:n+t.crop.y/100*e.height,width:r,height:i};const p=OP(t),h=xP(p,a),g=PP(t.crop,h),f=s*(g.width/100),y=l*(g.height/100),E=f*c/u,_=y*d/m;return{x:g.x/100*e.width+(f-E)/2,y:g.y/100*e.height+(y-_)/2,width:E,height:_}},k=(e,t,a)=>{const o=e/255,n=t/255,r=a/255,i=Math.min(o,n,r),s=Math.max(o,n,r),l=s-i;let c;0===l?c=0:(s===o&&(c=60*(n-r)/l),s===n&&(c=60*(2+(r-o)/l)),s===r&&(c=60*(4+(o-n)/l)));return{H:c,S:0===s?0:l/s,V:s}},C=(e,t,a,o,n)=>{const{chromaKeyThreshold:r,chromaKeyHueThreshold:i,chromaKeySatThreshold:s,chromaKeyValThreshold:l,chromaKeyChannel:c}=n;if("colorKey"===c){const{H:n,S:r,V:c}=k(e,t,a),d=Math.abs(o.H-n)<i,u=Math.abs(o.S-r)<s,m=Math.abs(o.V-c)<l;return d&&u&&m}const d="green"===c?t:a,u="green"===c?[e,a]:[e,t],m=Math.max(e,t,a);if(m!==d)return!1;return m-Math.max(...u)>255-r},N=(e,t)=>{if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor===m)return e;let a;if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor){const e=parseInt(t.chromaKeyColor.slice(1,3),16),o=parseInt(t.chromaKeyColor.slice(3,5),16),n=parseInt(t.chromaKeyColor.slice(5,7),16);a=k(e,n,o)}const o=u(e.width,e.height),n=o.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let s=0;s<i.length;s+=4)C(i[s],i[s+1],i[s+2],a,t)&&(i[s+3]=0);return n.clearRect(0,0,e.width,e.width),n.putImageData(r,0,0),e=o},A=async(e,t,a)=>{const o=u(e.width,e.height),n=o.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=Buffer.from(t.mask_base64_img.split(",")[1],"base64"),i=Qe.decode(r).data,s=n.getImageData(0,0,e.width,e.height),l=s.data,c=t.maskBitValuesToKeep[a]||[],d=[4,244,4,255];for(let u=0;u<l.length;u+=4){const e=i[u],t=i[u+1],a=i[u+2],o=i[u+3];c.some((n=>cW(n,[e,t,a,o])))||(l[u]=d[0],l[u+1]=d[1],l[u+2]=d[2],l[u+3]=d[3])}return n.clearRect(0,0,e.width,e.width),n.putImageData(s,0,0),e=o},x=async(e,t=!0,a,o)=>{if(!e)throw Error("Missing image source");const n=new d(a,o);return await new Promise(((o,r)=>{n.onload=()=>o(),t&&(n.onerror=e=>{r(e)}),n.src=e,(n.complete||!a&&n.width>0)&&o()})),n},P=(e,t,a,o)=>{var n,r;const i=Buffer.from(t.split(",")[1],"base64"),s=(new DOMParser).parseFromString(i,"text/xml").documentElement,l=s.hasAttribute("width")&&!(null==(n=s.getAttribute("width"))?void 0:n.includes("100%")),c=s.hasAttribute("height")&&!(null==(r=s.getAttribute("height"))?void 0:r.includes("100%"));if(l||c)return 1;const d=e.canvas.clientHeight||e.canvas.height,u=e.canvas.clientWidth||e.canvas.width;return a/o>u/d?u/a:d/o},R=(e,t,a,o)=>{const n=t.width+1e3,r=t.height+1e3,i=u(n,r),s=i.getContext("2d"),l=a.imageShadowDist||0,c=(a.imageShadowRot||0)*Math.PI/180,d=100*l*Math.cos(c),m=100*l*Math.sin(c);return s.shadowColor=a.imageEffectColor,s.shadowBlur=50*a.imageShadowBlur,s.shadowOffsetX=d,s.shadowOffsetY=m,s.drawImage(t,o.x,o.y,o.width,o.height,50,50,a.position.pixel_width,a.position.pixel_height),e.drawImage(i,-50,-50,i.width,i.height),i},O=async(a,o,n)=>{let r;a.save(),r=await x(o.base64_img,!1),o.chromaKey&&(r=N(r,o)),o.presetFilter&&!o.preProcessed&&(r=((e,t,a)=>{if(!t.presetFilter)return e;if("Original"===t.presetFilter.name)return e;const o=t.presetFilter,n=a(e.width,e.height),r=n.getContext("2d");if(!r)return;o.background&&uW(r,e.width,e.height,o.background,o.backgroundAngle,o.backgroundGradientEnd),r.globalCompositeOperation=o.backgroundBlendMode,r.filter=o.styles,r.save(),r.globalAlpha=o.opacity,r.drawImage(e,0,0,e.width,e.height),r.restore(),o.foreground&&uW(r,e.width,e.height,o.foreground,o.foregroundAngle,o.foregroundGradientEnd,o.foregroundBlendMode,o.foregroundOpacity);const i=a(e.width,e.height),s=i.getContext("2d");return s&&(s.drawImage(e,0,0,e.width,e.height),s.globalCompositeOperation="source-in",s.drawImage(n,0,0,e.width,e.height)),i})(r,o,u)),o.filters&&(r=T(a,r,o)),o.isSieveRemoveBackground&&(r=await A(r,o,t));const i=o.position.adjusted_x,s=o.position.adjusted_y,l=i+o.position.pixel_width/2,c=s+o.position.pixel_height/2;a.translate(l,c);let d=!1,m=!1;if(o.position.flip){const{x:e,y:t}=o.position.flip,n=e?-1:1,r=t?-1:1;d=e,m=t,a.scale(n,r)}if(o.position.rotation){const{rotation:e}=o.position;let t=null;!d&&!m||d&&m||(t=360-e),a.rotate((t||e)*Math.PI/180)}a.translate(-l,-c),a.translate(i,s);const p=a.canvas.clientHeight||a.canvas.height;W_(o,e.animations)&&await j_(e.animations,o,a,n);let h=I(r,o,n);if("image/svg+xml"===o.mime||"image/svg+xml"===o.mime_type){const e=await P(a,o.base64_img,o.position.file_width,o.position.file_height);h={x:h.x*e,y:h.y*e,width:h.width*e,height:h.height*e}}else a.imageSmoothingEnabled=!0;const g=(o.objectFit||"cover").toLowerCase(),f=o.lineWidth?parseFloat(o.lineWidth)/100*p:o.lineWidth,y=o.stroke||"#000000";o.borderRadius&&"0%"!==o.borderRadius.relative&&(o.preProcessed||UT(a,o,f,y)),!g||["cover","crop"].includes(g)?("dropShadow"!==o.imageEffect||o.preProcessed||o.borderRadius&&"0%"!=o.borderRadius.relative?a.drawImage(r,h.x,h.y,h.width,h.height,0,0,o.position.pixel_width,o.position.pixel_height):R(a,r,o,h),f>0&&(!o.borderRadius||"0%"===o.borderRadius.relative)&&(a.lineWidth=f,a.strokeStyle=y,a.strokeRect(-f/2,-f/2,o.position.pixel_width+f,o.position.pixel_height+f))):a.drawImage(r,0,0,o.position.adjusted_width,o.position.adjusted_height),a.restore()},L=(e,t,a,o)=>{e.lineCap="butt";const n=3*o,r=3*o,i=2*Math.PI,s=a.length;let l,c;l=a[s-2]-a[s-4],c=a[s-1]-a[s-3];const d=(Math.atan2(c,l)+i)%i;e.fillStyle=t.stroke,e.lineCap=t.lineCap,e.lineJoin=t.lineCap,e.save(),e.beginPath(),e.translate(a[s-2],a[s-1]),e.rotate(d),e.moveTo(0,0),"open"===t.lineArrow?(e.moveTo(-r,n/2),e.lineTo(0,0),e.lineTo(-r,-n/2)):(e.lineTo(-r,n/2),e.lineTo(-r,-n/2),e.closePath(),e.fill()),e.restore(),t.pointerAtBeginning&&(e.save(),e.translate(a[0],a[1]),l=a[2]-a[0],c=a[3]-a[1],e.rotate((Math.atan2(-c,-l)+i)%i),e.moveTo(0,0),e.lineTo(-r,n/2),e.lineTo(-r,-n/2),e.closePath(),e.restore()),e.setLineDash([]),e.stroke()},U=(e,t)=>{switch(e){case"big dash":return[4*t,2*t];case"small dash":return[2*t];case"dotted":return[0,t+t/2];default:return[]}},M=(e,t,a,o,n)=>{const r=new Path2D,i=n/2,s=("vertical"===t.lineRightAngle?n:a)-i,l=("horizontal"===t.lineRightAngle?n:o)-i,c={topLeft:[i,i,s,l],topRight:[s,i,i,l],bottomLeft:[i,l,s,i],bottomRight:[s,l,i,i]}[t.linePointStartCorner||"topLeft"],[d,u,m,p]=c,h=U(t.lineStyle||"solid",n);e.setLineDash(h),r.moveTo(d,u),r.lineTo(m,p),e.lineWidth=n,e.stroke(r),t.lineArrow&&L(e,t,c,n)},F=(e,t,a,o,n,r)=>{e.save(),e.scale(o,n);const i=new Path2D(r);e.fill(i),parseFloat(t.lineWidth)>0&&(e.lineWidth=a/o,e.stroke(i)),e.restore()},B=async(t,a,o)=>{const n=a.position.pixel_width,r=a.position.adjusted_x,i=a.position.pixel_height,s=a.position.adjusted_y,{pixel_width:l,pixel_height:c}=a.position;if("placeholder"!==a.converted_type){let d=1,u=1;a.position.svg_width&&a.position.svg_height&&(d=n/a.position.svg_width,u=i/a.position.svg_height);const{lineWidth:m}=a,p=t.canvas.clientHeight||t.canvas.height,h=isNaN(m)?parseFloat(m)/100*p:m;t.save(),t.fillStyle=a.background,t.strokeStyle=a.stroke,t.lineWidth=a.lineWidth,"number"==typeof a.globalAlpha&&(t.globalAlpha=a.globalAlpha);const g=r+l/2,f=s+c/2;"ellipse"===a.shapeType?t.translate(r,s):t.translate(g,f),a.position.rotation&&t.rotate(a.position.rotation*Math.PI/180),"ellipse"!==a.shapeType?(t.translate(-g,-f),t.translate(r,s)):t.translate(-l/2,-c/2),"progressBar"!==a.shapeType&&W_(a,e.animations)&&await j_(e.animations,a,t,o),"progressBar"===a.shapeType&&W_(a,e.animations)?await sW(a,t,o,h):"rectangle"===a.shapeType?(UT(t,a,h,t.strokeStyle),t.fill()):["line","arrow"].includes(a.shapeType)?(t.lineCap=a.lineCap||"square",M(t,a,n,i,h)):"ellipse"===a.shapeType?(t.translate(l/2,c/2),t.beginPath(),t.ellipse(0,0,n/2,i/2,0,0,2*Math.PI),t.save(),t.clip(),t.fill(),t.restore(),parseFloat(m)>0&&(t.lineWidth=h,t.stroke())):a.svgData?F(t,a,h,d,u,a.svgData):a.svgChildren&&a.svgChildren.forEach((({type:e,props:o})=>{if("path"===e){const{d:e}=o;F(t,a,h,d,u,e)}else if("circle"===e){const{cx:e,cy:a,r:n}=o;t.save(),t.scale(d,u),t.beginPath(),t.arc(e,a,n,0,2*Math.PI),t.closePath(),t.stroke(),t.fill(),t.restore()}}))}else{if(t.save(),a.position.rotation){const e=r+a.position.pixel_width/2,o=s+a.position.pixel_height/2;t.translate(e,o),t.rotate(a.position.rotation*Math.PI/180),t.translate(-e,-o)}t.translate(r,s);const e=new Path2D;e.rect(0,0,n,i),t.fillStyle=a.background,t.lineWidth=1,t.strokeStyle=a.borderColor||"black",t.setLineDash([10,5]),t.fill(e),t.stroke(e),t.setLineDash([])}t.restore()},W=({ctx:e,i:t,frequency:a,x:o,y:n,width:r,height:i})=>{const s=.004*r,l=o+t*(.002*r);if(l>o+r)return;let c,d;const u=i/2,m=a/255;d=-m*i*.3,c=n+i-u,e.fillRect(l,c+1,s,d),d=m*i*.3,c=n+i-u,e.fillRect(l,c-1,s,d)},V=({ctx:e,i:t,frequency:a,x:o,y:n,width:r,height:i})=>{const s=.005*r,l=o+t*(2*s);if(l>o+r)return;const c=n+i,d=-(a/255)*i*.8;e.fillRect(l,c,s,d)},j=(e,t,a)=>{e.save(),e.fillStyle=t.color;const o=e.canvas.clientHeight||e.canvas.height,n=e.canvas.clientWidth||e.canvas.width,r=parseFloat(t.position.width)/100*n,s=parseFloat(t.position.height)/100*o,l=parseFloat(t.position.x)/100*n,c=parseFloat(t.position.y)/100*o,d=parseInt(a,10),u=Math.floor(d/i),m=r,p=t.fft_data||[];let h;if("audiogramFrameData"in p)h=p.audiogramFrameData;else if(h=p[u],!h){const e=Object.values(p);h=e[e.length-1]}for(let i=0;i<m;i++){const a={ctx:e,i:i,frequency:h&&h[i]?h[i]:0,x:l,y:c,width:r,height:s};"wave"===t.waveformStyle?W(a):"bar"===t.waveformStyle&&V(a)}e.restore()},H=async(t,a,o,n,r)=>{const i=o.converted_type||o.type;let c=n/r;switch(s&&(c=l),i){case"text":await iI(t,o,c,HT(a,e,o),e.animations);break;case"placeholder":case"progressBar":case"shape":await B(t,o,c);break;case"subtitle":v(t,a,o).forEach((e=>{w(t,e),b(t,a,e)}));break;case"audio":o.isAudiogram&&await j(t,o,n);break;default:await O(t,o,c)}};let G;p?G=r:(document.body.style.margin="0px",G=document.getElementById(r),G.width=e.adjusted_width,G.height=e.adjusted_height);const $=G.getContext("2d",{alpha:!0});$.imageSmoothingEnabled=!1;const K=e.sceneBackground===m,Y=["gif","image","webp"].includes(e.videoType);if(!K||e.sceneDuration&&!Y?($.fillStyle=K?"#ffffff":e.sceneBackground,$.fillRect(0,0,G.width,G.height)):$.clearRect(0,0,G.width,G.height),a){const e=await x(a);$.drawImage(e,0,0,G.width,G.height)}const z={},q=e.animations&&e.animations.byId?Object.values(e.animations.byId).filter((e=>D.map((({name:e})=>e)).includes(e.animationName))):[];for(let a=0;a<q.length;a++){const n=q[a],r=e=>{const t=o.findIndex((t=>t.id===e));return[t,t>=0?o[t]:null]},i=([e,{animation:t,...a}])=>[e,a],{introLayerId:s,outroLayerId:l,animationName:c}=n,d=D.find((e=>e.name===c)),m=[r(l),r(s)];if(null==t||!m.some((e=>e[1])))continue;let p,h,g=-1,f=-1,y=0,E=H_(n,e.animations);if(m[0][1])if(m[1][1]){[[f,h],[g,p]]=m.map(i),y=ei(p).start;E=ei(h).end-y}else{[f,h]=i(m[0]);y=ei(h).end-E;const a=(t/e.maxFramerate-y)/E;if(a<0||a>1)continue}else{[g,p]=i(m[1]),y=ei(p).start;const a=(t/e.maxFramerate-y)/E;if(a<0||a>1)continue}const _=Math.max(f,g),v=t/e.maxFramerate,w=u(G.width,G.height),b=u(G.width,G.height),S=u(G.width,G.height),T=w.getContext("2d",{alpha:!0});T.imageSmoothingEnabled=!1;const I=S.getContext("2d",{alpha:!0});I.imageSmoothingEnabled=!1;const k=(v-y)/E;k<0||k>1||(h&&h.base64_img&&await H(T,w,h,t,e.maxFramerate),p&&p.base64_img&&await H(I,S,p,t,e.maxFramerate),lW(b,w,S,k,d,G.width,G.height,{}),z[_]=b)}let J=!1;for(let a=0;a<o.length;a++){const n=o[a];if("audio"===n.converted_type&&!n.isAudiogram)continue;"subtitle"!==n.type&&!n.isMagicSubtitle||J||(J=!0,e.watermark&&await h($,G));const r=e.sceneDuration||0;if(null!=t&&e.maxFramerate&&r&&!ri(n,t,{duration:r,maxFramerate:e.maxFramerate}))continue;if(s&&r>0&&!ii(n,l,{duration:r}))continue;await H($,G,n,t,e.maxFramerate);const i=z[a];i&&$.drawImage(i,0,0,G.width,G.height)}e.watermark&&!J&&await h($,G);const X=`image/${e.frameExt||"png"}`;return s?G:G.toDataURL(X,1)}catch(h){throw console.error("Failed to draw canvas",h.toString()),h}},yW=async(e,t,a="First Trim")=>{let{name:o}=e;const n=[e.startTime||0,e.endTime||e.duration];o||(o="input.mp4");const r={},i=n[1]-n[0];if(i<=0)throw new Error("Bad duration, sending to backend");r.trimsDuration=i,r.buildType="fixed memory";try{r.status="Initializing";const s=new MS,c=Date.now();await s.initialize();const d=Date.now(),u=(e=>{let t=e.replaceAll(" ","");return"mp4"!==t.split(".").pop()&&(t=`${t.split(".")[0]}.mp4`),t})(o),m=`trimmed-${y()}-${u}`;let p={},h="";const g=window.navigator.hardwareConcurrency;if("First Trim"===a&&e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate)r.trimType="Quick Trim",h=EW(u,m,n,g);else if(e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate||"First Trim"!==a){if(!("Slow Trim Mismatched Duration"===a&&i<=60))throw new Error("Quick trim failed and duration >1min, send to backend");r.trimType="Slow Trim after Quick Trim",h=_W(u,m,n,g)}else r.trimType="Slow Trim Mismatched Framerate",h=_W(u,m,n,g);if(r.command=h,p=await s.runCommandOnFile(h,t,u,m,"clientSideTrim"),!p)throw new Error("no output blob");r.status="Finished running command";const f=Date.now();if(r.status="Read output file",r.initTime=(d-c)/1e3,r.timeToRunCommand=(f-d)/1e3,r.newVideoDuration=await $w(p),r.durationsMatch=Math.abs(r.newVideoDuration-i)<=.5,!r.durationsMatch){if("First Trim"===a&&r.newVideoDuration<=60)return await yW(e,t,"Slow Trim Mismatched Duration");throw new Error("Slow trim failed and duration > 60, send to backend")}return r.browser=(new l.exports.UAParser).getBrowser(),r.device=(new l.exports.UAParser).getDevice().type,r.hardwareConcurrency=navigator.hardwareConcurrency,r.origVideoDuration=i,r.origVideoHeight=e.height,r.origVideoWidth=e.width,r.origVideoSize=e.size,{outputBlob:p,ffmpegData:r}}catch($ae){throw r.error=$ae,$ae}},EW=(e,t,a,o)=>`-ss ${a[0]} -i ${e} -t ${a[1]-a[0]} -c copy -threads ${o/2} ${t}`,_W=(e,t,a,o)=>`-ss ${a[0]} -i ${e} -t ${a[1]-a[0]} -threads ${o/2} ${t}`,vW=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]],wW=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]];function bW(){const{state:e}=io(),t=(e.isStudio?e.studio.duration:e.duration)>7200,a=Du({team:Bu()},au.UNLIMITED_EXPORT_DURATION_LIMIT);return t&&a}function SW(){var e;const{state:t}=io(),a=Bu(t),o=t.isStudio?t.studio.duration:t.duration,n=(null==(e=null==a?void 0:a.limits)?void 0:e.cumulativeExportDuration)||0;let r;r=t.isStudio?TW(t.studio.scenes)||o>420||n+o>10800:t.sourceVideo.size>262144e3||o>420||n+o>10800;const i=Du({team:Bu()},au.UNLIMITED_EXPORT_DURATION_LIMIT);return r&&!i}function TW(e){for(const t of e)for(const e of t.layers)if(kW(e))return!0;return!1}function IW(e){const t=[];for(const a of e)for(const e of a.layers)kW(e)&&t.push(e);return t}function kW(e){const{state:t}=io(),{assets:a}=t,o=a.byId[e.asset_id||""];return(e.size||(null==o?void 0:o.size)||(null==o?void 0:o.file_size)||0)>262144e3&&!("recordType"in e&&null!=e.recordType)}let CW={};let NW={};function AW(){return{lastUsed:CW,assetSizes:NW}}async function xW(e){const t=Ob.get("asset_last_used",{disabled:null});t&&"object"==typeof t&&(CW=t);const a=Ob.get("asset_sizes",{disabled:null});a&&"object"==typeof a&&(NW=a),Object.keys(NW).forEach((t=>{e.includes(t)||delete NW[t]})),Object.keys(CW).forEach((t=>{e.includes(t)||delete CW[t]})),e.forEach((e=>{NW[e]=NW[e]||0})),Ob.set("asset_sizes",NW)}function PW(e){const t=Date.now();for(const a of e)CW[a]=t;Ob.set("asset_last_used",CW)}function RW(e,t){const a=t?function(e){try{return ks(e)?function(e){var t,a,o,n;return((null==(t=e.file_v2)?void 0:t.file.size)||0)+((null==(a=e.optimizedPreviewFile_v2)?void 0:a.file.size)||0)+((null==(o=e.waveformData_v5)?void 0:o.file.size)||0)+((null==(n=e.thumbnail)?void 0:n.size)||0)}(e):function(e){return e.type===xr.Audio}(e)?function(e){var t;return e.file.size+((null==(t=e.waveformData_v5)?void 0:t.file.size)||0)}(e):function(e){return e.type===xr.Image}(e)?function(e){return e.file.size+e.thumbnail.size}(e):0}catch(t){return console.error(t),j(t),0}}(t):0;a?NW[e]=a:delete NW[e],Ob.set("asset_sizes",NW)}"undefined"!=typeof window&&(window.getMediaCache=()=>({assetSizes:NW,lastUsed:CW}));async function OW(e,t,a){return new Promise((o=>{const n=async()=>{e.removeEventListener("seeked",n),t.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height);const a=await async function(e){return new Promise((t=>{e.toBlob((e=>t(e)),"image/jpeg",.6)}))}(t);return o(a)};e.addEventListener("seeked",n),e.currentTime=a}))}async function DW(e,t,a){const[o,n,r]=await Promise.all([e,t,a].map((e=>e?async function(e){return new Promise((t=>{const a=document.createElement("video");a.crossOrigin="anonymous",a.preload="auto",a.addEventListener("loadeddata",(async()=>{const{duration:e}=a,o=document.createElement("canvas"),n=a.videoHeight,r=a.videoWidth,i=n/r;o.width=200,o.height=200*i;const[s,l]=await Promise.all([await Qk(a),await OW(a,o,0)]);t({duration:e,height:n,width:r,thumbnail:l,hasAudio:s})})),a.src=e,a.load()}))}(URL.createObjectURL(e)):Promise.resolve(void 0))));return{...o&&{file_v2:{file:e,duration:o.duration,width:o.width,height:o.height,hasAudio:o.hasAudio}},...n&&{optimizedPreviewFile_v2:{file:t,duration:n.duration,width:n.width,height:n.height,hasAudio:n.hasAudio}},...r&&{trackOptimizedPreviewFile_v2:{file:a,duration:r.duration,width:r.width,height:r.height,hasAudio:r.hasAudio}},thumbnail:(null==o?void 0:o.thumbnail)||(null==n?void 0:n.thumbnail)||(null==r?void 0:r.thumbnail),thumbnailSource:(!(null==o?void 0:o.thumbnail)?!!(null==n?void 0:n.thumbnail)&&"preview":"original")||!!(null==r?void 0:r.thumbnail)&&"thumbnail"}}"undefined"!=typeof window&&(window.idbCache||(window.idbCache={}));const LW=new Map;let UW=1e3;const MW={};function FW(e,t){Object.values(MW[e]||{}).forEach((e=>e(t)))}function BW(e,t){MW[e]||(MW[e]={});const a=(UW+=1,UW);MW[e][a]=t;const o=window.idbCache[e];return o?"complete"===o.status?t(o.asset):o.subscribers.push(t):zW(e).then((e=>{e&&t(e)})),()=>{delete MW[e][a]}}function WW(e,t){let a=LW.get(e);return a||(a=new at,LW.set(e,a)),a.runExclusive(t)}async function VW(e){try{await(await aV).delete("pendingConversions",e)}catch{}}async function jW(){let e=[];try{e=await(await aV).getAll("pendingConversions")}catch{}return e}async function HW(e,t,a,o,n){try{await(await aV).add("pendingConversions",{name:a,mediaLibraryID:y(),conversion_id:e,id:t,uploadId:o,cmlFileId:n})}catch{}}async function GW(e,t,a){return WW(e,(async()=>{try{const{idbCache:o}=window,n=await(await aV).get("assets",e);if(!n)return void console.error(`Could not find asset ${e}`);const r={...n,...t};if("video"===n.type&&a){const e=e=>{switch(e){case"original":return 3;case"preview":return 2;case"track":return 1;default:return 0}},t=await DW(a.original,a.preview,a.track),o={file_v2:n.file_v2,optimizedPreviewFile_v2:n.optimizedPreviewFile_v2,trackOptimizedPreviewFile_v2:n.trackOptimizedPreviewFile_v2,thumbnail:n.thumbnail,thumbnailSource:n.thumbnailSource},i=e(t.thumbnailSource)>e(o.thumbnailSource)?t:o,s={...o,...t,thumbnail:i.thumbnail,thumbnailSource:i.thumbnailSource};Object.assign(r,s)}await(await aV).put("assets",r),o[e].asset=r,FW(e,r),RW(r.mediaLibraryID,r)}catch{}}))}async function $W({mediaCacheId:e,type:t,file:a,optimizedPreviewFile:o,trackOptimizedPreviewFile:n}){return WW(e,(async()=>{var r;const{state:i,dispatch:s}=io(),l=null!=(r=i.currentUser.user._id)?r:"anonymous";window.idbCache[e]||(window.idbCache[e]={subscribers:[],status:"pending"});try{if(await(await aV).get("assets",e))return!1;if(t===xr.Video){if(!(a||o||n))throw Error("Did not receive a valid file during idbAddAsset");const t={...await DW(a,o,n),mediaLibraryID:e,timestamp:new Date,user_id:l,type:xr.Video};await(await aV).add("assets",t),window.idbCache[e].asset=t,window.idbCache[e].status="complete",FW(e,t),RW(t.mediaLibraryID,t)}else if(t===xr.Image){const t=()=>new Promise((e=>{const t=new Image;t.onload=()=>{e({width:t.width,height:t.height})},t.src=URL.createObjectURL(a)})),{width:o,height:n}=await t(),r={file:a,mediaLibraryID:e,timestamp:new Date,user_id:l,height:n,width:o,type:xr.Image,thumbnail:a};await(await aV).add("assets",r),window.idbCache[e].asset=r,window.idbCache[e].status="complete",FW(e,r),RW(r.mediaLibraryID,r)}else{if(t!==xr.Audio)throw window.idbCache[e].status="failed",FW(e,null),new Error(`IDB.addAsset. File type not supported: ${a.type} (layer type was ${t})`);{const t=await $w(a);if(void 0===t)throw new Error("Unable to get audio duration");const o={file:a,mediaLibraryID:e,timestamp:new Date,user_id:l,duration:t,type:xr.Audio};await(await aV).add("assets",o),window.idbCache[e].asset=o,window.idbCache[e].status="complete",FW(e,o),RW(o.mediaLibraryID,o)}}s(qs([e]))}catch($ae){return console.error($ae),window.idbCache[e].status="failed",FW(e,null),Math.random()<.2&&j($ae),!1}return!0}))}async function KW(e){return WW(e,(async()=>{try{const{idbCache:t}=window;delete t[e],await(await aV).delete("assets",e),RW(e,null);const{state:a,dispatch:o}=io(),{idbAssetIds:n}=a.studioLocal;if(null===n)return;o({type:"REMOVE_IDB_ASSET_ID",idbAssetId:e})}catch{}}))}async function YW(){try{window.idbCache={},await(await aV).clear("assets"),NW={},Ob.set("asset_sizes",NW);const{dispatch:e}=io();e({type:"CLEAR_IDB_ASSET_IDS"})}catch(e){console.error(e)}}async function zW(e){let t;const{idbCache:a}=window,o=a[e];if(o&&"complete"===o.status)t=o.asset;else if(o&&"pending"===o.status)t=await new Promise((e=>{o.subscribers.push(e)}));else{a[e]={subscribers:[],status:"pending"};try{t=await Xc(7e3,(await aV).get("assets",e)),t?(a[e].status="complete",a[e].asset=t):a[e].status="failed"}catch($ae){a[e]&&(a[e].status="failed")}finally{a[e].subscribers.forEach((e=>{e(t)})),a[e].subscribers=[]}}return t}async function qW(){let e=[];try{e=await(await aV).getAllKeys("assets")}catch{}return e}async function JW(){let e=[];try{e=await(await aV).getAll("assets")}catch{}return e}async function XW(e,t,a){await(await aV).add("thumbnails",{mediaLibraryID:e,frameTime:t,imageData:a})}async function QW(e,t,a){let o;const n=IDBKeyRange.bound([e,t],[e,a]);try{const e=await(await aV).getAllFromIndex("thumbnails","mediaLibraryID+frameTime",n);if(!e.length)return;let r=0,i=e.length-1;const s=(a+t)/2;for(;r<i-1;){const t=Math.floor((i+r)/2);s<=e[t].frameTime?i=t:r=t}const l=Math.abs(e[r].frameTime-s);o=Math.abs(e[i].frameTime-s)<l?e[i]:e[r]}catch(r){console.error(r)}return o}function ZW(e){const[t,a]=n.exports.useState(null);return n.exports.useEffect((()=>{if(!e)return a(null),()=>{};return BW(e,(e=>{e&&a(e)}))}),[e]),(null==t?void 0:t.mediaLibraryID)!==e?null:t}function eV(e,t){var a,o;if("video"!==e.type)return e.file;if(!t)return(null==(a=e.file_v2)?void 0:a.file)||(null==(o=e.optimizedPreviewFile_v2)?void 0:o.file);const[n]=t.map((t=>{var a,o,n;switch(t){case"original":return null==(a=e.file_v2)?void 0:a.file;case"preview":return null==(o=e.optimizedPreviewFile_v2)?void 0:o.file;case"track":return null==(n=e.trackOptimizedPreviewFile_v2)?void 0:n.file;default:return null}})).filter((e=>!!e));return n}function tV(e,t){if("audio"===e.type)return{duration:e.duration};if("video"!==e.type)return null;let a=null;return t?[a]=t.map((t=>{switch(t){case"original":return e.file_v2;case"preview":return e.optimizedPreviewFile_v2;case"track":return e.trackOptimizedPreviewFile_v2;default:return null}})).filter((e=>!!e)):a=e.file_v2||e.optimizedPreviewFile_v2,{duration:null==a?void 0:a.duration,height:null==a?void 0:a.height,width:null==a?void 0:a.width}}let aV;function oV(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let a=0;a<8;a+=1)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function nV(){const{history:e}=io(),{pathname:t}=e.location;return t.match(/studio\/editor$/)||t.includes("upload")||t.includes("replace")||t.includes("mediaLibrary")||t.includes("search")||t.includes("emoji")||t.includes("remove-background")||t.includes("plugins")}"undefined"!=typeof window&&(aV=Xc(5e3,(async()=>{try{await Ze();return await et("kapwing",6,{upgrade(e,t){t<=0&&e.createObjectStore("assets",{keyPath:"pathname"}),t<=1&&(e.objectStoreNames.contains("assets")&&e.deleteObjectStore("assets"),e.createObjectStore("assets",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingConversions",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingUploads",{keyPath:"mediaLibraryID"})),t<=2&&e.createObjectStore("thumbnails",{autoIncrement:!0}).createIndex("mediaLibraryID+frameTime",["mediaLibraryID","frameTime"]),t<=3&&e.createObjectStore("pendingDownloads",{keyPath:"mediaLibraryID"}),t<=4&&e.objectStoreNames.contains("pendingUploads")&&e.deleteObjectStore("pendingUploads"),t<=5&&e.objectStoreNames.contains("pendingDownloads")&&e.deleteObjectStore("pendingDownloads")},async blocked(){await tt("kapwing")},async blocking(){await tt("kapwing")}})}catch(e){throw"InvalidStateError"===e.name&&"string"==typeof e.message&&e.message.includes("A mutation operation was attempted on a database that did not allow mutations")&&(e.__SKIP_SENTRY=!0),e}})()),aV.catch((function(e){console.error(e);const{dispatch:t}=io();t(oT())})));const rV=e=>{const{state:t}=io(),a=Du({team:Bu(t)},au.UNLIMITED_UPLOAD_SIZE_LIMIT),o=Du({team:Bu(t)},au.UNLIMITED_EXPORT_DURATION_LIMIT);!kW(e)||a||ld(e.id)?"duration"in e&&e.duration&&e.duration>420&&!o&&!ld(e.id)&&fm("Paywalled Upload",{"Upload Type":e.type,Duration:e.duration}):fm("Paywalled Upload",{"Upload Type":e.type,"File Size":e.size})},iV=()=>({id:y()}),sV=async(e,t,a)=>{var o,n;const{state:{currentUser:{user:{_id:r}}}}=io(),{name:i,size:s,type:l,recordType:c}=e,d=URL.createObjectURL(e),u=await oC(d,e),m=u?u.type:t.type;if(!m)throw Error("Could not identify media type");const p={videoDelay:0};if(null==a?void 0:a.addAtSeeker){const e=ic(),{scenes:t,selectedSceneIndex:a}=io().state.studio;p.videoDelay=e-mn(t,a)}const h={...iV(),name:i,size:s,mime:l,...c&&{recordType:c},fileSizeChecked:!1,local_url:d,source:"local",objectFit:"cover",...t,...u,type:m,...(null==a?void 0:a.addAtSeeker)&&p,uploaderId:r};return"video"===(null==u?void 0:u.type)&&(h.startTime=null!=(o=t.startTime)?o:0,h.endTime=null!=(n=t.endTime)?n:u.duration),h},lV=async(e,t,a)=>{var o,n;const r=Rd(t),i=await zW(r);let s;if(i&&"video"===i.type){const e=null!=(o=i.optimizedPreviewFile_v2)?o:i.file_v2;e&&(s={duration:e.duration,hasAudio:e.hasAudio,width:t.width||e.width,height:t.height||e.height,type:i.type})}if(!s){const o={name:t.name,type:null!=(n=t.mime)?n:void 0};s=(null==a?void 0:a.mediaInfo)?a.mediaInfo:await oC(e,o)}const l=(null==a?void 0:a.overwriteLayerType)||(null==s?void 0:s.type)||t.type;if(!l)throw Error("Could not identify media type");return{...iV(),url:e,name:oV(),source:"upload",objectFit:"cover",...t,...s,type:l}},cV=(e,t)=>{var a,o;const{selectLayerInCreator:n=!1,sceneId:r="",currentVideo:i={},layerToReplace:s,newTimeline:l=!1,knownTimelineRow:c=!1,multiRowUploadForRecording:d=!1,singleFileUpload:u=!1,selectedGroupId:m=""}=t||{},{state:p}=io(),h=!0;if(!(null==(a=null==p?void 0:p.currentUser)?void 0:a.token)&&(e.wasUploadedAnonymously=!0),!e.originalName&&e.name&&(e.originalName=e.name),e.requireConversion)return((e,t,a,o)=>{const{dispatch:n}=io(),r={position:null,...e};rV(r);const i=a;return r.position=Pc(r),iR(r),["convert","fit-video","resize"].includes(e.origin)||n(Is({id:r.id,type:"layer"})),e.isMediaLibraryUpload||(o&&n(Zi(o,"handleUploadRequiringConversion")),hR(r,{sceneId:i})),"resize"===e.uploadLocation&&(r.lockAspectRatio=!0),t&&nV()&&["pastedLink","local"].includes(e.source)&&"oneoff-landing-page"!==e.origin&&$l(),r})(e,n,r,s);!["pastedLink","local"].includes(null!=(o=e.source)?o:"")&&e.local_url&&e.metadataGathered&&!EV(e)||rV(e),"image"!==e.type&&"isMuted"in i&&(e.isMuted=!0);const g=d||u;return s||e.isMediaLibraryUpload||!g||iR(e),s?gR(e,s,{knownTimelineRow:c,newTimeline:l,sceneId:r,undoable:h}):e.isMediaLibraryUpload||hR(e,{knownTimelineRow:c,newTimeline:l,sceneId:r,undoable:h}),(e=>{const{dispatch:t}=io();t(ds(e,{fileSizeChecked:!0}))})(e),((e,t,a)=>{const{dispatch:o,history:n}=io(),{pathname:r}=n.location;r.includes("/upgrade")||(t&&nV()||"oneoff-landing-page"===e.origin?(o(Is(a?{id:a,type:"group"}:{id:e.id,type:"layer"})),"oneoff-landing-page"===e.origin||r.includes("/studio/editor")?(r.includes("/overlay/upload")||r.includes("/overlay/library")||r.includes("/overlay/search")||r.includes("/overlay/projects")||r.includes("/overlay/emojis")||r.includes("/plugins")||r.includes("/drag-upload")||r.includes("/replace")||r.includes("/mediaLibraryUpload"))&&$l():$l()):"resize"!==e.uploadLocation&&"fit-video"!==e.uploadLocation&&"convert"!==e.uploadLocation||$l())})(e,n,m),e},dV=e=>{const{dispatch:t}=io(),a={};return Lw.forEach((t=>{t in e&&(a[t]=e[t])})),t(function(e,t){return{type:"UPDATE_UPLOADED_LAYER",layer:e,properties:t}}(e,a)),e},uV=(e,t)=>{let a=0;for(const o of e){if(o.id===t)break;a+=o.duration}return a},mV=e=>`${(e/1e6).toFixed(1)}MB`;function pV(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:a=101,gather_assets:o=101,uploading_converted:n=101}={}}=e;let r=null;if(t<100)r=`Uploading ... ${t}%`;else if(o<100)r="Getting Assets ... ";else if(a<100)r=`Converting ... ${a}%`;else if(n<100)r="Uploading ... ";else if(e.uploadManager&&gC(e.uploadManager.layer))return"Converting ... ";return r}function hV(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:a=101,gather_assets:o=101,uploading_converted:n=101}={}}=e;let r=null;return t<100?r=t:o<100?r=o:a<100?r=a:n<100&&(r=n),r}function gV(){return function(){const{state:e}=io(),{scenes:t,background:a}=e.studio;return!("rgba(-255,-255,-255,0)"!==a&&!t.find((e=>"rgba(-255,-255,-255,0)"===e.background)))}()?"png":"jpeg"}const fV=e=>{let t,a=0;for(const o of e){if(!["audio","video"].includes(o.type))continue;const e=ti(o);e>a&&(t=o,a=e)}return t},yV=(e,t,a)=>{const o=e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t};return`#${o(e)}${o(t)}${o(a)}`.toUpperCase()},EV=e=>{const{state:t}=io(),a=IE(e.id,t.studio);return!(null==a?void 0:a.position)||Object.keys(a.position).some((e=>{const t=e,o=a.position[t];return"string"==typeof o&&o.includes("NaN")}))},_V=/[\uFFE5\u3000-\u303F!.,:?;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]$/,vV=e=>_V.test(e),wV=[".","!","?"],bV=e=>wV.some((t=>e.endsWith(t))),SV=Intl&&Intl.Segmenter;function TV(e){let t=0,a=0;for(const o of e)IV(o)||(o.includes(" ")?t+=1:a+=1);return t>=a?" ":""}const IV=e=>/^\s*$/.test(e);function kV({locale:e,text:t}){if(!e||!SV)return t.split(/\s/);const a=new Intl.Segmenter(e,{granularity:"word"}).segment(t),o=[];let n="",r=!0;function i(e){o.length>0&&!r?o[o.length-1]+=e:o.push(e)}function s(){n.length>0&&(i(n),n="")}for(const{segment:l,isWordLike:c}of a)IV(l)?(s(),r=!0):c?(n?(i(n+l),n=""):o.push(l),r=!1):n+=l;return s(),o}const CV=16,NV=e=>e?vV(e.word)?.5:1:.5,AV=(e,t)=>e.reduce(((e,a,o)=>e+a.width+(o?t:0)),0);function xV({shouldStartNewFrame:e,shouldStartNewRow:t,separator:a,words:o}){const n=[];function r(o){if(0===o.length)return;let r=[o];const i=n[n.length-1];if(i){const s=i.flat(),l=s[s.length-1],c=vV(l.word),d=s.length>1,u=o[0][0].start_time-l.end_time>NV(l);if(d&&!c&&!u){const s=i.flat(),l=o.flat();for(let e=s.length-1;e>=0;e-=1){const t=s[e];if(vV(t.word))break;s.splice(e,1);if(AV(s,a.width)<=AV([t,...l],a.width)){s.push(t);break}l.unshift(t)}const[c]=xV({words:s,shouldStartNewFrame:e,shouldStartNewRow:t,separator:a});n[n.length-1]=c;r=xV({words:l,shouldStartNewFrame:e,shouldStartNewRow:t,separator:a})}}n.push(...r)}let i=[],s=0;const l=[...o],c=l.length;for(;l.length>0;){if(l.length>c)throw Error();const o=l.shift();if(!o)throw Error();const n=i.flat(),d=i[s]?AV(i[s],a.width):0,u=n[n.length-1],m=u?u.end_time:0,p=o.width+a.width;let h=!1;const g=o.start_time-m>NV(u),f=n.length>4&&bV(u.word);(g||f||o.forceBreak)&&(h=!0);const y=[...i[s]||[],o].map((e=>e.word)).join(a.text);i[s]&&t({newRowWidth:d+p,newText:y})&&(s+=1,e({rowCount:s})&&(h=!0));let E=!0;if(h&&i.length){s=0;let c=i;if(!vV(u.word)){if(n.some((e=>vV(e.word)))){const r=T.findLastIndex(n,(e=>vV(e.word))),i=n.slice(0,r+1),s=[...n.slice(r+1),o];[c]=xV({words:i,shouldStartNewFrame:e,shouldStartNewRow:t,separator:a}),l.unshift(...s),E=!1}}r(c),i=[],s=0}E&&(i[s]||(i[s]=[]),i[s].push(o))}return i.length>0&&r(i),n}const PV={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontSizeRatio:.05625,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textShadow:"#000000",textVerticalAlign:"bottom",updateSubtitlePosition:"8b2d8a0b-5a7c-43bc-82c2-17aab67d96c1"};function RV(e,t){const{id:a,duration:o}=t;if(void 0===o)throw Error("Cannot transcribe asset with no duration");const n={id:a,asset_id:t.asset_id,type:"video",videoDelay:0,startTime:0,endTime:o,duration:o,url:t.url};return{_id:e,isStudio:!0,scenes:[{background:"#ffffff",duration:o,id:y(),layers:[n],subtitle:PV,userSelectedDuration:0,userSetDuration:!1}],duration:o}}function OV(e,t){const{fontSize:a,lineHeight:o}=e,n=e.frame.lines.reduce(((e,t)=>Math.max(e,t.width)),0),r=e.frame.lines.length,i=a*r+(o-1)*a*r,{y:s}=t,l=Math.max(n-t.width,0);let c=t.x-l/2,d=Math.max(n,t.width);return d+=.5,c+=.25,{x:c,y:s,xDiff:l,width:d,height:i,rotation:t.rotation}}function DV(e,t){const a=t?t[e._id]:null;if(!((null==a?void 0:a.enabled)||!1))return null;const o=e.transcriptionIds;if(!o)return null;const n=Object.values(o).filter((e=>!e.result))[0];return n?n.job:null}function LV(e,t){return e.map((e=>({id:y(),words:e.flat(1).map((e=>"simple"===t?{text:e.word,styles:e.styles}:{end:e.end_time,start:e.start_time,text:e.word,styles:e.styles})),start:e[0][0].start_time,end:e[e.length-1][e[e.length-1].length-1].end_time})))}function UV(e){const t=TV(e.map((e=>e.text)));return e.map((e=>{const a=e.text.split(t).map((e=>({text:e})));return{id:y(),start:e.start,end:e.end,words:a}}))}let MV=null,FV=null,BV=null;const WV={};function VV(e,t,a){const o=function(e,t){if(FV!==e&&(BV=null,MV=null,FV=e),MV||(MV=document.createElement("canvas"),BV=MV.getContext("2d"),MV.width=800,MV.height=500),!BV)throw Error("Missing ctx");const a=[e.fontWeight,`${t}px`,e.fontFamily.fontFamily].filter((e=>!!e)).join(" ");return BV.font=a,BV}(t,a);return o.measureText(e).width}function jV(e,t,a,o){const n=`${e}_${a}_${o}_${(e=>JSON.stringify(e))(t)}`;if(!WV[n]){if(Object.keys(WV).length>=15){const[[e]]=Object.entries(WV).sort(((e,t)=>e[1].lastUpdated-t[1].lastUpdated));delete WV[e]}WV[n]={lastUpdated:Date.now(),widths:new Map,styleHash:n,scaledFontSize:a}}return WV[n].lastUpdated=Date.now(),WV[n]}const HV="/assets/waveform.86d6820a.png";function GV({asset:e,fallback:t,timelineLayer:a,uploadingLayer:o,cmlFile:n}){return n&&n.fileName?n.fileName:e&&e.name?e.name:o&&o.name?o.name:(null==a?void 0:a.name)?a.name:e&&e.blob_name?e.blob_name:t}function $V({asset:e,uploadingLayer:t}){var a;return e&&e.metadata_stage&&"number"==typeof e.duration?e.duration:t&&"image"!==t.type&&null!=(a=t.duration)?a:null}function KV({asset:e,framePercentage:t=0,idbAsset:a,timelineLayer:o}){var n,r;if(e&&(null==(n=e.content_type)?void 0:n.startsWith("audio")))return"/assets/waveform.86d6820a.png";const i=null==o?void 0:o.type;if(e&&e.url&&((null==(r=e.content_type)?void 0:r.startsWith("image"))||"image"===i)&&!e.conversion_id)return e.url;if(e&&e.metadata_stage&&e.thumbnails){const a=Math.round(t*(e.thumbnails.length-1));return function(e,t={}){const{bucket:a=co}=t;return a===co?`${po}/${e}`:`https://cdn.kapwing.com/${e}`}(e.thumbnails[a],{bucket:e.bucket_name})}return a&&"thumbnail"in a&&a.thumbnail?URL.createObjectURL(a.thumbnail):e&&e.pasted_link_thumbnail?e.pasted_link_thumbnail:null}function YV(e){var t;return(null==(t=e.original_asset)?void 0:t.asset_id)||e.asset_id}const zV=r((e=>e.studio.magicSubtitles),(e=>e.studio.scenes[0].layers),((e,t)=>{const a=new Set(t.map(YV));return Object.entries(e||{}).filter((([e,t])=>!!t&&(!!t.enabled&&a.has(e)))).map((e=>e[0]))})),qV=(e,t,a)=>{var o,n,r,i;return(null==(n=null==(o=(e.studioLocal.magicSubtitles||{})[t])?void 0:o.position)?void 0:n[a])||(null==(i=null==(r=(e.studio.magicSubtitles||{})[t])?void 0:r.position)?void 0:i[a])||0},JV=e=>r((t=>qV(t,e,"widthPct")),(t=>qV(t,e,"heightPct")),(e=>e.studio.height),(e=>e.studio.width),((e,t,a,o)=>{const n={height:a,width:o},{width:r,height:i}=vc(e,t,n);return{width:r,height:i}})),XV=e=>r((e=>e.studio.magicSubtitles),(e=>e.studioLocal.magicSubtitles),(e=>e.studio.height),(e=>e.studio.width),(e=>e.studio.canvasX),(e=>e.studio.canvasY),((t={},a={},o,n,r,i)=>{var s;const l={height:o,width:n,x:r,y:i},c=t[e];if(!c)return null;const d={...c.position,...null==(s=a[e])?void 0:s.position},{x:u,y:m}=Ec(d.xPct,d.yPct,l),{width:p,height:h}=vc(d.widthPct,d.heightPct,l);return{x:u,y:m,width:p,height:h,rotation:d.rotation}})),QV=e=>r((e=>e.studio.magicSubtitles),(e=>e.studioLocal.magicSubtitles),((t,a)=>{var o,n;const r=null==(o=(t||{})[e])?void 0:o.style,i=(null==(n=(a||{})[e])?void 0:n.style)||{};if(!r)return null;const s={...r};return Object.assign(s,i),s})),ZV=e=>r((t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.languageKey}),(t=>t.assetTranscriptions.byId[e]),((e,t)=>e&&t?t[e]:null)),ej=e=>r((e=>e.studio.scenes[0].layers),(t=>t.filter((e=>Ur(e)||Or(e))).filter((t=>{return YV(t)===e&&t.hasAudio&&!((a=t).detachedAudioId&&"video"===a.type);var a})))),tj=(e,t)=>{const a=ZV(e);return r((t=>{var a;return null==(a=t.studio.magicSubtitleFrames)?void 0:a[e]}),(t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.style}),a,(e=>e.studio.width||1),(t=>{var a,o,n;const r=null==(n=null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.style)?void 0:n.fontFamily;if(r)return t.loadedFonts[r.fontFamily]}),(t=>t.studio[`magicSubtitleCorrection_${e}`]),(function(a,o,n,r,i,s){if(!o)return null;let l,c=[];if(t){if(!n||"pending"===n.state)return null;l=yj(n.words,s,!1).map((e=>e.word))}else if(a)l=a.flatMap((e=>e.words.map((e=>e.text)))),c=a.flatMap((e=>e.words.map((({styles:e})=>e||[]))));else{if(!n||"pending"===n.state)return null;l=n.words.map((e=>e.word))}const{widths:d,height:u}=function(e,t,a,o,n,r){const i=o/700,s=a.fontSize*i,{widths:l}=jV(t,a,s,n);return l.has(" ")||l.set(" ",VV(" ",a,s)),e.forEach(((e,o)=>{const i={...a};if(o in r){const e=r[o];Object.values(e).find((e=>"bold"===e.fontWeight))&&(i.fontWeight="bold")}const{widths:c}=jV(t,i,s,n);if(!c.has(e)){const t=VV(e,i,s);c.set(e,t),l.set(e,t)}})),{height:s*a.lineHeight,widths:l}}(l,e,o,r,i,c);return{widths:d,textHeight:u}}))},aj=e=>{if(Wr(e))return e;if(0===e.words.length)return{...e,words:[]};const t=(e.end-e.start)/e.words.length;return{...e,words:e.words.map(((a,o)=>({text:a.text,start:e.start+o*t,end:e.start+(o+1)*t,styles:a.styles})))}},oj=e=>r((t=>{var a;return null==(a=t.studio.magicSubtitleFrames)?void 0:a[e]}),(t=>{var a;return null==(a=t.studioLocal.magicSubtitleFrames)?void 0:a[e]}),((e,t)=>{const a=t||e;return a?a.map(((e,t)=>({...e,originalNdx:t}))):a})),nj=({assetId:e,filterInvalid:t})=>{const a=ej(e),o=(e=>{const t=oj(e);return r(t,(e=>e?e.map(aj):e))})(e);return r(a,o,(function(e,a){if(!e.length||!a)return[];const o=[];for(const n of e){const{startTime:e=0,endTime:r=n.duration||1,playbackRate:i=1,videoDelay:s=0}=n,l=1/i,c=s-e*l,d=s,u=s+(r-e)*l;a.forEach(((a,n)=>{if(!an(a.start,a.end,e,r))return;const i=Math.max(a.start*l+c,d),s=Math.min(a.end*l+c,u);if(t){if(a.start===a.end)return;if(a.start>a.end)return;if(0===a.words.length)return;if(s-i<=.01)return;if(!a.words.filter((({text:e})=>!!e)).length)return}const m={start:i,end:s,originalNdx:n,timelineOffset:c,words:a.words.map((e=>({...e,start:e.start*l+c,end:e.end*l+c})))};o.push(m)}))}return o.sort(((e,t)=>e.start-t.start)),o}))},rj=({assetId:e,ignoreCorrections:t,shouldStartNewFrame:a,shouldStartNewRow:o,useDeprecatedV0Corrections:n})=>{const i=tj(e,n),s=ZV(e),l=lj(e),c=(e=>r((t=>{var a;return null==(a=t.studio.magicSubtitleFrames)?void 0:a[e]}),(e=>e?e.map(aj):e)))(e);return r(i,s,l,c,(t=>t.studio[`magicSubtitleCorrection_${e}`]),(function(e,r,i,s,l){var c;if(!e)return[];const{widths:d}=e,u=" "===i&&null!=(c=d.get(" "))?c:0;let m;if(s&&!t)m=s.flatMap((e=>e.words)).map((e=>({start_time:e.start,end_time:e.end,word:e.text,styles:e.styles})));else if(n&&l&&!t){if(!r||"completed"!==r.state)return[];m=yj(r.words,l,!1)}else{if(!r||"completed"!==r.state)return[];m=r.words}return xV({words:m.map((e=>({...e,width:d.get(e.word)}))),shouldStartNewFrame:a,shouldStartNewRow:o,separator:{text:i,width:u}})}))},ij=r(zV,(e=>e.length)),sj=e=>r((t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.languageKey}),(t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.translatedLanguageCode}),((e,t)=>{var a;if(t)return t;if(!e)return null;const[o,n]=e.split("_");return null!=(a=null!=n?n:o)?a:null})),lj=e=>{const t=sj(e),a=ZV(e),o=oj(e);return r(t,a,o,(t=>{var a,o;return null==(o=null==(a=t.studio.assetUploadedSubtitles)?void 0:a[e])?void 0:o.subtitles}),(t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.transcriptionSource}),(t=>{var a,o;return null==(o=null==(a=t.studio.magicSubtitles)?void 0:a[e])?void 0:o.translated}),((e,t,a,o,n,r)=>{if("upload"===n||"manual"===n)return o?TV(o.map((e=>e.text))):" ";if(!e||"completed"!==(null==t?void 0:t.state))return" ";return function(e,t){if(!SV)return" ";if(0===e.length)return"";if(1===e.length)return"";const a=new Intl.Segmenter(t,{granularity:"word"}),o=e.join(""),n=Array.from(a.segment(o)).filter((e=>e.isWordLike));if(0===n.length)return" ";const r=n.map((e=>e.segment)).join("");return Array.from(a.segment(r)).length<=1?" ":""}(r?(a||[]).flatMap((e=>e.words.map((e=>e.text)))).slice(0,40):t.words.slice(0,40).map((e=>e.word)),e)}))},cj=({assetId:e,filterInvalid:t})=>{const a=QV(e),o=mj({assetId:e,filterInvalid:t}),n=lj(e),i=gj(e);return r(a,o,n,(e=>(e.studio.width||1)/700),i,((t,a,o,n,r)=>{if(!t)return[];const i=t.fontSize*n,s={backgroundColor:t.backgroundColor,borderRadius:{relative:`${t.borderRadius}%`},color:t.fontColor,fontFamily:t.fontFamily.fontFamily,fontWeight:t.fontWeight,fontSize:i,globalAlpha:1,isTrimmed:!0,italic:t.italic,lineHeight:t.lineHeight,textAlign:t.textAlign,textShadow:"none"!==t.textShadow?t.textShadow:"transparent",textPadding:t.backgroundPadding,type:xr.Text,wrapOrFill:t.backgroundStyle,underline:t.underline};return"custom"===t.fontFamily.type&&(s.asset_id=t.fontFamily.asset_id,s.url=t.fontFamily.url,s.fontType=t.fontFamily.fontType,s.hasCustomFont=!0),a.map((function(t){const a=t.lines.map((e=>e.words.map((e=>e.text)).join(o))).join("\n");return{...s,id:String(Math.random()),text:a,textWithLineBreaks:a,startTime:t.start,endTime:t.end,isMagicSubtitle:!0,assetId:e,frame:t,wordSeparator:o,isRTL:r}}))}))},dj=e=>{const t=cj({assetId:e,filterInvalid:!0}),a=XV(e);return r(t,a,(e=>e.studio.width),(e=>e.studio.height),(e=>e.studio.canvasX),(e=>e.studio.canvasY),((e,t,a,o,n,r)=>t?e.map((e=>{const{x:i,y:s,width:l,height:c,rotation:d}=OV(e,t),{xPercent:u,yPercent:m}=kc(i,s,{x:n,y:r,width:a,height:o}),{widthPercent:p,heightPercent:h}=bc(l,c,{width:a,height:o});return{...e,position:{height:h,width:p,x:u,y:m,rotation:d||0}}})):[]))},uj=e=>{const t=ej(e),a=oj(e);return r(t,a,((e,t)=>t?t.filter((function(t){return!(t.start!==t.end)||e.some((e=>{var a,o,n;const r=null!=(a=e.startTime)?a:0,i=null!=(n=null!=(o=e.endTime)?o:e.duration)?n:0;return an(t.start,t.end,r,i)}))})):[]))},mj=({assetId:e,filterInvalid:t})=>{const a=nj({assetId:e,filterInvalid:t}),o=JV(e),n=tj(e,!1),i=lj(e);return r(a,n,o,i,((e,t,a,o)=>{var n;if(!t)return[];const{widths:r}=t,i=" "===o&&null!=(n=r.get(" "))?n:0;return e.map((e=>{var t;const o=[];function n(e,t){o.push({words:[],width:t}),o[o.length-1].words.push(e),s=t,l=!0}let s=0,l=!1;for(const c of e.words){const e=null!=(t=r.get(c.text))?t:0;if(l){const t=s+i+e;t>a.width?n(c,e):(o[o.length-1].words.push(c),o[o.length-1].width=t,s=t)}else n(c,e)}return{start:e.start,end:e.end,originalNdx:e.originalNdx,timelineOffset:e.timelineOffset,lines:o}}))}))},pj=e=>{const t=zV(e),a={},o={allIds:[],byId:{}};if(t.length>0)for(const n of t){const t=dj(n)(e);if(!t.length)continue;const{transitionId:r,transitionDuration:i,transitionOverlapDuration:s=0,wordByWordAnimations:l}=e.studio.magicSubtitles[n]||{};for(const e of t)e.fallbackFonts=ot(e.text);if(r&&r!==Pr.None){const e=t[0].id,a=y();t.forEach((e=>{e.startTime-=s,e.endTime+=s,e.animation={constant:[a]}})),o.allIds.push(a),o.byId[a]={animationName:r,id:a,isCrossTransition:!1,layerId:e,speed:"default",transitionDuration:i}}if(l&&l.animationId&&l.animationId!==Pr.None){const e=t[0].id,{animationId:a,animationName:n="",wordByWordStyles:r={}}=l,i={animationName:a,id:y(),isCrossTransition:!1,layerId:e,speed:"default",wordByWordStyles:r[n]};o.allIds.push(i.id),o.byId[i.id]=i,t.forEach((e=>{var t;e.animation||(e.animation={constant:[]}),null==(t=e.animation.constant)||t.push(i.id)}))}a[n]=t}return{animations:o,magicSubtitlesOnExport:a}},hj=/[\u0591-\u07FF]/,gj=e=>{const t=sj(e),a=lj(e);return r(t,(t=>{var a;return null==(a=t.studio.magicSubtitleFrames)?void 0:a[e]}),a,((e,t,a)=>{if(e)return nt.isRtlLang(e);const o=(t||[]).slice(0,4).map((e=>e.words.map((e=>e.text)).join(a))).join(a);return hj.test(o)}))},fj=e=>e?""===e.word?"delete":"edit":"none",yj=(e,t,a)=>{if(!t||0===t.length)return e;const o=[...t];function n(){const e=[];let t=o.shift();for(;t;){const a=e.length?e[e.length-1]:null;if(a&&(a.end_time!==t.start_time||fj(t)!==fj(a)))break;e.push(t),t=o.shift()}return t&&e.length&&e[e.length-1]!==t&&o.unshift(t),e}let r=n(),i=!1;const s=[...e],l=[];for(;s.length>0;){const e=s.shift();if(!e)throw Error("Word queue is empty");if(!r||0===r.length){l.push(e);continue}const t=r[0].start_time,o=r[r.length-1].end_time;if(e.start_time<o&&e.end_time>t)i=!0,a&&""===r[0].word&&l.push({...e,deleted:!0});else if(i){for(""!==r[0].word&&l.push(...r),i=!1,r=n();0!==r.length&&r[r.length-1].end_time<=e.start_time;)r=n();s.unshift(e)}else l.push(e)}return r.length>0&&""!==r[0].word&&l.push(...r),l},Ej=async(e,t,a,o)=>{let n=((e,t)=>{const{state:a}=io(),{scenes:o}=a.studio,{selectedSceneIndex:n}=a.studio,{draggedTracksOverrides:r={}}=a.studioLocal,i=o[n],s=uV(o,i.id),l=ti(e),c=!!r[e.id];let d=1;e.playbackRate&&(d=e.playbackRate);let u=t;return u-=s,u-=e.videoDelay||0,u>l&&!c&&(u%=l),u*=d,u+=e.startTime||0,e.isReversed&&(u=e.duration-u),u})(e,a);if(n>=t.duration&&(n=t.duration-.01),e.isReversed){const t=e.duration-n;o&&(o.currentTime=t)}if(dc(t.currentTime,n,1/30)&&0!==t.currentTime)return;const r=new Promise((e=>{t.onseeked=()=>{e()}}));t.currentTime=n,await r},_j={slow:3,default:1,fast:.5},vj={invertedParabola:(e,t=!0)=>t?1-(1-e)*(1-e):(1-e)*(1-e)},wj=e=>{const{start:t,end:a,current:o,fadeSpeed:n,fadePosition:r}=e,i=_j[n||""];let s=1;if(("intro"===r||"both"===r)&&t<=o&&o<t+i){s=vj.invertedParabola((o-t)/i)}if(("outro"===r||"both"===r)&&a-i<o&&o<=a){s=vj.invertedParabola((o-(a-i))/i,!1)}return Math.max(Math.min(s,1),0)},bj=(e,t,a)=>({startTime:a-t,endTime:a-e}),Sj=(e,t,a)=>({startTime:-1*(t-a),endTime:-1*(e-a)}),Tj=e=>{if(e.position){const{x:t,y:a,width:o,height:n}=e.position,[r,i,s,l]=[parseFloat(t),parseFloat(a),parseFloat(o),parseFloat(n)];let c,d;return c=r<0?r+s:s>100-r?100-r:s,d=i<0?i+l:l>100-i?100-i:l,c*d/100}return-1},Ij=e=>{let t=null,a=0;for(let o=0;o<e.length;o+=1){const n=e[o];if(Nj(n)){const e=Tj(n);e>=a&&(t=n,a=e)}}return{layer:t,percent:a}},kj=e=>{const t=(e=>{const t=[];return e.forEach((e=>{if(e&&!1!==e.canvasBlurValid&&Nj(e)){const[a,o]=Vv(e,0);let n=null,r=null;if([...Array(t.length).keys()].forEach((i=>{const s=t[i];a>s.startTime&&a<s.endTime&&(n=i),o>s.startTime&&o<s.endTime&&(r=i),s.startTime>=a&&s.endTime<=o&&s.layers.push(e)})),0===t.length){if(a>0){const e={layers:[],startTime:0,endTime:a};t.push(e)}const n={layers:[e],startTime:a,endTime:o};t.push(n)}else if(o<t[0].startTime){const n=t[0].startTime,r={layers:[e],startTime:a,endTime:o},i={layers:[],startTime:o,endTime:n};t.push(r),t.push(i)}else if(a>t[t.length-1].endTime){const n={layers:[],startTime:t[t.length-1].endTime,endTime:a},r={layers:[e],startTime:a,endTime:o};t.push(n),t.push(r)}else{if(o>t[t.length-1].endTime){const a={layers:[e],startTime:t[t.length-1].endTime,endTime:o};t.splice(t.length,0,a)}if(null!==r&&null!==n&&n===r){const r=t[n],i=r.startTime;r.startTime=o;const s={layers:[...r.layers],startTime:i,endTime:a},l={layers:[...r.layers],startTime:a,endTime:o};l.layers.push(e),t.splice(n,0,l),t.splice(n,0,s)}else{if(null!==r){const a=t[r],n=a.startTime,i=o;a.startTime=i;const s={layers:[...a.layers],startTime:n,endTime:i};s.layers.push(e),t.splice(r,0,s)}if(null!==n){const o=t[n],r=a,i=o.endTime;o.endTime=r;const s={layers:[...o.layers],startTime:r,endTime:i};s.layers.push(e),t.splice(n+1,0,s)}}if(a<t[0].startTime){const o={layers:[e],startTime:a,endTime:t[0].startTime};t.splice(0,0,o)}}}})),t})(e),a=(e=>{const t=[];return e.forEach((e=>{const{layer:a,percent:o}=Ij(e.layers);if(o>=99)return;const n={layer:a,startTime:e.startTime,endTime:e.endTime};null!==n.layer&&t.push(n)})),t})(t);return a},Cj=r([e=>e.studio.scenes],(e=>{const{layers:t}=e[0];return t.length>0?kj(t):[]})),Nj=e=>("video"===e.type||"image"===e.type)&&void 0===e.canvasBlurValid||e.canvasBlurValid,Aj=()=>{const{state:e}=io();return!e.studio.scenes[0].layers.every((e=>!Nj(e)))},xj=["addedFromMediaLibrary","asset_id","base64_img","blob_name","bucket","bucket_name","cmlFileId","content_type","converted_type","conversion_id","duration","endTime","ext","fileSizeChecked","ffprobeData","gcsShortId","hasAudio","height","hidden","id","index","isMediaLibraryUpload","isSample","local_source_url","local_url","lockAspectRatio","locked","loadErrorFired","longLoadFired","loopMode","mediaLibraryID","metadataGathered","mime","mime_type","name","objectFit","optimization_id","optimization_failed","originalName","original_url","position","positionTemp","preview","projectName","removeBgPreviewUrl","requireConversion","searchQuery","size","soundUrl","source","startTime","temp_dir","thumbnailUrl","timelineRow","timestamp","track_preview","type","uploadConfirmed","uploadLocation","uploadId","userSetFontSize","uri","url","wasUploadedAnonymously","width"],Pj={borderRadius:{relative:"0%"},borderRadiusTemp:null,filters:{},isAudiogram:!1,lineWidth:"0%",playbackRate:1,presetFilter:null,recordType:"",tempOverlayState:{},uploadPending:!1,uploadProgress:100,videoDelay:0,volume:1,volumeTemp:null},Rj=["isTrimmed","origin","conversion_type","loopMode","loadErrorFired"],Oj={videoConvertedState:"complete"};function Dj(e,t,a,o){var n,r;let i=!1;for(const[l,c]of Object.entries(e)){if(!xj.includes(l)&&JSON.stringify(Pj[l])!==JSON.stringify(c)){i=!1;break}i=!0}return i&&"video"===e.type&&((null==(n=e.mime)?void 0:n.includes("mp4"))||(null==(r=e.mime)?void 0:r.includes("quicktime")))&&!e.isTrimmed&&!e.crop&&Td(e)&&Id(e)&&Rv(e)&&kd(e,t)&&function(e,t){const{width:a,height:o}=e,[n,r]=t.split(":").map((e=>parseInt(e)));return a===n&&o===r}(e,a)&&("Standard"===(s=o).exportQuality&&"AUTO"===s.exportResolution);var s}function Lj(e,t){var a;const o=[...xj,...Rj],n={...Pj,...Oj};let r=!1;for(const[s,l]of Object.entries(e)){if(!o.includes(s)&&JSON.stringify(n[s])!==JSON.stringify(l)){r=!1;break}r=!0}const i=(null==(a=e.mime)?void 0:a.includes("mp4"))||"complete"===e.videoConvertedState;return r&&"video"===e.type&&i&&e.isTrimmed&&!e.crop&&(!e.videoDelay||0===e.videoDelay)&&Td(e)&&Id(e)&&Rv(e)&&kd(e,t)}function Uj(e,t=0){let a=!0;return e.scenes[t].layers.forEach((e=>{!["video","audio"].includes(e.type)&&"progressBar"!==e.shapeType&&Td(e)&&Id(e)&&Rv(e)&&!e.isTrimmed||(a=!1)})),e.duration>0&&a}function Mj(e,t){var a,o;if("videoState"===t){if(!e.studio)return!1;const{studio:t}=e;return 1===t.scenes.length&&1===t.scenes[0].layers.length&&"pastedLink"!==t.scenes[0].layers[0].source&&!(null==(a=null==e?void 0:e.audio)?void 0:a.url)}return"videoBuild"===t&&(!!e.scenes&&(1===e.scenes.length&&1===e.scenes[0].layers.length&&"pastedLink"!==e.scenes[0].layers[0].source&&!(null==(o=null==e?void 0:e.audio)?void 0:o.url)))}const Fj={AUTO:0,SD:848,HD:1280,FHD:1920},Bj=e=>2*Math.ceil(Number(e)/2),Wj=e=>Math.ceil(e),Vj=(e,t,a)=>{let o=a;const n=Math.abs(e),r=Math.abs(t);if(!r||!n)return[n,r];let i=n,s=r;const l=r/n,c=n/r;n>=r?(i=Math.min(Math.max(n,0),n),s=l*i):(s=Math.min(Math.max(r,0),r),i=c*s),["1:1","9:16","16:9","5:4","4:5"].includes(a)||(o=`${Bj(i)}:${Bj(s)}`);const[d,u]=((e,t,a)=>{let o=e,n=t;if("1:1"===a){const e=Math.max(o,n);return[e,e]}const r=a.split(":").map((e=>parseInt(e))),i=r[0],s=r[1];return o=Bj(o),n=Bj(n),o/n>i/s?(o=Math.ceil(o/i)*i,n=o*s/i):o/n<i/s&&(n=Math.ceil(n/s)*s,o=n*i/s),o%2==0&&n%2==0||(o+=i,n+=s),[o,n]})(i,s,o);return i=d,s=u,s=Bj(s),i=Bj(i),[i,s]},jj=(e,t,a)=>{if(!e)return[-1,-1];if(!(null==e?void 0:e.height)||!(null==e?void 0:e.width))return[-1,-1];let o=1,n=1;const[r,i]=((e,t)=>{const a=1280;let o=0,n=0,r=Math.abs(e.customOutputWidth||0),i=Math.abs(e.customOutputHeight||0),s=!0;for(const l of t){if(["placeholder","shape","subtitle","text","audio"].includes(l.type))continue;if(s=!1,!(null==l?void 0:l.position))return[0,0];const t=null==l?void 0:l.position;if(!t)return[0,0];for(const e of["width","height"])t[e]||(t[e]=0);const a=(null==t?void 0:t.width)||"100%",r=(null==t?void 0:t.height)||"100%",i=Number(String(r).replace("%",""))/100,c=Number(String(a).replace("%",""))/100,d=l.height||0,u=l.width||0;o=Math.max(o,d/(i||1)),n=Math.max(n,u/(c||1));const{ratio:m}=e;m&&([n,o]=Vj(n,o,m))}if(0!==n&&0!==o||(o=e.height||a,n=e.width||a),e.hasCustomOutput&&r&&i)return r<i&&r<10?i=10*i/r:i<r&&i<10&&(r=10*r/i),[r,i];return s?n>o?[a,a*o/n]:[a*n/o,a]:[n,o]})(e,t);let s=r,l=i;0!==e.height&&0!==e.width||(e.width=s,e.height=l),e.height&&e.width&&(o=e.height/e.width,n=e.width/e.height);const c=((e,t)=>{if("standard"===e.quality&&!e.exportQuality)return Fj.HD;if(!t&&e.exportQuality)return Fj.HD;if(!e.hasCustomOutput||(e=>{var t;return(e.duration||0)>0||!!((null==(t=e.scenes)?void 0:t.length)||[].length>1)})(e))return Fj.FHD;const a=e.customOutputHeight||0,o=e.customOutputWidth||0;return Math.max(o,a,Fj.FHD)})(e,a),d=(e=>e.hasCustomOutput?0:100)(e);let{exportResolution:u}=e;return"FHD"===u&&c<Fj.FHD&&(u="HD"),["SD","HD","FHD"].includes(u)?e.width>=e.height?(s=Fj[u],l=o*s):(l=Fj[u],s=n*l):e.width>=e.height?(s=Math.min(Math.max(s,d),c),l=o*s):(l=Math.min(Math.max(l,d),c),s=n*l),l=Wj(l),s=Wj(s),[s,l]};function Hj(e,t){const a=t.position||xc(t),o=t.converted_type||t.type,n=t.objectFit||"";if("0%"!==a.width&&"0%"!==a.height){if(a.adjusted_x=(a.float_x||0)*e.adjusted_width/100,a.adjusted_y=(a.float_y||0)*e.adjusted_height/100,["placeholder","shape","subtitle","text"].includes(o))return a.adjusted_height=a.pixel_height,void(a.adjusted_width=a.pixel_width);["contain","fit"].includes(n)?function(e,t){const a=t.position||xc(t),o=a.file_height||1,n=a.file_width||1,r=a.pixel_height||1,i=a.pixel_width||1,s=n/o;if(s<i/r){a.adjusted_height=r;const e=a.adjusted_height*s;a.adjusted_width=e,a.adjusted_x=(a.adjusted_x||0)+(i-e)/2}else{a.adjusted_width=i;const{adjusted_y:e}=a,t=a.adjusted_width*o/n;a.adjusted_height=t,a.adjusted_y=(e||0)+(r-t)/2}}(0,t):function(e,t){const a=t.position||xc(t);let o=a.file_height||1,n=a.file_width||1;t.crop&&(o=o*(t.crop.height||100)/100,n=n*(t.crop.width||100)/100);const r=a.pixel_height||1,i=a.pixel_width||1,s=n/o,l=s<i/r;a.adjusted_width=l?i:r*s,a.adjusted_height=l?i*o/n:r,a.crop_width=n*i/a.adjusted_width,a.crop_height=o*r/a.adjusted_height,a.crop_x=(n-a.crop_width)/2,a.crop_y=(o-a.crop_height)/2}(0,t)}}function Gj(e,t){const a=t.position||xc(t);for(const o of["width","height","x","y"]){const e=o;e in a&&(a[e]=a[e].toString().replace("NaN","0"))}a.float_width=parseFloat(a.width.toString().replace("%","")),a.float_height=parseFloat(a.height.toString().replace("%","")),a.float_x=parseFloat(a.x.toString().replace("%","")),a.float_y=parseFloat(a.y.toString().replace("%","")),a.pixel_width=a.float_width*e.adjusted_width*.01,a.pixel_height=a.float_height*e.adjusted_height*.01,Hj(e,t)}function $j(e,t,a,o=!0){let n=t,r=e;if(!n||!r)return{outputWidth:r,outputHeight:n};const i=n/r;r<n?r=r/n*n:n=i*r;let s=a;["1:1","9:16","16:9","5:4","4:5"].includes(a)||(s=`${r}:${n}`);const l=function(e,t,a,o=!0){if("1:1"===a){const a=Math.max(e,t);return{outputWidth:a,outputHeight:a}}const[n,r]=a.split(":").map((e=>parseInt(e,10)));let i=t,s=e;return s/t>n/r?(s=Math.ceil(s/n)*n,i=s*r/n):s/t<n/r&&(i=Math.ceil(i/r)*r,s=i*n/r),s%2==0&&i%2==0||!o||(s+=n,i+=r),{outputWidth:s,outputHeight:i}}(r,n,s,o);return r=l.outputWidth,n=l.outputHeight,{outputWidth:r,outputHeight:n}}function Kj(e){return"standard"===e.quality?1280:e.hasCustomOutput&&0===e.duration&&Math.max(e.customOutputWidth,e.customOutputHeight)>1920?Math.max(e.customOutputWidth,e.customOutputHeight):1920}function Yj(e){return e.hasCustomOutput?0:100}function zj(e,t=!0,a){let o=[];if("scenes"in e)for(const c of e.scenes)o=o.concat(c.layers);else o=e.layers||[];const[n,r]=jj(e,o,a);let i=1,s=1;e.height=e.height||0,e.width=e.width||0;const l=function(e,t=!0){let a=e.height||0,o=e.width||0,n=[];if("scenes"in e)for(const i of e.scenes)n=n.concat(i.layers);else n=e.layers||[];let r=!0;for(const i of n){const n=i.converted_type||i.type;if(["placeholder","shape","subtitle","text"].includes(n))continue;r=!1;const s=i.position||{};s.file_height=i.height,s.file_width=i.width;const l=parseFloat((s.height||"100%").toString().replace("%",""))/100,c=parseFloat((s.width||"100%").toString().replace("%",""))/100;a=Math.max(a,(s.file_height||0)/(l||1)),o=Math.max(o,(s.file_width||0)/(c||1));const{ratio:d}=e;if(d){const{outputWidth:e,outputHeight:n}=$j(o,a,d,t);o=e,a=n}}if(0!==o&&0!==a||(a=e.height||0,o=e.width||0),e.hasCustomOutput)return{adjusted_width:e.customOutputWidth,adjusted_height:e.customOutputHeight};return r?o>a?{adjusted_width:1280,adjusted_height:1280*a/o}:{adjusted_width:1280*o/a,adjusted_height:1280}:{adjusted_width:o,adjusted_height:a}}(e,t);e.adjusted_width=l.adjusted_width,e.adjusted_height=l.adjusted_height,0!==e.height&&0!==e.width||(e.width=e.adjusted_width,e.height=e.adjusted_height),e.height&&e.width&&(i=e.height/e.width,s=e.width/e.height),e.width>=e.height?(e.adjusted_width=Math.min(Math.max(e.adjusted_width,Yj(e)),Kj(e)),e.adjusted_height=i*e.adjusted_width):(e.adjusted_height=Math.min(Math.max(e.adjusted_height,Yj(e)),Kj(e)),e.adjusted_width=s*e.adjusted_height),e.adjusted_width=Math.round(e.adjusted_width),e.adjusted_height=Math.round(e.adjusted_height),e.adjusted_width=n,e.adjusted_height=r;for(const c of e.scenes)c.adjusted_width=e.adjusted_width,c.adjusted_height=e.adjusted_height,c.width=e.width,c.height=e.height}function qj(e){if(e.position){const{width:t,height:a,x:o,y:n}=e.position,r={x:gc(o),y:gc(n),width:gc(t),height:gc(a)};return 100===r.width&&100===r.height&&0===r.x&&0===r.y}return!1}const Jj="Static Image",Xj="No Changes Video",Qj="Trimmed Only Video";async function Zj(e,t=!1){const a=await v(e,{mode:"no-cors"}),o=await a.blob();return a.ok?t?o:(n=o,new Promise(((e,t)=>{const a=new FileReader;a.readAsDataURL(n),a.onload=()=>{a.result?e(a.result):t(new Error("Reader result was empty"))},a.onerror=e=>t(e)}))):"FAIL";var n}const eH=async(e,t)=>{var a,o;const n=k_(e,void 0,"original"),{type:r}=e;var i,s;return n&&"image"===r?e.base64_img=await Zj(n):n&&"video"===r?e.base64_img=await((e,t)=>{var a,o;const{state:n}=io(),r=n.studioLocal.layerTempValues[e.id]||{},{removeBgPreviewUrl:i}=r,[s,l]=Vv(e,0);if(!(s<=t&&t<=l))return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if((e.removeBg||e.blurBg)&&i)return Zj(i);const c=document.createElement("video");return c.src=null!=(o=null!=(a=e.url)?a:e.local_url)?o:"",c.crossOrigin="anonymous",new Promise((a=>{c.onloadedmetadata=async()=>{try{c.pause(),c.volume=0,await Xc(5e3,Ej(e,c,t))}catch(o){console.info("Video doesn't auto play")}setTimeout((()=>{var t,o;const n=document.createElement("canvas"),r=n.getContext("2d");return n.width=null!=(t=e.width)?t:0,n.height=null!=(o=e.height)?o:0,r&&r.drawImage(c,0,0,n.width,n.height),c.pause(),a(n.toDataURL("image/jpeg"))}),60)},c.onerror=()=>(console.warn(`video ${c.src} failed to load`),a("FAIL"))}))})(e,t):"text"!==e.type&&"subtitle"!==e.type||e.fontFamily&&await(i=e,s=!0,Xc(8e3,new Promise(((e,t)=>{QN(i,s,e,(e=>{const a="string"==typeof i?i:i.fontFamily;t(new Error(`Error loading font ${a}: ${e}`))}))})))),!e.mime&&(null==(o=null==(a=null==e?void 0:e.base64_img)?void 0:a.includes)?void 0:o.call(a,"image/svg+xml"))&&(e.mime="image/svg+xml"),null},tH=e=>{e.sourceVideo&&e.sourceVideo.base64_img&&delete e.sourceVideo.base64_img;for(const t of e.scenes)for(const e of t.layers)e&&e.base64_img&&delete e.base64_img};const aH=async(e,t=Ds.None)=>{let a;const o=t===Ds.EyedropperMode||t===Ds.ImageExport;try{const{state:n,dispatch:r}=io(),{studio:i}=n,{imageType:s}=i,l=ic();a=c(e);const d=Du({team:Bu(n)},au.HIGH_QUALITY);r(Ry(d?"high":"standard"));const u=pj(n);if(a.animations.allIds.push(...u.animations.allIds),a.animations.byId={...a.animations.byId,...u.animations.byId},a.scenes[0].layers.push(...Object.values(u.magicSubtitlesOnExport).flat().filter((e=>e.startTime<=l&&e.endTime>l))),i.canvasBlur){const e=Cj(n);if(e.length>0){let t=e[0];e.forEach((e=>{l>=e.startTime&&l<=e.endTime&&(t=e)}));const o={...t.layer},n=i.scenes[0].layers[0];if(o){n&&n.filters?o.filters={...n.filters,blurPercent:5}:o.filters={blurPercent:5},o.id=y();const e={x:"-5%",y:"-5%",width:"110%",height:"110%",rotation:0};o.position=e,a.scenes[0].layers=[o,...a.scenes[0].layers]}}}zj(a,!1,d),function(e){e&&e.scenes&&e.scenes[0].layers&&e.scenes[0].layers[0]&&!e.scenes[0].layers[0].position&&(e.scenes[0].layers[0].position={x:"0%",y:"0%",width:"100%",height:"100%",file_height:e.height,file_width:e.width})}(a),function(e){for(const t of e.scenes)for(const a of t.layers)Gj(e,a)}(a),await(async e=>{const t=ic(),a=[];for(const o of e.scenes)for(const e of o.layers)a.push(eH(e,t));return(await Promise.all(a)).some((e=>"FAIL"===e))?Promise.reject(new Error("A media layer failed to fetch!")):Promise.resolve()})(a),a.watermark&&(a.watermark_img=await Zj("https://cdn-useast1.kapwing.com/static/watermark.png"));const{alignWatermark:m,scenes:p,subtitlesSize:h,videoType:g,watermark:f,watermark_img:E,animations:_}=a,v=p[0];let w=l;o&&(w-=uV(p,v.id));let b=gV();"webp"!==s||Ln()||(b="webp");const{adjusted_height:S,adjusted_width:T,background:I,duration:k,height:C,maxFramerate:N,subtitlesPosition:A,width:x}=v;let{layers:P}=v;t===Ds.Thumbnail&&(P=P.filter((e=>{const{start:t}=ei(e);return 0===t}))),(e=>{for(const t of e)t.isAudiogram&&("wave"===t.waveformStyle?t.fft_data=wW:t.fft_data=vW)})(P),((e,t)=>{for(const a of e)"subtitle"===a.type&&(a.background=t.subtitle.backgroundColor,a.backgroundStyle=t.subtitle.backgroundStyle,a.color=a.color||t.subtitle.fontColor,a.fontFamily=t.subtitle.font,a.textAlign=a.textAlign||t.subtitle.textAlign,a.textVerticalAlign=t.subtitle.textVerticalAlign,a.fixedPosition=t.subtitle.fixedPosition)})(P,v);const R={videoArgs:{adjusted_height:S,adjusted_width:T,alignWatermark:m,animations:_,frameExt:b,maxFramerate:N,sceneBackground:I,sceneDuration:k,sceneHeight:C,sceneWidth:x,subtitlesPosition:A,subtitlesSize:h,videoType:g,watermark_img:E,watermark:f},frame:0,finalImageDataUrl:null,currentLayers:P,lastBatch:!0,div:"canvas-scratchpad",numThreads:6,eyedropperMode:!1,studioTime:w};if(t===Ds.EyedropperMode){R.eyedropperMode=!0;const e=await fW(R.videoArgs,R.frame,R.finalImageDataUrl,R.currentLayers,R.lastBatch,R.div,R.numThreads,R.eyedropperMode,R.studioTime);return tH(a),e}let O;if(t===Ds.ImageExport){R.eyedropperMode=!0;const e=await fW(R.videoArgs,R.frame,R.finalImageDataUrl,R.currentLayers,R.lastBatch,R.div,R.numThreads,R.eyedropperMode,R.studioTime),t=`image/${R.videoArgs.frameExt||"png"}`;O=e.toDataURL(t,1)}else O=await fW(R.videoArgs,R.frame,R.finalImageDataUrl,R.currentLayers,R.lastBatch,R.div,R.numThreads,R.eyedropperMode,R.studioTime);tH(a);return[{id:y(),source:"local",name:`video_image.${b}`,local_url:O},O]}catch(n){throw console.error(n),tH(a),"Attempt to draw background removed video when no preview is calculated"!==n.message&&console.error("An error occurred when processing the client side image.",n),n}},oH=(e,t,a=!1)=>{const o=On()||Ln();return(!a||!On())&&(!(0!==t&&!a)&&(!!e.scenes&&(!(e.scenes.length>1&&!a)&&(!(o&&e.canvasBlur&&Aj())&&e.scenes.every((e=>e.layers.every((e=>(!o||null==e.filters&&!e.presetFilter)&&("image/gif"!==e.mime&&"gif"!==Wu(e.url)&&(("image/webp"!==e.mime||"static"===e.webpType)&&("pastedLink"!==e.source&&(!e.removeBg&&!e.blurBg&&("placeholder"!==e.type&&(!e.uploadPending||(console.error("Layer still uploading:",e),!1)))))))))))))))};function nH(e,t,a="videoState",o=!1,n){let{studio:r}=e;!r&&e.scenes&&(r=e);const{videoType:i}=r,s=Object.keys(r.magicSubtitles||{}).length>0;let l=!1;if(Mn())l=!1;else if(oH(r,t,o))l=!0;else if(Mj(e,a)){if(s)return!1;const e=r.scenes[0].layers[0];if(!r.width||!r.height)return!1;const t=r.width/r.height;if("mp4"!==i&&"mp4_convert"!==i?l=!1:Dj(e,t,r.ratio,{exportQuality:r.exportQuality,exportResolution:r.exportResolution})&&n&&!cN(n,r.duration)&&(l=!0),Lj(e,t)&&xn()&&n&&im(n)){if(s)return!1;l=!0}}else l=!1;return l}const rH=async(e,t,a,o=!1,n)=>{const{dispatch:r}=io();let{studio:i}=t;!i&&t.scenes&&(i=t);const s=function(e,t,a=!1,o="videoState"){let{studio:n}=e;!n&&e.scenes&&(n=e);let r="";if(oH(n,t,a))r=Jj;else if(Mj(e,o)){const e=n.scenes[0].layers[0],t=n.width/n.height;Dj(e,t,n.ratio,{exportQuality:n.exportQuality,exportResolution:n.exportResolution})&&(r=Xj),Lj(e,t)&&(r=Qj)}return r}(t,a,o,n);let l,c,d,u=!0;switch(s){case Jj:try{i.watermark=cN(e,i.duration);const[t,a]=o?await aH(i,Ds.ImageExport):await aH(i);l=Vk(t,a),c=URL.createObjectURL(l),r(Ny("image"))}catch(m){console.debug("Can't process image on client, send to server"),u=!1}break;case Xj:case Qj:try{const e=i.scenes[0].layers[0],t=await(async(e,t,a)=>{const{dispatch:o,history:n,state:r}=io(),{currentUser:i}=r;let s=a,l={},c={};switch(e){case Xj:try{l=(await jk(t)).file}catch($ae){throw console.debug("Can't process no changes video on client, send to server"),s&&await v$(s,{progressText:"Client side video error, sending job to server..."}),$ae}break;case Qj:try{let e=3e3;if(!s){const t=await o(f$({currentUser:i,publish:!1,auto:!1,createLocation:"trim-save"}));s=t._id,e=100}const a={done:!1,clientSideProcessingInProgress:!0,pendingProcessOnClient:!0,progressText:"Processing on client, do not refresh this page or close the tab...",submittedAt:new Date};await v$(s,a),o(yS(a)),setTimeout((()=>{null==n||n.push(`/videos/${s}`)}),e);const r=await jk(t),d=await yW(t,r.file);d.outputBlob.id=y(),d.outputBlob.local_url=window.URL.createObjectURL(d.outputBlob),l=d.outputBlob,c=d.ffmpegData}catch($ae){throw console.debug("Can't trim video on client, send to server"),s&&await v$(s,{clientSideProcessingInProgress:!1,progressText:"Client side trim error, sending job to server..."}),$ae}}return{files:l,ffmpegData:c}})(s,e,i._id);l=t.files,c=t.files.local_url,d=t.ffmpegData,r(Ny("mp4"))}catch(m){console.error(m),u=!1}break;default:u=!1}if(u&&l&&!window.Cypress){const t=om(e)&&e.user.defaultPrivacy===xo.private,a=y(),o=await sV(l,{uploadId:a}),n=new Jw({analyticsUploadSource:"Client Side Processing",file:l,isPrivate:t,onFinish:(e,t,a)=>{((e,t,a)=>{const{dispatch:o,state:n}=io(),{studio:r}=n,i=t||r._id,s={clientSideProcessingInProgress:!1,pendingProcessOnClient:!1};if(!e)return o(yS(s)),void(i&&v$(i,s));const l={done:!0,draft:!1,fullPath:e,progressText:"Processed on client",url:e,...s};a===Jj&&(l.image_url=e,o(E$(e))),o(yS(l)),i&&v$(i,l)})(t,i._id,s)},origin:"client side processing",uploadSourceComponent:"client-side-processing",layer:o});n.upload()}return{files:l,processed:u,newUrl:c,ffmpegData:d}};function iH(e,t,a){var o,n;if(!["mp4","mp4_convert"].includes(e.videoType))return;const r=(null!=(o=e.width)?o:0)/(null!=(n=e.height)?n:1);if(Mj(e,"videoBuild")){const o=e.scenes[0].layers[0],{videoType:n}=e;Dj(o,r,e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes":!0,"Processed on client":a}),Lj(o,r)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trim only":!0,"Processed on client":a}),function(e,t,a){var o;return"mp4"===a&&"video"===e.type&&(null==(o=e.mime)?void 0:o.includes("mp4"))&&e.duration&&e.duration<=15&&Td(e)&&Id(e)&&Rv(e)&&(e.crop||!kd(e,t))}(o,r,n)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Short Duration Cropped or Resized Video":!0})}1===e.scenes.length&&(Uj(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Static Image Video":!0}),function(e,t=0){if(2!==e.scenes[t].layers.length)return!1;let a=!1,o=!1;return e.scenes[t].layers.forEach((t=>{var n,r;Dj(t,(null!=(n=e.width)?n:0)/(null!=(r=e.height)?r:1),e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(a=!0),"audio"!==t.type||t.isTrimmed||t.isAudiogram||(o=!0)})),a&&o}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes Video + Audio":!0}),function(e,t=0){if(2!==e.scenes[t].layers.length)return!1;let a=!1,o=!1;const n=(e.width||0)/(e.height||1);return e.scenes[t].layers.forEach((e=>{Lj(e,n)&&(a=!0),"audio"!==e.type||e.isTrimmed||e.isAudiogram||(o=!0)})),a&&o}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trimmed Video + Audio":!0})),e.scenes.length>1&&(function(e){let t=!0;return e.scenes.forEach(((a,o)=>{Uj(e,o)||(t=!1)})),t}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Multi Scene Static Image Video":!0}),function(e){let t=!0,a=!1;return e.scenes.forEach((e=>{e.layers.forEach((e=>{"audio"!==e.type||e.isTrimmed||e.isAudiogram?"video"!==e.type&&"progressBar"!==e.shapeType&&Td(e)&&Id(e)&&Rv(e)&&!e.isTrimmed||(t=!1):a=!0}))})),t&&a}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Multi Scene Static Image Video + Audio":!0}),function(e){let t=!0;const a=e.scenes[0].layers[0].asset_id;return e.scenes.forEach((o=>{o.layers.forEach((o=>{var n;const r=e.width/e.height;"video"===o.type&&(null==(n=o.mime)?void 0:n.includes("mp4"))&&Td(o)&&Id(o)&&Rv(o)&&kd(o,r)&&!o.crop&&o.asset_id===a||(t=!1)}))})),t}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Multi Scene Same Video":!0}))}function sH(e,t={},a=!1){try{!function(e,t={},a=!1){var o,n;const{state:r}=io(),i=!1,s={};e._id&&(s["Video ID"]=e._id,s["Link to Video"]=`kapwing.com/videos/${e._id}`);"studio-publish-dropdown"===e.createLocation&&(s["Exported With Dropdown"]=!0);e.isStopMotionVideo?s.Editor="Stop Motion Maker":e.isLooped?s.Editor="Loop Video":e.isCreator||e.isStudio?s.Editor="Studio":e.isReversed?s.Editor="Reverse Video":e.isTrimmedOnly?s.Editor="Trim Video":e.isMuted?s.Editor="Mute Video":e.isImageVideo?s.Editor="Image to Video":e.isCartoonify?s.Editor="Cartoonify":e.isRotate?s.Editor="Rotate Video":e.isSpeedVideo?s.Editor="Video Speed Changer":e.isConvertVideo&&(s.Editor="Convert Video");const{origin:l}=e;l&&(s["Landing Page"]=l);const{templateSource:c}=r;c&&(s["Template Source"]=c);Mn()&&(s["Used PWA"]=!0);e.duration&&(s.Duration=e.duration);(e.isCreator||e.isStudio)&&function(e,t,a,o,n){var r,i,s,l,c,d,u;const m=e.scenes[0];if(0===e.duration||e.exportFrameTime>=0?n["Export Type"]="jpg":n["Export Type"]=e.videoType,e.exportQuality&&(n.exportQuality=e.exportQuality),e.exportResolution&&(n.exportResolution=e.exportResolution),"usedUndo"in t&&t.usedUndo&&(n["Used Undo"]=!0),t.usedEyedropper&&(n["Used Eyedropper"]=!0),Im(n,t,a),t.analytics){const{analytics:e}=t;e.usedGapInsert&&(n["Used Drag Into Split/Small Gap"]=!0),e.usedRippleDelete&&(n["Used Ripple Delete"]=!0),e.usedRippleMode&&(n["Used Ripple Mode"]=!0),e.usedPasteModifications&&(n["Used Paste Modifications"]=!0),e.usedCanvasBlur&&(n["Used Canvas Blur"]=!0),e.usedSafezone&&(n["Used Safezone"]=!0),e.usedTimeline&&(n["Used Timeline V2"]=!0),e.usedCrop&&(n["Used Crop"]=!0),e.usedImageErase&&(n["Used Image Erase"]=!0),e.usedExactInput&&(n["Used Exact Input"]=!0),e.waveformCreationFailure&&(n["Waveform Creation Failure"]=!0),e.renameLayer&&(n["User Renamed Layer"]=!0),e.usedClassicTranscribe&&(n["Used Classic Transcribe"]=!0,n["Used Classic Autogenerate"]=!0),e.usedClassicTranslate&&(n["Used Classic Translate"]=!0,n["Used Classic Autogenerate"]=!0),e.usedUploadSRT&&(n["Used Upload SRT"]=!0)}"translate"in t&&!t.isTranscribed&&(n["Used Translate"]=!0),n["Number of Layers"]=Object.entries(e.allLayers.byId).length,n["Max Number of Rows Across Scenes"]=0,iH(e,n,o);const p=Object.keys({}).length;n["Number of Tracks Used"]=p,n["Strict Video Recorded Layers"]=0,n["Strict Audio Recorded Layers"]=0,n["Screen Recorded Layers"]=0,n["Video Recorded During Screen Record Layers"]=0,n["Audio Recorded During Screen Record Layers"]=0,n["Number of Subtitle Layers"]=0,n["Total Uploaded File Size (MB)"]=0;const h=new Set,g=new Set,f=new Set;let y=!1;for(const E of Object.values(e.allLayers.byId)){"subtitle"===E.type&&("fontStyle"in E&&E.fontStyle!==m.subtitle.fontStyle||"textColor"in E&&E.textColor!==m.subtitle.fontColor||"fontSizeRatio"in E&&E.fontSizeRatio!==m.subtitle.fontSizeRatio||"fontWeight"in E&&E.fontWeight!==m.subtitle.fontWeight||"textAlign"in E&&E.textAlign!==m.subtitle.textAlign)&&(n["Has Individual Subtitle Style"]=!0),E.volume&&E.volume>0&&E.volume<1&&(n["Uses Layer Volume Adjust"]=!0),"number"==typeof E.timelineRow&&(m.id,E.timelineRow,n["Max Number of Rows Across Scenes"]=Math.max(E.timelineRow+1,n["Max Number of Rows Across Scenes"])),"video"===E.type&&E.videoDelay&&(n["Uses Video Delay"]=!0),E.type===xr.Shape&&(n["Has Shape"]=!0),"progressBar"===E.shapeType&&(n["Has Progress Bar"]=!0),"subtitle"===E.type&&(n["Has Subtitles"]=!0,n["Number of Subtitle Layers"]+=1),E.type===xr.Text&&(n["Has Text"]=!0,"wrap"===E.wrapOrFill?n["Used Text Background"]="wrap":"fill"===E.wrapOrFill||E.backgroundColor?n["Used Text Background"]="fill":n["Used Text Background"]="none",E.textShadow&&"rgba(-255,-255,-255,0)"!==E.textShadow?n["Used Text Outline"]=E.textShadow:n["Used Text Outline"]="none"),"image"===E.type&&("dropShadow"===E.imageEffect&&(n["Has Image Drop Shadow"]=!0),"image/webp"===E.mime&&(n["Has Webp File"]=!0),E.isFreezeFrameLayer&&(n["Has Freeze Frame"]=!0)),E.pluginSource&&(n["Has Layer From Plugin"]=!0);const e=hv(E);e&&"none"!==e.id&&(n["Has Animation"]=!0,"image"===E.type&&(n["Has Image Animation"]=!0),"text"===E.type&&(n["Has Text Animation"]=!0),"video"===E.type&&(n["Has Video Animation"]=!0)),void 0!==gv(E).find((e=>"outro"===e.type))&&(n["Has Outro Animation"]=!0),RP(E)&&(n["Has Moving Zoom"]=!0);const{introTransition:t,outroTransition:o}=yv(E);if((t&&"none"!==t.id||o&&"none"!==o.id)&&(n["Has Transition"]=!0),(null==t?void 0:t.transitionId)&&q_(null==t?void 0:t.transitionId)&&f.add(null==t?void 0:t.transitionId),(null==o?void 0:o.transitionId)&&q_(null==o?void 0:o.transitionId)&&f.add(null==o?void 0:o.transitionId),"text"===E.type&&E.textEffect&&(n["Uses Text Effect"]=!0,"dropShadow"===E.textEffect&&(n["Uses Drop Shadow"]=!0),"textBlur"===E.textEffect&&(n["Uses Text Blur"]=!0)),(null==(r=E.draftJSTextTree)?void 0:r.blocks.length)&&!n["Uses Inline Styling"]){const{blocks:e}=E.draftJSTextTree,t=new Set(e[0].inlineStyleRanges.map((e=>e.style)));n["Uses Inline Styling"]=e.some((e=>e.inlineStyleRanges.some((a=>!t.has(a.style)||0!==a.offset||a.length!==e.text.length))))}"library"in E&&"emoji"===E.library&&(n["Has Emoji"]=!0),E.hasCustomFont&&(n["Has Custom Font"]=!0),"video"!==E.type&&"image"!==E.type||!("lineWidth"in E)||0===E.lineWidth||(n["Uses Image/Video Border"]=!0),E.isAudiogram&&(n["Has Audiogram"]=!0),E.removeBg&&(n["Uses Video Remove Background"]=!0),E.blurBg&&(n["Uses Video Blurred Background"]=!0),E.chromaKey&&(n["Uses Chroma Key"]=!0),E.isReversed&&(n["Uses Reverse Effect"]=!0),E.presetFilter&&E.presetFilter.name&&"Original"!==E.presetFilter.name&&(n["Uses Preset Filter"]=!0),"video"===E.recordType&&(n["Strict Video Recorded Layers"]+=1),"audio"===E.recordType&&(n["Strict Audio Recorded Layers"]+=1),"screen"===E.recordType&&(n["Screen Recorded Layers"]+=1),"screen-video"===E.recordType&&(n["Video Recorded During Screen Record Layers"]+=1),"screen-audio"===E.recordType&&(n["Audio Recorded During Screen Record Layers"]+=1),E.preemptiveDownloadError&&(n["Preemptive Download Error Detected"]=!0),E.addedFromMediaLibrary&&(n["Uses Media Library"]=!0),E.locked&&(n["Has a Locked Layer"]=!0),"rectangle"===E.shapeType&&E.borderRadius&&"0"!==E.borderRadius.relative&&(n["Has Rounded Rectangles"]=!0),E.isZoomed&&(n["Uses Zoom"]=!0),E.detachedAudioId&&(n["Detached Video"]=!0),E.audioEffect&&"fade"===E.audioEffect&&("audio"===E.type&&(n["Used Audio Fade"]=!0),"video"===E.type&&(n["Used Audio Fade for Video Layer"]=!0)),E.volume&&E.volume>1&&(n["Set Volume > 100%"]=!0),"number"==typeof E.size&&(n["Total Uploaded File Size (MB)"]+=E.size/1e6),!y&&a.teams.activeBrandkit&&((null==(i=a.teams.activeBrandkit)?void 0:i.cmlIds)&&E.cmlFileId&&a.teams.activeBrandkit.cmlIds.includes(E.cmlFileId)||E.color&&a.teams.activeBrandkit.colors.includes({value:E.color,default:!1})||E.backgroundColor&&a.teams.activeBrandkit.colors.includes({value:E.backgroundColor,default:!1})||E.fontFamily&&a.teams.activeBrandkit.fonts.some((e=>e.fontFamily===E.fontFamily))||E.fontColor&&a.teams.activeBrandkit.colors.includes({value:E.fontColor,default:!1}))&&(n["Used Brandkit Asset"]=!0,y=!0),E.fromTextDefaults&&(n["Text Defaults Used"]=!0),E.hasAudio&&(h.add(E.asset_id),g.add(E.id))}if(n["Audible Assets"]=h.size,n["Audible Layers"]=g.size,n["GLTransitions Used"]=[...f],e.ratio&&(n.Ratio=e.ratio),e.audio&&e.audio.url&&(n["Has Audio"]=!0),n["Scene Count"]=1,e.scenes&&e.scenes.length>1&&(n["Scene Count"]=e.scenes.length),e.scenes){const t=e.scenes.map((e=>e.layers.filter((e=>"video"===e.type)).length)),a=Math.max(...t);n["Max Video Layers in Single Scene"]=a}if(e.groups&&Object.values(e.groups).filter((e=>e.saved)).length>0&&(n["Has a Group"]=!0),e.contextMenuUsed&&(n["Opened Context Menu"]=e.contextMenuUsed),null===e.duration&&(n["Null Duration"]=!0),void 0===e.duration&&(n["Undefined Duration"]=!0),Object.values(t.magicSubtitles||{}).some((e=>null==e?void 0:e.enabled))){const e=Object.entries(t.magicSubtitles||{}).filter((([e,t])=>null==t?void 0:t.enabled)).map((([e])=>e)),a=new Set,o=new Set;for(const n of e){const e=(null==(l=null==(s=t.magicSubtitles)?void 0:s[n])?void 0:l.transitionId)||Pr.None,{wordByWordAnimations:r}=(null==(c=t.magicSubtitles)?void 0:c[n])||{};if(r&&r.animationId!==Pr.None&&r.animationName!==Pr.None){const{animationId:e,animationName:t}=r,o=`${e}:${t}`;a.add(o)}e!==Pr.None&&o.add(e)}const r=[...o],i=[...a];r.length&&(n["Magic Subtitle Transitions"]=r.join(" ")),i.length&&(n["Magic Subtitle Animations"]=i.join(" "));for(const s of e){const e=null==(d=t.magicSubtitles)?void 0:d[s];if(!e)continue;e.transcriptionSource&&"transcription"!==e.transcriptionSource||(n["Used Magic Autogenerate"]=!0),e.translatedLanguageCode&&(n["Used Magic Translate"]=!0);const a=null==(u=t.magicSubtitleFrames)?void 0:u[s],o=!!(null==a?void 0:a.find((e=>e.words.find((e=>e.styles&&Object.keys(e.styles).length>1)))));n["Used Magic Subtitles Inline Styling"]=o}}}(e,t,r,a,s);s["Trim And Drag Onboarding Overlay Active"]=i;const{paymentPlan:d,teamSubscription:u,currentTeam:m}=sg();s["Team ID"]=m?m._id:"None",s["Current Plan"]=pu(d.planTier),s["Monthly/Annual"]=d.paymentTerm,s["Subscription Status"]=ig(u),s["Quantity Legacy Members"]=Hh(m).length,s["Number of Workspace Members"]=m?m.users.length:0,s["Is Team Member"]=Gu(null!=(o=e.teamId)?o:""),s["Is Project Owner"]=Hu(null!=(n=e.creatorId)?n:""),fm("Create Video",s),Ir("Create Video")}(e,t,a)}catch($ae){console.error($ae),j($ae)}}function lH({callToAction:e,template:t,originOverride:a}){const{state:o}=io(),{currentUser:n,templateSource:r}=o,i=a||o.studio.origin,s={"Call to Action":e};if(s["Landing Page"]=i,!(null==s?void 0:s["Landing Page"]))switch(e){case pm.GetStarted:s["Landing Page"]="Home Page",s["Landing Page URL"]="https://www.kapwing.com/";break;case pm.NewContentWorkspace:s["Landing Page"]="Workspace",s["Landing Page URL"]="https://www.kapwing.com/folder";break;case pm.EditThisTemplate:s["Landing Page"]=(null==t?void 0:t.title)||"Unknown",s["Landing Page URL"]=`https://www.kapwing.com/explore/${null==t?void 0:t.slug}`;break;default:s["Landing Page"]="undefined",s["Landing Page URL"]="undefined"}r&&(s["Template Source"]=r),n&&n.user&&(s["Project Owner Email"]=n.user.email),s["Trim And Drag Onboarding Overlay Active"]=!1;const{paymentPlan:l,teamSubscription:c,currentTeam:d}=sg();s["Team ID"]=d?d._id:"None",s["Current Plan"]=pu(l.planTier),s["Monthly/Annual"]=l.paymentTerm,s["Subscription Status"]=ig(c),s["Quantity Legacy Members"]=Hh(d).length,s["Number of Workspace Members"]=d?d.users.length:0,fm("Started Editing",s),Ir("Started Editing")}const cH=async e=>{var t,a;const{state:o}=io(),{workspaces:n}=o,r=e.workspaceId,i=n.allWorkspaces.find((e=>e._id===r));let s,l=null==i?void 0:i.type;try{!i&&r&&(l=await async function(e){return(await ap(`/api/v1/workspaces/type/${e}`)).folderType}(r))}catch($ae){console.error("Failed to fetch folder type",$ae)}switch(l){case Io.personal:s="Private";break;case Io.team:s="Team"}const c={"Is Team Member":Gu(null!=(t=e.teamId)?t:""),"Is Project Owner":Hu(null!=(a=e.creatorId)?a:"")};s&&(c["Project Location"]=s),fm("Access Final Video Page",c)};function dH({id:e,fileName:t}){return{type:"ADD_UPLOAD_STATUS",id:e,fileName:t}}function uH(e,t){return{type:"UPDATE_UPLOAD_STATUS",id:e,updates:t}}const mH=["library","resources","samples","static","team_assets","assets","conversions"],pH=["%252F","%2F"];function hH(e){if(null==e)return null;let t=e;for(const a of pH)for(const e of mH)t.startsWith(`${e}${a}`)&&(t=decodeURIComponent(t));return t}function gH(e){if(null==e)return[null,null];if(!e||"string"!=typeof e)return[null,null];const t=e.split("?",1)[0];let a,o;if(t.startsWith(uo)){const e=t.split(uo)[1].split("/");[,a]=e,o=e.slice(2).join("/")}else if(t.startsWith("https://cdn.kapwing.com"))a="kapwing",o=t.slice("https://cdn.kapwing.com".length+1);else if(t.startsWith(po))a=co,o=t.slice(po.length+1);else{a=co;try{o=new URL(t).pathname}catch($ae){}}return"undefined"===a&&(a=co),[a,hH(o)]}const fH=["topLeft","topRight","bottomLeft","bottomRight"],yH=["middleLeft","middleRight"],EH=[...fH,...yH],_H=["top","left","bottom","right"],vH=(e,t)=>Math.sqrt(e*e+t*t),wH=({x:e,y:t},{x:a,y:o})=>180*Math.atan2(o-t,a-e)/Math.PI,bH=e=>e*Math.PI/180,SH=e=>Math.cos(bH(e)),TH=e=>Math.sin(bH(e)),IH=(e,t,a)=>{let o=t,n=e+t;return n<=a&&(o=a-e,n=a),{deltaW:o,width:n}},kH=(e,t,a)=>{let o=t,n=e+t;return n<=a&&(o=a-e,n=a),{deltaH:o,height:n}},CH=(e,t,a,o,n,r,i)=>{const{rotateAngle:s}=t;let l,c,{width:d,height:u,centerX:m,centerY:p}=t,h=o,g=a;switch(e){case"topRight":if(n){const e=d+a,t=u-o,r=1/n+n;g=(e*n+t)/r-d,h=u-(e+t/n)/r}h=-h,c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,m+=g/2*SH(s)+h/2*TH(s),p+=g/2*TH(s)-h/2*SH(s);break;case"topLeft":if(n){const e=d-a,t=u-o,r=1/n+n;g=d-(e*n+t)/r,h=u-(e+t/n)/r}g=-g,h=-h,c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,m-=g/2*SH(s)-h/2*TH(s),p-=g/2*TH(s)+h/2*SH(s);break;case"bottomRight":if(n){const e=d+a,t=u+o,r=1/n+n;g=(e*n+t)/r-d,h=(e+t/n)/r-u}c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,m+=g/2*SH(s)-h/2*TH(s),p+=g/2*TH(s)+h/2*SH(s);break;case"bottomLeft":if(n){const e=d-a,t=u+o,r=1/n+n;g=d-(e*n+t)/r,h=(e+t/n)/r-u}g=-g,c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,n&&(u=d/n,h=g/n),m-=g/2*SH(s)+h/2*TH(s),p-=g/2*TH(s)-h/2*SH(s);break;case"middleRight":h=0,c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,m+=g/2*SH(s)-h/2*TH(s),p+=g/2*TH(s)+h/2*SH(s);break;case"middleLeft":g=-g,h=0,c=IH(d,g,r),l=kH(u,h,i),d=c.width,g=c.deltaW,u=l.height,h=l.deltaH,m-=g/2*SH(s)+h/2*TH(s),p-=g/2*TH(s)-h/2*SH(s)}return{position:{centerX:m,centerY:p},size:{width:d,height:u}}},NH=(e,t,a,o)=>{const{x:n,y:r,width:i,height:s}=e,{x:l,y:c}=t,{x:d,y:u,width:m,height:p}=a,h=t.width/a.width,g=t.height/a.height;let f,y;switch(o){case"topLeft":f=l-d,y=c-u;break;case"topRight":f=l+m-(d+m),y=c+p-(u+p);break;case"bottomLeft":f=-(d-l),y=-(u-c);break;case"bottomRight":f=0,y=0;break;default:return null}return{x:(n-l+f)*h+l,y:(r-c+y)*g+c,width:i*g,height:s*g}},AH=(e,t,a)=>{const o=e.x+e.width/2,n=e.y+e.height/2,r=t.x+t.width/2,i=t.y+t.height/2,s=t.rotation-a.rotation,l=s*Math.PI/180;let c;c=a.rotation!==e.rotation?s+e.rotation:t.rotation;const d=Math.cos(l)*(e.x-o)-Math.sin(l)*(e.y-n)+o,u=Math.cos(l)*(e.y-n)+Math.sin(l)*(e.x-o)+n,m=Math.cos(l)*(e.x-r)-Math.sin(l)*(e.y-i)+r,p=Math.cos(l)*(e.y-i)+Math.sin(l)*(e.x-r)+i;return{newX:e.x+m-d,newY:e.y+p-u,layerRotation:c}},xH=e=>{const t={topLeft:e[0]<=e[2]&&e[1]<=e[3],bottomLeft:e[0]<=e[2]&&e[1]>=e[3],topRight:e[0]>=e[2]&&e[1]<=e[3],bottomRight:e[0]>=e[2]&&e[1]>=e[3]};return EH.find((e=>!0===t[e]))||"topLeft"},PH=(e,t,a,o)=>{const n=t-o,r=a-o;return{topLeft:[0,0,n,r],topRight:[n,0,0,r],bottomLeft:[0,r,n,0],bottomRight:[n,r,0,0],middleLeft:[0,r/2,n,0],middleRight:[n,r/2,0,0]}[e]},RH=(e,t,a,o,n,r,i,s,l,c)=>{let d=n,u=r,m=i,p=s,h=l;const g=o=>"start"===e?a[o]:t[o],f=g("x"),y=g("y");let E=o;const _=E-45*Math.floor(E/45);if(_>=41){E+=45-_}else _<=4&&(E-=_);(Math.abs(E)<1||Math.abs(E)>359)&&(E=0);let v="";switch(E){case 0:d=f+c,m=c,h=[0,0,0,p-c],v="vertical";break;case 90:u=y+c,p=c,h=[0,0,m-c,0],v="horizontal";break;case-90:u=y+c,p=c,h=[m-c,0,0,0],v="horizontal";break;case 180:case-180:d=f+c,m=c,h=[0,p-c,0,0],v="vertical"}return{x:d,y:u,width:m,height:p,points:h,lineRightAngle:v}},OH=e=>{if(qc(e))return!0;return 0===e.button};var DH={alignVert:!1,alignHoriz:!1,multiLine:!1,detectMultiLine:!0,minFontSize:6,maxFontSize:80,reProcess:!0,widthOnly:!1,alignVertWithFlexbox:!1};function LH(e,t){if(a=e,!("object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName)||!t.reProcess&&e.getAttribute("textFitted"))return!1;var a,o,n,r,i,s,l,c;if(t.reProcess||e.setAttribute("textFitted",1),r=e.innerHTML,i=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().width-parseInt(t.getPropertyValue("padding-left"),10)-parseInt(t.getPropertyValue("padding-right"),10)}(e),n=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().height-parseInt(t.getPropertyValue("padding-top"),10)-parseInt(t.getPropertyValue("padding-bottom"),10)}(e),!i||!t.widthOnly&&!n)throw t.widthOnly?new Error("Set a static width on the target element "+e.outerHTML+" before using textFit!"):new Error("Set a static height and width on the target element "+e.outerHTML+" before using textFit!");-1===r.indexOf("textFitted")?((o=document.createElement("span")).className="textFitted",o.style.display="inline-block",o.innerHTML=r,e.innerHTML="",e.appendChild(o)):UH(o=e.querySelector("span.textFitted"),"textFitAlignVert")&&(o.className=o.className.replace("textFitAlignVert",""),o.style.height="",e.className.replace("textFitAlignVertFlex","")),t.alignHoriz&&(e.style["text-align"]="center",o.style["text-align"]="center");var d=t.multiLine;t.detectMultiLine&&!d&&o.scrollHeight>=2*parseInt(window.getComputedStyle(o)["font-size"],10)&&(d=!0),d||(e.style["white-space"]="nowrap"),s=t.minFontSize,c=t.maxFontSize;for(var u=s;s<=c;)l=c+s>>1,o.style.fontSize=l+"px",o.getBoundingClientRect().width<=i&&(t.widthOnly||o.getBoundingClientRect().height<=n)?(u=l,s=l+1):c=l-1;if(o.style.fontSize!=u+"px"&&(o.style.fontSize=u+"px"),t.alignVert){!function(){if(document.getElementById("textFitStyleSheet"))return;var e=[".textFitAlignVert{","position: absolute;","top: 0; right: 0; bottom: 0; left: 0;","margin: auto;","display: flex;","justify-content: center;","flex-direction: column;","}",".textFitAlignVertFlex{","display: flex;","}",".textFitAlignVertFlex .textFitAlignVert{","position: static;","}"].join(""),t=document.createElement("style");t.type="text/css",t.id="textFitStyleSheet",t.innerHTML=e,document.body.appendChild(t)}();var m=o.scrollHeight;"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),UH(o,"textFitAlignVert")||(o.className=o.className+" textFitAlignVert"),o.style.height=m+"px",t.alignVertWithFlexbox&&!UH(e,"textFitAlignVertFlex")&&(e.className=e.className+" textFitAlignVertFlex")}}function UH(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}const MH=(e,t,a,o)=>{const n=document.createElement("div");return n.style.overflow="hidden",n.style.position="relative",n.style.width="0px",n.style.height="0px",e&&(n.style.position="fixed",n.style.bottom="0",n.style.right="0",n.style.width=t,n.style.height=a,n.style.zIndex="100",n.style.background=o),document.body.appendChild(n),n},FH=e=>{const{div:t,layer:a}=e;t.style.display="inline-block",t.style.verticalAlign="middle",t.style.outline="none";const{fontWeight:o,italic:n,fontFamily:r,text:i,textShadow:s,textAlign:l,lineHeight:c}=a;let d="normal";o&&o.includes("bold")&&(d="bold"),t.style.fontWeight=d,t.style.fontStyle=n?"italic":"",t.style.fontFamily=r,t.style.textAlign=l||"left",t.style.whiteSpace="pre-line",t.style.lineHeight=String(c),t.textContent=i,t.style.textShadow=`-1px -1px 0 ${s}, 1px -1px 0 ${s}, -1px 1px 0 ${s}, 1px 1px 0 ${s}`};function BH(e,t,a,o=!1){var n;if(""===e.text.trim())return null!=(n=e.fontSize)?n:16;if(t<=0||a<=0)return null;const r=document.createElement("div"),i=Math.abs(t),s=Math.abs(a),l={div:r,layer:e},c=MH(o,`${i}px`,`${s}px`,"white");if(i&&s&&i>0&&s>0){r.style.width=`${i<1?1:i}px`,r.style.height=`${s<1?1:s}px`,FH(l),c.appendChild(r),function(e,t){t||(t={});var a={};for(var o in DH)t.hasOwnProperty(o)?a[o]=t[o]:a[o]=DH[o];"function"==typeof e.toArray&&(e=e.toArray());var n=Object.prototype.toString.call(e);"[object Array]"!==n&&"[object NodeList]"!==n&&"[object HTMLCollection]"!==n&&(e=[e]);for(var r=0;r<e.length;r++)LH(e[r],a)}(r,{multiLine:!0,minFontSize:1,maxFontSize:500});const e=parseInt(r.getElementsByTagName("span")[0].style.fontSize,10);return o||c.remove(),Math.max(e,1)}return 16}function WH(e){const t=e.position?e.position.width:"0",a=e.position?e.position.height:"0",{width:o,height:n}=function(e,t){const{state:a}=io(),o=a.studio.width||0,n=a.studio.height||0;return{width:parseFloat(e)/100*o,height:parseFloat(t)/100*n}}(t,a);return BH(e,o,n)}const VH=(e,t,a)=>t<a?{height:e,width:a/t*e}:{height:t/a*e,width:e},jH=["8","9","10","11","12","14","18","24","30","36","48","64","72","96","100","125","150"],HH=()=>{const e=[];return jH.forEach((t=>{e.push({iconUrl:"",value:t,label:`${t}`})})),e},GH=()=>{const e=[];return yr.forEach((t=>{e.push(t)})),e},$H=e=>{KH(e).forEach((e=>QN(e,!1)))},KH=e=>[e,{...e,fontFamily:`asset_${e.asset_id}`}],YH=()=>{const{state:e}=io(),{teams:{activeBrandkit:t}}=e,a=null==t?void 0:t.fonts;null==a||a.forEach((e=>{if("custom"===e.type){const{fontFamily:t,url:a,asset_id:o}=e;$H({fontFamily:t,url:a,asset_id:o})}}))},zH=({nameType:e,name:t},a,o,n)=>{let r;if("blob"===e){const e=t.split("-");if(e.length>=2){const[t]=e;r=t}else e.pop(),r=e.join("-")}else[r]=t.split(".");return{fontFamily:r,url:a,fontType:o.includes("ttf")?"truetype":"opentype",asset_id:n}};function qH(e,t){const a=e/t;return!a||Number.isNaN(a)?1:a}function JH(e,t,a,o,n){const r=BH(void 0!==o?{...e,text:o}:e,t,a);if(!r)return;const i={fontSize:r,baseWidth:t,baseHeight:a};A(n,i)||zl(e.id,{fontSizingTemp:i})}function XH(e,t){return t?Math.round(e/t*700):e}function QH(e,t){return t?e/700*t:e}function ZH(e,t,a,o){const n=[];let r=0;const i=document.createElement("canvas").getContext("2d");if(i&&e&&t){const s=e.fontWeight||"normal",l=GT(e,e.fallbackFonts||[]),c=e.italic?"italic":"normal";i.font=`${c} normal ${s} ${o}px ${l}`,r=i.measureText("W").width;a.replaceAll("\r\n","").split("\n").forEach((e=>{const a=function(e,t,a){const o=[];if(t.length<1)return o;let n="";const r=[" ","-"];let i=-1;for(let l=0;l<t.length;l+=1){const c=t.charAt(l);e.measureText(n+c).width>=a&&(-1!==i?(o.push(n.substring(0,i+1)),n=n.substring(i+1)):(o.push(n),n=""),i=-1),s=c,r.includes(s)&&(i=n.length),n+=c}var s;return n.length>0&&o.push(n),o}(i,e,t),o=a.join("\r\n");n.push(o)}))}return{textWithLineBreaks:n.join("\n"),minWidth:r}}const eG=(e,t)=>{const a=ob(t);return[...(null==a?void 0:a.recentlyUsedFonts)||[]].filter((t=>"custom"!==t.type||t.asset_id!==e.asset_id))},tG=(e,t)=>{const a=ob(t),o=[...(null==a?void 0:a.recentlyUsedFonts)||[]],n=o.findIndex((t=>"default"===e.type?"default"===t.type&&t.fontFamily===e.fontFamily:"custom"===t.type&&t.asset_id===e.asset_id));return-1!==n?o.splice(n,1):5===o.length&&o.pop(),o.unshift(e),o},aG=async(e,t)=>{const{asset_id:a}=e;await tp("/api/v1/workspaceAssets",{body:{asset_id:a}})},oG=async()=>{const{dispatch:e,state:t}=io(),{workspaces:a,currentUser:o}=t,n=Du({team:Bu(t)},au.BRANDKIT);try{const t=a.selectedWorkspace;if(!t||"shared-with-me"===t||!n)return;const r=await(async(e,t)=>{const{token:a,user:o}=t||{},n={token:a,userId:o&&o._id,workspaceId:e,type:"font"},{dispatch:r}=io();try{const e=await ap("/api/v1/workspaceAssets",{params:n}),t=[];return e.forEach((e=>{const a=zH({nameType:"blob",name:e.blob_name},e.url,e.content_type,e._id);$H(a);const o={source:e.source,...a};t.push(o)})),t}catch(i){return console.error(i),r(wh("There was an error while loading your font assets. Please refresh the page and try again.")),[]}})(t,o);e(Zf(t,r))}catch(r){console.error(r),e(wh("There was an error while loading your custom fonts. Please refresh the page and try again."))}},nG=()=>{const{state:e}=io(),t=e.workspaces.selectedWorkspace;if(t){const e=ob(t),{customFonts:a}=e||{};return a}},rG=e=>{const{dispatch:t,state:a}=io();t({type:"SHOW_STUDIO_CANVAS"});const o=function(e="30%",t="30%"){let a=100-parseInt(e,10)-20;a<5&&(a=5);const o=Math.random()*(a-3)+3,n=15*Math.random()+5;return{x:cd(o),y:cd(n),width:e,height:t,rotation:0}}((null==e?void 0:e.width)||"45%",(null==e?void 0:e.height)||"8%"),n=(null==e?void 0:e.font)||(()=>{const{state:e}=io(),{selectedWorkspace:t}=e.workspaces,a=ob(t);return a&&a.recentlyUsedFonts&&a.recentlyUsedFonts.length>0?a.recentlyUsedFonts[0]:null})()||{type:"default",fontFamily:"Arial"};let r={id:y(),type:xr.Text,backgroundColor:(null==e?void 0:e.backgroundColor)||"rgba(-255,-255,-255,0)",borderRadius:(null==e?void 0:e.borderRadius)||{relative:"25%"},color:(null==e?void 0:e.color)||"#000000",fontFamily:(null==e?void 0:e.fontFamily)||n.fontFamily,fontSize:null==e?void 0:e.fontSize,baseWidth:null==e?void 0:e.baseWidth,baseHeight:null==e?void 0:e.baseHeight,italic:null==e?void 0:e.italic,fontWeight:(null==e?void 0:e.fontWeight)||"normal",globalAlpha:(null==e?void 0:e.globalAlpha)||1,lineHeight:(null==e?void 0:e.lineHeight)||1,lockAspectRatio:!0,position:o,text:"Sample text",textAlign:(null==e?void 0:e.textAlign)||"center",textShadow:(null==e?void 0:e.textShadow)||"transparent",underline:null==e?void 0:e.underline,wrapOrFill:(null==e?void 0:e.wrapOrFill)||"wrap",textPadding:(null==e?void 0:e.textPadding)||12.5};const i=xc(r);if(i){const{width:e,height:t}=i,a=BH(r,e,t);a&&!r.fontSize&&(r.baseWidth=e,r.baseHeight=t,r.fontSize=a);const o=(r.lineHeight||1)*(r.fontSize||0),{textWithLineBreaks:n}=ZH(r,e,r.text,r.fontSize||0),s=Tc(e,n.split("\n").length*o);r.position&&(r.position.height=s.heightPercent)}const{type:s,...l}=n;if("custom"===n.type){r={...r,...l,hasCustomFont:!0};const e={fontFamily:n.fontFamily,url:n.url,fontType:n.fontType,asset_id:n.asset_id};$H(e)}if(!r.fontSize){const e=WH(r);r.fontSize=e||void 0}return hR(r,{sceneId:a.studio.scenes[0].id,undoable:!0}),t({type:"ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",id:r.id}),r},iG=(e,t,a,o=!1,n=!1)=>{const{state:r,dispatch:i}=io(),s=fn(r,e.id).fontSizingTemp,l=n&&null!=s?s:e;if(l&&(l.baseWidth!==t||l.baseHeight!==a)){if(n)return void zl(e.id,{fontSizingTemp:{fontSize:l.fontSize,baseWidth:t,baseHeight:a}});i(ds(e,{baseWidth:t,baseHeight:a},o))}},sG=(e,t="")=>{const{state:a}=io();if(!yn(a,e.id)||"text"!==e.type)return;const{textTemp:o=""}=fn(a,e.id);""!==o||""!==t?zl(e.id,{isEditing:!1}):kR(e.id,!0)},lG=e=>{const{dispatch:t}=io();t(nl(e))},cG=(e,t,a=!1)=>{var o;const{width:n,x:r,y:i}=t||xc(e),{containerWidth:s,containerHeight:l}=((e,t,a=!1)=>{const{fontSize:o,lockAspectRatio:n}=e,r=document.createElement("div");if(FH({div:r,layer:e}),r.style.fontSize=`${o}px`||"",n){const{baseHeight:t=0,baseWidth:a=0}=e;r.style.height="1px",r.style.width="1px",document.body.appendChild(r);const o={containerHeight:0,containerWidth:0};let n=1;const{containerHeight:i,containerWidth:s}=io().state.studio;for(;r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth;){if(n>i&&n>s)return r.remove(),o;const{height:e,width:l}=VH(n,t,a);o.containerHeight=e,o.containerWidth=l,r.style.height=`${e}px`,r.style.width=`${l}px`,n+=1}return r.remove(),o}const i=MH(a,`${t}px`,"auto","blue");i.style.width=`${t}px`,i.appendChild(r);const{width:s}=r.getBoundingClientRect(),{height:l}=r.getBoundingClientRect();return a||i.remove(),{containerWidth:s,containerHeight:l}})(e,n),c=a?n:s,d=l,u={x:r,y:i,width:c,height:d,rotation:null==(o=e.position)?void 0:o.rotation};bR(e,u,!0),iG(e,c,d,!0)};function dG(e,t,a,o=!0){const{dispatch:n}=io(),r=BH(e,t,a);if(!r)return e.fontSize;const i=qH(t,e.baseWidth);return r===e.fontSize&&1===i&&null!=e.baseWidth||(o?tr.execInUndoBatch((()=>{n(ds(e,{fontSize:r},!0)),iG(e,t,a,!0)})):(n(ds(e,{fontSize:r},!1)),iG(e,t,a,!1))),r}const uG=(e,t,a,o)=>{const{dispatch:n}=io();n(gs(e,t,a,o))},mG=(e,t,a,o)=>{const{dispatch:n}=io();n(fs(e,t,a,o))},pG=(e,t,a)=>{const{dispatch:o}=io();o(ys(e,t,a))},hG=(e,t,a)=>{const{dispatch:o}=io();o(function(e,t,a){return{type:"ADD_GROUP_TO_GROUP",srcGroupId:e,destGroupId:t,undoable:a}}(e,t,a))},gG=(e,t,a)=>{const{dispatch:o}=io();o(function(e,t,a){return{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:e,destGroupId:t,undoable:a}}(e,t,a))},fG=r((e=>{var t,a;return e.studio.groups[null!=(a=null==(t=e.studio.selectedItem)?void 0:t.id)?a:""]}),(e=>e.studio.allLayers.byId),((e,t)=>{var a;if(!e||!e.layers||!e.layers.length)return;const o=null==(a=t[e.layers[0].id])?void 0:a.type;return!o||e.layers.every((e=>{var a;return(null==(a=t[e.id])?void 0:a.type)===o}))?o:void 0})),yG=e=>e.some((e=>!("audio"===e.type&&!e.isAudiogram))),EG=(e,t,a=!0)=>{const{state:o,dispatch:n}=io(),{selectedItem:r,groups:i}=o.studio,s=(null==r?void 0:r.id)||"";if(e&&s!==e)if(i[s]){const o=s,n=i[s].layers.find((t=>t.id===e));n?n.fromMergedGroup?gG(n.fromMergedGroup,o,t):pG(e,o,t):uG(e,o,a,t)}else{const o=y();n(Is({id:o,type:"group"})),i[s]?hG(s,o,t):uG(s,o,a,t),uG(e,o,a,t)}},_G=(e,t,a,o=!0)=>{const{state:n,dispatch:r}=io(),{groups:i}=n.studio;if(e!==t)if(i[e]){const o=e;i[o].layers.map((e=>e.id)).some((e=>i[t].layers.map((e=>e.id)).includes(e)))?gG(t,o,a):hG(t,o,a)}else{uG(e,t,o,a),r(Is({id:t,type:"group"}))}},vG=(e,t=!0)=>{const{dispatch:a,state:o}=io(),{groups:n}=o.studio,r=Object.keys(n).find((t=>A(n[t].layers.map((e=>e.id)),e))),s=Object.keys(n),l=[],c=[];e.forEach((e=>{s.includes(e)?l.push(e):c.push(e)}));const d=l.shift()||y();if(e.length>0){if(r)return a(Is({id:r,type:"group"})),r;if(1===e.length){const t=Object.keys(n).find((t=>t===e[0]));return a(Is({id:e[0],type:t?"group":"layer"})),e[0]}return i.exports.batch((()=>{l.forEach((e=>{hG(e,d,!1)})),c.length>0&&mG(c,d,t,!1),a(Is({id:d,type:"group"}))})),d}return a(Is(null)),null},wG=(e,t)=>{const a=(null==t?void 0:t.state)||io().state,{groups:o,selectedItem:n}=a.studio;if(!n||"group"!==n.type)return!1;const r=(null==t?void 0:t.currentGroup)||o[n.id];return!!r&&!!r.layers.find((({id:t})=>e===t))},bG=(e,t=!0)=>{const{state:a}=io(),{selectedItem:o}=a.studio;o&&"group"===o.type&&SG(o.id,e,t)},SG=(e,t,a=!0)=>{const{state:o,dispatch:n}=io(),{groups:r}=o.studio;i.exports.batch((()=>{t&&r[e].layers.forEach((t=>{const i=Object.keys(r).filter((a=>a!==e&&wG(t.id,{currentGroup:r[a],state:o})));i.length>0&&i.forEach((e=>{n(Es(e,!1,a)),n(Is(null,!1))}))})),n(Es(e,t,a)),!1===t&&n(Is(null,!1))}))};function TG(e,t){var a,o;const{state:n,dispatch:r}=io(),{scenes:i}=n.studio,{layers:s,duration:l}=i[n.studio.selectedSceneIndex],c=[];let d=Number.MAX_SAFE_INTEGER;for(const y of e.layers){let t=null==(a=e.hydratedLayers)?void 0:a.find((({id:e})=>e===y.id));if(t||(t=null!=(o=sR(y.id))?o:void 0),t){const{start:e}=ei(t,l);e<d&&(d=e),c.push(t)}}const u=y(),{minTimelineRow:m}=function(e){let t=-1,a=Number.MAX_SAFE_INTEGER;for(const o of e)null!=o.timelineRow&&(o.timelineRow<a&&(a=o.timelineRow),o.timelineRow>t&&(t=o.timelineRow));return t=Math.max(t,1),a=Math.min(t,a),t+=1,{minTimelineRow:a,maxTimelineRow:t}}(s),p=ic()-d,h={},g=c.map((e=>{var t,a,o;const n={timelineRow:0,...e,id:y()};if($r(n)||jr(n)?n.videoDelay=(null!=(t=n.videoDelay)?t:0)+p:(n.startTime=(null!=(a=n.startTime)?a:0)+p,n.endTime=(null!=(o=n.endTime)?o:0)+p),Jr(n)){const t=pv(e);n.animation={intro:[],constant:[],outro:[]};["intro","constant","outro"].forEach((a=>{var o,i;const s=t[a][0];if(s&&s.id!==Pr.None)if(s.isCrossTransition){const t=s.animationStateMapId,a=s.introLayerId===e.id;h[t]||(h[t]={animationName:s.transitionId,speed:s.speed}),h[t][a?"newIntroLayer":"newOutroLayer"]=n}else{const e={id:y(),animationName:s.id,isCrossTransition:!1,layerId:n.id,speed:s.speed};null==(i=null==(o=n.animation)?void 0:o[a])||i.push(e.id),r(zi(e))}}))}return n.timelineRow<m&&(n.timelineRow=m+n.timelineRow),n}));Object.values(h).filter((e=>!!e.newIntroLayer&&!!e.newOutroLayer)).forEach((({newIntroLayer:e,newOutroLayer:t,animationName:a,speed:o})=>{var n,i,s,l;const c={id:y(),animationName:a,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id,speed:o};null==(i=null==(n=e.animation)?void 0:n.intro)||i.push(c.id),null==(l=null==(s=t.animation)?void 0:s.outro)||l.push(c.id),r(zi(c))}));const{isTimelineGroup:f=!1}=e;g.forEach((e=>{hR(e,{undoable:t})}));const E=e.saved;g.forEach((e=>{uG(e.id,u,f,t)})),E&&SG(u,!0,t),r(Is({id:u,type:"group"}))}const IG=(e,t=!0)=>{try{t&&tr.beginBatch(),TG(e,t)}finally{t&&tr.endBatch()}},kG=()=>{const e=CG(!0);e&&IG(e,!0)},CG=e=>{const{state:t}=io(),{selectedItem:a}=t.studio;return a&&"group"===a.type?NG(a.id,e):null},NG=(e,t)=>{var a;const{state:o}=io();let n=null==(a=o.studio.groups)?void 0:a[e];if(n){if(t){const e=[];n.layers.forEach((t=>{const a=sR(t.id);a&&e.push({...a})})),n={...n,hydratedLayers:e}}return n}return null};const AG=()=>{const{studio:e}=io().state,{selectedSceneIndex:t,scenes:a,groups:o}=e,n=a[t].layers;let r=n.filter((e=>e.type!==xr.Subtitle)).map((e=>e.id));if(0===r.length){if(!(n.length>0))return;r=n.map((e=>e.id))}vG(((e,t)=>{const a=new Set,o=[];for(const n of e)if(!a.has(n)){const e=Object.keys(t).find((e=>t[e].saved&&t[e].layers.find((e=>e.id===n))));e?(o.push(e),t[e].layers.forEach((e=>a.add(e.id)))):o.push(n)}return o})(r,o))},xG=tr.withUndoBatch(((e,t,a=!0)=>{const{rotation:o,origin:n,xDiff:r,yDiff:s,transformerNode:l}=t;void 0!==o&&((e,t,a)=>{const{dispatch:o,state:{studio:n}}=io(),r=n.groups[e],{rotation:s,currentPosition:l,initialPosition:c}=t;s&&l&&c&&i.exports.batch((()=>{OG(e,{rotation:s},a);for(const{id:e}of r.layers){const t=IE(e,n);if(!t)continue;const{position:r}=t;let i=xc(t);"shape"===t.type&&"ellipse"===t.shapeType&&(i={...i,x:i.x-i.width/2,y:i.y-i.height/2});const s=AH(i,l,c),{layerRotation:d}=s;let{newX:u,newY:m}=s;"shape"===t.type&&"ellipse"===t.shapeType&&(u+=i.width/2,m+=i.height/2);const{xPercent:p,yPercent:h}=Nc(u,m);o(os(t,d,a)),zl(t.id,{positionTemp:null}),o(es(t,p,h,r.width,r.height,a))}}))})(e,t,a),(r||s)&&((e,t,a)=>{const{xDiff:o,yDiff:n}=t,{dispatch:r,state:{studio:i}}=io(),s=i.groups[e];for(const{id:l}of s.layers){const e=IE(l,i);if(!e)continue;const{position:t}=e,{x:s,y:c}=Ec(t.x,t.y),{xPercent:d,yPercent:u}=Nc(s+o,c+n);zl(e.id,{positionTemp:null}),r(es(e,d,u,t.width,t.height,a))}})(e,t,a),l&&((e,t,a)=>{const{currentPosition:o,initialPosition:n,transformerNode:r}=t;if(!r||!o||!n)return;const{dispatch:i,state:{studio:s}}=io(),l=s.groups[e];for(const{id:c}of l.layers){const e=IE(c,s);if(!e)continue;const t=NH(xc(e),o,n,r),{xPercent:l,yPercent:d}=Nc(t.x,t.y),{widthPercent:u,heightPercent:m}=Tc(t.width,t.height);zl(e.id,{positionTemp:null}),i(es(e,l,d,u,m,a)),Yr(e)&&dG(e,t.width,t.height,a)}})(e,t,a),n&&OG(e,{origin:n},a)})),PG=tr.withUndoBatch(((e,t=!0)=>{const{dispatch:a,state:o}=io(),{groups:n,scenes:r,selectedSceneIndex:i}=o.studio,{layers:s}=r[i],l=n[e];if(t){const t=[...s],o=n[e].layers.map((e=>sR(e.id))).filter((e=>e));tr.add({type:"STUDIO_DELETE_GROUP",undo:{func(){for(const e of o){hR(e,{layerIndex:SE(t,e.id),isUndo:!0})}OG(e,l,!1),a(Is({type:"group",id:e})),l.saved&&bG(!0,!1)}},redo:{type:"REMOVE_GROUPED_LAYERS",func(){PG(e,!1)}}})}if(l){for(const e of l.layers)kR(e.id,!1,!0);l.saved&&OG(e,{saved:!1},!1)}a(Is(null))})),RG=tr.withUndoBatch(((e,t,a=!0)=>{const{state:o}=io(),n=o.studio.groups[e].layers.map((e=>e.id)),r=o.studio.scenes[0].layers.filter((e=>n.includes(e.id))),i={width:o.studio.width||0,height:o.studio.height||0};let s=null;if(t){const t=vd(r,0);if(t.width>i.width){const o=i.width-t.width;if(s={width:i.width,height:t.height*i.width/t.width,x:t.x-o/2,y:t.y-o/2},s.height>i.height){const e=i.height-s.height;s={width:s.width*i.height/s.height,height:i.height,x:s.x-e/2,y:s.y-e/2}}xG(e,{initialPosition:t,currentPosition:s,transformerNode:"topLeft"},a)}const o=s?{x:s.x+s.width/2,y:s.y+s.height/2}:Ed(r),n=Ec(50,50),l=n.x-o.x,c=n.y-o.y;xG(e,{xDiff:l,yDiff:c},a)}})),OG=(e,t,a=!0)=>{const{dispatch:o}=io();o(function(e,t,a){return{type:"UPDATE_GROUP",groupId:e,updates:t,undoable:a}}(e,t,a))},DG=(e,t=!0)=>{const{dispatch:a,state:o}=io(),n=o.studio.groups[e],{layers:r}=n,s=o.studio.scenes[o.studio.selectedSceneIndex].layers.filter((e=>r.map((e=>e.id)).includes(e.id))),l=s.every((e=>e.locked));i.exports.batch((()=>{for(const e of s)a(ds(e,{locked:!l},!1))})),a(Is(null)),t&&tr.add({undo:{func(){i.exports.batch((()=>{for(const e of s)a(ds(e,{locked:e.locked},!1))}))}},redo:{func(){DG(e,!1)}}})};async function LG(e,t){if(!e.length)return[];const{dispatch:a}=io(),{uploadOptions:{multiRowUploadForRecording:o}}=t;let n=Array.from(e).sort(((e,t)=>e.lastModified-t.lastModified));o&&(n=n.sort(((e,t)=>"screen"===e.recordType?-1:1)));const r=new rt(8),i=(await Promise.all(n.map(((e,a)=>r.runExclusive((()=>async function(e,t,a){var o;const{dispatch:n,state:r}=io();let i,s,l,c=e;const d=UG(t,a),{uploadOptions:{dragUpload:u,isMediaLibraryUpload:m,uploadLocation:p,doDuplicateHandling:h,convertToAudio:g,isThumbnail:f,analyticsUploadSource:y},validationOptions:E,uploadId:_}=d;f||(fm("Upload Started",{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":y}),m||Em(null==(o=e.type)?void 0:o.split("/")[0],y));const v=((e,t)=>{var a;const{audiogramUpload:o=!1,audioUpload:n=!1,disallowImages:r=!1,disallowGif:i=!1,disallowVideo:s=!1,fontUpload:l=!1}=t,c=Kk(e);return c?(null!=(a=e.size)?a:0)>6442450944?"You file is over 6GB and cannot be uploaded.":0===e.size?`Your upload has an invalid size of ${e.size} bytes. Please choose a valid file to upload.`:i&&"image/gif"===c?"Removing background from gifs is currently not supported. We support .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, and .mpeg formats for this feature.":!s||o||zk(c)?qk(c)||mC(c)||!n?qk(c)||mC(c)||!r?zk(c)||qk(c)||mC(c)||l?!l||c.endsWith("ttf")||c.endsWith("otf")?null:"Upload failed. Please upload a font with valid file types.":"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, .mpeg formats.":"You must choose video/audio to use this feature. Currently we support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"Your file format is not currently supported. Currently we only support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.":"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension."})(e,E);if(v)return n(wh(v)),$G(d),{};if(E.fontUpload){const t={...iV(),uploadId:_,type:xr.Image,source:"upload",name:e.name};VG(d,e,t)}else try{if(i=await sV(e,{uploadId:_,uploadLocation:u?"dragUpload":p,isMediaLibraryUpload:m},{addAtSeeker:t.uploadOptions.addAtSeeker}),g&&i.type!==xr.Image&&!i.hasAudio)throw i=void 0,new Error("Please upload a file with Audio");if(c=await YG(d,e,i),h){const t=t$(e),a=await t.arrayBuffer(),o=await crypto.subtle.digest("SHA-256",a);if(s=a$(o),s){const e=r.CMLFiles.byId;for(const t of r.CMLFiles.myMediaIds){const a=e[t];(null==a?void 0:a.hash)&&0===Buffer.compare(s,new Uint8Array(a.hash.data))&&(l=a)}}}await dC(c,i)&&(i.requireConversion=!0,delete i.local_url)}catch(w){console.error(w),n(wh(w.message)),fm("Upload Fails",{FailStage:"Process File and Create Layer",Origin:p,Message:w.message,FileType:e.type,"File Size (MB)":e.size/1e6}),$G(d)}return{file:c,layer:i,bundle:d,hash:s,cmlDuplicate:l}}(e,t,a))))))).filter((({layer:e})=>e));return i.length?(a(fl(!0)),o||ZG(i),async function(e){const{dispatch:t,state:{assets:{byId:a},editorPath:o,mediaCache:{assetIdToMediaCacheId:n},studio:{_id:r,selectedItem:i,allLayers:{byId:s}},studioLocal:{localProjectId:l},uploadStatuses:c}}=io();let d=!1;await Promise.all(e.map((async({file:e,layer:o,bundle:u,hash:m,cmlDuplicate:p})=>{if(!o)return;const{omitFromMediaLibrary:h,fontUpload:g,isMediaLibraryUpload:f,replace:E,convertToAudio:_}=u.uploadOptions;let v;if(h||!o.uploadId||g||(v=y(),t(zc({mediaCacheId:v,uploadId:o.uploadId}))),p){!async function(e){const{dispatch:t}=io();t(ch({id:e.id,modified:new Date})),await np("/api/v1/cloudMediaLibrary/myMedia/updateFileModifiedDate",{body:{cmlFileID:e.id}})}(p),t(mS(p,r));const m=p.asset_id,h=a[m],g=n[m];if((!g||!(await zW(g)))&&v)try{$W({mediaCacheId:v,type:o.type,file:e}),t(Yc({mediaCacheId:v,assetId:m}))}catch(w){console.error(w)}let y={};if(_&&(y={type:xr.Audio,convert_type:"audio"}),E&&i&&h){s[i.id]&&n$(p,h,y)}else!f&&h&&(o$(p,h,y),t(Il(m)));t(uH(u.uploadId,{stage:Cs.done})),d=!0;const b=l!==u.initialLocalProjectId;QG(o,c,u,{retries:0},{projectIdChanged:b,isDuplicateUpload:!0})}else{u.hash=m;try{if(o.requireConversion)o.conversion_type=$k(o.url,e.type),XG(u,e,o);else{if(v)try{const a=await $W({mediaCacheId:v,type:o.type,file:e});o.isMediaLibraryUpload&&t(fi(v)),a&&fm("Upload Failed IDB Add",{fileType:e.type,fileSize:e.size})}catch(b){console.error(b)}zG(u,e,o)}}catch(b){console.error(b),t(wh(b.message)),$G(u)}}}))),e.length>1&&e[0].bundle.uploadOptions.multiRowUploadForRecording&&tr.execInUndoBatch((()=>{const t=y();mG(e.filter((e=>e.layer)).map((e=>{var t;return(null==(t=e.layer)?void 0:t.id)||""})),t,!0,!0),SG(t,!0,!0)}));t(fl(!1)),d&&Ml(o)}(i),i.filter((({layer:e})=>e)).map((e=>e.bundle.uploadId))):[]}function UG(e,t){const a=y();let{analyticsUploadSource:o}=e.uploadOptions;return void 0!==t&&e.uploadOptions.analyticsUploadSources&&(o=e.uploadOptions.analyticsUploadSources[t]),{eventHandlers:{...e.eventHandlers},initialLocalProjectId:io().state.studioLocal.localProjectId,uploadOptions:{...e.uploadOptions,analyticsUploadSource:o},validationOptions:{...e.validationOptions},uploadId:a}}function MG(e,t){if(e.uploadOptions.skipUploadStatusUpdates)return;const{dispatch:a}=io();a(uH(e.uploadId,t))}async function FG(e,t){const{dispatch:a,state:o}=io(),n=y(),{mediaLibraryID:r}=e;if("video"===e.type&&!e.file_v2)throw Error("Do not have the original file. Cannot reupload.");const i="video"!==e.type?e.file:e.file_v2.file,s={eventHandlers:{...t.eventHandlers},initialLocalProjectId:o.studioLocal.localProjectId,uploadOptions:{...t.uploadOptions},validationOptions:{...t.validationOptions},uploadId:n};s.uploadOptions.isThumbnail||fm("Upload Started",{"File Type":i.type,"Size (MB)":i.size/1e6,"Upload Location":t.uploadOptions.analyticsUploadSource,"Is Reupload":!0}),a(zc({mediaCacheId:r,uploadId:n}));try{const e=await sV(i,{uploadId:n}),t=await YG(s,i,e);zG(s,t,e)}catch(l){console.error(l),a(wh(l.message)),$G(s)}}async function BG(e,t,a){const{dispatch:o}=io();let n=t;const r={};t.uploadId||(r.uploadId=y()),t.local_url||(r.local_url=URL.createObjectURL(e)),E(r)||(o(ds(t,r)),n={...t,...r});const i={...UG(a),uploadId:n.uploadId};i.uploadOptions.isThumbnail||fm("Upload Started",{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":a.uploadOptions.analyticsUploadSource,"Is Reupload":!0});const s=await YG(i,e,t);zG(i,s,n)}function WG(e){const{state:{uploadStatuses:t={}},dispatch:a}=io(),o=t[e];if(!o)return;const{uploadManager:n}=o;null==n||n.cancel(),a({type:"DELETE_UPLOAD_STATUS",id:e})}const VG=(e,t,a)=>{const{dispatch:o,state:{privacy:n,teams:{selectedTeamId:r}}}=io(),{uploadId:i,uploadOptions:{isThumbnail:s,fontUpload:l,uploadSourceComponent:c,createTeamAsset:d}}=e,u=Du({team:Bu()},au.UNLIMITED_EXPORT_DURATION_LIMIT);u&&"duration"in a&&a.duration&&a.duration>7200&&o(Sh("Your file is longer than 2 hour. You must trim your video to publish.")),!u&&"duration"in a&&a.duration!==1/0&&a.duration&&a.duration>420&&Sh("Your file is longer than 7 minutes. Trim or upgrade to export videos longer than 7 minutes.");const m=1===n||!s,p=new Jw({analyticsUploadSource:e.uploadOptions.analyticsUploadSource,file:t,layer:a,isPrivate:m,onError:KG(e),onProgress:jG(e),onFinish:GG(e),onCancel:()=>$G(e),onRetry:HG(e),origin:a.uploadLocation,uploadSourceComponent:c});p.upload(),e.uploadOptions.skipUploadStatusUpdates||o(dH({id:i,fileName:t.name})),MG(e,{fontUpload:l,uploadManager:p,omitFromMediaLibrary:e.uploadOptions.omitFromMediaLibrary,teamId:d?r:void 0})},jG=e=>(t,a,o)=>{if(!o.uploadId)return;const n=Math.round(100*t);let r=`Uploading ... ${n.toString()}%`;100===n&&"image/gif"===a.type?r="Processing your GIF ...":100===n&&"video/3gpp"===a.type&&(r="Converting file to mp4 ..."),MG(e,{progressText:r,progress:n,stage:Cs.inProgress})},HG=e=>(t,a)=>{t.uploadId&&MG(e,{retryInfo:a})},GG=e=>async(t,a,o,n,r)=>{var i,s;const{uploadId:l,uploadOptions:{fontUpload:c,isThumbnail:d,createTeamAsset:u,createWorkspaceAsset:m,usedProFeature:p},hash:h}=e,{dispatch:g,state:{privacy:f,studio:{_id:y},workspaces:{selectedWorkspace:E},teams:{selectedTeamId:_}}}=io(),v=t=>{MG(e,{stage:t})};if(200!==t.status)return void KG(e)(t.statusText||"An error occurred during upload. Please try again.",o,n,"onGCSUploadFinish");v(Cs.onGCSUploadFinish);const[w,b]=gH(a),S={bucket:w||co,size:o.size,mime:o.type,name:o.name,hash:h,usedProFeature:p};if(b&&(S.blob_name=b),c){const e=null!=(s=null==(i=S.name)?void 0:i.split(".").pop())?s:"";n.mime=`font/${e}`}const T={fontUpload:c,skipSigning:!f&&d,skipCML:d||c};y&&(T.video_id=y),m&&(T.workspaceId=E),u&&(T.teamId=_),v(Cs.createAsset);const{asset:I,cmlFile:k}=await $C(S,T),C={...I};n.conversion_type&&(C.conversion_type=n.conversion_type),c||LN(C,k,l);const N={...n,asset_id:I._id,source:"upload",url:a,uploadConfirmed:Date.now()};if(v(Cs.assetCreated),n.requireConversion){v(Cs.runConversion);const e=await fN({asset_id:I._id,resource:b,type:"blob",conversion_type:n.conversion_type,layer:N});N.conversion_id=e,N.videoConvertedState="begun",v(Cs.addPendingConversion),await HW(e,n.id,n.name,l,null==k?void 0:k.id)}else"local_url"in n&&n.local_url&&(S.local_url=n.local_url);if(S.name&&(N.name=S.name),k&&(N.cmlFileId=k.id),I.ffprobeData){N.ffprobeData=I.ffprobeData;const{duration:e}=I.ffprobeData,t=Number(e);"number"!=typeof t||isNaN(t)||(N.duration=t)}const A=Od(n);A&&g(wi(A)),c||d||(v(Cs.updateCompletedUploadInIDB),!n.requireConversion&&A&&await GW(A,{url:N.url,asset_id:N.asset_id})),v(Cs.handleFinish),qG(e,N,r),v(Cs.done)},$G=e=>{const{uploadId:t,eventHandlers:{handleCancel:a},uploadOptions:{dragUpload:o}}=e,{dispatch:n,state:r}=io(),i=r.mediaCache.uploadIdToMediaCacheId[t];i&&n(wi(i)),o&&"Scenes"!==Xv()&&$l(),a&&a(t)},KG=e=>(t,a,o,n,r)=>{w({category:"Upload Flow Error",message:`ErrorType: ${n} layer: ${JSON.stringify(o)} file: ${JSON.stringify(a)}`}),r&&j(new Error(t));const{eventHandlers:{handleError:i},initialLocalProjectId:s}=e,{dispatch:l}=io();if(io().state.studioLocal.localProjectId!==s)return;MG(e,{stage:Cs.errored}),null==i||i();let c=t;t||(c="An error occurred while uploading. Please try again later."),l(wh(c)),$G(e)},YG=async(e,t,a)=>{const{dispatch:o}=io();e.uploadOptions.skipUploadStatusUpdates||o(dH({id:e.uploadId,fileName:t.name}));const n=await Hk(t,(t=>MG(e,{progressText:t})),KG(e));if(t!==n&&(a.local_url=URL.createObjectURL(n)),n.type.includes("video")||n.type.includes("audio")){const e=await $w(n);a.duration=e}return n},zG=(e,t,a)=>{const{state:{editorPath:o}}=io();try{JG(e,a,t),VG(e,t,a)}catch($ae){console.error("error during upload ",$ae),KG(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,a,"checkFileAndUpload"),Ml(o)}},qG=(e,t,a)=>{const{state:{studioLocal:{localProjectId:o},uploadStatuses:n}}=io();try{const{eventHandlers:{handleFinish:r},initialLocalProjectId:i}=e,s=o!==i;QG(t,n,e,a,{projectIdChanged:s,isDuplicateUpload:!1}),r&&!s&&r(t)}catch($ae){console.error("error during upload ",$ae),KG(e)(`An error occurred during upload. ${$ae}`,void 0,t,"handleFinish");const{state:{editorPath:o}}=io();Ml(o)}},JG=(e,t,a)=>{MG(e,{preemptivelyAvailableAt:performance.now()});try{const{eventHandlers:{handlePreemptiveFinish:a},initialLocalProjectId:o,uploadOptions:{multiRowUploadForRecording:n,recordScreenAndCameraUpload:r},selectedGroupId:i}=e,s=io().state.studioLocal.localProjectId!==o;a&&!s&&a(t,{multiRowUploadForRecording:n,selectLayerInCreator:!0,selectedGroupId:i,recordScreenAndCameraUpload:r})}catch($ae){console.error("error during upload ",$ae),KG(e)(`An error occurred during upload. ${$ae}`,a,t,"handleFinish");const{state:{editorPath:n}}=io();Ml(n)}},XG=(e,t,a)=>{const{state:{editorPath:o}}=io();try{JG(e,a,t),VG(e,t,a)}catch($ae){console.error("error during upload ",$ae),KG(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,a,"checkFileAndUpload"),Ml(o)}};function QG(e,t,a,o,n){var r;if(!a.uploadOptions.isThumbnail)try{const i=Od(e),s={"Layer Type":e.type,mime:e.mime,"Size (MB)":(null!=(r=e.size)?r:0)/1e6,"Layer Duration":"duration"in e&&e.duration||0,"Conversion Required":e.requireConversion||!1,"Project ID Changed During Upload":n.projectIdChanged,mediaCacheId:i,"Upload Retries":o.retries,"Upload Location":a.uploadOptions.analyticsUploadSource,"Duplicate Upload":n.isDuplicateUpload},l=null==t?void 0:t[a.uploadId];if(l){const e=performance.now();s["Overall Upload Duration"]=(e-l.beganAt)/1e3,l.preemptivelyAvailableAt&&(s["Time to on Canvas"]=(l.preemptivelyAvailableAt-l.beganAt)/1e3,s["Upload Duration after on Canvas"]=(e-l.preemptivelyAvailableAt)/1e3)}"ffprobeData"in e&&e.ffprobeData&&(e.ffprobeData.codec_name&&(s.Codec=e.ffprobeData.codec_name),e.ffprobeData.codec_long_name&&(s["Codec (Long)"]=e.ffprobeData.codec_long_name)),fm("Upload Finished",s)}catch($ae){console.error($ae),j($ae)}}const ZG=e=>{const{state:t,dispatch:a}=io(),o=e$(),n=Bn(t);let r=void 0===n?0:ic();const i=e.filter((({layer:e})=>e)).some((({layer:e})=>e.duration)),s=e.every((({layer:e,bundle:t})=>!(!e||t.uploadOptions.isThumbnail)&&"image"===e.type)),l="make/slideshow"===t.studio.origin&&s;if(!t.studio.duration&&s){const o=e.filter((({layer:e,bundle:t})=>e&&"Media sidebar button - This Project"!==t.uploadOptions.analyticsUploadSource)).map((({layer:e,file:t})=>`${e.id} ${t.lastModified}`));if(a(El([...t.studioLocal.staticUploadIds,...o])),e.filter((({layer:e})=>e)).length>1){const t=y();mG(e.filter((({layer:e})=>e)).map((({layer:e})=>e.id)),t,!1,!1),e.forEach((({bundle:e})=>{e.selectedGroupId=t}))}}if(!t.studio.duration&&!i&&!l)return;const c=[o];e.forEach((({layer:t,bundle:a})=>{if(!t)return;if(a.uploadOptions.isThumbnail)return;if(t.requireConversion){const e=e$(c);return t.timelineRow=e,void c.push(e)}e.length>1&&(t.timelineRow=o);["video","audio"].find((e=>e===t.type))?(t.videoDelay=r,r+=t.duration||0):(t.isTrimmed=!0,t.startTime=r,t.endTime=r+3,r=t.endTime)}));const d=t.studio.selectedTimelineRows,u=1===e.length,m=_R({...e[0].layer},ic(),Math.min(...d,0));if(u&&m&&d.length>0&&(e[0].layer.timelineRow=Math.min(...d)),!t.studio.duration&&i){Tw(t.studio.scenes[t.studio.selectedSceneIndex],r,!0)}l&&(e=>{const{dispatch:t}=io(),a=y(),o=e.filter((({layer:e})=>e)).map((({layer:e})=>e.id));t(l_("")),mG(o,a,!0,!0),t(Is({id:a,type:"group"}))})(e)},e$=(e=[])=>{const{state:t}=io(),{layers:a}=t.studio.scenes[t.studio.selectedSceneIndex];if(!t.studio.duration&&a.length)return a.length;const o=[...a.map((e=>e.timelineRow||0)),...e];for(let n=0;n<o.length+1;n+=1)if(!o.includes(n))return n;return 0},t$=e=>new File([e],"tempFile",{type:e.type}),a$=e=>{const t=Buffer.alloc(e.byteLength),a=new Uint8Array(e);for(let o=0;o<t.length;o+=1)t[o]=a[o];return t},o$=async(e,t,a={})=>{const{state:o,dispatch:n}=io(),{isAdding:r}=o.studioLocal;let i=t;if(r[i._id]||CR(i._id),t.url||(i=await zC(t._id,"addFromMediaLib"),n(Bb([i]))),!i.url)return CR(i._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{dimensions:s}=i;try{const t={addedFromMediaLibrary:!0,asset_id:i._id,cmlFileId:e.id,name:i.name||i.blob_name,mime:i.content_type,...s,...a},o=await r$(i,t);return iR(o),hR(o,{undoable:!0}),o}catch(l){return n(wh(l.message)),null}},n$=async(e,t,a={})=>{const{dispatch:o,state:n}=io(),{isAdding:r}=n.studioLocal;let i=t;if(r[i._id]||CR(i._id),t.url||(i=await zC(t._id,"addFromMediaLib"),o(Bb([i]))),!i.url)return CR(i._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{state:{studio:{selectedItem:s,scenes:l}}}=io(),c=sR((null==s?void 0:s.id)||"");if(!c)return null;try{const o=await r$(i,{addedFromMediaLibrary:!0,asset_id:t._id,cmlFileId:e.id,...a}),n=Pd(o,c);return gR(n,c,{knownTimelineRow:!0,sceneId:l[0].id,undoable:!0}),o}catch(d){return o(wh(d.message)),null}},r$=async(e,t={})=>{const{state:a,dispatch:o}=io(),{mediaCache:{assetIdToMediaCacheId:n}}=a;let r;const i=n[e._id];if(i&&(r=await(async(e,t,a)=>{const o=await zW(e);if(!o)return;const n=eV(o,["preview","original"]),r=tV(o);if(!n)return;const{id:i}=iV(),s={},l=t.preview;if(null==l?void 0:l.url)if(l.width&&l.height&&l.duration){const{width:e,height:t,duration:a}=l;s.preview={...l,width:e,height:t,duration:a,startTime:0,endTime:a}}else{const e=await Xk(l.url,"video/mp4");if(!e.success)return;const{width:t,height:a,duration:o}=e.properties;s.preview={...l,width:t,height:a,duration:o,startTime:0,endTime:o}}if(t.track_preview){s.track_preview={...t.track_preview,mediaLibraryID:e};const a=eV(o,["track"]);a&&zl(i,{trackPreviewLocalUrl:URL.createObjectURL(a)})}return s.preview&&s.track_preview&&(s.addedFromOptimizedFile=!0),{id:i,url:t.url,asset_id:o.asset_id,type:o.type,...r,source:"local",local_url:URL.createObjectURL(n),size:n.size,name:n.name,originalName:n.name,mime:n.type,addedFromMediaLibrary:!0,...s,...a}})(i,e,t)),!r){const a=i||y();r=await(async(e,t,a)=>{if(!e.url)return;const o={...e.preview,mediaLibraryID:t};if(o&&o.url)if(o.width&&o.height&&o.duration){const{width:e,height:t,duration:n}=o;a.preview={...o,width:e,height:t,duration:n,startTime:0,endTime:n}}else{const e=await Xk(o.url,"video/mp4");if(!e.success)return;const{width:t,height:n,duration:r}=e.properties;a.preview={...o,width:t,height:n,duration:r,startTime:0,endTime:r}}const n={...e.track_preview,mediaLibraryID:t};return n&&(a.track_preview=n),await lV(e.url,a,{overwriteLayerType:a.type})})(e,a,t),o(Yc({assetId:e._id,mediaCacheId:a}))}return r};function i$(e){return{type:"SET_DIMENSIONS",dimensions:e}}function s$(e){return{type:"SET_DURATION",duration:e}}function l$(e){switch(e){case"Pridi":return"Pridi-Regular";case"Montserrat":return"Montserrat-Regular";case"Noto Sans":return"NotoSans-Regular";default:return null==e?void 0:e.replace(/ /g,"-")}}function c$(e){return{type:"SET_NUM_LOOPS",numLoops:e}}function d$(){return{type:"MARK_AS_LOOPED"}}function u$(){return{type:"TOGGLE_REVERSE_STOP_MOTION"}}function m$(e){return{type:"SET_STOP_MOTION_CLIP_RATE",clipRate:e}}function p$(e){return{type:"SET_STOP_MOTION_SPEED",speed:e}}function h$(){return{type:"MARK_AS_STOP_MOTION"}}function g$(e,t,a){let o,n=!1;e.isStopMotionVideo?o=function(e,t){const a=om(e.currentUser)?e.currentUser.user._id:void 0;if(e.duration/e.stopMotionClipRate*e.stopMotionSpeed>60)throw new Error("Your final video cannot be longer than 1 min. Please trim the video or adjust the clip rate and speed.");const o=""===e.projectName?"Stop Motion Project":e.projectName;return e.projectName=o,{isStopMotionVideo:!0,stopMotionClipRate:e.stopMotionClipRate,stopMotionSpeed:e.stopMotionSpeed,reverseStopMotion:e.reverseStopMotion,...aN(e),watermark:t,startTime:e.startTime,endTime:e.endTime,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:l$(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,creatorId:a}}(e,a):e.isLooped?o=function(e,t){if((e.endTime-e.startTime)*e.numLoops>7200)throw new Error("The output video must be less than 2 hour long. Choose a fewer number of loops.");const a=om(e.currentUser)?e.currentUser.user._id:void 0,o=""===e.projectName?"Looped Video Project":e.projectName;return e.projectName=o,{isLooped:!0,numLoops:e.numLoops,...aN(e),watermark:t,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:l$(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,startTime:e.startTime,endTime:e.endTime,creatorId:a}}(e,a):(o=lN(e,t),n=!0);const r=function(e){const t=Cj(e),a=[];e.studio.canvasBlur&&t&&t.forEach((e=>{if(e.layer){const t={...e.layer};if("video"===t.type){t.videoDelay=e.startTime;let a=e.endTime-e.startTime;t.playbackRate&&(a*=t.playbackRate),t.startTime=0,void 0!==e.layer.startTime&&(t.startTime=e.layer.startTime+e.startTime,void 0!==e.layer.videoDelay&&(t.startTime-=e.layer.videoDelay,t.startTime<0&&(t.startTime=0))),t.endTime=t.startTime+a,t.isMuted=!0}else Dr(t)&&(t.startTime=e.startTime,t.endTime=e.endTime);t.animation=void 0,t.isTrimmed=!0,t.filters={...e.layer.filters,blurPercent:5},t.id=y();const o={x:"-5%",y:"-5%",width:"110%",height:"110%",rotation:0};t.position=o,a.push(t)}}));return a}(e);return r.length>0&&(o.backgroundLayers=r),[o,n]}function f$({currentUser:e,publish:t=!0,auto:a=!1,createLocation:o="NA",processedOnClient:n=!1}){return async(r,i)=>{const{token:l,user:c}=e||{},{_id:d}=c||{},u=!om(e),m=i(),{selectedTeamId:p}=m.teams,{isBrandKitTemplate:h}=m.studio;if(!a&&EC(m)){const e=new Error("Your content is still uploading. Please try again in a few seconds.");return e.statusCode=425,function(e){if(!e.isStudio)return;const{studio:{_id:t,scenes:a=[]},uploadStatuses:o={}}=e;try{let e,n,r,i,s=!1,l=!1,c=0,d=!1,u=Number.MAX_SAFE_INTEGER;for(const t of a)for(const a of t.layers){const t=hC(a);if(!t)continue;c+=1;const m=a.uploadId?o[a.uploadId]:null;if(m){const{progress:o=0,stage:c,stageStarted:d}=m;o<1&&(s=!0),o>=99&&(l=!0),c<u&&(u=c,e=t,n=a.mime,r=a.url?Gk(a.url):null,i=performance.now()-d>1e4)}a.addedFromMediaLibrary&&(d=!0)}const m={"Stuck at 0%":s,"Stuck at 99%":l,"Num Pending Uploads":c,"Added from Media Library":d,Stage:Cs[u]||"missing","Stuck at Stage":i,"Still Uploading Reason":e,Mimetype:n,Extension:r};t&&(m["Video ID"]=t,m["Link to Video"]=`kapwing.com/videos/${t}`),fm("Export Blocked by Remaining Upload",m)}catch($ae){console.error($ae),j($ae)}}(m),Promise.reject(e)}const[g,f]=g$(m,t,u);g.createLocation=o,g.workspaceId=(m.workspaces||{}).selectedWorkspace,g.teamId=p;const y=Yh(p),E=Eu((null==y?void 0:y.planTier)||jd.FREE);if(g.creatorHasLicense=E.isPaid,g.animations){const{animations:e,magicSubtitlesOnExport:t}=pj(m);g.animations.allIds.push(...e.allIds),g.animations.byId={...g.animations.byId,...e.byId},g.magicSubtitlesOnExport=t,(e=>{try{if(!e.scenes||!e.animations)return;const t=[];let a=e.scenes.map((({layers:e})=>e)).flat().map((({id:e})=>e));const o=Object.values(e.magicSubtitlesOnExport||{}).map((e=>{var t;return null==(t=e[0])?void 0:t.id})).filter((e=>!!e));a=a.concat(o);for(const n of e.animations.allIds){const o=e.animations.byId[n];o&&(["layerId","introLayerId","outroLayerId"].some((e=>a.includes(o[e])))&&t.push(o.id))}e.animations.allIds=t,e.animations.byId=t.reduce(((t,a)=>(t[a]=e.animations.byId[a],t)),{})}catch($ae){s("Unable to clean video animations",{extra:{video:e.id,__FORCE_SAMPLE:!0}})}})(g)}g.isStudio&&"/studio/editor"!==g.editorPath&&s("Studio video but non studio editor!!"),t&&(!function(e,t,a){try{const{studio:o}=e;sH(t,o,a)}catch($ae){console.info("Failed to log createVideo")}}(m,g,n),g._id&&r(function(e){return async t=>{try{const[a,o]=await aH(e,Ds.Thumbnail);LG([Vk(a,o)],{eventHandlers:{handleFinish:a=>{t(E$(a.url));const o={image_url:a.url};v$(e._id,o)}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromMediaLibrary:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Export"}})}catch(a){console.error(a)}}}(g)));const _=!g._id;if(!_&&!t&&f)return g;let v;v=_?"/api/v1/videos":t?"/api/v1/videos/publish":"/api/v1/videos/save";return async function(e,t,a,o){o&&(t(a?fS({...e,done:!1}):ES(!0)),function(e,t,a){t(y$(e._id)),t((o=e.projectId||"",{type:"SET_PROJECT_ID",projectId:o})),t({type:"SET_VIDEO_DRAFT_INFO",draft:!a&&e.draft,done:e.done,createdAt:e.createdAt,lastSaved:e.lastSaved});var o}(e,t,a));return e}(await op(v,{body:{publish:t,processedOnClient:n,token:l,userId:d,video:g,selectedTeamId:p,isBrandKitTemplate:h}}),r,t,f)}}function y$(e){return{type:"SET_VIDEO_ID",_id:e}}function E$(e){return{type:"SET_IMAGE_URL",image_url:e}}function _$(e){return(t,a)=>{const{currentUser:o,isStudio:n,studio:r,editorPath:i}=a(),{token:s}=o||{};if(!e){w({category:"Bad Trigger Lambda",message:`isStudio: ${n} videoId ${r._id} editorPath ${i}`});const e=new Error("triggerLambda run with no video!");j(e)}return function(e,t){return op("/api/v1/videos/triggerLambda",{body:{token:t,video:e}}).then((()=>e)).catch((e=>(console.error(e),e)))}(e,s)}}async function v$(e,t){const{token:a}=io().state.currentUser||{};return np(`/api/v1/videos/${e}`,{params:{clientVersion:"0.6"},body:t,headers:{"x-access-token":a},parseJSON:!1})}function w$({currentUser:e,newLayer:t,teamId:a}){return async()=>{const{token:o,user:n}=e||{},{_id:r}=n||{},i=y(),{projectName:s,workspaceId:l}=t;delete t.projectName,delete t.workspaceId;const c={currentUser:e,projectName:s,studio:{background:"#ffffff",showCanvas:!0,isStudio:!0,isCreator:!0,creatorId:n._id,origin:"workspaceUpload",quality:"high",ratio:`${t.width}:${t.height}`,scenes:[{background:"#ffffff",duration:0,id:i,layers:[{...t}],subtitle:{...Dd}}],workspaceId:l,teamId:a}};let d;try{d=lN(c,true)}catch(m){return console.error("error"),Promise.reject(m)}d.editorPath="/studio/editor",d.projectVersion="0.6";const u=d.scenes[0].layers[0].duration;return u&&(d.scenes[0].duration=u,d.duration=u),sH(d),op("/api/v1/videos",{body:{publish:true,processedOnClient:!1,token:o,userId:r,video:d}})}}const b$="GenericBlock-module_genericContainer_mgpDY",S$="GenericBlock-module_horizontalContainer_MSe08",T$="GenericBlock-module_content_XQG7Y",I$="GenericBlock-module_buttonWrapper_b15gp",k$="GenericBlock-module_img_2ESKP",C$="GenericBlock-module_genericBlockContainer_nLr9u",N$="GenericBlock-module_hasImg_TJcRj",A$="GenericBlock-module_contentContainer_nGFHZ",x$="GenericBlock-module_heading_qzdFQ",P$="GenericBlock-module_body_fTcX-",R$=({body:e,heading:t,button:a,img:o,className:n="",headingClassName:r="",bodyClassName:i="",testId:s="",horizontal:l=!1})=>l?m.createElement("div",{className:`${b$} ${S$} ${o?N$:""} ${n}`,"data-cy":s},o&&m.createElement("img",{src:o.imgSrc,alt:o.imgAlt,className:`${k$} ${o.className}`}),m.createElement("div",{className:T$},t&&m.createElement("div",{className:`${x$} ${r}`},t),e&&m.createElement("div",{className:`${P$} ${i}`},e)),m.createElement("div",{className:I$},a)):m.createElement("div",{className:`${b$} ${C$} ${o?N$:""} ${n}`,"data-cy":s},m.createElement("div",{className:A$},o&&m.createElement("img",{src:o.imgSrc,alt:o.imgAlt,className:`${k$} ${o.className}`}),m.createElement("div",{className:T$},t&&m.createElement("div",{className:`${x$} ${r}`},t),e&&m.createElement("div",{className:`${P$} ${i}`},e))),a),O$="UpsellBlock-module_upsellBlock_sCLzk",D$="UpsellBlock-module_horizontalWrapper_17PU7",L$="UpsellBlock-module_button_QqETY",U$="UpsellBlock-module_wrapper_pX-Bc",M$="UpsellBlock-module_topLeftImg_g1fHG",F$="GenericButton-module_genericButton_OMRjJ",B$="GenericButton-module_disabled_AYYOH",W$=({icon:e,buttonText:t="",className:a="",onClick:o=(()=>{}),testId:n,disabled:r=!1})=>m.createElement("div",{className:`${F$} ${a} ${r?B$:""}`,onClick:o,"data-testid":n,"data-cy":n},t,e),V$="UpsellButton-module_upsellButton_faS-2",j$=({action:e,onPaywallSuccess:t=(()=>{}),hasIcon:a=!0,buttonText:o="Upgrade",className:n="",testId:r="upsell",team:i})=>{const s=pO(),l=Pu();return m.createElement(W$,{className:`${V$} ${n}`,buttonText:o,icon:a?m.createElement(fO,null):null,onClick:()=>{s(t,{action:e,team:i||l})()},testId:`${r}-button`})},H$=e=>{const t=Pu(),{img:a,upsellBlockHeading:o,upsellBlockBody:n,buttonText:r}=mu(e.action),i=e.topLeftImg?M$:e.imgClassName;return m.createElement("div",{className:U$},m.createElement(R$,{className:`${O$} ${e.horizontal?D$:""}`,img:e.noImg?null:{...a,imgSrc:e.imgSrc||a.imgSrc,className:i},heading:o,body:n,horizontal:e.horizontal,button:e.buttonText||r?m.createElement(j$,{className:L$,onPaywallSuccess:e.onPaywallSuccess,action:e.action,buttonText:e.buttonText||r,team:t,testId:e.testId}):null,testId:e.testId}))},G$=e=>Ru().hasPermission(e),$$="RemoveWatermark-module_upsellBlock_A-Myi",K$="RemoveWatermark-module_override_NlJdb",Y$=()=>{const e=oe(),t=Fe(),a=Ru(),o=G$(au.EXPORT_ALL_WITHOUT_WATERMARK),r=G$(au.EXPORT_30_SEC_WITHOUT_WATERMARK),s=cn((e=>e.currentUser)),l=cn((e=>e.currentVideo)),c=i.exports.useDispatch(),[d,u]=n.exports.useState(!1),p=n.exports.useCallback((async()=>{u(!0);try{const e=await c(function(e,t=""){return async(a,o)=>{const{currentUser:n,workspaces:r}=o(),{token:i,user:s}=n||{},{_id:l}=s||{},{selectedWorkspace:c}=r||{};if(E(e)){const e=new Error("No video found. Please try again later.");return Promise.reject(e)}const{_id:d,...u}=e;c&&Object.assign(u,{workspaceId:c}),Object.assign(u,{done:!1,finishedAt:void 0,fullPath:void 0,local_url:void 0,image_url:void 0,lastSeen:new Date,paymentOption:t,progressText:"Loading ... Removing watermark ...",submittedAt:new Date,watermark:!1});const m=nH(u,u.duration,"videoBuild"),p=await op("/api/v1/videos",{body:{publish:!0,token:i,userId:l,video:u,processOnClient:m}});return a(fS(p)),p}}(l)),{duration:a}=e;let o,n;if(nH(e,a,"videoBuild")){const{processed:t,newUrl:r}=await rH(s,e,a,!1,"videoBuild");n=t,o=r}n&&c(yS({local_url:o})),t.push(`/videos/${e._id}`)}catch(e){c(wh(e.message)),u(!1)}}),[s,c,l,t]);n.exports.useEffect((()=>{const t=new URLSearchParams(e.search);om(s)&&r&&"true"===t.get("removeWatermark")&&!d&&p()}),[s,e.search,p,d,r]);const h=((null==l?void 0:l.duration)||0)<30;return l.watermark?o||h&&r?m.createElement(R$,{heading:"Re-export to remove the watermark",body:`Welcome to Kapwing ${a.displayPlanTier}, re-export to remove the watermark`,button:m.createElement(ZR,{onClick:p,overrideColor:"lightBlue"},"Re-export without a watermark"),className:`${$$} ${K$}`,img:{imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp",imgAlt:`Welcome to Kapwing ${a.displayPlanTier}, re-export to remove our watermark from your projects.`},testId:"remove-watermark-upsell-block"}):m.createElement("div",{className:$$},m.createElement(H$,{action:h?ou.REMOVE_30_SEC_WATERMARK:ou.REMOVE_WATERMARK,onPaywallSuccess:p,testId:"remove-watermark-upsell-block"})):null},z$="SubscriptionStateBlock-module_errorBlock_0kzPV",q$="SubscriptionStateBlock-module_errorBlockHeading_eP7ZK",J$="SubscriptionStateBlock-module_errorButton_N32og",X$="SubscriptionStateBlock-module_reactivateBlock_79PEw",Q$="SubscriptionStateBlock-module_reactivateButton_z4jPw",Z$=({className:e="",entryPoint:t=tg.WORKSPACE_PAST_DUE_BANNER})=>{const a=Fe(),o=Pu(),r=Zw(cn((e=>e.currentUser)).user._id),i=vO(),[s,l]=n.exports.useState(!1),[c,d]=n.exports.useState(!1),u=Ru(),p=()=>{a.push(`/team/${o._id}/billing`)},h=()=>{eb(null==r?void 0:r.role)?l(!0):d(!0)};return(null==i?void 0:i.cancel_at_period_end)&&u.showReactivate(i)?(()=>{const t=i?C(1e3*i.current_period_end).format("ddd, MMMM Do, YYYY"):"";return m.createElement(m.Fragment,null,c&&m.createElement(MO,{hide:()=>d(!1)}),m.createElement(R$,{className:`${X$} ${e}`,heading:`Your access to ${pu(u.planTier)}  features is ending`,body:u.getReactivateText(t),button:m.createElement(W$,{className:Q$,buttonText:"Reactivate my subscription",onClick:p,icon:m.createElement(fO,null)})}))})():(null==i?void 0:i.status)===Mr.PAST_DUE?m.createElement(m.Fragment,null,s&&m.createElement(PO,{exitOverlay:()=>l(!1),stripeId:o.stripeId,entryPoint:t}),c&&m.createElement(MO,{hide:()=>d(!1)}),m.createElement(R$,{className:`${z$} ${e}`,heading:"Payment Failed",headingClassName:q$,body:m.createElement(m.Fragment,null,"Premium features are still active on your account, but your current subscription invoice is ",m.createElement("strong",null,"past due.")," Please update your payment details to avoid losing access to premium features."),button:m.createElement(W$,{className:J$,buttonText:"Update Payment Details",onClick:h})})):null},eK="ShareButton-module_tooltip_6GrU2",tK="ShareButton-module_shareButtonTooltip_duKu8",aK="ShareButton-module_shareButton_GeWEo",oK="ShareButton-module_shareButtonIcon_gcQXq",nK="ShareButton-module_shareButtonText_BsVtc",rK=ie(i.exports.connect((e=>({currentUser:e.currentUser,videoId:e.studio._id,creatorEmail:e.studio.creatorEmail,videoSaving:e.videoSaving,editorPath:e.editorPath})),(e=>he({createVideo:f$,showError:wh},e)))((e=>{const[t,a]=n.exports.useState(!1),[o,r]=n.exports.useState(!1),i=me(),s=()=>{var t;(null==(t=i.path)?void 0:t.endsWith("/share"))?Ml(e.editorPath):l()},l=async t=>{const{showError:n,createVideo:i,currentUser:s,creatorEmail:l,videoSaving:c}=e,{user:d}=s||{};if(t&&t.stopPropagation(),!(()=>{const{currentUser:t}=e;return t&&t.user&&t.user._id})())return void a(!0);if(o)return;if(e.videoId){const t=null!=l?l:d.email;((e,t,a)=>{const o={"Project Owner Email":a,"Sharer Email":e.email,"Video ID":t};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Dialog Opened",o)})(d,e.videoId,t)}r(!0);let{videoId:u}=e;!u&&c?(await(async()=>new Promise(((e,t)=>{const a=setInterval((()=>{io().state.studio._id&&(clearInterval(a),e())}),250)})))(),a(!1),Ml("/studio/editor/share")):u?(a(!1),Ml("/studio/editor/share")):u=await i({currentUser:s,publish:!1,auto:!1,createLocation:"studio-share"}).then((()=>{a(!1),Ml("/studio/editor/share")})).catch((e=>(a(!1),n(e.message),null))),r(!1)};return m.createElement(m.Fragment,null,m.createElement("div",{className:`${eK} ${aK}`,onClick:s,"data-cy":"share-button","data-testid":"studio-header-share-button"},m.createElement(it,{className:oK})," ",m.createElement("span",{className:nK},"Share"),m.createElement("span",{className:tK},"Share this project to invite ",m.createElement("br",null)," others to collaborate with you")),t&&m.createElement(MC,{hideSignIn:()=>{a(!1)},onSuccess:()=>{e.onSignin&&e.onSignin(),l()},description:"Kapwing works better if you're signed in. Sign in to share your project with people and edit collaboratively in real time.",immediateRedirectPathname:"/studio/editor/share"}))})));var iK=(e=>(e.LAYER_CONTROLS="LAYER_CONTROLS",e.MEDIA_CONTROLS="MEDIA_CONTROLS",e.COMMENTS="COMMENTS",e))(iK||{});const sK="CommentSection-module_commentSection_XqVp7",lK="CommentSection-module_mobileCommentSection_E-5Ff",cK="CommentSection-module_studioCommentSection_LLY3e",dK="CommentSection-module_commentsTitle_-tDSv",uK="CommentSection-module_emptyCommentMessage_mT1aX",mK="CommentSection-module_commentsContent_RqN-c",pK="CommentSection-module_selectedCommentsContent_YCFF0",hK="CommentSection-module_videoCommentSection_JM301",gK="CommentSection-module_commentPostContainer_plgkT",fK="CommentSection-module_selectedCommentPostContainer_6B-Kb",yK="CommentSection-module_commentThreadContainer_bsn99",EK="CommentSection-module_fillMaxHeight_dz4SB",_K="CommentSection-module_noEditAccessMessage_NBgzd",vK="Timestamp-module_timestamp_3o0bP",wK="Timestamp-module_staticTimestamp_taL8V",bK="Timestamp-module_timestampContainer_ticJR",SK="Timestamp-module_timestampEditableContainer_1-9nG",TK="Timestamp-module_staticTimestampInEditContainer_eQIjO",IK="Timestamp-module_disabledTimestampContainer_EPdfn",kK="Timestamp-module_staticTimestampContainer_4ufKX",CK="Timestamp-module_timestampEditable_pOXSY",NK=({videoTimestamp:e,isEditable:t,maxTime:a,disabled:o,inEditModeComment:n,seekOnCurrentVideo:r})=>{const{hours:i,minutes:s,seconds:l}=(e=>{let t=e;const a=Math.floor(t/3600);return t%=3600,{hours:a,minutes:Math.floor(t/60),seconds:Math.floor(t%60)}})(e),c=e=>{e.target.type="text",e.target.setSelectionRange(0,e.target.value.length),e.target.type="number"},d=(e,t)=>{const o=parseInt(e.target.value),n=("seconds"===t?o:l)+60*("minutes"===t?o:s)+3600*("hours"===t?o:i),c=Math.min(n,a);r(c)};return t?m.createElement("div",{className:`${SK} ${o?IK:""}`,"data-cy":"comment-post-timestamp"},!!i&&m.createElement(m.Fragment,null,m.createElement("input",{className:CK,type:"number",name:"hours",value:i.toString().padStart(2,"0"),placeholder:i.toString(),onFocus:c,onChange:e=>d(e,"hours"),"data-cy":"comment-post-timestamp-hours"}),m.createElement("span",{className:vK},":")),m.createElement("input",{className:CK,type:"number",name:"minutes",value:s.toString().padStart(2,"0"),placeholder:s.toString(),onFocus:c,onChange:e=>d(e,"minutes"),"data-cy":"comment-post-timestamp-seconds"}),m.createElement("span",{className:vK},":"),m.createElement("input",{className:CK,type:"number",name:"seconds",value:l.toString().padStart(2,"0"),placeholder:l.toString(),onFocus:c,onChange:e=>d(e,"seconds"),"data-cy":"comment-post-timestamp-seconds"})):m.createElement("div",{className:`${bK} ${n?TK:kK} ${o?IK:""}`,onClick:t=>{t.stopPropagation(),r(e)}},m.createElement("div",{className:wK},!!i&&`${i.toString().padStart(2,"0")}:`,s.toString().padStart(2,"0"),":",l.toString().padStart(2,"0")))},AK="CommentPost-module_commentPostContainer_vy9lg",xK="CommentPost-module_replyPostContainer_GEP9e",PK="CommentPost-module_commentPostRow_FpBer",RK="CommentPost-module_commentPostRow2_-0CaE",OK="CommentPost-module_commentPostContainerInputFocused_xa4qj",DK="CommentPost-module_timeStampAndInputContainer_qRvs7",LK="CommentPost-module_postTextBox_xlPKW",UK="CommentPost-module_disabledPostTextBox_mexvv",MK="CommentPost-module_postTextBoxWithTimestamp_MJanO",FK="CommentPost-module_postTextBoxWithLongTimestamp_sob2Y",BK="CommentPost-module_checkboxContainer_ZEcpy",WK="CommentPost-module_postButton_A5lUy",VK="CommentPost-module_disabledPostButton_Y0gkn",jK="CommentPost-module_inlinePostButton_6u0CQ",HK=e=>{const t={};if((null==e?void 0:e.build)&&!E(null==e?void 0:e.build)){const{outputByteSize:a,outputExt:o,outputWidth:n,outputHeight:r}=e.build,{exportQuality:i}=e;if(!a||!o||!i)return null;if(!(n&&r||"mp3"===o))return null;t.fileSize=(e=>{const t=e/1e3;if(t<1e3)return`${(Math.round(10*t)/10).toFixed(1)} KB`;const a=t/1e3;if(a<1e3)return`${(Math.round(10*a)/10).toFixed(1)} MB`;const o=a/1e3;return`${(Math.round(10*o)/10).toFixed(1)} GB`})(a),t.format=o.toUpperCase(),"mp3"!==o&&(t.resolution=`${n}x${r}`),t.quality=i}return t},GK=(e,t)=>{if(!e||!t)return null;const a=null==e?void 0:e.find((e=>e._id===t));return(null==a?void 0:a.parentId)||(null==a?void 0:a._id)},$K=e=>{if(!e||E(e))return null;const t=[{label:"Format",value:e.format||""}];return"MP4"!==e.format&&"GIF"!==e.format||!e.quality||t.push({label:"Quality",value:e.quality}),"MP3"!==e.format&&e.resolution&&t.push({label:"Resolution",value:e.resolution}),e.fileSize&&t.push({label:"File Size",value:e.fileSize}),t},KK=e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");if(window.getSelection){const e=window.getSelection();if((null==e?void 0:e.getRangeAt)&&e.rangeCount){const a=e.getRangeAt(0);a.deleteContents(),a.insertNode(document.createTextNode(t)),a.collapse(!1)}}},YK=async e=>{const{dispatch:t}=io(),a=await zK(e);a&&t(uE(a))};async function zK(e){let t,a=[];try{for(;;){const o={pageSize:500};t&&(o.lastId=t);const n=await ap(`/api/v1/videos/${e}/comments`,{params:o});if(!(null==n?void 0:n.length))break;if(t=n[n.length-1]._id,n.sort(((e,t)=>e._id<t._id?-1:1)),a=[...n,...a],n.length<500)break}}catch($ae){console.error(`Error while fetching comments: ${$ae.message}`)}return a}const qK=()=>{const{dispatch:e}=io();e(mE("")),e(pE(!1))},JK=e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)},XK="Checkbox-module_container_dJwO5",QK="Checkbox-module_checkboxContainer_zcwNm",ZK="Checkbox-module_label_xYViQ",eY=({label:e,checked:t,onChange:a,disabled:o})=>m.createElement("div",{className:XK,onClick:()=>!o&&a(!t),style:{opacity:o?.5:1}},m.createElement("div",{className:QK},m.createElement(st,{size:16,style:{opacity:t?1:0}})),m.createElement("div",{className:ZK},e)),tY=({currentVideoTime:e,userCanPostComment:t,maxTime:a,disabled:o,mobileView:r,replyPost:s,onPostSuccess:l,location:c,seekOnCurrentVideo:d,commentContainerRef:u})=>{const{selectedCommentParentId:p,currentVideo:h}=cn((e=>{const{selectedCommentId:t,comments:a}=e.comments;return{selectedCommentParentId:GK(a,t),currentVideo:e.currentVideo}}),i.exports.shallowEqual),g=s?p:void 0,f=n.exports.useRef(null),[y,E]=n.exports.useState(!1),[_,v]=n.exports.useState(!1),[w,b]=n.exports.useState(!1),[S,T]=n.exports.useState(!s),I=i.exports.useDispatch(),k=o||!t||!w||_,C=async()=>{var t;if(k)return;v(!0);const a=null==(t=f.current)?void 0:t.innerText.trim(),o=h._id;if(a){o||I(wh("There was an error with getting the id of the current video."));try{const t={content:a,videoTime:S?e:void 0,submittedAt:h.submittedAt,location:c,parentId:g},n=await op(`/api/v1/videos/${o}/addComment`,{body:t});Dm(g?"reply":"new comment",c,{includeTimestamp:S,teamId:h.teamId,creatorId:h.creatorId}),r&&f.current&&f.current.blur(),I(gE(n.newComment)),null==l||l(),g&&I(mE(n.newComment._id))}catch($ae){console.error($ae),I(wh("There was an error with posting this comment. Please try again."))}f.current&&(f.current.innerText="",b(!1)),v(!1)}};let N=g?"Type your reply":"Type something";t?o&&(N="Exporting in progress... you can leave a comment after the export is complete"):N="Only members of this team workspace can comment on this video";const A=[];A.push([!o&&t?LK:UK]),void 0!==e&&S&&(e>=3600?A.push(FK):A.push(MK));const x=!o&&t,P=m.createElement("div",{className:k?VK:WK,"data-cy":"comment-post-button",onClick:C},s?"Reply":"Comment");return m.createElement("div",{className:`${s?xK:AK} ${r&&y?OK:""}`,ref:e=>{if(e&&s){if(!u.current)return;const t=u.current.getBoundingClientRect(),a=e.getBoundingClientRect();(a.bottom>t.bottom||a.top<t.top)&&e.scrollIntoView({block:"end",behavior:"smooth"})}},"data-cy":s?"comment-reply-box":"comment-post-box"},m.createElement("div",{className:PK},m.createElement("div",{className:DK},void 0!==e&&S&&m.createElement(NK,{key:"commentTimeStamp",videoTimestamp:e,isEditable:x,maxTime:a,seekOnCurrentVideo:d}),m.createElement("div",{className:A.join(" "),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),C())},onKeyUp:e=>{const t=e.target.innerText||"";b(!!t.trim().length)},onBlur:e=>{e.target.innerText.trim().length||(e.target.innerText=""),r&&E(!1)},ref:f,contentEditable:x,"data-placeholder":N,onPaste:e=>{x&&KK(e)},"data-cy":"comments-input-field"})),void 0===e&&m.createElement("div",{className:jK},P)),void 0!==e&&m.createElement("div",{className:RK},m.createElement("div",{className:BK},m.createElement(eY,{disabled:!x,label:"Include timestamp",checked:S,onChange:()=>{T(!S)}})),P))},aY="CommentElement-module_commentContainer_qXF8U",oY="CommentElement-module_selectedCommentContainer_KqbuK",nY="CommentElement-module_threadParentComment_du-w2",rY="CommentElement-module_childCommentContainer_l-gVR",iY="CommentElement-module_commentHeader_J1VYT",sY="CommentElement-module_timestampAndCommentContainer_grCab",lY="CommentElement-module_editingTimestampAndCommentContainer_tm4X5",cY="CommentElement-module_commentContent_z4IMo",dY="CommentElement-module_userName_EWcnK",uY="CommentElement-module_profilePic_8p5FX",mY="CommentElement-module_dateText_ia47-",pY="MoreOptions-module_moreOptions_93QzE",hY="MoreOptions-module_moreOptionsIcon_VVJh9",gY="MoreOptions-module_buttonContainer_oRiF2",fY="MoreOptions-module_buttonLabel_SLQvg",yY="MoreOptions-module_buttonText_gVjm9",EY="MoreOptions-module_buttonIcon_hjLoZ",_Y=({handleEditing:e,handleDeleteComment:t})=>{const[a,o]=n.exports.useState(!1),r=n.exports.useRef(null),i=n.exports.useRef(null),s=e=>{e.stopPropagation(),o((e=>!e))};return n.exports.useEffect((function(){const e=e=>{var t,a;(null==(t=i.current)?void 0:t.contains(e.target))||(null==(a=r.current)?void 0:a.contains(e.target))||o(!1)};if(a)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[a]),m.createElement("div",{ref:r,className:pY},m.createElement(lt,{size:22,className:hY,onClick:e=>{s(e)},"data-cy":"comment-options-toggle"}),a&&r.current&&m.createElement("div",{className:gY,ref:e=>{null==e||e.scrollIntoView({block:"nearest"}),i.current=e}},t&&m.createElement("div",{className:fY,onClick:e=>{s(e),t()},"data-cy":"delete-comment-button"},m.createElement(ct,{className:EY}),m.createElement("span",{className:yY},"Delete")),e&&m.createElement("div",{className:fY,onClick:t=>{s(t),e()},"data-cy":"edit-comment-button"},m.createElement(dt,{className:EY}),m.createElement("span",{className:yY},"Edit"))))},vY="CommentEdit-module_editTextBox_gMXmK",wY="CommentEdit-module_editTextBoxLongTimestamp_Q3wjB",bY="CommentEdit-module_editButtonsContainer_G8-tI",SY="CommentEdit-module_saveButton_S69Q6",TY="CommentEdit-module_cancelButton_6FJFJ",IY="CommentEdit-module_buttonText_IFvqV",kY="CommentEdit-module_disabledSaveButton_6SVDO",CY=({comment:e,setEditMode:t,location:a})=>{const o=i.exports.useDispatch(),r=n.exports.useRef(!1),[s,l]=n.exports.useState(e.content);async function c(){try{await np(`/api/v1/comments/${e._id}`,{body:{content:s}}),Dm("edited comment",a),o(fE({commentId:e._id,updates:{content:s}})),t(!1)}catch($ae){console.error($ae.message),o(wh("There was an error with saving the edit with this comment"))}}const d=s.trim().length>0;return m.createElement(m.Fragment,null,m.createElement("div",{className:`${vY} ${(e.videoTime||0)>=3600?wY:""}`,onKeyUp:e=>{l(e.target.innerText)},onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),c())},ref:e=>{if(e&&r.current){null==e||e.focus();const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const a=window.getSelection();a&&(a.removeAllRanges(),a.addRange(t)),r.current=!1}},onPaste:KK,contentEditable:!0,suppressContentEditableWarning:!0},e.content),m.createElement("div",{className:bY,ref:e=>{null==e||e.scrollIntoView({block:"nearest",behavior:"smooth"})}},m.createElement("button",{className:TY,type:"submit",onClick:a=>{a.stopPropagation(),l(e.content),t(!1)}},m.createElement("span",{className:IY},"Cancel")),m.createElement("button",{className:`${SY} ${d?"":kY}`,type:"submit",disabled:!d,onClick:e=>{e.stopPropagation(),d&&c()}},m.createElement("span",{className:IY},"Save"))))},NY="DeleteCommentDialog-module_deleteDialogBackground_HKTKU",AY="DeleteCommentDialog-module_deleteDialogContainer_jUz0E",xY="DeleteCommentDialog-module_header_c-s1v",PY="DeleteCommentDialog-module_description_Ioldc",RY="DeleteCommentDialog-module_deleteCloseContainer_Z7Vhn",OY="DeleteCommentDialog-module_buttonsContainer_yJ-Vf",DY=({onDelete:e,hideDelete:t,hasReplies:a})=>{const[o,r]=n.exports.useState(!1);let i="Delete Comment",s="Are you sure you want to delete this comment?";return a&&(i+=" Thread",s+=" Deleting this comment will delete all replies in the thread."),m.createElement(m.Fragment,null,m.createElement("div",{className:NY,onClick:t}),m.createElement("div",{className:AY},m.createElement("div",{className:RY,onClick:t},m.createElement(Ee,null)),m.createElement("div",{className:xY},i),m.createElement("div",{className:PY},s),m.createElement("div",{className:OY},m.createElement(ux,{cancelFn:t,confirmFn:async()=>{r(!0),e(),r(!1),t()},loadingMsg:o?"Deleting...":void 0,stopClickPropogation:!0,cancelStyle:{color:"black"}}))))},LY="CommentReplyCount-module_container_TAje5",UY="CommentReplyCount-module_profilePic_4R9dC",MY=({commentReplies:e})=>{const t=[],a=new Set;for(let o=0;o<e.length;o+=1){const{user:n}=e[o],r=null==n?void 0:n.picture;if(r){if(a.has(r))continue;if(t.push(m.createElement(jO,{key:o,user:n,className:UY})),a.add(r),t.length>3)break}}return m.createElement("div",{className:LY},t,m.createElement("span",null,e.length>1?`${e.length} replies`:"1 reply"))},FY=({comment:e,replies:t,maxTime:a,disableTimeStamp:o,isChild:r,location:s,onCommentSelected:l,onCommentEditStart:c,seekOnCurrentVideo:d,threadParent:u})=>{var p;const{selectedCommentId:h,currentUser:g,currentVideo:f}=cn((e=>({selectedCommentId:e.comments.selectedCommentId,currentUser:e.currentUser,currentVideo:e.currentVideo})),i.exports.shallowEqual),y=h===e._id,[E,_]=n.exports.useState(!1),[v,w]=n.exports.useState(!1),b=n.exports.useRef(!1),S=i.exports.useDispatch();n.exports.useEffect((function(){y&&null!==e.videoTime&&d(e.videoTime)}),[]);const T=e.creatorId===g.user._id,I=T||!!f.creatorId&&f.creatorId===g.user._id;return m.createElement("div",{className:(()=>{const e=[aY];return r&&e.push(rY),y&&e.push(oY),u&&e.push(nY),e.join(" ")})(),onClick:()=>{y?S(mE("")):(S(mE(e._id)),l(e._id,e.videoTime))},spellCheck:!1,key:e._id,"data-cy":"video-comment"},m.createElement("div",{className:iY},m.createElement(jO,{user:e.user,className:uY}),m.createElement("div",{className:dY},null==(p=e.user)?void 0:p.name),m.createElement("span",{className:mY},(k=e.createdAt,C(k).format("h:mma MMMM Do"))),(T||I)&&m.createElement(_Y,{handleEditing:T?()=>{c(e.videoTime),b.current=!0,_(!0)}:void 0,handleDeleteComment:I?()=>w(!0):void 0})),m.createElement("div",{className:`${sY} ${E?lY:""}`},null!==e.videoTime&&m.createElement(NK,{videoTimestamp:e.videoTime,isEditable:!1,maxTime:a,disabled:o,inEditModeComment:E,seekOnCurrentVideo:d}),E?m.createElement(CY,{comment:e,setEditMode:_,location:s}):m.createElement("div",{className:cY},e.content)),(null==t?void 0:t.length)&&m.createElement(MY,{commentReplies:t}),v&&m.createElement(DY,{hideDelete:()=>w(!1),onDelete:async()=>{try{await tp(`/api/v1/comments/${e._id}`,{}),Dm("deleted comment",s,{teamId:f.teamId,creatorId:f.creatorId}),S(yE(e._id))}catch($ae){console.error($ae.message),S(wh("There was an error with deleting this comment"))}},hasReplies:!!(null==t?void 0:t.length)}));var k},BY="CommentThread-module_commentList_XIyop",WY=({parentComment:e,replies:t,onCommentSelected:a,onCommentEditStart:o,maxTime:n,seekOnCurrentVideo:r,location:i})=>m.createElement("div",{className:BY},m.createElement(FY,{key:e._id,comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>n),maxTime:n,onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:r,threadParent:!0,location:i}),null==t?void 0:t.map((e=>m.createElement(FY,{key:e._id,comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>n),maxTime:n,isChild:!0,onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:r,location:i})))),VY="MobileSelectedCommentHeader-module_commentsThreadHeader_v4seU",jY="MobileSelectedCommentHeader-module_commentsThreadHeaderLeft_YgaqH",HY="MobileSelectedCommentHeader-module_commentsThreadHeaderRight_UIeKO",GY="MobileSelectedCommentHeader-module_commentsThreadBackIcon_gWJft",$Y="MobileSelectedCommentHeader-module_disabled_NxyTE",KY=()=>{const{selectedCommentId:e,comments:t}=cn((e=>({selectedCommentId:e.comments.selectedCommentId,comments:e.comments.comments})),i.exports.shallowEqual),a=i.exports.useDispatch(),[o,r]=n.exports.useState([]),[s,l]=n.exports.useState(0);return n.exports.useEffect((function(){const a=GK(t,e),o=(null==t?void 0:t.filter((e=>!e.parentId)))||[];r(o.map((({_id:e})=>e))),l(o.findIndex((({_id:e})=>e===a)))}),[t,e]),m.createElement("div",{className:VY,"data-cy":"mobile-selected-comment-header"},m.createElement("div",{className:jY,onClick:()=>{a(mE())}},m.createElement(ut,{size:22,className:GY}),"All Comments"),o.length>1&&s+1<=o.length&&m.createElement("div",{className:HY},m.createElement(mt,{size:22,className:0===s?$Y:"",onClick:()=>{const e=s-1;e>=0&&a(mE(o[e]))}}),s+1," of ",o.length,m.createElement(pt,{size:22,className:s+1===o.length?$Y:"",onClick:()=>{const e=s+1;e<o.length&&a(mE(o[e]))}})))},YY="You need edit access to this project to view and leave comments.\nContact the project owner for edit access.",zY=({maxTime:e,currentVideoTime:t,onCommentEditStart:a,onCommentSelected:o,contentExporting:r,userCanPostComment:s,mobileView:l,location:c,onCommentPostSuccess:d,seekOnCurrentVideo:u,commentsLoading:p})=>{const{comments:h,selectedCommentId:g,selectedComment:f}=cn((e=>{const{comments:t,selectedCommentId:a}=e.comments,o=null==t?void 0:t.find((e=>e._id===a));return{comments:t,selectedCommentId:a,selectedComment:o}}),i.exports.shallowEqual),[y,E]=n.exports.useState([]),[_,v]=n.exports.useState({}),w=n.exports.useRef(null),b=(null==f?void 0:f.parentId)||(null==f?void 0:f._id);n.exports.useEffect((function(){const e=[],t={};null==h||h.forEach((a=>{const{parentId:o}=a;o?(t[o]||(t[o]=[]),t[o].push(a)):e.push(a)})),E(e),v(t)}),[h]);const S=()=>{w.current&&w.current.scrollTo({top:w.current.scrollHeight,behavior:"smooth"})},T=!!(l&&g&&f);return m.createElement("div",{className:`${l?lK:sK} ${c===xs.Studio?cK:hK}`,"data-cy":"comments-section"},!l&&m.createElement("div",{className:dK},"Comments"),T&&m.createElement(KY,null),s?m.createElement(m.Fragment,null,m.createElement("div",{className:T?pK:mK,ref:w,"data-cy":"comments-list-div",id:"comments-content-list"},p&&m.createElement(bk,{wrapperStyles:{marginTop:20}}),!p&&T&&m.createElement("div",{className:yK},m.createElement(WY,{maxTime:e,parentComment:f,replies:_[g],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,location:c})),!p&&!T&&(y.length?y.map((r=>r._id===b?m.createElement(n.exports.Fragment,{key:r._id},m.createElement(WY,{maxTime:e,parentComment:r,replies:_[r._id],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,location:c}),m.createElement("div",null,m.createElement(tY,{currentVideoTime:t,userCanPostComment:s,maxTime:e,mobileView:l,location:c,replyPost:!0,onPostSuccess:d,seekOnCurrentVideo:u,commentContainerRef:w}))):m.createElement(FY,{location:c,comment:r,maxTime:e,replies:_[r._id],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,key:r._id}))):m.createElement("div",{className:uK},"No comments yet.")),l&&m.createElement("div",{className:EK})),m.createElement("div",{className:l&&g?fK:gK},m.createElement(tY,{currentVideoTime:t,disabled:r,userCanPostComment:s,maxTime:e,mobileView:l,onPostSuccess:()=>{setTimeout(S,0),null==d||d()},location:c,replyPost:T,seekOnCurrentVideo:u,commentContainerRef:w}))):m.createElement("div",{className:_K,"data-cy":"no-edit-message"},c===xs.Studio?"Please sign in to leave a comment.":YY))};var qY=(e=>(e.USER_FOLDER_ACCESS="User does not have access to this folder.",e))(qY||{});function JY(e){return e?ap(`/api/v1/workspaces/${e}`):null}const XY=e=>{const{state:t}=io(),{workspaces:{allWorkspaces:a}}=t;return a.find((t=>t._id===e))};function QY(){const{state:e,dispatch:t}=io(),{teams:a,workspaces:o}=e,{selectedTeamId:n}=a,{selectedWorkspace:r}=o,i=XY(r);if(!i)return;const{teamId:s}=i;s&&s!==n&&Yh(s)&&t(dg(s))}async function ZY(){const{dispatch:e,state:t,history:a}=io(),{currentUser:o,workspaces:n,studio:r}=t,{workspaceId:i}=r,{selectedWorkspace:s,allWorkspaces:l}=n,{location:{pathname:c}}=a;if(c.endsWith("/studio/editor")&&om(o)&&s!==i&&i){if(nb(i))return e(Af(i)),void QY();try{const t=await JY(i);if(!t)return;e(Af(i)),e(Nf([t,...l])),QY()}catch($ae){if((null==$ae?void 0:$ae.message)!==qY.USER_FOLDER_ACCESS)return void console.error("Error while attempting folder - video synchronization.",$ae);e(Af("shared-with-me"))}}}async function ez(){const{dispatch:e}=io();let t;try{t=await op("/api/v2/teams/suggested"),t&&e(iy(t))}catch($ae){console.error($ae,"There was an error while fetching suggested workspaces.")}return t}const tz="ProjectName-module_projectNameContainer_FJ0U0",az="ProjectName-module_hiddenSpan_zvycS";class oz extends n.exports.Component{constructor(e){super(e),t(this,"inputRef",null),t(this,"spanRef",null),t(this,"projectNameOnChange",(e=>{this.setState({projectName:e.target.value})})),t(this,"projectNameOnSubmit",(()=>{const{setProjectName:e,projectId:t,currentUser:a}=this.props,{projectName:o}=this.state;null!=o&&e(o),Lf(t,{name:o},a)})),t(this,"onEnterPressed",(e=>{var t;"Enter"===e.code&&!1===e.shiftKey&&(e.preventDefault(),null==(t=this.inputRef)||t.blur())})),this.state={projectName:"",width:0}}componentDidMount(){var e;const{projectName:t}=this.props;this.setState({projectName:t,width:(null==(e=this.spanRef)?void 0:e.offsetWidth)||0})}componentDidUpdate(e,t){var a;const{projectName:o,projectId:n,currentUser:r}=this.props;this.state.projectName!==t.projectName&&this.setState({width:(null==(a=this.spanRef)?void 0:a.offsetWidth)||0}),o!==e.projectName&&(this.setState({projectName:o}),""===o&&Lf(n,{name:o},r))}render(){const{projectName:e,width:t}=this.state,{isBrandKitTemplate:a}=this.props;let o="Untitled Project";e?o=e:a&&(o="Untitled Template");const n=`${o} — Kapwing`;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,n)),m.createElement("span",{className:az,ref:e=>{this.spanRef=e}},o),m.createElement("input",{ref:e=>{this.inputRef=e},disabled:this.props.disabled,className:tz,style:{width:t},"data-cy":"studio-project-name-field",onChange:this.projectNameOnChange,onBlur:this.projectNameOnSubmit,onKeyDown:this.onEnterPressed,placeholder:a?"Untitled Template":"Untitled Project",value:e}))}}const nz=i.exports.connect((e=>({projectName:e.projectName,projectId:e.sharedDoc&&e.sharedDoc.projectId,currentUser:e.currentUser,isBrandKitTemplate:e.studio.isBrandKitTemplate})),(e=>he({setProjectName:rS},e)))(oz),rz=(e,t)=>!e||t,iz=async(e,t="",a=!1)=>{const{dispatch:o,history:n,state:r}=io(),{studio:i,currentUser:s,videoSaving:l,projectName:c}=r,d=r.sharedDoc&&r.sharedDoc.projectId,u=i._id,{scenes:m,videoType:p,duration:h}=i,{pathname:g}=window.location,f=()=>window.location.pathname!==g;if("gif"===(t||p)&&h>60)return void Nk("Max GIF duration is 60 seconds. Please trim your video or switch output to mp4.");if(((e,t,a)=>e&&!t||!e&&a)(u,e,l))return void Nk("Saving your work - please wait a second and try again.");if(!(e=>{for(const t of e)for(const e of t.layers){if("begun"===e.videoConvertedState)return console.error("Layer still converting:",e),Ml("/studio/editor/conversion-warning"),!1;if("image/webp"===e.mime&&"unknown"===e.webpType)return console.error("Layer still processing image:",e),Ml("/studio/editor/image-processing-warning"),!1}return!0})(m))return void Nk("A layer is still converting. Please try again later.");a||o(Py(-1)),"mp3"!==p||t||o(Ny("mp4"));const y=nH(r,h,"videoState",a,s);let E,_,v=!1;const w=Date.now(),b="Failed to client side process video";try{if(y)try{const e=await rH(s,r,h,a,"videoState");if(f())return;if((!e.processed||!e.newUrl)&&i.duration>0)throw Error(b);v=e.processed,E=e.newUrl,_=e.ffmpegData}catch($ae){throw Error(b)}const e="Studio Draft"===c||""===c?"Studio Project":c;d&&s&&await Lf(d,{name:e},s);const l=t||a?"studio-publish-dropdown":"studio-publish",u=await o(f$({currentUser:s,publish:!0,auto:!1,createLocation:l,processedOnClient:v}));if(f())return;if(v){o(yS({local_url:E}));const e=u.scenes[0].layers.some((e=>"video"===e.type));window.Cypress&&e?await v$(u._id,{done:!0,draft:!1}):e&&u.duration>0&&(await v$(u._id,{pendingProcessOnClient:!0}),((e,t,a,o)=>{var n;const r=om(e)?e.user._id:null,i=Date.now();let s=0,l=0;t.scenes.forEach((e=>{s+=e.layers.length,l+=e.duration}));const c={buildDuration:(i-a)/1e3,layerDuration:l,layerCount:s,outputDuration:null!=(n=t.duration)?n:null,sceneCount:t.scenes.length};o&&(c.ffmpegData=o),v$(t._id,{build:c}),"mp4"===t.videoType&&fm("Video Proccessed",{clientSideProcessed:!0,creatorId:r,isStudio:!0})})(s,u,w,_));try{await hN(i,!0)}catch($ae){console.error(`There was an error with creating the snapshot for this client-side project on export: ${$ae.toString()}`)}}return y&&await v$(u._id,{processedOnClient:v}),void(null==n||n.push(`/videos/${u._id}`))}catch(S){if(425===S.statusCode)return void Ml("/studio/editor/upload-warning");if(S.message===b&&u)return console.error(b),void(await sz(u,"Error"));console.error(S),Nk(S.message)}},sz=async(e,t)=>{const{dispatch:a,state:o}=io(),{currentUser:n}=o;await a(f$({currentUser:n,publish:!0,auto:!1,createLocation:"studio-publish",processedOnClient:!1})),await v$(e,{pendingProcessOnClient:!1,clientSideProcessingInProgress:!1}),fm("Create Failed Client Side Video",{videoId:e,Reason:t})},lz="PublishContainer-module_createButton_RiHLs",cz="PublishContainer-module_createButtonDisabled_llU9O",dz="PublishContainer-module_createButtonWarning_mGShM",uz="PublishContainer-module_buttonContainer_HL-ly",mz="PublishContainer-module_exportIcon_lDu4V",pz="PublishContainer-module_displayNone_KPyJE",hz="WatermarkModal-module_modalBackground_6nkm2",gz="WatermarkModal-module_cardImage_jxYgx",fz="WatermarkModal-module_container_BcwCP",yz="WatermarkModal-module_description_Stspv",Ez="WatermarkModal-module_optionsContainer_LT8ye",_z="WatermarkModal-module_title_07gHF",vz="WatermarkModal-module_cardTitle_YbLeP",wz="WatermarkModal-module_cardContext_70ZcD",bz="WatermarkModal-module_selectedCard_RHDwd",Sz="WatermarkModal-module_unselectedCard_8-Ubc",Tz="WatermarkModal-module_submitButton_HOcMQ",Iz="WatermarkModal-module_exportIcon_43HQi",kz="WatermarkModal-module_cardContent_TgYqk",Cz=e=>{const{closeModal:t,handleExport:a}=e,[o,r]=n.exports.useState(!1),[i,s]=n.exports.useState(!1),l=oe(),c=()=>{t(),a()},d=e=>{const t="select-convert"===e;return m.createElement("div",{className:t?i?bz:Sz:i?Sz:bz,onClick:t?()=>s(!0):()=>s(!1)},m.createElement("img",{className:gz,src:t?"https://i.imgur.com/wRccXyO.jpg":"https://i.imgur.com/bpnzhjy.jpg",alt:t?"Example video with watermark":"Example video without watermark"}),m.createElement("div",{className:kz},m.createElement("div",{className:vz},t?"Export without a watermark":"Export without signing in"),m.createElement("div",{className:wz},t?"Sign in or sign up for free to get 0 videos without a watermark every month.":"Your exported video will contain a small Kapwing watermark in the bottom corner.")))};return m.createElement(kx,{onClick:e=>e.stopPropagation(),unsetCancelModal:()=>{t(),fm("Watermark Modal Action",{action:"Close"})},className:hz},m.createElement("div",{className:fz,"data-cy":"watermark-modal"},o&&m.createElement(MC,{hideSignIn:()=>r(!1),onSuccess:()=>{c()},immediateRedirectPathname:`${l.pathname}?export=true`}),m.createElement("div",{className:_z},"Your export will have a watermark. Sign in to remove it for free."),m.createElement("div",{className:yz},"If you export without signing in, your content will have a small watermark. Creating a free Kapwing account lets you export without a watermark for up to ",0," times a month, save projects to your workspace, collaborate on videos, and much more."),m.createElement("div",{className:Ez},d("select-export"),d("select-convert")),m.createElement("button",{className:Tz,type:"button",onClick:()=>{i?(r(!0),fm("Watermark Modal Action",{action:"Conversion"})):(c(),fm("Watermark Modal Action",{action:"Export"}))},"data-cy":"watermark-modal-export-button"},i?m.createElement(m.Fragment,null,"Sign In and Export ",m.createElement(ht,{className:Iz})):m.createElement(m.Fragment,null,"Export with watermark ",m.createElement(ht,{className:Iz}))," ")))},Nz=()=>{const{state:e}=io(),{scenes:t,selectedSceneIndex:a}=e.studio,o=t[a],{layers:n}=o;let r=!1;for(let i=0;i<n.length;i+=1)if("subtitle"===n[i].type&&""!==n[i].text){r=!0;break}return r},Az=e=>Math.round(1e3*e)/1e3;function xz(e,t){for(let a=0;a<e.length-1;a+=1){const o=e[a],n=e[a+1];if((!o.frame||!n.frame||o.frame.originalNdx!==n.frame.originalNdx)&&(o&&Az(o.endTime)-t>Az(n.startTime)))return o}}const Pz="PublishOverlay-module_blueButton_G-bG6",Rz="PublishOverlay-module_exportAnywayButton_6a9CT",Oz="PublishOverlay-module_greenButton_qvdKy",Dz="PublishOverlay-module_header_1ABTD",Lz="PublishOverlay-module_primaryImage_2RGo1",Uz="PublishOverlay-module_description_xSsYO",Mz="PublishOverlay-module_descriptionGray_MncCf",Fz="PublishOverlay-module_descriptionScrollBox_9XkTn",Bz="PublishOverlay-module_buttonContainer_evD-N",Wz=e=>{const{onClose:t,onContinue:a,overlappingSubtitle:o}=e,n=i.exports.useDispatch(),r="classic"===o.type?"":" magic";return m.createElement(eP,{onClose:t},m.createElement("div",{className:Dz},"Heads up! Overlapping Subtitles"),m.createElement("div",{className:Uz},"Your project has overlapping",r," subtitles. This is likely unintentional. Please consider addressing this before exporting your project."),m.createElement("div",{className:Bz},m.createElement("div",{className:Oz,onClick:()=>a()},"Export anyway"),m.createElement("div",{className:Pz,onClick:e=>{"classic"===o.type?n(Is({id:o.layer.id,type:"layer"})):n(Is({id:o.layer.assetId,type:"magicSubtitle"})),n(XS({tabId:Sn.subtitles,tabContainerId:"media-sidebar"})),t(),e.stopPropagation()}},"Fix overlapping subtitles")))},Vz=()=>{const{state:e,dispatch:t}=io(),{layers:a}=e.studio.scenes[e.studio.selectedSceneIndex],{studio:{selectedTimelineRows:o}}=e,n=o[0],r=[...$z(n,a),...Kz(n,a)];tr.withUndoBatch((()=>{i.exports.batch((()=>{r.forEach((e=>t(ds(e,{timelineRow:e.timelineRow+1},!0))))}))}))()},jz=()=>Ml("/studio/editor/delete-row"),Hz=()=>{const{state:e,dispatch:t}=io(),{layers:a}=e.studio.scenes[e.studio.selectedSceneIndex],{studio:{selectedTimelineRows:o}}=e;let n=[];for(let i=0;i<o.length;i+=1){const e=o[i],t=$z(e,a);n=[...n,...t]}const r=o.sort(((e,t)=>e-t)),s=r[0],l=r[r.length-1],c=[...Yz(s,l,o,a),...Kz(l,a)],d={};for(let i=s,u=0;i<=l;i+=1)i===r[u]&&(u+=1),d[i]=u;tr.withUndoBatch((()=>{i.exports.batch((()=>{n.forEach((e=>kR(e.id))),c.forEach((e=>{const{timelineRow:a=0}=e,o=a>l?d[l]:d[a];t(ds(e,{timelineRow:a-o},!0))}))}))}))(),t(vs([]))},Gz=(e,t)=>{const{dispatch:a,state:o}=io(),{layers:n}=o.studio.scenes[o.studio.selectedSceneIndex];let r,s,l;[r,s,l]=e<t?[e,t,-1]:[t,e,1];const c=$z(e,n);let d=[];for(let i=r;i<=s;i+=1)i!==e&&(d=[...d,...$z(i,n)]);tr.withUndoBatch((()=>i.exports.batch((()=>{c.forEach((e=>a(ds(e,{timelineRow:t},!0)))),d.forEach((e=>a(ds(e,{timelineRow:e.timelineRow+l},!0))))}))))()},$z=(e,t)=>{let a=[];return t.every(((o,n)=>void 0!==o.timelineRow&&o.timelineRow===e?"subtitle"===o.type?(a=t.slice(n),!1):(a.push(o),!0):"subtitle"!==o.type)),a},Kz=(e,t)=>{const a=[];return t.every((t=>void 0!==t.timelineRow&&t.timelineRow>e?(a.push(t),!0):"subtitle"!==t.type)),a},Yz=(e,t,a,o)=>o.filter((({timelineRow:o})=>void 0!==o&&e<o&&o<t&&!a.includes(o))),zz=e=>{const{layers:t}=e.studio.scenes[0],{duration:a}=e.studio;if(0===a)return[];const o=[...t];o.sort(((e,t)=>Vv(e,0)[0]-Vv(t,0)[0]));const n=[{startTime:0,endTime:0}];if(o.forEach((e=>{const[t,a]=Vv(e,0),o=n[n.length-1];t-.01<=o.endTime?n[n.length-1].endTime=Math.max(a,o.endTime):n.push({startTime:t,endTime:a})})),1===n.length)return[];const r=[];return n.forEach(((e,t)=>{const a=n[t+1];t!==n.length-1&&r.push({startTime:e.endTime,endTime:a.startTime})})),r},qz=e=>{const{onClose:t,onExportAnyway:a}=e,{gapsInTimeline:o}=cn((e=>({gapsInTimeline:zz(e)})),dn),n=i.exports.useDispatch();return m.createElement(eP,{onClose:t},m.createElement("div",{className:Dz},"Empty Frames Detected In Your Video"),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/dFU-gapsInTimeline.png",className:Lz,alt:"Gaps in timeline"}),m.createElement("div",{className:Mz},"We found gaps in your project! Did you mean for this to happen? Add media or adjust your timing to avoid empty space in your final project."),m.createElement("div",{className:Mz},m.createElement("div",null,m.createElement("b",null,"Empty frames detected in your project")),m.createElement("div",{className:Fz},o.map(((e,t)=>m.createElement("div",{key:t},`${Oh(e.startTime)} -- ${Oh(e.endTime)}`))))),m.createElement("div",{className:Bz},m.createElement("div",{className:Rz,onClick:()=>{t(),a()}},"Export anyway"),m.createElement("div",{className:Pz,onClick:()=>{Ml("/studio/editor"),n(Ti(!1)),$b(o[0].startTime),n(Hs(!0)),t()}},"Check the timeline")))},Jz=r((e=>e.studio.videoType),(e=>e.studio.duration),(e=>e.studio.scenes),((e,t,a)=>{const o=e.toLowerCase();let n="";return t?n="gif"===o?"GIF":"Video":"gif"===o?n="GIF":(e=>{for(const t of e)for(const e of t.layers)if("video"===e.type&&!e.converted_gif)return!0;return!1})(a)||(n="Image"),n}));class Xz extends n.exports.Component{constructor(e){super(e),t(this,"_mounted",!1),t(this,"validationStageModals",[{stage:"gapInTimeline",render:()=>m.createElement(qz,{onClose:()=>this.bailOnExportValidation(),onExportAnyway:()=>this.advanceValidationStage(this.nextStage())})},{stage:"classicOverlap",render:()=>m.createElement(Wz,{onClose:()=>{var e;this.bailOnExportValidation();const t=null==(e=this.state.overlappingClassicSubtitle)?void 0:e.id;t&&io().dispatch(Is({id:t,type:"layer"})),Ml("/studio/editor/subtitles")},onContinue:()=>this.advanceValidationStage(this.nextStage()),overlappingSubtitle:{type:"classic",layer:this.state.overlappingClassicSubtitle}})},{stage:"magicOverlap",render:()=>m.createElement(Wz,{onClose:()=>{var e;this.bailOnExportValidation();const t=null==(e=this.state.overlappingMagicSubtitle)?void 0:e.assetId;t&&io().dispatch(Is({id:t,type:"magicSubtitle"})),Ml("/studio/editor/subtitles")},onContinue:()=>this.advanceValidationStage(this.nextStage()),overlappingSubtitle:{type:"magic",layer:this.state.overlappingMagicSubtitle}})}]),t(this,"setSubmitting",(e=>{this.setState({submitting:e})})),t(this,"hideWatermark",(()=>this.setState({showingWatermarkModal:!1}))),t(this,"handleClick",(()=>{const{overlayWithHeader:e,exportBlocked:t,exportBlockedAction:a,exportBlockedOnDurationPro:o,dispatch:n}=this.props;if(!o)return t?(fm("Paywalled Export Clicked",{"Limit Source":Sm(a)}),void hO((()=>{}),{action:a})()):void(bW()?Ml("/studio/editor/warning"):SW()?Ml("Scenes"===e?"/studio/editor/scenes/upgrade":"/studio/editor/upgrade"):this.advanceValidationStage(0));n(u_("proUserDurationLimit"))})),t(this,"handleExport",(async(e="")=>{const{videoFetched:t}=this.props;try{this.setSubmitting(!0),await iz(t,e)}catch(a){console.error(a)}finally{this._mounted&&this.setSubmitting(!1)}})),t(this,"nextStage",(()=>{var e;return(null!=(e=this.state.exportStageNdx)?e:0)+1})),t(this,"advanceValidationStage",(e=>{var t;if(null===e)return void this.advanceValidationStage(0);const a=null==(t=this.validationStageModals[e])?void 0:t.stage;if(!a)return this.setState({exportStageNdx:null}),void(e=>{const{dispatch:t}=io();fm("Studio Export Panel Opened"),t(xi({key:"exportPanel",params:e}))})({});switch(a){case"classicOverlap":{const t=(()=>{const{layers:e}=io().state.studio.scenes[0];return xz(uR(e).sort(((e,t)=>e.startTime-t.startTime)),.01)})();if(t)return void this.setState({overlappingClassicSubtitle:t,exportStageNdx:e});break}case"magicOverlap":{const t=(()=>{const e=zV(io().state);for(const t of e){const e=xz(cj({assetId:t,filterInvalid:!0})(io().state),0);if(e)return e}})();if(t)return void this.setState({overlappingMagicSubtitle:t,exportStageNdx:e});break}case"gapInTimeline":if(zz(io().state).length>0)return void this.setState({exportStageNdx:e});break}this.advanceValidationStage(e+1)})),t(this,"bailOnExportValidation",(()=>{this.setState({exportStageNdx:null,overlappingMagicSubtitle:void 0,overlappingClassicSubtitle:void 0})})),this.state={exportStageNdx:null}}componentDidMount(){const{signedOut:e,location:t}=this.props;this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed(),this.showTooltipIfTextToSpeechUsed();const a=new URLSearchParams(t.search);e||"true"!==a.get("export")||this.handleExport(),this._mounted=!0}componentDidUpdate(e){const{dispatch:t,exportBlocked:a}=this.props;e.exportBlocked&&!a&&(t(Oy("freeUserFileSizeLimitWarned",!1)),t(Oy("freeUserDurationLimitWarned",!1)),t(Oy("cleanAudioUsed",!1)),t(Oy("smartCutUsed",!1)),t(Oy("removeVideoBackgroundUsed",!1)),t(Oy("audiogramUsed",!1)),t(Oy("textToSpeechUsed",!1))),this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed(),this.showTooltipIfTextToSpeechUsed()}componentWillUnmount(){this._mounted=!1}showTooltipIfFreeLimitExceeded(){const{dispatch:e,exportBlocked:t,exportBlockedOnDuration:a,exportBlockedOnFilesize:o,freeUserDurationLimitWarned:n,freeUserFileSizeLimitWarned:r,isProjectFetched:i,showingTooltip:s}=this.props;i&&(a&&!n?(e(u_("freeUserDurationLimit")),e(Oy("freeUserDurationLimitWarned",!0))):o&&!r?(e(u_("freeUserSizeLimit")),e(Oy("freeUserFileSizeLimitWarned",!0))):t||"freeUserDurationLimit"!==s&&"freeUserSizeLimit"!==s||e(u_("")))}showTooltipIfProLimitExceeded(){const{dispatch:e,exportBlockedOnDurationPro:t,showingTooltip:a,proUserDurationLimitWarned:o}=this.props;t&&!o?(e(u_("proUserDurationLimit")),e(Oy("proUserDurationLimitWarned",!0))):t||"proUserDurationLimit"!==a||e(u_(""))}showTooltipIfCleanAudioUsed(){const{dispatch:e,exportBlockedOnCleanAudio:t,cleanAudioFeatureUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(u_("cleanAudioUsed")),e(Oy("cleanAudioUsed",!0))):t||"cleanAudioUsed"!==o||e(u_(""))}showTooltipIfSmartCutUsed(){const{dispatch:e,exportBlockedOnSmartCutAudio:t,exportBlockedOnSmartCutVideo:a,smartCutFeatureUsedWarned:o,showingTooltip:n}=this.props,r=t||a;if(r&&!o){e(u_(a?"videoSmartCutUsed":"audioSmartCutUsed")),e(Oy("smartCutUsed",!0))}else r||"videoSmartCutUsed"!==n&&"audioSmartCutUsed"!==n||e(u_(""))}showTooltipIfRemoveVideoBackgroundUsed(){const{dispatch:e,exportBlockedOnRemoveVideoBackground:t,removeVideoBackgroundUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(u_("removeVideoBackgroundUsed")),e(Oy("removeVideoBackgroundUsed",!0))):t||"removeVideoBackgroundUsed"!==o||e(u_(""))}showTooltipIfAudiogramUsed(){const{dispatch:e,exportBlockedOnAudiogram:t,audiogramUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(u_("audiogramUsed")),e(Oy("audiogramUsed",!0))):t||"audiogramUsed"!==o||e(u_(""))}showTooltipIfTextToSpeechUsed(){const{dispatch:e,exportBlockedOnTextToSpeech:t,textToSpeechUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(u_("textToSpeechUsed")),e(Oy("textToSpeechUsed",!0))):t||"textToSpeechUsed"!==o||e(u_(""))}renderCreateButton(){const{exportBlocked:e,shrinkCreateButton:t,isBrandKitTemplate:a,exportBlockedOnDurationPro:o}=this.props,{submitting:n}=this.state;let r=a?"published"===a?"Published to Workspace":"Publish to Workspace":"Export Project",i=m.createElement(gt,{className:mz});return e&&!o&&(i=m.createElement(fO,null)),t&&(i=null,r=a?"Publish":"Export"),n?m.createElement("div",{className:`${lz} ${cz}`,"data-cy":"loading-create-button"},"Loading..."):m.createElement("div",{className:`${lz}\n        ${e&&!o?dz:""}\n        ${o?cz:""}\n        ${a?pz:""}`,"data-cy":"create-button",onClick:e=>{this.handleClick(),e.stopPropagation()}},r,i)}render(){const{disabled:e,shrinkCreateButton:t,isBrandKitTemplate:a}=this.props,{exportStageNdx:o,showingWatermarkModal:n}=this.state,r=a?"Publish":"Export",i=a?"Publish to Workspace":"Export Project";if(e)return m.createElement("div",{className:`${lz} ${cz} ${a?pz:""}`},t?r:i);const s=null!==o?this.validationStageModals[o]:null;return m.createElement("div",{className:uz},n&&m.createElement(Cz,{closeModal:this.hideWatermark,handleExport:this.handleExport}),s&&s.render(),this.renderCreateButton())}}const Qz=ie(i.exports.connect((e=>{const{studio:t,currentUser:a,assets:{byId:o}}=e,{scenes:n}=t,r=!a.token,i=Ou({team:Bu()}),s=i.hasPermission(au.REMOVE_BACKGROUND),l=!s&&n[0].layers.some((e=>{var t;return e.backgroundRemoved||e.asset_id&&"remove-background"===(null==(t=o[e.asset_id])?void 0:t.usedProFeature)})),c=!s&&n[0].layers.some((e=>"remove-video-background"===e.usedProFeature)),d=!i.hasPermission(au.CLEAN_AUDIO)&&n[0].layers.some((e=>{var t;return e.asset_id&&"clean-audio"===(null==(t=o[e.asset_id])?void 0:t.usedProFeature)})),u=i.hasPermission(au.SMART_CUT),m=!u&&n[0].layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===xr.Video)),p=!u&&n[0].layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===xr.Audio)),h=!i.hasPermission(au.AUDIOGRAM)&&n[0].layers.some((e=>"audiogram"===e.usedProFeature)),g=!i.hasPermission(au.TEXT_TO_SPEECH)&&n[0].layers.some((e=>"text-to-speech"===e.usedProFeature)),f=!i.hasPermission(au.UNLIMITED_EXPORT_DURATION_LIMIT)&&t.duration>420,y=!i.hasPermission(au.UNLIMITED_UPLOAD_SIZE_LIMIT)&&n[0].layers.some(kW),E=t.duration>7200,_=f||E||y||l||d||p||m||c||h||g;let v=ou.DEFAULT;return l?v=ou.BACKGROUND_IMAGE_ERASE:y?v=ou.UPLOAD_LIMIT:f?v=ou.SINGLE_VIDEO_DURATION_LIMIT:d?v=ou.CLEAN_AUDIO:m?v=ou.SMART_CUT_VIDEO:p?v=ou.SMART_CUT_AUDIO:c?v=ou.REMOVE_VIDEO_BACKGROUND:h?v=ou.AUDIOGRAM_BAR:g&&(v=ou.TEXT_TO_SPEECH),{type:Jz(e),exportBlocked:_,exportBlockedAction:v,exportBlockedOnRemoveBg:l,exportBlockedOnCleanAudio:d,exportBlockedOnSmartCutAudio:p,exportBlockedOnSmartCutVideo:m,exportBlockedOnAudiogram:h,exportBlockedOnRemoveVideoBackground:c,exportBlockedOnTextToSpeech:g,exportBlockedOnDuration:f,exportBlockedOnDurationPro:E,exportBlockedOnFilesize:y,freeUserDurationLimitWarned:Gn(e,"freeUserDurationLimitWarned"),freeUserFileSizeLimitWarned:Gn(e,"freeUserFileSizeLimitWarned"),proUserDurationLimitWarned:Gn(e,"proUserDurationLimitWarned"),cleanAudioFeatureUsedWarned:Gn(e,"cleanAudioUsed"),smartCutFeatureUsedWarned:Gn(e,"smartCutUsed"),removeVideoBackgroundUsedWarned:Gn(e,"removeVideoBackgroundUsed"),audiogramUsedWarned:Gn(e,"audiogramUsed"),textToSpeechUsedWarned:Gn(e,"textToSpeechUsed"),isProjectFetched:e.studioLocal.isProjectFetched,overlayWithHeader:t.overlayWithHeader,showingTooltip:e.toolTip,signedOut:r,isBrandKitTemplate:e.studio.isBrandKitTemplate,brandkitTemplates:e.teams.brandkitTemplates,videoId:e.studio._id}}))(Xz));let Zz,eq;async function tq(e,t,a,o){let n,r;try{const e=await t.getInternalRecorder();if(n=await new Promise((t=>e.stop(t))),xn()&&(n=await ft(n,o)),!n||!n.size)throw new Error("Screen recording failed. Please try again.")}catch($ae){return void console.error($ae)}e.getTracks().forEach((e=>e.stop())),t.reset(),r="screen"===a||"screen-video"===a||"video"===a?"video/webm":"audio/webm";const i=new File([n],`${a}-recording.webm`,{type:r});return i.recordType=a,i}function aq(e){const t=e.getTracks().some((e=>"video"===e.kind)),a=function(e,t){if("audio"===t)return new eq(e,{type:"audio",mimeType:"audio/webm",disableLogs:!1,timeSlice:3e4,recorderType:Zz});return new eq(e,{videoBitsPerSecond:oq(e),type:"video",mimeType:"video/webm",disableLogs:!1,timeSlice:3e4,recorderType:Zz})}(e,t?"video":"audio");return a.startRecording(),a}function oq(e){const t=e.getVideoTracks()[0];if(null==t)return;const a=t.getSettings();if("number"!=typeof a.width||"number"!=typeof a.height)return 8e6;const o=a.width>a.height?a.height:a.width;return"number"!=typeof a.frameRate||a.frameRate<=30?o<=360?1e6:o<=480?25e5:o<=720?5e6:8e6:o<=360?15e5:o<=480?4e6:o<=720?75e5:12e6}async function nq(e){let t;try{t=navigator.mediaDevices.getDisplayMedia?await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e}):await navigator.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e})}catch(a){if("NotAllowedError"===a.name)return"permissionError"}return t}async function rq(e,t,a){let o;try{o=await navigator.mediaDevices.getUserMedia({video:{deviceId:t},audio:!!e&&{deviceId:a}})}catch(n){if("NotAllowedError"===n.name)return"permissionError"}return o}async function iq(e){let t;try{t=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e}})}catch{}return t}function sq(){let e=!1,t=!1,a=!1;return Ln()||On()||(navigator.mediaDevices&&"getUserMedia"in navigator.mediaDevices&&(e=!0,t=!0),(navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices||"getDisplayMedia"in navigator)&&(a=!0)),{supportsAudio:e,supportsVideo:t,supportsScreenRecord:a}}"undefined"!=typeof window&&Eb((()=>import("./RecordRTC.44537c33.js").then((e=>e.R))),["assets/RecordRTC.44537c33.js","assets/vendor.6b80416b.js"]).then((e=>{eq=e.RecordRTCPromisesHandler,Zz=e.MediaStreamRecorder}));const lq=()=>r(((e,{groupId:t})=>e.studio.groups[t]),((e,{studioTime:t})=>tS(e,t)),((e,t)=>{if(!e)return[];const a=new Set(e.layers.map((e=>e.id)));return t.filter((e=>"string"!=typeof e&&a.has(e.id)))})),cq=()=>{const e=lq();return r(((e,{groupId:t})=>e.studio.groups[t]),((e,{groupId:t})=>e.studioLocal.groupDragOverrides[t]),((t,{groupId:a,studioTime:o})=>e(t,{groupId:a,studioTime:o})),(e=>e.studio.width),(e=>e.studio.height),((e,t,a)=>t||{absolutePosition:vd(a,(null==e?void 0:e.rotation)||0,null==e?void 0:e.origin),xDiff:0,yDiff:0,transformerNode:null,isResizing:!1,isRotating:!1}))},dq=(e,t,a)=>{const o=e.studio.groups[t],n=e.studioLocal.groupDragOverrides[t];return n||{absolutePosition:vd(a,o.rotation,o.origin),xDiff:0,yDiff:0,transformerNode:null,isResizing:!1,isRotating:!1}},uq=e=>{var t,a;return(null==(a=e.studioLocal.layerTempValues[(null==(t=e.studio.selectedItem)?void 0:t.id)||""])?void 0:a.isBeingInlineCropped)||null};function mq(e){const t=n.exports.useRef();return n.exports.useEffect((()=>{t.current=e}),[e]),t.current}function pq(e,t){const[a,o]=n.exports.useState(e);return n.exports.useEffect((()=>{const a=setTimeout((()=>{o(e)}),t);return()=>{clearTimeout(a)}}),[e,t]),a}const hq=(e,t)=>{n.exports.useEffect((()=>{const a=a=>{e.current&&!e.current.contains(a.target)&&t(a)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}}),[e,t])},gq=(e,t=60)=>{const a=n.exports.useRef(),o=n.exports.useRef();n.exports.useEffect((()=>{const n=r=>{if(void 0!==o.current){const a=r-o.current;a>=1e3/t&&(e(a),o.current=r)}else o.current=r;a.current=requestAnimationFrame(n)};return a.current=requestAnimationFrame(n),()=>cancelAnimationFrame(a.current)}),[e,t])};function fq(){return cn(oS)}const yq=e=>{const t=(e=>{const t=n.exports.useRef(e);return t.current=e,t})(e);return n.exports.useCallback((function(...e){return t.current(...e)}),[])},Eq=()=>cn(uq),_q=["overlay/record/video","overlay/record/audio","overlay/record/screen"],vq=n.exports.createContext(void 0),wq=({children:e})=>{const t=i.exports.useDispatch(),[a,o]=n.exports.useState(void 0),r=n.exports.useRef(null),[s,l]=n.exports.useState(void 0),c=n.exports.useRef(null),[d,u]=n.exports.useState(!1),[p,h]=n.exports.useState([]),[g,f]=n.exports.useState(void 0),[y,E]=n.exports.useState([]),[_,v]=n.exports.useState(void 0),[w,b]=n.exports.useState(),{pathname:S}=oe(),T=n.exports.useCallback(((e,a)=>{const o=cV(e,{selectLayerInCreator:!0});$l(),function(e){var t,a;const{state:o,dispatch:n}=io(),{byId:r}=o.studio.allLayers,i=null==(t=o.studioLocal.awaitingRecordings)?void 0:t.screen,s=null==(a=o.studioLocal.awaitingRecordings)?void 0:a.video;if("recordType"in e)switch(e.recordType){case"screen-audio":case"screen-video":"string"==typeof i&&Sq(r,e,i),n(ml({video:e.id}));break;case"screen":"string"==typeof s&&Sq(r,e,s),n(ml({screen:e.id}))}}(o),"recordType"in o&&("screen-video"===o.recordType&&(zl(e.id,{positionTemp:null}),t(es(o,"3%","67%","30%","30%")),t(is(o))),"screen"===o.recordType&&(null==a?void 0:a.recordScreenAndCameraUpload)&&t(ss(o)))}),[t]),I=n.exports.useCallback((()=>{var e;null==(e=r.current)||e.destroy(),r.current=null,o((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]),k=n.exports.useCallback((()=>{var e;null==(e=c.current)||e.destroy(),c.current=null,l((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]);n.exports.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop()))}),[a]),n.exports.useEffect((()=>()=>{null==s||s.getTracks().forEach((e=>e.stop()))}),[s]);const C=n.exports.useCallback((()=>{b(Date.now()),o((e=>(e&&(r.current=aq(e),u(!0)),e)))}),[]),N=n.exports.useCallback((()=>{b(Date.now()),l((e=>(e&&(c.current=aq(e),u(!0)),e)))}),[]),A=n.exports.useCallback((()=>{N(),C()}),[N,C]),x=n.exports.useRef(!1),P=yq((async()=>{const e=[];if(!x.current){x.current=!0;try{const t=Date.now()-(null!=w?w:0);if(b(void 0),r.current&&a){const o=a.getTracks().some((e=>"video"===e.kind));let n,i;s&&c.current?(n=o?"screen-video":"screen-audio",i="Record screen"):o?(i="Record video",n="video"):(i="Record audio",n="audio"),e.push(tq(a,r.current,n,t).then((e=>({file:e,analyticsUploadSource:i}))).finally((()=>I())))}c.current&&s&&e.push(tq(s,c.current,"screen",t).then((e=>({file:e,analyticsUploadSource:"Record screen"}))).finally((()=>k())));const o=(await Promise.all(e)).filter((({file:e})=>e)).map((({file:e,analyticsUploadSource:t})=>({file:e,analyticsUploadSource:t})));u(!1);const n=o.map((({file:e})=>e)),i=o.map((({analyticsUploadSource:e})=>e)),l=!!n.find((e=>"screen-video"===e.recordType));return LG(n,{eventHandlers:{handlePreemptiveFinish:T,handleFinish:dV},uploadOptions:{addAtSeeker:!0,analyticsUploadSource:i[0],analyticsUploadSources:i,uploadSourceComponent:"RecordContext",multiRowUploadForRecording:!0,recordScreenAndCameraUpload:l}})}finally{x.current=!1}}})),R=n.exports.useCallback((async()=>{const e=await async function(){const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"default"!==e.deviceId)).filter((e=>""!==e.deviceId));return{videoInputDevices:e.filter((e=>"videoinput"===e.kind)),audioInputDevices:e.filter((e=>"audioinput"===e.kind))}}();return h(e.videoInputDevices),E(e.audioInputDevices),e}),[]);return n.exports.useEffect((()=>{!g&&p.length>0&&f(p[0])}),[g,p]),n.exports.useEffect((()=>{!_&&y.length>0&&v(y[0])}),[_,y]),n.exports.useEffect((()=>{s&&d&&(s.getVideoTracks()[0].onended=P)}),[s,d,P]),n.exports.useEffect((()=>{_q.some((e=>S.includes(e)))||d||(I(),k())}),[k,I,S,d]),n.exports.useEffect((()=>()=>{k(),I()}),[k,I]),m.createElement(vq.Provider,{value:{videoAudioStream:a,isRecording:d,micDevices:y,selectedMic:_,setSelectedMic:v,cameraDevices:p,selectedCamera:g,setSelectedCamera:f,setVideoAudioStream:o,setScreenStream:l,pollDevices:R,saveRecordings:P,recordScreen:N,recordVideo:C,record:A,startTime:w}},e)};function bq(){const e=n.exports.useContext(vq);if(!e)throw new Error("useRecord must be used within a RecordProvider");return n.exports.useEffect((()=>{e.pollDevices()}),[]),e}function Sq(e,t,a){var o,n;const{dispatch:r}=io(),i=e[t.id],s=e[a];if(!i||!s)return;const l=null!=(o=null==i?void 0:i.duration)?o:0,c=null!=(n=null==s?void 0:s.duration)?n:0,d=Math.min(l,c);r(ds(i,{endTime:d,isTrimmed:!0})),r(ds(s,{endTime:d,isTrimmed:!0}))}const Tq="Header-module_disabled_LhZ0P",Iq="Header-module_logo_xESyj",kq="Header-module_headerContainer_RrHY4",Cq="Header-module_impersonating_JikJn",Nq="Header-module_headerLeft_EG9z0",Aq="Header-module_headerRight_7wFRV",xq="Header-module_headerButtonContainer_zZNYX",Pq="Header-module_commentsLabel_yp6vG",Rq="Header-module_selectedCommentsLabel_ChtfY",Oq="Header-module_headerButtonIcon_o7HhI",Dq="Header-module_accountButton_0kzGN",Lq="Header-module_headerLogoContainer_ph4oL",Uq="Header-module_signInButton_iafs6",Mq="Header-module_breadcrumbContainer_fsVUd",Fq="Header-module_breadcrumb_Ec0pU",Bq="Header-module_upgradeLabel_g6s9W",Wq="Header-module_presenceIconContainer_BWWNU",Vq="Header-module_presenceIconWrapper_W2fBp",jq="Header-module_presenceIcon_heHaB",Hq="Header-module_presenceHoverText_fN9cH",Gq="Header-module_plusIcon_uWwzN",$q="Header-module_projectName_nFOnW",Kq="Header-module_disabledCommentsLabel_AcQZ5",Yq="Header-module_commentsDisabledTooltip_ymfq2",zq="Header-module_settingsButtonIcon_GD7-G",qq="Header-module_impersonationWarning_n-t3Y",Jq="Header-module_headerUploadButtonContainer_5jmhN",Xq="Header-module_headerButtonTooltip_8qmPx",Qq="Header-module_headerSubtitlesButtonContainer_Qd8we",Zq="Header-module_headerSubtitlesTooltip_-2O5k",eJ="Header-module_headerSettingsButtonContainer_zVBTs",tJ="Header-module_headerSettingsTooltip_1ZgFQ",aJ="Header-module_headerCommentsButtonContainer_lSiRM",oJ="Header-module_headerCommentsTooltip_OLlwb",nJ="Header-module_commentsIcon_64rNH",rJ=e=>{var t;const{currentUser:a}=e;return!!(null==(t=null==a?void 0:a.user)?void 0:t._id)},iJ=r((e=>{var t;return null==(t=e.currentUser)?void 0:t.user}),(e=>{var t;return(null==(t=e.email)?void 0:t.endsWith("kapwing.com"))||(null==e?void 0:e.isTeamsEarlyAccess)})),sJ="OnlineStatus-module_onlineStatusContainer_gjuCw",lJ="OnlineStatus-module_containerUserNoLicense_g9v3x";const cJ=()=>{const e=(so(5e3),window.navigator.onLine),t=(so(15e3),cn(wn)||!e),{timeOfLastSyncSuccess:a}=cn((e=>({timeOfLastSyncSuccess:e.studioLocal.lastSyncedUserFacing})),i.exports.shallowEqual),o=Ru(),n=cn(rJ),r=i.exports.useDispatch();let s="";if(a){s=`Last ${t?"saved":"edited"} ${yt.duration(-yt().diff(yt(a))).humanize(!0)}. `}return n&&s?m.createElement("div",{className:`${sJ} ${o.planTier!==jd.FREE?"":lJ}`,onClick:()=>{r(XS({tabId:qS.Versions,tabContainerId:"controls"}))}},t?m.createElement(m.Fragment,null,m.createElement(Et,{color:"grey",size:14,style:{marginRight:5,marginTop:2}}),s):s):null},dJ=()=>{const{dispatch:e}=io();e(_l(void 0))},uJ=()=>{const{dispatch:e}=io();e(_l(iK.LAYER_CONTROLS))},mJ=()=>{const{currentUser:e,teams:t}=io().state,{allTeams:a}=t,{user:o}=e;return a.find((e=>e.primary&&e.creatorId===o._id))},pJ=async e=>{const{state:t,dispatch:a}=io(),{workspaces:o}=t,{selectedTeamId:n}=t.teams;try{let t=null!=e?e:o.selectedWorkspace;if("shared-with-me"===t){const e=mJ(),r=Qw(o.allWorkspaces,(null==e?void 0:e._id)||n);if(0===r.length){t=(await hb("New Folder",Io.team,null==e?void 0:e._id))._id}else t=r[0]._id;a(Af(t))}}catch(r){console.error(r)}},hJ=async()=>{const{state:e,dispatch:t}=io(),{currentUser:a,currentVideo:o,workspaces:n}=e;try{if(!o.isStudio||!om(a))return void no.push(`/editor/videos/${o._id}`);let e=n.selectedWorkspace;if(om(a)){const t=XY(e);if(!((null==t?void 0:t.creatorId)===a.user._id)){const t=n.allWorkspaces.find((e=>e.creatorId===a.user._id));t&&(e=t._id)}}pJ(e);const{_id:r}=await t(xf(o.projectId,e));o._id&&t(l_("re-edit")),window.Cypress?no.push(`/${r}/studio/editor`):window.open(`/${r}/studio/editor`,"_blank")}catch(r){console.error(r)}},gJ=async(e,t,a)=>{var o;const{state:n,dispatch:r}=io(),{currentVideo:i,workspaces:s}=n,{selectedTeamId:l}=n.teams;try{const n=null!=t?t:s.selectedWorkspace;pJ(n);const c=await r(xf(e?e.projectId:i.projectId,n,null!=a?a:l,`Template of ${null!=(o=(null==e?void 0:e.projectName)||(null==e?void 0:e.name))?o:"Untitled Project"}`,!0));window.open(`/${c._id}/studio/editor`,"_blank")}catch(c){console.error(c)}},fJ="HeaderOverflow-module_headerOverflowContainer_annIJ",yJ="HeaderOverflow-module_headerOverflowIcon_ADqXM",EJ="HeaderOverflow-module_headerOverflowDropdownMenu_K0-rF",_J="HeaderOverflow-module_headerOverflowDropdownItem_j8E2W",vJ=()=>{const{currentUser:e,isBrandKitTemplate:t,video:a}=cn((e=>({currentUser:e.currentUser,isBrandKitTemplate:!!e.studio.isBrandKitTemplate,video:e.currentVideo})),dn),o=G$(au.BRANDKIT),r=om(e),[i,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!1),d=n.exports.useRef(null),u=pO(),p=e=>{d.current&&e.target instanceof Node&&!d.current.contains(e.target)&&s(!1)};n.exports.useEffect((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const h=()=>{r?(fm("Make a brand template within the studio"),gJ(a)):c(!0)};return m.createElement("div",{ref:d,className:fJ},m.createElement(_t,{className:yJ,onClick:()=>s(!i),"data-cy":"header-overflow-icon"}),i&&m.createElement("div",{className:EJ},t?m.createElement("div",{className:_J,onClick:()=>{u((()=>{r?(fm("Start a new brand template within the studio"),window.open("/studio/editor/new-brand-template/","_blank")):c(!0)}),{if:!o,action:ou.BRANDKIT})()}},"Start new Brand Template",!o&&m.createElement(fO,null)):m.createElement("div",{className:_J,onClick:()=>{r?(fm("Start a new project within the studio"),window.open("/studio/editor","_blank")):c(!0)}},"Start a new project"),m.createElement("div",{className:_J,"data-cy":"header-overflow-copy",onClick:()=>{r?(fm("Make a copy within the studio"),hJ()):c(!0)}},"Make a copy"),!t&&m.createElement("div",{className:_J,onClick:()=>{o?h():u(h,{action:ou.BRANDKIT})()}},"Save as Brand Template ",!o&&m.createElement(fO,null))),l?m.createElement(MC,{hideSignIn:()=>{c(!1)}}):null)},wJ=e=>!!e&&"_id"in e,bJ=({videoFetched:e})=>{const t=ed(),a=i.exports.useDispatch(),{currentUser:o,currentFolderId:n,isCollaborating:r,presence:s,presentUserId:l,shouldHidePreview:c,viewOnlyMode:d,isBrandKitTemplate:u,folderName:p}=cn((e=>({allFolders:e.workspaces.allWorkspaces,currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,duration:e.studio.duration,showCanvas:e.studio.showCanvas,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,shouldHidePreview:Kn(e),viewOnlyMode:Yn(e),videoFolderId:e.studio.workspaceId,isBrandKitTemplate:e.studio.isBrandKitTemplate,folderName:lb(e.workspaces.selectedWorkspace)})),i.exports.shallowEqual),{showUpgrades:h}=Ru(),{user:g}=o||{},f=Xg(o),{isRecording:y}=bq();return m.createElement("div",{className:kq+(f?` ${Cq}`:""),onClick:()=>a(Is(null))},m.createElement(gD,{className:qq}),m.createElement("div",{className:Nq},m.createElement(AJ,{currentFolderId:n}),m.createElement("div",{className:Mq,"data-cy":"breadcrumbs"},wJ(g)?m.createElement(_e,{to:u?"/brandkit":`/folder/${n}`,onClick:e=>{e.stopPropagation()},className:Fq},u?"Brand Templates":p):m.createElement(_e,{to:"/",onClick:e=>{e.stopPropagation()},className:Fq},"Kapwing"),m.createElement(vt,null)),m.createElement("span",{className:$q},m.createElement(nz,{disabled:d}),m.createElement(vJ,null)),m.createElement(NJ,{disabled:d}),m.createElement(kJ,{disabled:d}),h&&m.createElement(_O,{className:Bq,action:ou.STUDIO}),m.createElement(FO,{className:Bq,entryPoint:tg.WORKSPACE_HEADER})),m.createElement("div",{className:Aq},m.createElement(cJ,null),r&&s&&m.createElement(SJ,{presence:s,presentUserId:l}),m.createElement(TJ,{isMobile:t,disabled:d}),m.createElement(IJ,{disabled:d}),m.createElement(rK,null),m.createElement(Qz,{videoFetched:e,disabled:c||y,shrinkCreateButton:t}),m.createElement(CJ,{profile:g})))},SJ=({presence:e,presentUserId:t})=>{const a=[],o=ed(),[r,i]=n.exports.useState(3);n.exports.useEffect((function(){i(o?2:3)}),[e,o]),Object.keys(e).forEach((t=>{rf(e[t].heartbeat)&&a.push(t)}));const s=t=>e[t].profileImg?e[t].profileImg:function(e,t){let a;const o=document.createElement("canvas"),n=e;o.width=n,o.height=n;const r=o.getContext("2d");if(r){r.fillStyle="#78909C",r.fillRect(0,0,n,n),r.font=`normal ${n/2}px sans-serif`,r.textAlign="center",r.textBaseline="middle",r.fillStyle="white";const e=null==t?void 0:t.split(" ")[0][0];r.fillText(e,n/2,n/2),a=o.toDataURL("image/png")}return a}(20,e[t].name);return m.createElement("div",{className:Wq},a.map(((a,o)=>{return o<r?m.createElement("div",{className:Vq,key:a},m.createElement("img",{src:s(a),alt:"User icon",className:jq,style:(n=a,{border:`2px solid ${e[n].color}`})}),m.createElement("span",{className:Hq},a===t?"You":e[a].name)):null;var n})),a.length>r&&m.createElement("div",{className:Vq},m.createElement(wt,{className:Gq}),m.createElement("span",{className:Hq},"+ ",a.length-r," more")))},TJ=({isMobile:e,disabled:t})=>{const a=cn((e=>e.comments.commentsOpen)),o=i.exports.useDispatch(),[r,s]=n.exports.useState(!1),l=n.exports.useRef(null),c=document.querySelector(".app-container");return m.createElement(m.Fragment,null,m.createElement("div",{className:`${a?Rq:Pq} ${t?Kq:""}\n        ${aJ} `,onClick:t?void 0:()=>{e&&(a?dJ():uJ()),o(pE(!a))},onMouseEnter:()=>t&&s(!0),onMouseLeave:()=>t&&s(!1),ref:l,"data-cy":"header-comments-button"},m.createElement(bt,{className:nJ}),m.createElement("span",{className:oJ},"Comments")),r&&c&&ye.createPortal(m.createElement("div",{className:Yq,style:(()=>{var e;const t=null==(e=l.current)?void 0:e.getBoundingClientRect();return{width:250,left:t?t.left+(t.width-250)/2:1e3}})()},YY),c))},IJ=({disabled:e=!1})=>m.createElement("div",{className:`${xq}\n      ${eJ}\n      ${e?Tq:""}`,onClick:t=>{e||(Ml("/studio/editor/settings"),t.stopPropagation())},"data-cy":"header-settings-button"},m.createElement(St,{className:zq}),m.createElement("span",{className:tJ},"Settings")),kJ=({disabled:e})=>{const t=i.exports.useDispatch(),a=ed();return m.createElement("div",{className:`${xq}\n      ${Qq}\n      ${e?Tq:""}`,onClick:o=>{e||(fm("Start Editing Subtitles"),t(Ii(!0)),t(XS({tabContainerId:"media-sidebar",tabId:"Subtitles"})),a&&t(_l(iK.MEDIA_CONTROLS)),o.stopPropagation())},"data-cy":"header-subtitler-button"},m.createElement(Tt,{className:Oq}),m.createElement("span",{className:Zq},"Add Subtitles"))},CJ=e=>{const{profile:t}=e,[a,o]=n.exports.useState(!1);return wJ(t)?m.createElement("div",{className:Dq,onClick:e=>{null==no||no.push({pathname:"/home",state:{openModal:vk.account}}),e.stopPropagation()},"data-cy":"account-nav-button"},m.createElement(jO,{absoluteWidth:30,absoluteHeight:30})):m.createElement(m.Fragment,null,m.createElement("div",{className:`${xq} ${Uq}`,onClick:()=>{o(!0)},"data-cy":"signin-nav-button"},"Sign In"),a&&m.createElement(MC,{hideSignIn:()=>{o(!1)},onSuccess:ZY}))},NJ=({disabled:e})=>m.createElement("div",{className:`${xq}\n      ${Jq}\n      ${e?Tq:""}`,onClick:t=>{e||(Ml("/studio/editor/overlay/upload"),t.stopPropagation())},"data-cy":"header-upload-button"},m.createElement(It,{className:Oq}),m.createElement("span",{className:Xq},"Upload")),AJ=({currentFolderId:e})=>{let t="/";return e&&(t=`/folder/${e}`),m.createElement("div",{className:Lq,onClick:e=>{null==no||no.push(t),e.stopPropagation()}},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",className:Iq,alt:"Kapwing Logo","data-cy":"studio-header-logo"}))},xJ="FinalVideoHeader-module_wrapper_yD-7a",PJ="FinalVideoHeader-module_brand_-WaEu",RJ="FinalVideoHeader-module_kapwing_mJmoE",OJ="FinalVideoHeader-module_displayedProjectName_2GeX-",DJ="FinalVideoHeader-module_showBorder_77V7B",LJ="FinalVideoHeader-module_textarea_Woemx",UJ="FinalVideoHeader-module_projectName_IoVI1",MJ=({projectName:e,updateProjectName:t})=>{const a=cn((e=>e.currentUser)),o=cn((e=>e.currentVideo)),{user:r}=a,[i,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!1),[d,u]=n.exports.useState(e);n.exports.useEffect((()=>{u(e)}),[e]);const p=e=>{const t=e.target.value;e.target.value="",e.target.value=t},h=()=>{d&&(t(d),s(!1),c(!1))},g=e=>{13===e.keyCode&&!1===e.shiftKey&&(e.preventDefault(),h())},f=()=>{h()},y=e=>{const t=e.target.value;u(t),s(!0)};return m.createElement("div",{className:xJ},m.createElement("div",{className:PJ},m.createElement(AJ,null),m.createElement(_e,{className:RJ,to:"/"},"KAPWING")),m.createElement("div",{className:UJ},(()=>{var e;if(!om(a)||!(null==(e=o.userPermissions)?void 0:e.canWrite))return m.createElement("div",{className:OJ,"data-cy":"displayed-project-name"},d);const t=i?`${LJ} ${DJ}`:`${LJ}`,n=l?`${OJ} ${DJ}`:`${OJ}`;return i?m.createElement("textarea",{className:t,value:d,onChange:y,onFocus:p,onBlur:f,onKeyDown:g,wrap:"off",autoFocus:!0}):m.createElement("div",{className:n,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onClick:()=>s(!0),"data-cy":"displayed-project-name"},d)})()),m.createElement("div",null,m.createElement(CJ,{profile:r})))};function FJ(){return{type:"RESET_STATE_PRESERVE_USER"}}function BJ(e){return{type:"UPDATE_ENTIRE_STATE",newStateProperties:e}}async function WJ(e){const{bucket_name:t,blob_name:a,url:o}=e;if(o)return o;if(t)return`${uo}/${t}/${a}}`;try{if((await Xm(`${uo}/${co}/${a}}`,{method:"HEAD"})).ok)return`${uo}/${co}/${a}}`}catch($ae){}return`${uo}/kapwing/${a}}`}const VJ="VideoPrivacyOptions-module_container_cbXry",jJ="VideoPrivacyOptions-module_inVideoContainer_LoSh3",HJ="VideoPrivacyOptions-module_currentPrivacy_VJSp4",GJ="VideoPrivacyOptions-module_changePrivacy_Khz-X",$J="VideoPrivacyOptions-module_privacyIcon_IVDeO";class KJ extends n.exports.Component{constructor(e){super(e),t(this,"changeVideoPrivacy",(()=>{const{changeVideoPrivacy:e,setCurrentVideo:t,currentVideo:a,showError:o}=this.props,{_id:n,privacy:r}=a,i=r===xo.private?xo.public:xo.private;Du({team:Bu()},au.CHANGE_PRIVACY)||!i?e(n,i).then((e=>{t(e)})).catch((e=>{o(e)})):this.setState({showPaywall:!0})})),this.state={showPaywall:!1}}render(){const{currentVideo:e,inVideoContainer:t}=this.props,{_id:a,workspaceId:o}=e,n=Du({team:Bu()},au.CHANGE_PRIVACY),{privacy:r}=e||{};if(!nb(o))return null;const i=Vu(e.fullPath);return m.createElement("div",{className:t?jJ:VJ},this.state.showPaywall&&m.createElement(cO,{action:ou.PRIVACY,onClose:()=>this.setState({showPaywall:!1}),video:e,videoId:a,upgradeTier:Lu(Bu(),{upgradeTiers:[jd.PRO,jd.TEAM]})}),m.createElement("div",{className:HJ},r?m.createElement(kt,{className:$J,color:"white"}):m.createElement(Ct,{className:$J,color:"white"}),`This ${i} is ${r===xo.private?"private":"unlisted"}`,"."),m.createElement("div",{className:GJ,onClick:this.changeVideoPrivacy},`Make ${i} ${r===xo.private?"unlisted":"private"}`,!n&&m.createElement(fO,null)))}}const YJ=i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,allWorkspaces:e.workspaces.allWorkspaces})),(e=>he({changeVideoPrivacy:oN,setCurrentVideo:fS,showError:wh},e)))(KJ);function zJ(e){return{type:"SET_EDITOR_PATH",path:e}}const qJ="LooperHome-module_home_XMs19",JJ="LooperHome-module_homeHowBackgroundWhite_7yMHF",XJ="LooperHome-module_splashText_8ObiG",QJ="LooperHome-module_splashSubtext_C2J5z",ZJ="LooperHome-module_dottedLineContainer_FTRTa",eX="BackButton-module_backButton_ltWHd",tX="BackButton-module_buttonIcon_Y-FC8",aX="BackButton-module_buttonLabel_pI3AF",oX=e=>{const{url:t}=e;return m.createElement("a",{className:eX,href:t},m.createElement("div",{className:tX},m.createElement(Nt,null)),m.createElement("div",{className:aX},"Back"))};class nX extends n.exports.Component{constructor(e){super(e),t(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),t(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),t(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),t(this,"handleFinish",(()=>{this.props.markAsLooped(),this.props.setEditorPath("/editor/loop-video")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:a}=this.state;a&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Loop Video Online — Upload — Kapwing"),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement(yD,null),m.createElement("div",{className:qJ,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave},m.createElement(oX,{url:"/tools/loop"}),m.createElement("div",{className:`${JJ} ${ZJ}`},m.createElement("div",{className:XJ},m.createElement("h1",null,"Loop Video"),m.createElement("h2",{className:QJ},"Upload or paste a link to a video or GIF to get started!"),m.createElement(YN,{destination:"/editor/loop-video",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog})))),m.createElement(HC,null))}}const rX=i.exports.connect(void 0,(e=>he({markAsLooped:d$,setEditorPath:zJ},e)))(nX),iX="StopMotionHome-module_home_ampDM",sX="StopMotionHome-module_homeHowBackgroundWhite_vBIhy",lX="StopMotionHome-module_splashText_gn3Sd",cX="StopMotionHome-module_splashSubtext_E-hMP",dX="StopMotionHome-module_dottedLineContainer_iMjp1";class uX extends n.exports.Component{constructor(e){super(e),t(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),t(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),t(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),t(this,"handleFinish",(()=>{this.props.markAsStopMotion(),this.props.setEditorPath("/editor/stop-motion")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:a}=this.state;a&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Stop Motion Maker — Upload — Kapwing"),m.createElement("meta",{name:"robots",content:"noindex, nofollow"})),m.createElement(yD,null),m.createElement("div",{className:iX,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave},m.createElement(oX,{url:"/tools/stop-motion"}),m.createElement("div",{className:`${sX} ${dX}`},m.createElement("div",{className:lX},m.createElement("h1",null,"Stop Motion"),m.createElement("h2",{className:cX},"Upload or paste a link to a video or GIF to get started!"),m.createElement(YN,{destination:"/editor/stop-motion",helperText:"",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog}),!td()&&m.createElement("div",{className:"stop-motion-link-to-montage-maker"},"Want to create a stop motion from images?",m.createElement("br",null),"Use the ",m.createElement("a",{href:"/tools/make"},"Video Maker")," instead!"))),m.createElement(HC,null)))}}const mX=[{toolsTitle:"Loop Video",toolsDescription:"Loop and repeat video online in just a few clicks. Makes it easy to lengthen a short video.",component:rX,url:"/upload/loop"},{toolsTitle:"Stop Motion Maker",toolsDescription:"Turn any video into a stop motion easily.",component:i.exports.connect(void 0,(e=>he({markAsStopMotion:h$,setEditorPath:zJ},e)))(uX),url:"/upload/stop-motion"}],pX="OptionsContainer-module_wrapper_8vlNC",hX="OptionsContainer-module_mobileCommentsWrapper_cT5hy",gX="OptionsContainer-module_container_f7sEv",fX="OptionsContainer-module_mobileCommentsContainer_KNypL",yX="OptionsContainer-module_metaDataContainer_Tw--1",EX="OptionsContainer-module_metaDataRow_aOAOd",_X="OptionsContainer-module_metaDataLabel_rFGA1",vX="OptionsContainer-module_metaDataDescription_2zhXY",wX="OptionsContainer-module_actionButton_AUJMV",bX="OptionsContainer-module_actionIcon_3woF7",SX="OptionsContainer-module_description_AUQtk",TX="OptionsContainer-module_reportAProblemButton_6ekr-",IX="OptionsContainer-module_upsellBlock_AptWG",kX="VideoContainer-module_videoActionButton_E4ZMo",CX="VideoContainer-module_actionIcon_uYB7L",NX="VideoContainer-module_upsellBlock_btc9R",AX="VideoContainer-module_overlay_x1GzY",xX="VideoContainer-module_overlayBackground_vhcxF",PX="VideoContainer-module_finalVideoContainer_-snrS",RX="VideoContainer-module_finalVideoPreviewContainer_XqKGP",OX="VideoContainer-module_socialDescription_p0WPR",DX="VideoContainer-module_loadingWrapper_qW6py",LX="VideoContainer-module_commentsFinalVideoContainer_-mG8R",UX="VideoContainer-module_topEditButtonContainer_L1S-s",MX="VideoContainer-module_privacyAndSocialWrapper_JSqWY",FX="VideoContainer-module_topEditLeft_rnVLD",BX="VideoContainer-module_topEditRight_tnjnu",WX="VideoContainer-module_commentsMetaDataIconContainer_K1zoz",VX="VideoContainer-module_commentsMetaDataFileSize_E7zW4",jX="VideoContainer-module_commentsMetaDataIcon_hR10J",HX="VideoContainer-module_commentsMetaDataContainer_-Bl-H",GX="VideoContainer-module_commentsContainerWrapper_6KkLk",$X="VideoContainer-module_commentsSharingWrapper_GJ6Fw",KX="VideoContainer-module_videoContainerContent_kYsvH",YX="VideoContainer-module_commentingVideoContainerContent_dyij1",zX="VideoContainer-module_adminSectionWrapper_ikRiy",qX="VideoContainer-module_emailMessageContainer_pfbva",JX="VideoContainer-module_emailMessageDiv_2CVRr";class XX extends n.exports.Component{constructor(){super(...arguments),t(this,"state",{loading:!1,showExportMetaData:!1}),t(this,"setReEditOrigin",(()=>{const{currentVideo:e}=this.props;e._id&&this.props.setOrigin("re-edit")})),t(this,"copyVideo",(async()=>{this.setState({loading:!0}),await hJ(),this.setState({loading:!1})})),t(this,"setShowExportMetaData",(e=>{this.setState({showExportMetaData:e})}))}render(){var e;const{currentVideo:t,commentingView:a,onDownload:o,local_url:n}=this.props,{showExportMetaData:r}=this.state,{creatorId:i}=t,s=!t._id||this.state.loading,l=this.state.loading,c=t.isStudio&&i&&(null==(e=t.userPermissions)?void 0:e.canWrite),d=m.createElement(_e,{className:"`edit-video-menu-link",to:`/${t._id}/studio/editor`,onClick:this.setReEditOrigin},m.createElement("button",{type:"button",className:`${a?kX:wX} ${s?XD.disabled:""}`,"data-cy":"edit-video-button"},a?m.createElement(At,{className:CX}):m.createElement(xt,{className:bX}),"Edit this project"));let u=c?"Copy project and edit":"Edit a copy";a&&(u="Make a Copy");const p=m.createElement("button",{type:"button",className:`${l?XD.disabled:""} edit-video-menu-link ${a?kX:wX}`,disabled:l,"data-cy":"copy-and-edit-button"},m.createElement("div",{className:"edit-video-menu-link",onClick:this.copyVideo},m.createElement(Pt,{className:a?CX:bX}),m.createElement("span",null,u)));if(a){const e=HK(t),a=$K(e);return m.createElement(m.Fragment,null,m.createElement("div",{className:FX},c?d:null,p,m.createElement(ZX,null)),m.createElement("div",{className:BX},e&&a&&m.createElement("div",{className:WX},m.createElement("div",{className:VX},(null==e?void 0:e.fileSize)||""),m.createElement(Ue,{className:jX,onMouseEnter:()=>this.setShowExportMetaData(!0),onMouseLeave:()=>this.setShowExportMetaData(!1)}),r&&m.createElement("div",{className:HX},a.map((({label:e,value:t})=>m.createElement("div",{className:EX,key:e},m.createElement("div",{className:_X},`${e}:`),m.createElement("div",{className:vX},t)))))),m.createElement(QX,{onDownload:o,local_url:n})))}return c?m.createElement(m.Fragment,null,d,p):p}}const QX=({inRightSidebar:e,onDownload:t,local_url:a})=>{const{currentUser:o,currentVideo:r,imageType:s,projectName:l}=cn((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo,imageType:e.studio.imageType,projectName:e.projectName})),i.exports.shallowEqual),[c,d]=n.exports.useState(!1),u=a||k_(r,"fullPath"),p=l&&l.trim().split(" ").join("_");let h;"mp4"===r.convertOption||"mp4"===r.videoType?h="mp4":(h=gV(),"webp"===s&&(h=s));const g=l?`${p}.${h}`:`image.${h}`;return m.createElement(m.Fragment,null,m.createElement("a",{download:!(!r.done&&!r.local_url)&&g,href:u,onClick:e=>{om(o)?t&&t():(e.preventDefault(),d(!0)),function(e){const{paymentPlan:t,teamSubscription:a,currentTeam:o}=sg();fm("Download File",{"Is Signed In":e,"Team ID":o?o._id:"None","Current Plan":pu((null==t?void 0:t.planTier)||"None"),"Monthly/Annual":(null==t?void 0:t.paymentTerm)||"None","Subscription Status":ig(a),"Quantity Legacy Members":Hh(o).length,"Number of Workspace Members":o?o.users.length:0})}(om(o))},"data-cy":"download-final-video-button",className:`${r.done||r.local_url?"":XD.disabled}`},m.createElement("div",{className:`${e?wX:kX}`},m.createElement(Rt,{className:e?bX:CX}),m.createElement("span",null,"Download file"))),c&&m.createElement(MC,{hideSignIn:()=>d(!1),onSuccess:()=>{},customTitle:"Sign in to download this file"}))},ZX=({inRightSidebar:e})=>{const t=i.exports.useDispatch(),{origin:a,editorPath:o}=cn((e=>({origin:e.currentVideo.origin,editorPath:e.currentVideo.editorPath})),i.exports.shallowEqual);return m.createElement(_e,{to:(()=>{if(!a)return o;if(["","edit-in-studio","re-edit"].includes(a))return o;if("video-maker"===a)return"/video-maker";if("memeMaker"===a)return"/meme-maker";const e=(e=>{let t;t="addText"===e?"/tools/add-text":"addImageVideo"===e?"/tools/add-image":`/tools/${(e=>{if(e.length<1)return e;let t=e[0].toLowerCase()+e.slice(1);return t=t.replace("GIF","Gif"),t.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))})(e)}`;const a=mX.find((e=>e.url===t));return(a||!!a)&&t})(a);return e||o})()||"/",onClick:()=>{t(uS()),fm("Start New Project from Final Video")}},m.createElement("div",{className:e?wX:kX,"data-cy":"start-new-project"},m.createElement(Ot,{className:e?bX:CX}),"Start a new project"))},eQ=ie(i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,selectedTeamId:e.teams.selectedTeamId})),(e=>he({setOrigin:l_,setCurrentFolder:Af},e)))(XX));function tQ(e,t){fm("Share Final Video",{type:t})}function aQ(e,t=!1){return(a,o)=>{const{token:n,user:r}=o().currentUser||{},{_id:i}=r||{};return np(`/api/v1/videos/${e}/share`,{body:{token:n,userId:i,write:t}})}}const oQ="Sharing-module_container_5srG3",nQ="Sharing-module_commentViewContainer_E1YFf",rQ="Sharing-module_header_vzZb-",iQ="Sharing-module_copyLinkButton_4kRMS",sQ="Sharing-module_input_eIlfs",lQ="Sharing-module_moreContainer_zdB4V",cQ="Sharing-module_embedButton_3tra-",dQ="Sharing-module_embedButtonIcon_YWWH0",uQ="Sharing-module_socialMediaButtons_VEL7u",mQ="Sharing-module_socialOptionIcon_jsbGH",pQ=e=>{const{showTikTokModal:t,showEmbedModal:a,inCommentView:o}=e,[r,s]=n.exports.useState(!1),l=n.exports.useRef(null),c=i.exports.useDispatch(),d=cn((e=>e.currentVideo)),u=cn((e=>e.projectName)),p=`https://www.kapwing.com/videos/${d._id}`;n.exports.useEffect((()=>{const e=window.location.search,t=new URLSearchParams(e).get("tiktokstatus");t&&c("success"===t?bh("Shared succesfully - Check the TikTok app to finish posting your video"):wh(`Something went wrong. ${t}`))}),[c]);const h=()=>{const{_id:e}=d||{};return e&&tQ(0,"Twitter"),Promise.resolve()},g=()=>{const{_id:e}=d||{};return e&&tQ(0,"Facebook"),Promise.resolve()},f=(e,t=navigator.language)=>{const[a,...o]=e;return void 0===a?e:a.toLocaleUpperCase(t)+o.join("")};return d&&d._id?m.createElement("div",{className:o?nQ:oQ},m.createElement("div",{className:rQ},m.createElement("div",null,"Share this"),m.createElement("div",null,m.createElement("div",{className:iQ,onClick:()=>{s(!0),setTimeout((()=>{s(!1)}),1500);const{_id:e}=d||{};e&&tQ(0,"Link");navigator.clipboard.writeText(p).then((()=>{var e;if(l.current){const t=l.current;null==(e=null==window?void 0:window.getSelection())||e.selectAllChildren(t)}}))}},r?"Copied!":"Copy link"))),m.createElement("div",{className:sQ,ref:l},p),m.createElement("div",{className:lQ},m.createElement("div",{className:uQ},(()=>{const e=f(u);return m.createElement(xe,{beforeOnClick:h,hashtags:["kapwing"],title:`${e} made with Kapwing`,url:p,via:"kapwingapp"},m.createElement(Lt,{className:mQ}))})(),(()=>{const e=f(u);return m.createElement(Ne,{beforeOnClick:g,"data-cy":"facebook-share-button",quote:`${e} made with Kapwing`,url:p},m.createElement(Ut,{className:mQ}))})(),null),m.createElement("div",{className:cQ,onClick:()=>{const{_id:e}=d||{};a(),e&&tQ(0,"Embed")}},m.createElement(Dt,{className:dQ})," Embed"))):null},hQ="ExportNotificationOptions-module_exportNotificationOptionsContainer_KS-0K",gQ="ExportNotificationOptions-module_bellIcon_5Sq-i",fQ="ExportNotificationOptions-module_bellIconRightSidebar_n65KN",yQ="ExportNotificationOptions-module_changeOption_lN9FM",EQ=e=>{const{inRightSidebar:t}=e,a=cn((e=>e.currentUser)),{muteExportCompleteNotificationSound:o}=a.user,n=i.exports.useDispatch();return o?m.createElement("div",{className:hQ},m.createElement(Ft,{className:t?fQ:gQ}),"A notification chime will not play when the export finishes."," ",m.createElement("button",{type:"button",className:yQ,onClick:()=>n(Bg(!1))},"Turn it on")," "):m.createElement("div",{className:hQ},m.createElement(Mt,{className:t?fQ:gQ})," ","A notification chime will play when the export finishes."," ",m.createElement("button",{type:"button",className:yQ,onClick:()=>n(Bg(!0))},"Turn it off")," ")},_Q=["isMuted","isTrimmedOnly"];class vQ extends n.exports.Component{constructor(){super(...arguments),t(this,"resetCreator",(async()=>{var e;const{currentVideo:t}=this.props;if(this.props.resetStatePreserveUser(),this.props.setOrigin("edit-in-studio"),_Q.some((e=>e in t))){if(null==(e=t.sourceVideo)?void 0:e.url){const{url:e}=t.sourceVideo,a=e.split("?",1)[0].split("/").pop(),o=await lV(e,{name:a});cV(o,{selectLayerInCreator:!1,currentVideo:t})}}else if("mp3"===t.convertOption)(async(e={})=>{const{asset:t,cmlFile:a}=await KC(e._id);LN(t,a);const{dispatch:o}=io();o(QE("400:400")),o({type:"SHOW_STUDIO_CANVAS"}),$l()})(t);else if(t.fullPath){const{asset:e,cmlFile:a}=await KC(t._id);LN(e,a);const{blob_name:o}=e,n=await WJ(e),r=await lV(n,{name:o,asset_id:e._id});a&&(r.cmlFileId=a.id),cV(r)}})),t(this,"resetProject",(()=>{const{resetStudio:e}=this.props;e(),fm("Start New Project from Final Video")})),t(this,"renderBackToWorkspace",(()=>{const{currentUser:e}=this.props;return m.createElement(_e,{to:"/",onClick:this.resetProject},m.createElement("div",{className:wX},m.createElement(Bt,{className:bX}),m.createElement("span",null,om(e)?"Return to Workspace":"Return to Kapwing")))})),t(this,"renderDescription",(()=>{const{showReportIssueModal:e}=this.props,t=Du({team:this.props.currentTeam},au.REPORT_ISSUE);return m.createElement("div",{className:SX},"Tag ",m.createElement("strong",null,"#kapwing")," so we can find you on social media!"," ",t&&m.createElement(m.Fragment,null,"Any issues?"," ",m.createElement("button",{type:"button",className:TX,onClick:()=>e()},"Report a problem")," ","and let us know."))}))}renderOpenInStudio(){return m.createElement(_e,{to:"/studio/editor",onClick:this.resetCreator},m.createElement("button",{type:"button",className:wX},m.createElement(Wt,{className:bX}),"Open in Studio"))}renderMetaData(){const e=HK(this.props.currentVideo),t=$K(e);return t?m.createElement("div",{className:yX},t.map((({label:e,value:t},a)=>m.createElement("div",{className:EX,key:a},m.createElement("div",{className:_X},`${e}:`),m.createElement("div",{className:vX},t))))):null}render(){const{currentUser:e,currentVideo:t,showEmbedModal:a,showTikTokModal:o,local_url:n,mobileCommentsView:r}=this.props;let i=!1;return E(t)||t.isCreator&&t.isStudio||(i=!0),m.createElement("div",{className:r?hX:pX,"data-cy":"options-container"},m.createElement("div",{className:r?fX:gX},m.createElement("div",{className:IX},m.createElement(Y$,null)),m.createElement(Z$,{className:IX,entryPoint:tg.WORKSPACE_PAST_DUE_BANNER}),m.createElement(pQ,{showEmbedModal:a,showTikTokModal:o}),m.createElement(eQ,{local_url:n}),m.createElement(QX,{onDownload:this.props.onDownload,local_url:this.props.local_url,inRightSidebar:!0}),m.createElement("div",null,m.createElement(YJ,null)),i?this.renderOpenInStudio():null,m.createElement(ZX,{inRightSidebar:!0}),this.renderBackToWorkspace(),m.createElement(EQ,{inRightSidebar:!0}),this.renderDescription(),this.renderMetaData(),im(e)?m.createElement(UB,null):null))}}const wQ=ie(i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName,imageType:e.studio.imageType,currentTeam:Bu(e)})),(e=>he({setOrigin:l_,resetStatePreserveUser:FJ,resetStudio:uS},e)))(vQ));function bQ(e=!0){const{hostname:t}=window.location;return function(e,t=!0){let a;if(e.endsWith("kapwing.com"))a="kapwi.ng";else if("localhost"===e)a=t?"localhost:5000":"dev.kapwi.ng";else if(e.endsWith("kapwing-dev.com")){const t=e.split(".")[0];a=`${"www"===t?"dev":t}.kapwi.ng`}else e.startsWith("kapwing-dev")&&e.endsWith("herokuapp.com")&&(a=e);if(!a)throw new Error("Could not map current host to a short host");return a}(t,e)}function SQ(e,t="c",a=!0){const{protocol:o}=window.location;return`${o}//${bQ(a)}/${t}/${e}`}function TQ(e){if(null==e||!e.length)throw new Error("Missing short code for sharing.");const{protocol:t}=window.location;return`${t}//${function(e=!0){let{hostname:t}=window.location;return"localhost"===t&&(t=e?"localhost:5000":"www.kapwing-dev.com"),t}()}/e/${e}`}const IQ="ShareEmbed-module_container_O0ZG3",kQ="ShareEmbed-module_closeContainer_UE6SZ",CQ="ShareEmbed-module_title_PsHo9",NQ="ShareEmbed-module_description_r6vpF",AQ="ShareEmbed-module_contentContainer_6Z0uj",xQ="ShareEmbed-module_copyContainer_S9hDz",PQ="ShareEmbed-module_linkContainer_aD1BY",RQ="ShareEmbed-module_linkText_ueJke",OQ="ShareEmbed-module_copyLink_oNI9z",DQ="ShareEmbed-module_optionsContainer_UdM-V",LQ="ShareEmbed-module_autoplay_PaRRW";class UQ extends n.exports.Component{constructor(e){super(e),t(this,"copyTimeout"),t(this,"getEmbedText",(()=>{const{_id:e,height:t=1,width:a=1}=this.props.currentVideo||{},{autoplay:o}=this.state,n=TQ(e),r=t/a*100;let i=`height: 0; padding-bottom: ${`calc(${r.toFixed(2)}%)`}; position:relative; width: 100%;`;if(r>100){const e=300;i=`height: ${(e*t/a).toFixed(2)}px; width: ${e.toFixed(2)}px; position:relative;`}return`<div style="${i}">${`<iframe allow="autoplay; gyroscope;" allowfullscreen height="100%" referrerpolicy="strict-origin" src="${n}${o?"?autoplay=true":""}" style="border:0; height:100%; left:0; overflow:hidden; position:absolute; top:0; width:100%" title="Embedded content made on Kapwing" width="100%"></iframe>`}</div><p style="font-size: 12px; text-align: right;">Video edited on <a href="https://www.kapwing.com/video-editor">Kapwing</a></p>`})),t(this,"onCopied",(()=>{this.setState({copiedEmbed:!0}),setTimeout((()=>this.setState({copiedEmbed:!1})),3e3)})),t(this,"onClickCopyContent",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),t(this,"renderClose",(()=>m.createElement("div",{className:kQ},m.createElement(Ee,{onClick:this.props.hideOverlay})))),this.state={autoplay:!1,copiedEmbed:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderCopyEmbed(){const{copiedEmbed:e,autoplay:t}=this.state,a=this.getEmbedText();return m.createElement("div",{className:xQ},m.createElement("div",{className:PQ},m.createElement("textarea",{className:RQ,id:"embed-text",onClick:this.onClickCopyContent,value:a,readOnly:!0}),m.createElement("div",{className:DQ},m.createElement(Vt,{className:OQ,"data-clipboard-target":"#embed-text",onSuccess:this.onCopied},e?"Copied!":"Copy"),m.createElement("label",{className:LQ},m.createElement("input",{type:"checkbox",checked:t,onChange:()=>{this.setState({autoplay:!t})}}),"Autoplay video"))))}renderContent(){return m.createElement("div",{className:AQ},this.renderCopyEmbed())}renderDescription(){return m.createElement("div",{className:NQ},"Copy and paste the following code into your website or blog to embed this video.")}render(){return m.createElement("div",{className:IQ},this.renderClose(),m.createElement("div",{className:CQ},"Embed Content"),this.renderDescription(),this.renderContent())}}const MQ=i.exports.connect((e=>({currentVideo:e.currentVideo})))(UQ),FQ="ShareLink-module_container_45cOO",BQ="ShareLink-module_loadingContainer_SEZGJ",WQ="ShareLink-module_loader_2ehy3",VQ="ShareLink-module_closeContainer_6WCvs",jQ="ShareLink-module_title_WPALv",HQ="ShareLink-module_contentContainer_OZc9b",GQ="ShareLink-module_linkContainer_NGdcl",$Q="ShareLink-module_linkText_ifgbp",KQ="ShareLink-module_copyLink_j-lXz";class YQ extends n.exports.Component{constructor(e){super(e),t(this,"copyTimeout"),t(this,"getShortLink",(()=>{const{currentVideo:e,showError:t}=this.props,{code:a}=e||{};try{return SQ(a)}catch(o){return t(o.message),"n/a"}})),t(this,"onCopied",(()=>{this.setState({copiedShortLink:!0}),setTimeout((()=>this.setState({copiedShortLink:!1})),3e3)})),t(this,"onClickLink",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),t(this,"renderClose",(()=>m.createElement("div",{className:VQ},m.createElement(Ee,{onClick:this.props.hideOverlay})))),this.state={copiedShortLink:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderShortLink(){const{copiedShortLink:e}=this.state;return m.createElement("div",null,m.createElement("div",{className:GQ},m.createElement("input",{className:$Q,id:"short-link",onClick:this.onClickLink,readOnly:!0,value:this.getShortLink()}),m.createElement(Vt,{className:KQ,"data-clipboard-target":"#short-link",onSuccess:this.onCopied},e?"Copied":"Copy")))}renderContent(){return m.createElement("div",{className:HQ},this.renderShortLink())}render(){const{code:e}=this.props.currentVideo||{};return null==e?m.createElement("div",{className:BQ},this.renderClose(),m.createElement("div",{className:WQ},m.createElement(bk,null))):m.createElement("div",{className:FQ},this.renderClose(),m.createElement("div",{className:jQ},"Share a link"),this.renderContent())}}const zQ=i.exports.connect((e=>({currentVideo:e.currentVideo})),(e=>he({showError:wh},e)))(YQ),qQ="VideoPlayer-module_videoPlayerContainer_-xB76",JQ="VideoPlayer-module_videoPlayerLandscape_tQRnz",XQ="VideoPlayer-module_videoPlayerPortrait_LNLpK",QQ="VideoPlayer-module_videoPlayerImage_HfG6k",ZQ=({autoPlay:e=!0,currentVideo:t,local_url:a,loop:o=!1,maxHeight:r,maxWidth:s,minHeight:l,muted:c=!1,showControls:d=!0,setCurrentVideoRef:u})=>{const{isProjectFetched:p}=cn((e=>({isProjectFetched:e.studioLocal.isProjectFetched,currentUser:e.currentUser})),i.exports.shallowEqual),[h,g]=n.exports.useState(!0),[f,y]=n.exports.useState(!1),E=n.exports.useRef(null),[_,v]=n.exports.useState(!1),w=n.exports.useRef(""),b=jt(),S={};r&&(S.maxHeight=600,S.height="100%"),s&&(S.maxWidth=600,S.width="100%");const T=a?t.videoType:Vu(t.fullPath);n.exports.useEffect((()=>{E.current&&(null==u||u(E))}),[f,u]);return n.exports.useEffect((()=>{if(t._id===b.id){if(w.current.startsWith("blob:"))return;w.current=k_(t,"fullPath"),g(!1)}}),[t,p,b.id]),h?m.createElement(bk,{text:"Getting url...",textStyles:{color:"#eee",fontWeight:600}}):m.createElement("div",{className:qQ},"image"===T||"gif"===T||t.isImage?(()=>{const e={};return l&&(e.minHeight=l),m.createElement("img",{alt:"Final",src:a||k_(t,"fullPath"),style:e,className:QQ,"data-cy":"final-image",loading:"lazy"})})():m.createElement("video",{id:"final-video","data-cy":"final-video",onLoadedMetadata:()=>{if(!E.current)return;if(!("videoWidth"in E.current))return;const{videoWidth:e,videoHeight:t}=E.current;t>e&&v(!0)},ref:e=>{E.current=e,y(!0)},autoPlay:e,className:(()=>{let e="";return e+=_?` ${XQ}`:` ${JQ}`,e})(),controls:d,loop:o,muted:c,playsInline:!0,preload:"auto",src:w.current,style:S,controlsList:"nodownload"}))},eZ="VideoProgress-module_proBadge_qakM6",tZ="VideoProgress-module_videoProgressWrapper_4WpNs",aZ="VideoProgress-module_videoProgressContainer_2sVh-",oZ="VideoProgress-module_videoProgressBg_1HUcb",nZ="VideoProgress-module_videoBgThumbnail_QotEq",rZ="VideoProgress-module_progressOverlay_M1ceQ",iZ="VideoProgress-module_topProcessingText_DmGha",sZ="VideoProgress-module_bottomProcessingText_-Pxhc",lZ="VideoProgress-module_processingTextLine_pfrZA",cZ="VideoProgress-module_processingLink_7aBM-",dZ="VideoProgress-module_processingTextHeader_W0LFH",uZ="VideoProgress-module_progressContainer_N-Mj3",mZ="VideoProgress-module_progressPercentage_f9MN5",pZ="VideoProgress-module_progressBarWrapper_yMpGY",hZ="VideoProgress-module_checkmark_fhTPm",gZ="VideoProgress-module_progressBar_tuAUp",fZ="VideoProgress-module_errorIcon_Eubye",yZ="VideoProgress-module_videoErrorContainer_-sGRX",EZ="VideoProgress-module_videoErrorTop_Bd83q",_Z="VideoProgress-module_videoErrorBottom_ZmGDY",vZ="VideoProgress-module_videoErrorContainerRight_QwZPY",wZ="VideoProgress-module_videoErrorHeader_HDthA",bZ="VideoProgress-module_videoErrorDescription_ynvFj",SZ="VideoProgress-module_errorButtonContainer_m6sy6",TZ="VideoProgress-module_studioBackButton_J-tLG",IZ="VideoProgress-module_reportProblemButton_WAGD-",kZ="VideoProgress-module_progressInfo_77uL2",CZ=e=>{const{progressDict:t}=e,{stageNum:a,numStages:o,stagePercentage:n,stageName:r}=t,i=a/o*100-100/o+n/100*(100/o);return m.createElement("div",{className:pZ},m.createElement(m.Fragment,null,m.createElement("div",{className:mZ,style:{marginLeft:"clamp(2%, 3%, 87%)",width:`clamp(2%, ${i}%, 95%)`,minWidth:220}},m.createElement("div",{className:kZ},m.createElement("div",null,"Stage ",m.createElement("span",null,a||1)," of"," ",m.createElement("span",null,o||1),": ",m.createElement("span",null,r||"")),m.createElement("div",null,Math.min(99,Math.ceil(n)||51),"% complete"))),m.createElement("div",{className:uZ,id:"progress-container"},m.createElement("div",{className:gZ,style:{display:"block",width:`${i}%`,height:"100%"}}))))},NZ=ie((({currentVideo:e,currentUser:t,currentFolderId:a,thumbnailUrl:o,onFirstProgressLoad:r,onFinishedVideo:s,match:l})=>{const c=i.exports.useDispatch(),[d,u]=n.exports.useState(null),[p,h]=n.exports.useState(!1),[g,f]=n.exports.useState(!1),y=n.exports.useRef(e.pendingProcessOnClient),E=n.exports.useRef(null),_=n.exports.useRef(!1),v=Ru(),w=G$(au.FAST_EXPORT),b=["Loading ...","Initializing servers ...","Setting up connection ...","Getting your export ready ...","Reaching server ...","Checking settings ...","mp3"===e.videoType?"Arranging bits ... ":"Lining up pixels ..."];let S=0;const[T,I]=n.exports.useState(b[S]),k=yq((t=>{e._id===l.params.id&&e.clientSideProcessingInProgress&&(t.preventDefault(),t.returnValue="Are you sure you want to leave the page? Your current progress will be lost.")})),C=n.exports.useCallback((()=>{E.current&&clearInterval(E.current),E.current=null}),[]),N=yq((async()=>{var t;if(e._id&&_.current){if(I(b[S%b.length]),S+=1,e.pendingProcessOnClient){console.debug("Checking client side progress!");const a=new Date,o=new Date(e.submittedAt),n=(a.getTime()-o.getTime())/1e3;return e.clientSideProcessingInProgress&&n>180&&(null==(t=e.progressText)?void 0:t.includes("Processing on client"))&&(C(),sz(e._id,"Trim Refresh")),void(e.clientSideProcessingInProgress||(C(),sz(e._id,"Refresh")))}try{const t=await c((a=e._id,()=>ap(`/api/v1/videos/${a}/progress`,{params:{id:a}})));if(P(t))return s(),h(!0),void C();if(t.hasError)return s(),f(!0),void C();if(t.done)return C(),u({stageNum:5,numStages:5,stagePercentage:100,stageName:"Upload"}),void(await x());if(console.debug("Checking progress!"),t.progressDict){d||r();const e=JSON.parse(t.progressDict);u({...e})}}catch(o){console.error(o)}var a}})),A=n.exports.useCallback((()=>{C(),E.current=window.setInterval(N,3500)}),[N,C]);n.exports.useEffect((function(){return _.current=!0,e.local_url||A(),window.addEventListener("beforeunload",k),()=>{C(),window.removeEventListener("beforeunload",k),_.current=!1}}),[A,C,e.local_url,k]),n.exports.useEffect((function(){!e.pendingProcessOnClient&&y.current&&A()}),[A,e.pendingProcessOnClient,d]);const x=async()=>{C();try{await c(xS({id:e._id,preserveId:!0})),s()}catch(t){[403,404,410].includes(t.statusCode)?wh(t.message):A()}},P=t=>{var a;if(!t.hasError||!e.isCreator)return!1;const{explainedErrorParams:o={}}=t;if("download"===t.explainedErrorKind){const{layer_ids:t}=o;if(null==t?void 0:t.length){const o=Cd(null!=(a=e.scenes)?a:[],t);if(o.length)return ZC(o,!1),!0}return!1}return!1};return m.createElement("div",{className:tZ},m.createElement("div",{className:aZ,"data-cy":"video-progress-container"},m.createElement("div",{className:oZ},o&&m.createElement("img",{className:nZ,src:o,alt:"Project thumbnail"})),m.createElement("div",{className:rZ},m.createElement("div",{className:iZ},!om(t)&&m.createElement(m.Fragment,null,m.createElement("div",{className:dZ},"Just a minute..."),m.createElement("div",{className:lZ},"Your content is being exported and will appear here automatically when complete.")),v.planTier===jd.PRO&&m.createElement("div",{className:eZ},"PRO"),w&&m.createElement("div",{className:lZ},m.createElement(Me,{className:hZ}),"Fast processing"),!e.watermark&&m.createElement("div",{className:lZ},m.createElement(Me,{className:hZ}),"Watermark-free")),(()=>{if(e.clientSideProcessingInProgress)return m.createElement(bk,{text:"Hang tight.",secondaryText:"Please don't refresh or close this tab.",textStyles:{color:"#fff"},wrapperStyles:{maxWidth:"250px"}});if(p||g){const t=p?"Looks like there's an invalid layer.":"Oops, an error occurred with your video.",a=p?" There was an issue fully downloading one of your provided media files. Go back to Studio to remove the layer and try re-exporting.":"";return m.createElement("div",{className:yZ},m.createElement("div",{className:EZ},m.createElement("div",null,m.createElement(Gt,{className:fZ})),m.createElement("div",{className:vZ},m.createElement("div",{className:wZ},t),m.createElement("div",{className:bZ},a))),m.createElement("div",{className:_Z},m.createElement("a",{href:"https://www.kapwing.com/help/export-troubleshooting-tips/",target:"_blank",rel:"noopener noreferrer"},m.createElement("div",{className:SZ},m.createElement("div",{className:IZ},"Video Troubleshooting"))),p&&m.createElement("div",{className:SZ},m.createElement(_e,{to:`/editor/videos/${e._id}`},m.createElement("div",{className:TZ},"Back to Studio")))))}return d?m.createElement(CZ,{progressDict:d}):m.createElement(bk,{textStyles:{color:"#fff"},text:T})})(),m.createElement("div",{className:sZ},om(t)&&a&&!e.clientSideProcessingInProgress?m.createElement("div",{className:lZ},"This content will be saved to your"," ",m.createElement(_e,{className:cZ,to:`/folder/${a}`},"Workspace"),"."):m.createElement("div",{className:lZ},"Want to learn more about editing on Kapwing? Check out the Kapwing"," ",m.createElement("a",{className:cZ,href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"blank",rel:"noopener noreferrer"},"Youtube Channel")," ",m.createElement(Ht,null))))))})),AZ="ReportIssueModal-module_prompt_5DH6w",xZ="ReportIssueModal-module_issueSelect_SN3dt",PZ="ReportIssueModal-module_commentArea_Eih4Q",RZ="ReportIssueModal-module_emailInput_ddkLa",OZ=["Can’t download or play video.","Wrong duration or timing issues.","Text size, position or appearance is wrong.","Audio is missing or is out of sync.","Quality or resolution of output isn’t correct.","Image, shape or video position/appearance is wrong.","Can’t upload media.","Issue saving work or progress.","Layers (e.g. image, video, text, subtitles) are missing.","Subscription or billing issue.","Sharing or managing a Team.","Issues with our Brand Kit.","Finding a project.","Other"],DZ=i.exports.connect((e=>({state:e,currentUser:e.currentUser,currentVideo:e.currentVideo})),(e=>he({showError:wh,showSuccess:bh},e)))((({hide:e,currentUser:t,state:a,currentVideo:o,videoId:r,showError:i,showSuccess:s,fromVideoProgress:l=!1,fromWorkspace:c})=>{var d;const{currentFolderId:u}=cn((e=>({currentFolderId:e.workspaces.selectedWorkspace})),dn),{user:m}=t,p=Ru(),h=Pu(),g=lN(a,!1),[f,y]=n.exports.useState(""),[E,_]=n.exports.useState(""),[v,w]=n.exports.useState(""),[b,S]=n.exports.useState(!1),T=null==(d=null==o?void 0:o.build)?void 0:d.canaryCluster,I=f&&((null==m?void 0:m._id)||v.includes("@"))&&!b&&E.length>0;return n.exports.createElement(kx,{unsetCancelModal:b?void 0:e,confirmButtonOptions:{confirmFn:async()=>{var a,d;S(!0);const y={selectedIssue:f,comment:E,email:v,fromVideoProgress:l,pageURL:window.location.href,currentUser:t,snapshotVideo:g,teamId:h._id,currentFolderId:u},_=null!=(a=null==m?void 0:m.email)?a:v;try{fm("Report a Problem",{Email:_,"Signed In":!!m,"Pro User":p.planTier===jd.PRO,"Video ID":r,"Link to Video":`kapwing.com/videos/${r}`,"Video Finished":o.done,"Video Build Error":null==(d=o.build)?void 0:d.error,"Error Reason":f,Details:E,Timestamp:(new Date).toISOString(),"From Video Progress":l,"Run On Canary":T,"Current Plan":pu(h.planTier),"Folder ID":u}),c?await op("/api/v1/videos/reportProblem",{body:y}):await op(`/api/v1/videos/${r}/reportProblem`,{body:y}),s(n.exports.createElement(n.exports.Fragment,null,"This issue has been logged and our team will look into it. We’ll follow up with you at the email address associated with your account.",l&&n.exports.createElement(n.exports.Fragment,null,n.exports.createElement("br",null),"Read our"," ",n.exports.createElement("a",{href:"https://www.kapwing.com/help/video-processing-faq/",target:"_blank",rel:"noopener noreferrer"},"Video Processing FAQ")," ","for troubleshooting advice.")))}catch($ae){i($ae.message)}e()},disabled:!I,confirmText:"Submit"}},n.exports.createElement(kx.Header,null,"Report a Problem"),n.exports.createElement("label",{className:AZ},"What went wrong?",n.exports.createElement("select",{className:xZ,value:f,onChange:e=>y(e.target.value)},n.exports.createElement("option",{value:""},"Select an Issue"),OZ.map((e=>n.exports.createElement("option",{key:e,value:e},e))))),!(null==m?void 0:m._id)&&n.exports.createElement("label",{className:AZ},"Email",n.exports.createElement("input",{className:RZ,type:"email",value:v,onChange:e=>w(e.target.value)})),n.exports.createElement("label",{className:AZ},"Details",n.exports.createElement("textarea",{value:E,onChange:e=>_(e.target.value),placeholder:"Please add as much information (including any steps we can use to reproduce your issue) as possible.",className:PZ})))})),LZ="ShareTikTok-module_container_AJ3Xd",UZ="ShareTikTok-module_closeContainer_3ozxp",MZ="ShareTikTok-module_contentContainer_Lucoi",FZ="ShareTikTok-module_title_EdbbH",BZ="ShareTikTok-module_icon_eH2VA",WZ="ShareTikTok-module_context_sFzTX",VZ="ShareTikTok-module_button_UKE07",jZ=({hideOverlay:e})=>{let t;const a=()=>{const{location:{protocol:e,host:a,pathname:o}={}}=window;t=`${e}//${a}${o}${(null==o?void 0:o.endsWith("/"))?"":"/"}logintiktok`,window.location.href=t};return m.createElement("div",{className:LZ},m.createElement("img",{src:"https://i.imgur.com/Axk8BiL.png",alt:"Kapwing and TikTok"}),m.createElement("div",{className:UZ},m.createElement(Ee,{onClick:e})),m.createElement("div",{className:MZ},m.createElement("div",{className:FZ},"Share to TikTok"),m.createElement("div",{className:WZ},"After clicking the share button you will be redirected to TikTok's website, where you will be prompted to sign in and then authorize Kapwing to share videos for you. Then, you will be able to complete sharing from the TikTok app."),m.createElement("button",{type:"button",className:VZ,onClick:a},m.createElement($t,{className:BZ})," Share to TikTok")))},HZ="ReviewSurvey-module_container_0W--j",GZ="ReviewSurvey-module_choicesContainer_Z22Zl",$Z="ReviewSurvey-module_starHovered_jmUav",KZ="ReviewSurvey-module_starSelected_TbvbQ",YZ="ReviewSurvey-module_starUnselected_E5TwO",zZ="ReviewSurvey-module_starShape_veNRq",qZ="ReviewSurvey-module_closeContainer_ZfBKx",JZ="ReviewSurvey-module_contentContainer_WKGf-",XZ="ReviewSurvey-module_title_kqw4e",QZ="ReviewSurvey-module_icon_zVEqg",ZZ="ReviewSurvey-module_context_Xwz4l",e1="ReviewSurvey-module_reviewContainer_WUbuk",t1="ReviewSurvey-module_button_fWacS",a1="GROWTH_SURVEY_LAST_ANSWERED_TIME_2";var o1=(e=>(e.ReviewSurvey="ReviewSurvey",e.RoughCutSurvey="RoughCutSurvey",e))(o1||{});const n1=["ReviewSurvey","RoughCutSurvey"];class r1 extends n.exports.Component{constructor(e){super(e),t(this,"submitRating",(()=>{const{rating:e}=this.state;Ob.set(a1,(new Date).getTime().toString()),fm("Growth Survey Response",{rating:e}),this.setState({rating:e,submitted:!0})})),t(this,"renderClose",(()=>m.createElement("div",{className:qZ},m.createElement(Ee,{onClick:this.props.hideOverlay})))),this.state={rating:0,submitted:!1},this.preventOverSurvey()}getButtonStyle(e){const{rating:t,submitted:a}=this.state;let o;return o=t>=e?a?KZ:$Z:YZ,o}preventOverSurvey(){const{hideOverlay:e}=this.props,t=Ob.get(a1,{disabled:(new Date).getTime().toString()}),a=(new Date).getTime();t&&a-parseInt(t)<12096e5&&e()}renderStarButtons(){const{submitted:e}=this.state;return m.createElement("div",{className:GZ},[1,2,3,4,5].map((t=>m.createElement("div",{key:t,className:this.getButtonStyle(t),onClick:e?void 0:()=>{this.submitRating()},onMouseEnter:e?void 0:()=>{const e=t;this.setState({rating:e})},onMouseLeave:e?void 0:()=>{this.setState({rating:0})}},m.createElement(Kt,{className:zZ})))))}renderResponse(){const{rating:e,submitted:t}=this.state;return t?e>=4?this.renderReviewAsk():m.createElement("div",{className:e1}," Thanks for your feedback!"):null}renderReviewAsk(){const e=Yt([{name:"Product Hunt",icon:"https://cdn-useast1.kapwing.com/static/product-hunt.jpg",href:"https://www.producthunt.com/posts/kapwing/reviews"},{name:"SourceForge",icon:"https://i.imgur.com/opDzZd7.jpg",href:"https://sourceforge.net/software/product/Kapwing/reviews/new"},{name:"G2",icon:"https://i.imgur.com/rUpH2fb.jpg",href:"https://www.g2.com/products/kapwing/take_survey"},{name:"Google",icon:"https://i.imgur.com/3An97sX.jpg",href:"https://g.page/r/CT6UhDF1z6zYEAg/review"},{name:"Capterra",icon:"https://cdn-useast1.kapwing.com/static/capterra.jpg",href:"https://reviews.capterra.com/new/180041"},{name:"Trustpilot",icon:"https://cdn-useast1.kapwing.com/static/trustpilot.jpg",href:"https://www.trustpilot.com/evaluate/www.kapwing.com"}],3);return m.createElement("div",{className:e1},m.createElement("div",null,"Thanks for your feedback. Would you consider leaving us a review?"),e.map((({href:e,name:t,icon:a})=>m.createElement("a",{className:t1,href:e,target:"_blank",rel:"noopener noreferrer",key:t},m.createElement("img",{src:a,alt:`${t} Logo`}),"Review us on ",t))))}renderQuestion(){return m.createElement(m.Fragment,null,m.createElement("div",{className:ZZ},"Your content has started downloading. Please check your downloads folder for your exported file."),m.createElement("div",{className:ZZ},"We’d love to get your feedback. How would you rate your experience with Kapwing today?"))}render(){return m.createElement("div",{className:HZ},this.renderClose(),m.createElement("div",{className:XZ},m.createElement(zt,{className:QZ})," Your download has started!"),m.createElement("div",{className:JZ},this.renderQuestion(),this.renderStarButtons(),this.renderResponse()))}}const i1=i.exports.connect((e=>({currentVideo:e.currentVideo})))(r1),s1="RoughCutSurvey-module_surveyFooter_FxxhR",l1="RoughCutSurvey-module_unselectedOption_bnWFO",c1="RoughCutSurvey-module_selectedOption_PGiqr",d1="RoughCutSurvey-module_surveyOption_U-tXE",u1="RoughCutSurvey-module_mobileSurveyOption_BMXcO",m1="RoughCutSurvey-module_surveyDescriptor_vMWXu",p1="RoughCutSurvey-module_surveyHeader_eMykx",h1="RoughCutSurvey-module_optionsRow_Ikozr",g1="RoughCutSurvey-module_commentFormContainer_HWNxO",f1="RoughCutSurvey-module_mobileCommentFormContainer_ZrmfJ",y1="RoughCutSurvey-module_commentHeader_2VvIM",E1="RoughCutSurvey-module_commentQuestion_CkE42",_1="RoughCutSurvey-module_commentTextfield_TxT9L",v1="RoughCutSurvey-module_closeContainer_IH3y7",w1="RoughCutSurvey-module_footerCloseContainer_eS93J",b1="RoughCutSurvey-module_headerRow_dBoTn",S1="RoughCutSurvey-module_submitRow_xutyq",T1="RoughCutSurvey-module_noSubmit_mt5IP",I1="RoughCutSurvey-module_submitButton_DTWWj",k1=[0,1,2,3,4,5,6,7,8,9,10];class C1 extends n.exports.Component{constructor(e){super(e),t(this,"cancelPageExitEvent",null),t(this,"closeFooter",(()=>{this.setState({hidden:!0})})),t(this,"onSubmit",(()=>{this.submitAnalyticsEvent(),this.setState({hidden:!0})})),t(this,"scoreClicked",(e=>{var t;this.setState({score:e}),null==(t=this.cancelPageExitEvent)||t.call(this);try{this.cancelPageExitEvent=function(e,t={}){const a=()=>fm(e,t);return Pm.push(a),()=>{const e=Pm.indexOf(a);e>-1&&Pm.splice(e,1)}}("Submit Ending Survey",this.getEventProps())}catch($ae){console.error($ae)}})),t(this,"renderFooter",(()=>{const{score:e,isMobile:t}=this.state;return m.createElement("div",{className:s1},m.createElement("div",{className:w1},m.createElement(Ee,{onClick:this.closeFooter})),m.createElement("div",{className:p1},"How likely is it that you would recommend Kapwing to a friend or colleague?"),m.createElement("div",{className:h1},!t&&m.createElement("div",{className:m1},"Not At All Likely"),k1.map((a=>m.createElement("div",{key:a,className:`${d1} ${t?u1:""}\n              ${a===e?c1:l1}`,onClick:()=>this.scoreClicked(a)},a))),!t&&m.createElement("div",{className:m1},"Extremely Likely")))})),t(this,"renderCommentForm",(()=>{const{isMobile:e}=this.state;return m.createElement("div",{className:AX},m.createElement("div",{className:xX,onClick:this.onSubmit}),m.createElement("div",{className:`${g1} ${e?f1:""}`},m.createElement("div",{className:b1},m.createElement("div",{className:y1},"Thank you for rating your experience!"),m.createElement("div",{className:v1},m.createElement(Ee,{onClick:this.onSubmit}))),m.createElement("div",{className:E1},"We'd love to hear why you picked your rating or what we can do to make your experience better"),m.createElement("textarea",{className:_1,placeholder:"Comments",onChange:e=>this.setState({comment:e.target.value})}),m.createElement("div",{className:S1},m.createElement("div",{className:T1,onClick:this.onSubmit},"No thanks"),m.createElement("button",{className:I1,type:"submit",onClick:this.onSubmit},"Submit"))))}));const a=Rn();this.state={comment:void 0,isMobile:a}}componentDidMount(){Ob.set(a1,(new Date).getTime().toString())}getEventProps(){const{score:e,comment:t}=this.state,a={score:e,comment:t||"<no comment>"};return Im(a,io().state.studio,io().state),{...a,...cg()}}submitAnalyticsEvent(){var e;null==(e=this.cancelPageExitEvent)||e.call(this),this.cancelPageExitEvent=null;try{fm("Submit Ending Survey",this.getEventProps())}catch($ae){console.error($ae)}}render(){return this.state.hidden?null:m.createElement("div",null,this.renderFooter(),void 0!==this.state.score?this.renderCommentForm():null)}}const N1="FollowUsOnTwitter-module_container_L8NU6",A1="FollowUsOnTwitter-module_closeContainer_TvtZD",x1="FollowUsOnTwitter-module_contentContainer_bexQN",P1="FollowUsOnTwitter-module_title_9CFvO",R1="FollowUsOnTwitter-module_icon_e1CLr",O1="FollowUsOnTwitter-module_context_cVGau",D1="FollowUsOnTwitter-module_twitterButton_gMTFv",L1="FollowUsOnTwitter-module_followButton_hUy9P",U1=({hideOverlay:e})=>{n.exports.useEffect((()=>{const e=document.createElement("script");e.src="https://platform.twitter.com/widgets.js",e.charset="utf-8",document.body.appendChild(e)}),[]);return m.createElement("div",{className:N1},m.createElement("div",{className:A1},m.createElement(Ee,{onClick:e})),m.createElement("div",{className:P1},m.createElement(zt,{className:R1})," Your download has started!"),m.createElement("div",{className:x1},m.createElement(m.Fragment,null,m.createElement("div",{className:O1},"Your content has started downloading. Please check your downloads folder for your exported file."),m.createElement("div",{className:O1},"We'd love to connect with you on social media. Follow us to get the latest information on product changes, feature updates, and social media trends."),m.createElement("div",{className:L1},m.createElement("a",{href:"https://twitter.com/KapwingApp?ref_src=twsrc%5Etfw",className:`twitter-follow-button ${D1}`,"data-size":"large","data-show-count":"false"},"Follow @KapwingApp")))))},M1=({currentVideoRef:e,contentExporting:t,userCanPostComment:a,mobileView:o})=>{var r,s,l;const{id:c,commentId:d}=jt(),u=i.exports.useDispatch(),p=n.exports.useRef(!1),h=n.exports.useRef(!1),[g,f]=n.exports.useState(null==(r=null==e?void 0:e.current)?void 0:r.currentTime);n.exports.useEffect((function(){return p.current=!0,()=>{p.current=!1}}),[]),n.exports.useEffect((function(){function t(e){f(this.currentTime)}if(null==e?void 0:e.current){const a=e.current;return a.addEventListener("timeupdate",t),()=>{a.removeEventListener("timeupdate",t)}}return()=>{}}),[e]);const y=async()=>{if(!c||h.current||!a)return;h.current=!0;const e=await zK(c);p.current&&(u(uE(e)),h.current=!1)};n.exports.useEffect((function(){y()}),[c,a]),n.exports.useEffect((function(){u(mE(d))}),[d]);const E=(t,a)=>{var o,n;void 0!==(null==(o=null==e?void 0:e.current)?void 0:o.currentTime)&&void 0!==(null==(n=null==e?void 0:e.current)?void 0:n.duration)&&(e.current.currentTime="number"!=typeof e.current.duration||isNaN(e.current.duration)?t:Math.min(t,e.current.duration),a&&e.current.pause())},_=(null==(s=null==e?void 0:e.current)?void 0:s.duration)||0;return m.createElement(zY,{maxTime:(null==(l=null==e?void 0:e.current)?void 0:l.duration)||0,currentVideoTime:g,contentExporting:t,userCanPostComment:a,mobileView:o,onCommentSelected:(e,t)=>"number"==typeof t&&E(t),onCommentEditStart:e=>"number"==typeof e&&E(e,!0),onCommentPostSuccess:y,seekOnCurrentVideo:e=>{e<=_&&E(e)},location:xs.Export})},F1="ProductHuntAnnouncement-module_container_At2vc",B1="ProductHuntAnnouncement-module_closeContainer_OZxbB",W1="ProductHuntAnnouncement-module_contentContainer_uqChs",V1="ProductHuntAnnouncement-module_title_LGphD",j1="ProductHuntAnnouncement-module_icon_U7p-g",H1="ProductHuntAnnouncement-module_context_HuiYS",G1="ProductHuntAnnouncement-module_button_8CR3A",$1="ProductHuntAnnouncement-module_buttonText_DTYHf",K1="ProductHuntAnnouncement-module_buttonIcon_WFJiZ",Y1="ProductHuntAnnouncement-module_image_E6t-b",z1=({hideOverlay:e})=>m.createElement("div",{className:F1},m.createElement("div",{className:B1},m.createElement(Ee,{onClick:e})),m.createElement("div",{className:V1},m.createElement(zt,{className:j1})," Your download has started!"),m.createElement("div",{className:W1},(()=>{const e="https://www.producthunt.com/posts/magic-subtitles";return m.createElement(m.Fragment,null,m.createElement("div",{className:H1},"By the way, we launched ",m.createElement("b",null,"Magic Subtitles")," on Product Hunt!"),m.createElement("div",{className:H1},m.createElement("a",{href:e,target:"_blank",rel:"noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/RWR-4k-g0zxE-image.webp",alt:"Magic Subtitles Launch",className:Y1}))),m.createElement("div",{className:H1},"If you enjoy using Kapwing, would you please consider supporting us on Product Hunt?"),m.createElement("div",null,m.createElement("a",{href:e,target:"_blank",rel:"noreferrer"},m.createElement("div",{className:G1},m.createElement("span",{className:$1},"Support us on Product Hunt"," "),m.createElement(qt,{className:K1})))))})())),q1={height:630,width:1200};class J1 extends n.exports.Component{constructor(e){super(e),t(this,"_mounted",!1),t(this,"serverProcessedVideoShown",!1),t(this,"sensor",null),t(this,"startedCheckingExportNotif",!1),t(this,"exportCheckCondition"),t(this,"getVideoUserPermissions",(async()=>{const{currentVideo:e={},updateCurrentVideo:t}=this.props,a=e._id;if(a)try{t({userPermissions:await ap("/api/v1/videos/userPermissions",{params:{videoId:a}})})}catch($ae){console.error(`Error getting video permissions: ${$ae.error}`)}})),t(this,"getVideoLockStatus",(async()=>{const{currentVideo:e,showPaywall:t}=this.props,a=null==e?void 0:e._id;if(a)try{if((await ap("/api/v1/videos/locked",{params:{id:a}})).locked){t({options:{action:ou.STORAGE_LIMIT,closeable:!1}})}}catch($ae){console.error(`Error getting video lock status: ${$ae.error}`)}})),t(this,"fetchVideo",(async()=>{const{match:e,fetchVideo:t,history:a,showError:o}=this.props,{numRetries:n}=this.state,r=e.params.id;if(r!==this.state.fetchingVideoId){this.setState({fetchingVideoId:r});try{await t({id:r,preserveId:!0})}catch(i){let e,t=!1;switch(i.status){case 403:e=i.message,t=!0;break;case 404:e="Content couldn't be found.",t=!0;break;case 410:e="Content has been deleted.",t=!0}t||n>=10?(o(e||i),a.push("/")):n<10&&setTimeout((()=>this.setState({numRetries:n+1})),2e3)}finally{this._mounted&&this.setState({fetchingVideoId:void 0})}}})),t(this,"hideOverlay",(()=>{this.setState({overlay:void 0})})),t(this,"showOverlay",(e=>{this.setState({overlay:e})})),t(this,"updateProjectName",(e=>{const{currentUser:t,projectId:a}=this.props;Lf(a,{name:e},t)})),t(this,"hideReportIssueModal",(()=>{this.setState({showReportIssueModal:!1})})),t(this,"showReportIssueModal",(e=>{this.setState({showReportIssueModal:!0,showReportIssueSource:e})})),t(this,"onDownload",(()=>{const{surveyToShow:e}=this.state,{currentUser:t}=this.props,a=Ou({team:Bu()}),o=new Date("12/16/2022");new Date<o?this.showOverlay("product-hunt-announcement"):e===o1.ReviewSurvey?this.showOverlay(o1.ReviewSurvey):!e&&!function(e){if(!om(e))return!1;const{accountType:t}=e.user;return t===Oo.student}(t)&&a.planTier===jd.FREE&&Math.floor(11*Math.random())>=6&&this.showOverlay("follow-us-on-twitter")})),t(this,"showLinkModal",(()=>{this.showOverlay("share-link")})),t(this,"showEmbedModal",(()=>{this.showOverlay("share-embed")})),t(this,"showTikTokModal",(()=>{this.showOverlay("share-tik-tok")})),t(this,"setCurrentVideoRef",(e=>{this.setState({currentVideoRef:e})})),t(this,"checkShowExportEmailMessage",(async()=>{var e,t;const a=null==(e=this.props.currentVideo)?void 0:e._id,o=!!(null==(t=this.props.currentUser.user.optOutEmails)?void 0:t.includes(Cr.Export));if(this.startedCheckingExportNotif||!om(this.props.currentUser)||o||!a)return;this.startedCheckingExportNotif=!0;const n=async e=>{const t=(new Date).getTime();if("stop"===this.exportCheckCondition||t-e>18e4)return;let o="lastCheck"!==this.exportCheckCondition;try{const{jobExists:e,userExporter:t}=await ap(`/api/v1/videos/${a}/emailOnExport`);t&&this.setState({showEmailMessage:!0}),(t||e)&&(o=!1)}catch($ae){console.error("Error while checking show export email message",$ae)}o&&setTimeout((()=>n(e)),5e3)};n((new Date).getTime())}));let a=null;!function(){try{const e=Ob.get(a1,{disabled:(new Date).getTime().toString()});if(!e)return!1;const t=(new Date).getTime(),a=12096e5;return e&&t-parseInt(e)<a}catch($ae){return!1}}()&&e.surveyEligible&&(a=n1[Math.floor(Math.random()*n1.length)]),this.state={numRetries:0,showReportIssueModal:!1,showReportIssueSource:"",surveyToShow:a,currentVideoRef:null,showEmailMessage:!1}}componentDidMount(){const{currentVideo:e={},updateCurrentVideo:t,resetCurrentVideo:a,selectTab:o}=this.props,n=window.innerWidth<=1024;this.setState({commentsMobileSize:n}),e._id!==this.props.match.params.id&&a(),e&&e.local_url&&(this.setState({fetchingVideoId:void 0,local_url:e.local_url}),t({local_url:e.local_url})),!e.userPermissions&&e._id&&this.getVideoUserPermissions(),this.getVideoLockStatus();if((()=>{const{hydratedServerSide:e}=window;return!!e&&(window.hydratedServerSide=!1,!0)})()&&!E(e)||this.fetchVideo(),e._id){const{paymentPlan:t,teamSubscription:a,currentTeam:o}=sg();qh(e,t.planTier,t.paymentTerm,ig(a),Hh(o).length)}cH(e),this._mounted=!0,this.sensor=new qe.ResizeSensor(document.body,(()=>{this.setState({commentsMobileSize:window.innerWidth<=1024})})),this.props.match.params.commentId&&o({tabId:"Comments",tabContainerId:"mobile-options-container"})}componentDidUpdate(e,t){var a,o;const{match:n,currentVideo:r={}}=this.props,{numRetries:i,local_url:s}=this.state,{numRetries:l}=t;if(r._id===n.params.id&&l===i||(this.fetchVideo(),this.getVideoLockStatus()),r._id&&!(null==(a=e.currentVideo)?void 0:a._id)){const{paymentPlan:e,teamSubscription:t,currentTeam:a}=sg();qh(r,e.planTier,e.paymentTerm,ig(t),Hh(a).length)}r.local_url&&r.local_url!==s&&(this.setState({local_url:r.local_url}),this.serverProcessedVideoShown=!1),!r.done&&(null==(o=e.currentVideo)?void 0:o.done)&&(this.serverProcessedVideoShown=!1),this.state.surveyToShow&&!this.props.surveyEligible&&this.setState({surveyToShow:null}),this.state.commentsMobileSize&&!t.commentsMobileSize&&this.props.match.params.commentId&&XS({tabId:"Comments",tabContainerId:"mobile-options-container"})}componentWillUnmount(){var e;const{resetState:t}=this.props;t(),null==(e=this.sensor)||e.detach(),this._mounted=!1}getGifDimensions(){const{adjusted_height:e,adjusted_width:t,height:a,width:o}=this.props.currentVideo||{};let n=a||e||1,r=o||t||1;return r>=n?(n=200*n/r,r=200):(r=200*r/n,n=200),[n,r]}getVideoDimensions(){const{adjusted_height:e,adjusted_width:t,height:a,width:o}=this.props.currentVideo||{},n=a||e||1,r=o||t||1;let i=Math.min(Math.max(1280,n),1920),s=Math.min(Math.max(1280,r),1920);return s>=i?i=s*n/r:s=i*r/n,[i,s]}getHelmetDimensions(e){const{privacy:t}=this.props.currentVideo||{};if(t)return q1;const[a,o]="gif"===e?this.getGifDimensions():this.getVideoDimensions();return{height:a,width:o}}getUrl(){let{hostDomain:e}=this.props;const{currentVideo:t={}}=this.props,{_id:a}=t;return e||(e=document&&document.domain),`https://${e}/videos/${a}`}getImageUrl(){const{currentVideo:e={}}=this.props,{privacy:t}=e;return t?"https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp":k_(e,"image_url")}getVideoUrl(e){const{currentVideo:t}=this.props,{privacy:a,video_url:o}=t||{};if("image"!==e&&!a)return"gif"===e&&o?o:k_(t,"fullPath")}getImageTags({height:e,width:t}){const a=this.getImageUrl();return[m.createElement("meta",{key:"ogImage",property:"og:image",content:a}),m.createElement("meta",{key:"ogImageHeight",property:"og:image:height",content:e}),m.createElement("meta",{key:"ogImageSecureUrl",property:"og:image:secure_url",content:a}),m.createElement("meta",{key:"ogImageUrl",property:"og:image:url",content:a}),m.createElement("meta",{key:"ogImageWidth",property:"og:image:width",content:t}),m.createElement("meta",{key:"twitterImage",property:"twitter:image",content:a})]}getVideoTags({content:e="video/mp4",height:t,outputType:a,width:o}){const n=this.getVideoUrl(a);return n?[m.createElement("meta",{key:"ogType",property:"og:type",content:"video"}),m.createElement("meta",{key:"ogVideo",property:"og:video",content:n}),m.createElement("meta",{key:"ogVideoHeight",property:"og:video:height",content:t}),m.createElement("meta",{key:"ogVideoSecureUrl",property:"og:video:secure_url",content:n}),m.createElement("meta",{key:"ogVideoType",property:"og:video:type",content:e}),m.createElement("meta",{key:"ogVideoWidth",property:"og:video:width",content:o})]:null}showingVideoProgress(e,t){const{convertOption:a,currentVideo:o={},ffmpegReducer:n}=e,{done:r}=o,{fetchingVideoId:i,local_url:s}=t;return!(s||r||this.serverProcessedVideoShown||"FULFILLED"===n.ffmpegStatus&&void 0!==n.outputFileUrl&&"mp4"===a||i)}renderHelmet(){const{currentVideo:e={},facebookAppId:t,projectName:a}=this.props,{fullPath:o}=e,n=Vu(o),{height:r,width:i}=this.getHelmetDimensions(n),s=e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};let l=`${s(n)} — Kapwing`;a&&(l=`${a} — Kapwing`);const c=`${s(n)} made on Kapwing`;return m.createElement(Ce,null,m.createElement("title",null,l),m.createElement("meta",{name:"description",content:c}),m.createElement("meta",{property:"fb:app_id",content:t}),m.createElement("meta",{property:"og:description",content:c}),m.createElement("meta",{property:"og:title",content:a}),m.createElement("meta",{property:"og:url",content:this.getUrl()}),m.createElement("meta",{name:"robots",content:"noindex, nofollow"}),this.getImageTags({height:r,width:i}),this.getVideoTags({height:r,outputType:n,width:i}))}renderFinalVideo(e){const{currentVideo:t={}}=this.props;return m.createElement(ZQ,{autoPlay:!1,setCurrentVideoRef:this.setCurrentVideoRef,currentVideo:t,local_url:e})}renderVideoProgress(){const{currentUser:e,currentVideo:t,currentFolderId:a,thumbnailUrl:o}=this.props;return m.createElement(NZ,{currentUser:e,currentVideo:t||{},currentFolderId:a,hideReportIssueModal:this.hideReportIssueModal,showReportIssueModal:()=>this.showReportIssueModal("progress"),thumbnailUrl:o,onFinishedVideo:()=>{if(!e.user.muteExportCompleteNotificationSound){new Audio("/export-notification-chime.mp3").play()}this.exportCheckCondition="stop"},onFirstProgressLoad:()=>{this.exportCheckCondition="lastCheck"}})}renderBody(){var e,t,a;const{convertOption:o,currentVideo:n={},ffmpegReducer:r,currentUser:i}=this.props,{done:s}=n,{fetchingVideoId:l,local_url:c,currentVideoRef:d,commentsMobileSize:u=!1,showEmailMessage:p}=this.state,h=Ou({team:Bu()}),g=void 0===(null==(e=n.userPermissions)?void 0:e.canWrite);let f,y=!1,E=!1;const _=m.createElement("div",{className:DX},m.createElement(bk,{text:"Loading content...",textStyles:{color:"#eee",fontWeight:600}}));c?(f=this.renderFinalVideo(c),y=!0):s||this.serverProcessedVideoShown?(f=this.renderFinalVideo(c),this.serverProcessedVideoShown=!0,y=!0):"FULFILLED"===r.ffmpegStatus&&void 0!==r.outputFileUrl&&"mp4"===o?(f=this.renderFinalVideo(r.outputFileUrl),y=!0):l?(f=_,E=!0):f=this.renderVideoProgress();let v=null,w=!1;return n._id&&!n.creatorId?v=m.createElement(wQ,{hideOverlay:this.hideOverlay,local_url:c,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:()=>this.showReportIssueModal("options"),showTikTokModal:this.showTikTokModal}):g?v=m.createElement("div",{className:GX},m.createElement("div",{className:gX})):u?v=m.createElement("div",null,m.createElement(iW,{cyPrefix:"mobile-options-container",id:"mobile-options-container",tabTitles:["Actions","Comments"],mobileCommentsView:!0},m.createElement(wQ,{hideOverlay:this.hideOverlay,local_url:c,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:()=>this.showReportIssueModal("options"),showTikTokModal:this.showTikTokModal,mobileCommentsView:!0}),m.createElement(M1,{currentVideoRef:d,contentExporting:!y,userCanPostComment:!!(null==(t=n.userPermissions)?void 0:t.canWrite),mobileView:!0}))):(w=!E,v=m.createElement("div",{className:GX},m.createElement("div",{className:$X},m.createElement(Y$,null),m.createElement(Z$,{className:NX,entryPoint:tg.WORKSPACE_PAST_DUE_BANNER}),m.createElement(pQ,{showEmbedModal:this.showEmbedModal,showTikTokModal:this.showTikTokModal,inCommentView:!0})),m.createElement(M1,{currentVideoRef:d,contentExporting:!y,userCanPostComment:!!(null==(a=n.userPermissions)?void 0:a.canWrite)}),im(i)?m.createElement("div",{className:zX},m.createElement(UB,{commentingView:!0})):null)),m.createElement("div",{className:PX},m.createElement("div",{className:RX},w&&m.createElement("div",{className:UX},m.createElement(eQ,{local_url:c,onDownload:this.onDownload,commentingView:!0})),m.createElement("div",{className:LX},m.createElement("div",{className:w?YX:KX},f)),p&&this.showingVideoProgress(this.props,this.state)&&this.renderEmailMessage(),w&&m.createElement("div",{className:MX},m.createElement("div",null,m.createElement(YJ,{inVideoContainer:!0}),m.createElement(EQ,null)),m.createElement("div",{className:`${SX} ${OX}`},"Tag ",m.createElement("strong",null,"#kapwing")," so we can find you on social media!"," ",h.planTier!==jd.FREE&&m.createElement(m.Fragment,null,"Any issues?"," ",m.createElement("button",{type:"button",className:TX,onClick:()=>this.showReportIssueModal("options")},"Report a problem")," ","and let us know.")))),v)}renderOverlay(){let e;switch(this.state.overlay){case"share-embed":e=m.createElement(MQ,{hideOverlay:this.hideOverlay});break;case"share-link":e=m.createElement(zQ,{hideOverlay:this.hideOverlay});break;case o1.ReviewSurvey:e=m.createElement(i1,{hideOverlay:this.hideOverlay});break;case"share-tik-tok":e=m.createElement(jZ,{hideOverlay:this.hideOverlay});break;case"follow-us-on-twitter":e=m.createElement(U1,{hideOverlay:this.hideOverlay});break;case"product-hunt-announcement":e=m.createElement(z1,{hideOverlay:this.hideOverlay});break;default:return null}return m.createElement("div",{className:AX},m.createElement("div",{className:xX,onClick:this.hideOverlay}),e)}renderEmailMessage(){return m.createElement("div",{className:qX},m.createElement("div",{className:JX},m.createElement("p",null,m.createElement("b",null,"Taking too long? You can close this page.")),m.createElement("p",null,"We will send you an email with a download link when your project is ready.")))}render(){const{match:e,projectName:t}=this.props,{showReportIssueModal:a,showReportIssueSource:o,surveyToShow:n}=this.state,r="progress"===o;return m.createElement("div",null,this.renderHelmet(),m.createElement(MJ,{projectName:t,updateProjectName:this.updateProjectName}),this.renderBody(),m.createElement(HC,null),this.renderOverlay(),n===o1.RoughCutSurvey&&m.createElement(C1,null),a&&m.createElement(DZ,{hide:()=>this.hideReportIssueModal(),videoId:e.params.id,fromVideoProgress:r}))}}const X1=ie(i.exports.connect(((e,t)=>{const{match:a}=t,{id:o}=a.params,n=e.currentVideo._id&&e.currentVideo._id===o,r=e.studio._id&&e.studio._id===o;let i;return n?i=e.currentVideo:r&&(i=e.studio),{currentUser:e.currentUser,currentVideo:i,currentFolderId:e.workspaces.selectedWorkspace,facebookAppId:e.config.FACEBOOK_APP_ID,projectName:e.projectName,editorPath:e.editorPath,projectId:null==i?void 0:i.projectId,ffmpegReducer:e.ffmpegReducer,convertOption:e.convertOption,thumbnailUrl:e.studio.image_url,surveyEligible:r}}),(e=>he({fetchVideo:xS,updateCurrentVideo:yS,showError:wh,showPaywall:cA,resetState:VS,resetCurrentVideo:wS,selectTab:XS},e)))(J1)),Q1="Warning-module_warningMessagePosition_saHmq",Z1="Warning-module_warningMessage_OIg3c",e0="Warning-module_warningSnackbar_ERtRr",t0="Warning-module_warningCloseSnackbar_tWOwp",a0=()=>{const e=i.exports.useDispatch(),{showWarning:t,warningMessage:a}=cn((e=>({showWarning:e.toasts.showWarning,warningMessage:e.toasts.warningMessage})),dn);if(!t)return null;const o=()=>{e({type:"HIDE_WARNING"})};return setTimeout((()=>{t&&o()}),1e4),m.createElement("div",{className:e0},m.createElement("div",{className:Q1},m.createElement("div",{className:Z1},a||"")),m.createElement("div",{className:t0,onClick:o},"×"))},o0="FolderInviteAccept-module_backgroundContainer_xRbzZ",n0="FolderInviteAccept-module_contentContainer_AXnTq",r0="FolderInviteAccept-module_logoContainer_jiUPP",i0="FolderInviteAccept-module_logoHeader_VIaB0",s0="FolderInviteAccept-module_header_EQx81",l0="FolderInviteAccept-module_description_8hLn7",c0="FolderInviteAccept-module_acceptButton_c82Cr",d0="FolderInviteAccept-module_acceptLoading_UBLvn",u0=ie(i.exports.connect((e=>({allWorkspaces:e.workspaces.allWorkspaces,workspaces:e.workspaces,currentUser:e.currentUser,profile:e.currentUser.user})),void 0)((e=>{const t=i.exports.useDispatch(),[a,o]=n.exports.useState(!1),[r,s]=n.exports.useState(""),[l,c]=n.exports.useState(""),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(!0),[g,f]=n.exports.useState(!0),[y,E]=n.exports.useState(!1),{currentUser:_,match:v}=e,{token:w,user:b}=_||{},{_id:S}=b||{},T={token:w,userId:S},I=v.params.id;n.exports.useEffect((()=>{ap(`/api/v1/invites/presentationInfo/${I}`,{params:T}).then((e=>{if(e.invite&&e.invite.used)f(!1),h(!1);else{hf(b,e.workspaceId,e.creatorEmail,"Folder Email Invite");const{creatorName:a,creatorEmail:o,workspaceName:n,workspaceId:r}=e;s(a),c(o),u(n),f(!1),t(oy(r)),t(ay(o))}})).catch((e=>{console.error(e),h(!1),f(!1)}))}));const k=()=>{const{currentUser:a,history:n,match:r}=e,{user:i}=a||{},{email:s}=i||{};if(om(a)){E(!0);const{token:e,user:o}=a||{},{_id:i}=o||{},c={token:e,userId:i};op(`/api/v1/invites/${r.params.id}/accept`,{body:c}).then((e=>{e.workspaceId?(gf(o,e.workspaceId,l,s,"Folder Email Invite"),t(IS(e.workspaceId)),QO(e.workspaceId),E(!1)):n.push("/home")}))}else o(!0)};return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement("div",{className:o0},m.createElement("div",{className:n0},g?m.createElement(bk,null):m.createElement("div",null,m.createElement("div",{className:r0},m.createElement("img",{alt:"Kapwing kitten logo",className:i0,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp"})),p?(()=>{const{currentUser:t}=e;return m.createElement(m.Fragment,null,m.createElement("div",{className:s0},"Join ",d," on Kapwing"),m.createElement("div",{className:l0},"You were invited by"," ",m.createElement("b",null,r," (",l,")"," "),"to join the folder: ",m.createElement("b",null,d),"."),m.createElement("div",{className:l0},om(t)?m.createElement(m.Fragment,null," ","By continuing, you will join the folder with the account"," ",m.createElement("b",null,t.user.email),"."):m.createElement(m.Fragment,null," ","By continuing, you will sign in and become a member of the folder.")),y?m.createElement("div",{className:d0},m.createElement(bk,null)):m.createElement("div",{className:c0,onClick:()=>k()},"Accept Invite"),a?m.createElement(MC,{hideSignIn:()=>{o(!1)},onSuccess:k}):null)})():m.createElement(m.Fragment,null,m.createElement("div",{className:s0},"Invite link is invalid"),m.createElement("div",{className:l0},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),m.createElement(_e,{to:"/"},m.createElement("div",{className:c0},"Go Home")))))),m.createElement(HC,null))}))),m0=ie((({history:e,match:t})=>{const a=i.exports.useDispatch(),o=cn((e=>e.currentUser)),[r,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!0),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(""),[g,f]=n.exports.useState(!0),[y,E]=n.exports.useState(!1);n.exports.useEffect((()=>{const e=t.params.id,{token:n,user:r}=o||{},{_id:i}=r||{};ap(`/api/v1/invites/check-invite-link/${e}`,{params:{token:n,userId:i}}).then((e=>{if(e.canAccess){e.type===Io.team&&function(e){const{teams:t}=io().state,{allTeams:a}=t;return 0!==a.length&&a.some((t=>t._id===e))}(e.teamId)&&a(dg(e.teamId));op("/api/v1/invite-link/accept",{body:{token:n,userId:i,workspaceId:t.params.id}}),QO(e.workspaceId)}else u(e.name),f(!1),h(e.workspaceOwnerEmail),a(ay(e.workspaceOwnerEmail)),a(oy(e.workspaceId)),hf(r,e.workspaceId,e.workspaceOwnerEmail,"Folder Invite Link")})).catch((e=>{console.error(e),c(!1),f(!1)}))}),[]);const _=()=>{const{user:n}=o||{},{email:r}=n||{};if(om(o)){E(!0);const{token:n,user:i}=o||{},{_id:s}=i||{};op("/api/v1/invite-link/accept",{body:{token:n,userId:s,workspaceId:t.params.id}}).then((t=>{t.workspaceId?(gf(i,t.workspaceId,p,r,"Folder Invite Link"),a(IS(t.workspaceId)),QO(t.workspaceId),E(!1)):e.push("/home")}))}else s(!0)};return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement("div",{className:o0},m.createElement("div",{className:n0},g?m.createElement(bk,null):m.createElement("div",null,m.createElement("div",{className:r0},m.createElement("img",{alt:"Kapwing kitten logo",className:i0,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp"})),l?m.createElement(m.Fragment,null,m.createElement("div",{className:s0},"Join ",d," on Kapwing"),m.createElement("div",{className:l0},"By joining this folder, you will be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together!"),m.createElement("div",{className:l0},om(o)?m.createElement(m.Fragment,null," ","By continuing, you will join the folder with the account"," ",m.createElement("b",null,o.user.email),"."):m.createElement(m.Fragment,null," ","By continuing, you will sign in and become a member of the folder.")),y?m.createElement("div",{className:d0},m.createElement(bk,null)):m.createElement("div",{className:c0,onClick:_},"Accept Invite"),r?m.createElement(MC,{hideSignIn:()=>{s(!1)},onSuccess:_}):null):m.createElement(m.Fragment,null,m.createElement("div",{className:s0},"Invite link is invalid"),m.createElement("div",{className:l0},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),m.createElement(_e,{to:"/"},m.createElement("div",{className:c0},"Go Home")))))),m.createElement(HC,null))})),p0="DeleteDialog-module_deleteDialogBackground_KjRMs",h0="DeleteDialog-module_deleteButton_--UFm",g0="DeleteDialog-module_override_8SR2y",f0="DeleteDialog-module_deleteDialogContainer_ErvIj",y0="DeleteDialog-module_dark_WXXot",E0="DeleteDialog-module_header_Ex1yj",_0="DeleteDialog-module_description_l93jw",v0="DeleteDialog-module_deleteCloseContainer_S3Gqz",w0="DeleteDialog-module_buttonsContainer_oBRrT",b0=({hideDelete:e,delete:t,headerTitle:a,description:o,theme:r="light"})=>{const[i,s]=n.exports.useState(!1),l=()=>{s(!0),t(),e()},c=()=>m.createElement(m.Fragment,null,m.createElement("div",{className:p0,onClick:e}),m.createElement("div",{className:`${f0} ${"dark"===r?y0:""}`},m.createElement("div",{className:v0,onClick:e},m.createElement(Ee,null)),m.createElement("div",{className:E0},a),m.createElement("div",{className:_0},o),m.createElement("div",{className:w0},m.createElement(ux,{cancelFn:e,confirmFn:l,confirmText:"Delete",cancelText:"Cancel",loadingMsg:i?"Deleting...":void 0,confirmButtonClassName:`${h0} ${g0}`})))),d=document.querySelector(".app-container");return d?ye.createPortal(c(),d):c()},S0=(e,{plural:t=!1,extraText:a=""}={})=>`Are you sure you want to delete ${t?"these":"this"} ${e}? ${a}`,T0=ie((({hideDelete:e,delete:t,multiple:a=!1})=>{const o={extraText:"You will not be able to edit or download a project after it has been deleted."},n=a?S0("projects",{...o,plural:!0}):S0("project",{...o});return m.createElement(b0,{hideDelete:e,delete:t,headerTitle:a?"Delete Projects":"Delete Project",description:n})})),I0="Snapshots-module_actionButton_lPAz7",k0="Snapshots-module_actionIcon_Yg5zF",C0="Snapshots-module_actions_jRx9w",N0="Snapshots-module_background_LweQL",A0="Snapshots-module_snapshotTile_VEGp6",x0="Snapshots-module_mediaContainer_sLXJV",P0=ie((e=>{const{match:t,snapshot:a,history:o,showDelete:n}=e,r=t.params.id,i=k_(a,"fullPath"),s={maxWidth:300,maxHeight:300},l=a.created_on||"unknown",c=a.content.scenes.length,d=a.content.scenes.reduce(((e,t)=>e+t.layers.length),0),u=1===c?"scene":"scenes",p=1===d?"layer":"layers";return m.createElement("div",{className:A0},m.createElement("div",{className:x0},(()=>{var e,t;if(null==(t=null==(e=a.content)?void 0:e.fullPath)?void 0:t.endsWith("mp4"))return m.createElement("video",{src:i,style:s,controls:!0,playsInline:!0,preload:"auto"});const{image_url:o}=a.content;return o?m.createElement("img",{src:o,style:s,alt:""}):m.createElement(Jt,{size:300})})()),m.createElement("div",{className:C0},m.createElement("div",null,"Snapshot Type: ",a.snapshot_type),m.createElement("div",null,"Version Number: ",a.version_number),m.createElement("div",null,"Exported: ",a.export.toString()),"Created on ",l,m.createElement("div",null,c," ",u," / ",d," ",p),m.createElement("div",{onClick:async()=>{const e=await pN(r,a.id);e.draft?o.push(`/${e._id}/studio/editor`):o.push(`/videos/${e._id}`)}},m.createElement("button",{type:"button",className:I0},m.createElement(Pt,{className:k0}),"Fork")),m.createElement("div",{onClick:async()=>{o.push(`/videos/${r}/snapshots/${a.id}/debug`)}},m.createElement("button",{type:"button",className:I0},m.createElement(Pt,{className:k0}),"View Debug Page")),m.createElement("div",{onClick:()=>n(a.id)},m.createElement("button",{type:"button",className:I0},m.createElement(Pt,{className:k0}),"Delete"))))})),R0=ie((e=>{const{match:t}=e,a=t.params.id,[o,r]=n.exports.useState(!0),[i,s]=n.exports.useState(null),[l,c]=n.exports.useState([]),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(!1),g=e=>{u(e),h(!0)},f=()=>{u(""),h(!1)};return n.exports.useEffect((()=>{uN(a).then((e=>c(e.reverse()))).catch((e=>{console.error(e),s(e)})).finally((()=>r(!1)))}),[]),m.createElement("div",{className:N0},m.createElement("h1",null,"Snapshots"),o&&m.createElement("div",null,"Loading snapshots..."),!o&&0===l.length&&m.createElement("div",null,"No snapshots found"),i&&m.createElement("div",null,"Error: ",JSON.stringify(i)),l.map(((e,t)=>m.createElement(P0,{snapshot:e,showDelete:g,key:t}))),p&&m.createElement(T0,{hideDelete:f,delete:async()=>{await async function(e,t){try{return await tp(`/api/v1/snapshots/${e}/${t}`)}catch($ae){throw console.error($ae),$ae}}(a,d);const e=await uN(a);c(e.reverse()),f()}}))}));function O0(e){return{type:"SET_CONFIG",config:e}}const D0="UploadOld-module_screenReaderOnlyLabel_yWGwW",L0="UploadOld-module_uploadContainer_5kZ40",U0="UploadOld-module_uploadOverlayThemeContainer_hCt50",M0="UploadOld-module_uploadTextContainer_9xrxw",F0="UploadOld-module_uploadText_vRuCX",B0="UploadOld-module_uploadButton_msU0h",W0="UploadOld-module_uploadLabel_qSQhY",V0="UploadOld-module_lightLabel_soNGh",j0="UploadOld-module_uploadLabelHeader_eWbF9",H0="UploadOld-module_uploadLabelSubheader_HgVti",G0="UploadOld-module_uploadIcon_fJBao",$0="UploadOld-module_uploadLabelHeaderMediaLibrary_QYZJz",K0="UploadOld-module_uploadLabelSubheaderMediaLibrary_QTkzi",Y0="UploadOld-module_oneOffUploadButton_rYmLr",z0="UploadOld-module_oneOffUploadIcon_kieQy",q0="UploadOld-module_oneOffUploadButtonContainer_i-izG";class J0 extends n.exports.Component{constructor(){super(...arguments),t(this,"renderUploadText",(()=>{const{audioUpload:e,fontUpload:t}=this.props;return e?"Click to upload audio":t?"Click to upload a .ttf or .otf file":"Click to upload"}))}componentDidUpdate(e){const{files:t,handleMultiFileUpload:a}=this.props;t&&t!==e.files&&a(t)}render(){const{handleMultiFileUpload:e,inputClassNames:t,isMediaLibraryUpload:a,labelClassNames:o,lightTheme:n,multiple:r,oneOffUpload:i,returnAccepts:s,uploadOverlayTheme:l}=this.props,c=[l?U0:L0];let d=B0,u=W0,p=j0,h=H0;t&&(d+=` ${t}`),o&&(u+=` ${o}`),n&&(u+=` ${V0}`),a&&(p+=` ${$0}`,h+=` ${K0}`);const g=`upload-button-input-${y()}`;return i?m.createElement("div",{className:q0},m.createElement("label",{htmlFor:g,className:Y0},m.createElement(Xt,{className:z0})," Upload File",m.createElement("input",{"data-cy":"upload-input","data-testid":"upload-input",id:g,className:d,accept:s(),onChange:t=>{var a,o;return e(null!=(o=null==(a=null==t?void 0:t.target)?void 0:a.files)?o:[])},type:"file",multiple:r}))):m.createElement("div",{className:c.join(" ")},m.createElement("label",{htmlFor:g,className:u},m.createElement("span",{className:D0},"Click to Upload"),m.createElement("input",{"data-cy":"upload-input","data-testid":"upload-input",id:g,className:d,accept:s(),onChange:t=>{var a,o;return e(null!=(o=null==(a=null==t?void 0:t.target)?void 0:a.files)?o:[])},type:"file",multiple:r}),m.createElement("div",{className:M0},m.createElement("div",{className:F0},m.createElement("div",{className:p},this.renderUploadText(),m.createElement(Xt,{className:G0})),m.createElement("div",{className:h},"or, drag and drop a file here")))))}}const X0={home:"PasteLink-module_home_UPQqz",homeHowBackgroundWhite:"PasteLink-module_homeHowBackgroundWhite_5KQ96",largeButton:"PasteLink-module_largeButton_EFzOG",sectionContent:"PasteLink-module_sectionContent_PuecO",sectionHeader:"PasteLink-module_sectionHeader_Suz0S",spacer:"PasteLink-module_spacer_RJx0R",chevron:"PasteLink-module_chevron_zD5mb",splashText:"PasteLink-module_splashText_28pjN",splashSubtext:"PasteLink-module_splashSubtext_4U6pJ",aboutSection:"PasteLink-module_aboutSection_l5Fsp",mobile:"PasteLink-module_mobile_FzSNu",desktop:"PasteLink-module_desktop_2QKES",screenReaderOnlyLabel:"PasteLink-module_screenReaderOnlyLabel_-hb1P",disabled:"PasteLink-module_disabled_HUr0n",noScrollBar:"PasteLink-module_noScrollBar_O-EfO",textOverflowEllipsis:"PasteLink-module_textOverflowEllipsis_308O8",genericButtonBlue:"PasteLink-module_genericButtonBlue_MefRJ",container:"PasteLink-module_container_RIHGR",input:"PasteLink-module_input_fU4WY",lightInput:"PasteLink-module_lightInput_-EZBn",newTimelineInputMobile:"PasteLink-module_newTimelineInputMobile_IF4aK",oneOffContainer:"PasteLink-module_oneOffContainer_1m1sV",newTimelineInputDesktop:"PasteLink-module_newTimelineInputDesktop_qDA14"},Q0=new Set(["https://www.youtube.com/watch?app=desktop","https://www.png","https://www.youtube.com","https://www.youtube.com/","https://www.youtube.com/watch?reload=9","https://www.google.com/url?sa=t",""]),Z0=/^https:\/\/www.kapwing.com\/videos.*/;class e2 extends n.exports.Component{constructor(e){super(e),t(this,"handleChange",(async e=>{var t;const{audiogramUpload:a,disallowVideo:o,handleFinish:n,projectName:r,setProgressText:i,setProjectName:s,stopUpload:l,videoId:c,audiogramUploadStart:d,isMediaLibraryUpload:u,analyticsUploadSource:m}=this.props;let p=e.target.value,h={didError:!1,stage:Ns.PreExtractValidation,pastedUrl:p,uploadSource:m,isMediaLibraryUpload:u};if(!UN(p)){const e=`${p} is not a valid URL`;return void this.logPastedLinkUploadFinish(h,e)}if(p.includes("www.kapwing.com")&&!Z0.test(p)){const e=`${p} is not a valid URL. Try a link to a specific video instead such as https://www.kapwing.com/videos/63503f4177ecc9008b7011a3`;return void this.logPastedLinkUploadFinish(h,e)}if(Q0.has(p)){const e=`${p} is not a valid URL. Try a link to a specific video instead such as https://www.youtube.com/shorts/EwAsLiM3vgs`;return void this.logPastedLinkUploadFinish(h,e)}if(Yk(p)){const e="MPD files are not currently supported. Please try a different file format.";return void this.logPastedLinkUploadFinish({...h,fileType:"mpd"},e)}p.includes("instagram.com/reel/")&&(p=p.replace("/reel/","/p/")),(p.includes("youtu.be/")||p.includes("youtube.com/"))&&(p=this.cleanUpYoutubeUrl(p));let g=p.substring(0,Math.min(50,p.length));p.length>50&&(g+=" ..."),i(`Fetching ${g} ...`),a&&(null==d||d()),r&&""!==r||s("Studio Draft");const f=e=>{h={...h,...e}};try{h.stage=Ns.Extraction;const e=io().state.studioLocal.localProjectId,{asset:r,cmlFile:s,extractInfo:l}=await MN({acceptAudio:!o||a||!1,acceptVideo:!o,additionalAssetParams:{video_id:c},progressCallback:i,analyticsCallback:f,url:p,doDuplicateHandling:!0});h.stage=Ns.LayerCreation;const d=await(async(e,t,a,o,n,r)=>{const i=await oC(n.url,{name:n.url,type:n.mime}),s=null==i?void 0:i.type;if(!s)throw Error("Could not identify media type");const l=(null==o?void 0:o.duplicate)||n.hasUploadedAssetDuplicate?"upload":"pastedLink",c={...iV(),name:oV(),asset_id:a._id,conversion_id:a.conversion_id||n.conversion_id,mime:n.mime,pastedUrl:e,requireConversion:n.requireConversion,conversion_type:n.conversion_type,soundUrl:n.soundUrl,source:l,url:n.url,objectFit:"cover",isMediaLibraryUpload:r,...i,type:s};return Rd(c),o&&(c.cmlFileId=o.id),r||Em(c.type,"paste link"),n.thumbnailUrl&&(c.thumbnailUrl=n.thumbnailUrl),c})(p,0,r,s,l,!!u);d.requireConversion&&d.conversion_type&&d.conversion_type.includes("gif-to")&&(d.type=xr.Video),(null==(t=d.url)?void 0:t.includes("googlevideo.com/video"))&&(d.assetSource="Youtube");const m=io().state.studioLocal.localProjectId;if(m!==e)return;h.stage=Ns.HandleFinish,n(d,{singleFileUpload:!0}),i(""),h.stage=Ns.Finish;const g=!!(null==s?void 0:s.duplicate);fm("Add from Pasted Link",{...h,isDuplicate:g})}catch(y){console.error(y);const e=422===y.status;e||(h.didError=!0),h.errorMessage=y.message;const t=e?"Sorry, we don't support that URL, please try a different one":`Sorry, that pasted URL (${g}) didn't work. ${y.message}`;this.logPastedLinkUploadFinish(h,t),l()}})),t(this,"cleanUpYoutubeUrl",(e=>{let t=e;if((t.includes("/shorts/")||t.includes("/live/"))&&(t=this.convertYtLinkToWatchLink(t)),t.includes("/youtu.be/")){const e=t.split("/")[3];return e?`https://www.youtube.com/watch?v=${e.split("?")[0]}`:t}return t.split("&")[0]})),t(this,"logPastedLinkUploadFinish",((e,t)=>{const{showError:a}=this.props;t&&a(t),fm("Add from Pasted Link",{...e})})),t(this,"renderPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste an audio or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)":"Paste an image or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)"})),t(this,"renderShortPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste audio or video URL":"Paste image or video URL"})),this.state={pastedLink:""}}convertYtLinkToWatchLink(e){return`https://www.youtube.com/watch?v=${(e.split("/shorts/")[1]||e.split("/live/")[1]).split("?")[0]}`}render(){const{pastedLink:e}=this.state,{classNames:t,isTimeline:a,lightTheme:o}=this.props,n=`upload-link-input-${y()}`,r=[X0.input];t&&r.push(t),o&&r.push(X0.lightInput);const i={className:r.join(" "),type:"url",value:e,onChange:this.handleChange},s={...i,placeholder:this.renderPlaceholder(),className:[...r,X0.newTimelineInputDesktop].join(" ")},l={...i,placeholder:this.renderShortPlaceholder(),className:[...r,X0.newTimelineInputMobile].join(" ")};return m.createElement("div",{className:X0.container},a?m.createElement(m.Fragment,null,m.createElement("input",{...s,"data-cy":"pasted-link-input"}),m.createElement("input",{...l,"data-cy":"pasted-link-input"})):m.createElement("label",{htmlFor:n},m.createElement("span",{className:X0.screenReaderOnlyLabel},"Paste a URL"),m.createElement("input",{placeholder:this.renderPlaceholder(),id:n,...i,"data-cy":"pasted-link-input"})))}}const t2=i.exports.connect((e=>({videoId:e.studio._id,projectName:e.projectName,currentUser:e.currentUser})),(e=>he({setProjectName:rS,showError:wh,showWarning:Sh,setSnapInTimelineBasedOnLandingPage:Iy},e)))(e2),a2="FolderUpload-module_uploadDialogBackground_JOaNN",o2="FolderUpload-module_uploadDialogContainer_aedxy",n2="FolderUpload-module_uploadCloseDialog_y2-kO",r2="FolderUpload-module_uploadTypesContainer_nAoHO",i2="FolderUpload-module_header_g7S4H",s2="FolderUpload-module_dragHeader_n6bFw",l2="FolderUpload-module_or_D7tWX",c2="FolderUpload-module_uploading_uFE9x",d2="FolderUpload-module_loadingText_IhzrO",u2="FolderUpload-module_darkText_hkfw5",m2=e=>{const{hideDialog:t,handleMultiFileUpload:a,startUpload:o,stopUpload:r,handlePasteLinkFinish:i,returnAccepts:s,hidePasteLink:l=!1,headerText:c="Upload an image or video"}=e,[d,u]=n.exports.useState(""),p=cn((e=>e.theme.darkMode));return m.createElement(m.Fragment,null,m.createElement("div",{className:a2,onClick:t}),m.createElement("div",{className:o2,"data-cy":"workspace-overlay"},m.createElement("div",{className:n2,onClick:t},m.createElement(Ee,null)),m.createElement("div",{className:i2},c),d?m.createElement("div",{className:c2},m.createElement(bk,{text:d}),m.createElement("div",{className:d2},"Closing this dialog will not interrupt your upload")):m.createElement("div",{className:r2},m.createElement(J0,{returnAccepts:s,multiple:!0,handleMultiFileUpload:a,lightTheme:!0}),!l&&m.createElement(m.Fragment,null,m.createElement("div",{className:l2}," "),m.createElement(t2,{startUpload:o,stopUpload:r,setProgressText:u,handleFinish:i,lightTheme:!p,workspaceUpload:!0})))))};ie(m2);const p2=e=>new Promise((t=>setTimeout((()=>t()),e))),h2=i.exports.connect((e=>({currentUser:e.currentUser,showUploadDialog:e.workspaces.showUploadDialog,showDragUploadDialog:e.workspaces.showDragUploadDialog,privacy:e.privacy,currentFolderId:e.workspaces.selectedWorkspace,workspaceUploadFiles:e.workspaces.workspaceUploadFiles,selectedTeamId:e.teams.selectedTeamId,currentTeam:Bu(e)})),(e=>he({hideUploadDialog:Bf,hideDragUploadDialog:Vf,showError:wh,createWorkspaceUploadVideo:w$,setWorkspaceUploadStatus:jf,addWorkspaceUploadFile:Hf,setWorkspaceFileUploadProgress:Gf,clearWorkspaceUploadFiles:Kf,addWorkspaceUploadProject:$f,updateWorkspaceUploadFile:qf,removeWorkspaceUploadFile:Yf,markUploadAsCreated:Jf,setProjectName:rS},e))),g2=h2((e=>{const{showUploadDialog:t,hideUploadDialog:a,showDragUploadDialog:o,hideDragUploadDialog:r,showError:i,privacy:s,currentUser:l,currentFolderId:c,createWorkspaceUploadVideo:d,setWorkspaceUploadStatus:u,addWorkspaceUploadFile:p,setWorkspaceFileUploadProgress:h,clearWorkspaceUploadFiles:g,addWorkspaceUploadProject:f,workspaceUploadFiles:E,updateWorkspaceUploadFile:_,removeWorkspaceUploadFile:v,markUploadAsCreated:w,setProjectName:b,selectedTeamId:S}=e,T=G$(au.UNLIMITED_EXPORT_DURATION_LIMIT),I=n.exports.useCallback((async e=>{if(w(e.id),e.conversion_id){let t=!1;for(;!t;){await p2(5e3);const a=await yN(e.conversion_id);a.status!==$o.failed&&a.status!==$o.completed||(t=!0,Object.assign(e,{asset_id:a.asset_id,bucket:co,created:a.created,modified:a.modified,source:"upload",uploadedAt:new Date,url:a.output_url}))}const a=await oC(e.url,e);a&&Object.assign(e,a)}const t=await d({currentUser:l,newLayer:e,teamId:S}),a={_id:t._id,isStudio:!0,name:t.projectName,submittedAt:t.submittedAt,draft:!1,done:!1,duration:t.duration,pendingWorkspaceUpload:!0,workspaceId:t.workspaceId};f(a),h(e.id,"uploaded")}),[f,d,l,w,h,S]);n.exports.useEffect((()=>{g()}),[g]),n.exports.useEffect((()=>{Object.keys(E).forEach((e=>{const t=E[e];!t.asset_id||t.uploadCancelled||t.startedVideoCreation||"100%"!==t.uploadProgress||I(t)}))}),[I,E]);const k=()=>"image/*,video/mp4,video/webm,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv",C=e=>{"upload"===e&&(a(),r()),u("started")},N=()=>{a()},A=async e=>{const t=Kk(e);if(t){if(zk(t)||qk(t)||mC(t)){if((e.size||0)>6442450944)throw fm("Rejected Upload",{Origin:"Workspace","File Size":e.size}),new Error("Your content must be under 6GB.");return e.id=y(),e}throw fm("Rejected Upload",{Origin:"Workspace","File Type":t}),new Error("Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, .mpeg formats.")}throw fm("Rejected Upload",{Origin:"Workspace"}),new Error("Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.")},x=async(e,t)=>{var a;let o,n={source:"workspaceUpload",projectName:t};const r=await dC(e,e);return r?(o={...e},n={...n,...e,type:"image"===(null==(a=e.mime)?void 0:a.split("/")[0])?"image":"video",width:400,height:400,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0}},r&&"image/gif"===e.mime&&(n.type="video",n.mime=Ln()?"video/quicktime":"video/webm",n.isTrimmed=!1)):(o=await oC(e.url||"",e),n={...n,...e,...o,objectFit:"cover",fileSizeChecked:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0}}),{newLayer:n,mediaInfo:o}},P=(e,t={},a="")=>{let o=e;e||(o="An error occurred while uploading. Please try again later."),i(o),Xf(t.id),v(t.id)},R=(e,t,a,o,n=0)=>{n<=5?0===e||503===e?F(t,a,o,n+1):D(t,a,o,{},n+1):P("An error occurred during upload. Please try again later.",o,"onUploadError")},O=async(e,t,a)=>{if(200!==e.status)return void P(e.statusText||"An error occurred during upload. Please try again.",a,"onUploadFinish");u("finished");const[o,n]=gH(t),r={blob_name:n,bucket:o||co,name:n,size:a.size,mime:a.type},i={read_uri:t};s||(i.skipSigning=!0);const{asset:l,cmlFile:d}=await $C(r,i);LN(l,d);const m=$k(a.url,a.type),p=await sV(a,{});let h;await dC(a,p)&&(h=await fN({asset_id:l._id,resource:r.name,type:"blob",conversion_type:m}));const g={...r,asset_id:l._id,source:"workspaceUpload",url:t,workspaceId:c,conversion_id:h};l.ffprobeData&&(g.ffprobeData=l.ffprobeData),a.id&&(g.id=a.id),a.type.includes("video")&&(g.duration=a.duration);const f=_C(a.name||"");b(f);const{newLayer:y}=await x(g,f);_(g.id,y)},D=async(e,t,a,o={},n=0)=>{const r=new XMLHttpRequest;r.open("PUT",e,!0),r.onerror=o=>{o&&console.error("upload error",o||null),R(r.status,e,t,a,n)},r.onload=async()=>{O(r,t,a)},r.upload.onprogress=e=>((e,t)=>{if(e.lengthComputable){const a=`${Math.round(e.loaded/e.total*100).toString()}%`;h(t.id,a)}})(e,a),r.setRequestHeader("Content-Type",a.type);for(const[i,s]of Object.entries(o))r.setRequestHeader(i,s);r.send(a)},L=e=>{const t={name:e.name,id:e.id||"",workspaceId:c,uploadProgress:"0%"};p(t),(async e=>{const t=1===s,a=await Yw({files:[{file:e}],isPrivate:t}),{read_uri:o,upload_uri:n}=a.uris[0];D(n,o,e)})(e)},U=async t=>{const o=await Hk(t,void 0,P);try{o.local_url=URL.createObjectURL(o);"video"===o.type.split("/")[0]?(t=>{const{currentTeam:a}=e,o=document.createElement("video");o.src=t.local_url||"",o.onerror=()=>{L(t)},o.onloadedmetadata=()=>{var e,n;if(t.duration=o.duration,!a)throw new Error("Error during file upload, no team found.");const r=(null!=(n=null==(e=a.limits)?void 0:e.cumulativeExportDuration)?n:0)+t.duration;return!T&&r>10800?(i("You've reached your publishing limit of 3 hours of video this month. Upgrade to publish unlimited videos."),fm("Paywalled Upload",{"Paywall Type":"Total Video Duration Limit",Origin:"Workspace"}),void v(t.id)):!T&&t.duration>420?(fm("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":T?"Pro":"Basic"}),i("Upgrade your workspace to upload files over 7 minutes (up to 2 hour) long."),void v(t.id)):t.duration>7200?(fm("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":T?"Pro":"Basic"}),i("Your content must be under 2 hour long."),void v(t.id)):void L(t)}})(o):L(o)}catch($ae){P("An error occurred during upload. Please make sure your media is a compatible format.",t,"checkFileAndUpload"),a()}},M=async e=>{if(!e||e.length<=0)i("Please choose a file!");else if(e.length>15)i("Please upload 15 or fewer files at a time.");else{C("upload");for(let t=0;t<e.length;t+=1)try{const a=await A(e[t]);if(!T&&(a.size||0)>262144e3)return fm("Rejected Upload",{Origin:"Workspace","File Size":a.size,"Workspace Type":T?"Pro":"Basic"}),void i("Upgrade your workspace to upload files over 250MB up to 6GB.");U(a)}catch($ae){const t=$ae.toString().split("Error: ")[1];i(t)}}},F=(e,t,a,o)=>{const n=new XMLHttpRequest;n.open("PUT",e,!0),n.onload=r=>{if(308===r.target.status){console.debug("gcs returned 308, try resuming upload");const r=n.getResponseHeader("Range");if(!r)return console.debug("no range returned, try again"),void D(e,t,a,{},o);const i=parseInt(r.split("-").pop(),10);if(i<0)return console.debug("Last uploaded byte < 0, try again from beginning"),void D(e,t,a,{},o);const s=i+1,l=a.size-1,c={"Content-Range":`bytes ${s}-${l}/${a.size}`};console.debug("Resuming upload, starting at byte ",i),D(e,t,a.slice(s,l+1),c,o)}else O(n,t,a)},n.onerror=()=>{R(n.status,e,t,a,o)},n.setRequestHeader("Content-Range",`bytes */${a.size}`),n.send()},B=async e=>{a();const t=e;t.mime&&t.mime.includes("image")&&(t.duration=0),t.name="Studio Project",t.workspaceId=c,t.id=y();const o=t.name;b(o);const{newLayer:n,mediaInfo:r}=await x(t,o);if(!r)throw Error("Could not determine upload type");return!T&&"duration"in r&&r.duration&&r.duration>420?(fm("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":T?"Pro":"Basic"}),i("Upgrade your workspace to upload files over 7 minutes (up to 2 hour) long."),void v(t.id)):"duration"in r&&r.duration&&r.duration>7200?(fm("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":T?"Pro":"Basic"}),i("Your content must be under 2 hour long."),void v(t.id)):(p(n),u("pending"),void h(t.id,"100%"))};return m.createElement("div",null,t&&m.createElement(m2,{hideDialog:()=>a(),showError:i,handleMultiFileUpload:M,startUpload:C,stopUpload:N,handlePasteLinkFinish:B,returnAccepts:k}),o&&m.createElement(AN,{hideDragUploadDialog:r,handleDragUpload:M,showDragUploadDialog:!0,dragUpload:!0},m.createElement("div",{className:s2},"Upload video or image"),m.createElement(DN,{returnAccepts:k,handleMultiFileUpload:M,multiple:!0,labelClassNames:u2})))})),f2="AiVideoGeneratorViewer-module_step_1CcLo",y2="AiVideoGeneratorViewer-module_filled_9xmv-",E2="AiVideoGeneratorViewer-module_stepper_SbzrF",_2="AiVideoGeneratorViewer-module_progress_lUVdu",v2="AiVideoGeneratorViewer-module_wrapper_oWe-v",w2="AiVideoGeneratorViewer-module_container_8B-vj",b2="AiVideoGeneratorViewer-module_resultsContainer_Rmilm",S2="AiVideoGeneratorViewer-module_image_Sfoy-",T2="AiVideoGeneratorViewer-module_header_C1YSI",I2="AiVideoGeneratorViewer-module_placeholder_tlYOB",k2="AiVideoGeneratorViewer-module_complete_TiUEM",C2="AiVideoGeneratorViewer-module_footer_T86VG",N2="AiVideoGeneratorViewer-module_startOver_JFgcp",A2="AiVideoGeneratorViewer-module_share_h-fef",x2="AiVideoGeneratorViewer-module_shareButton_K-bIo",P2="AiVideoGeneratorViewer-module_credits_C3nR6",R2="AiVideoGeneratorViewer-module_imageContainer_8U1KT",O2="AiVideoGeneratorViewer-module_download_HxRZ1",D2="AiVideoGeneratorViewer-module_downloadButton_5tY6Y",L2="AiVideoGeneratorViewer-module_failed_3NlMj",U2=()=>{const[e,t]=n.exports.useState(),a=jt(),o=i.exports.useDispatch(),r=Fe();n.exports.useEffect((function(){const e=async a=>{try{const{doc:o,error:i}=await op("/api/v1/stunts/poll-video",{body:{id:a}});if(!o)return void r.replace("/ai-video-generator");if(i)throw Error(i);if(t(o||void 0),null==o?void 0:o.failed)return;if(400===(null==o?void 0:o.lastIteration)&&(null==o?void 0:o.video))return void console.info(o);setTimeout((()=>e(n)),3e3)}catch(i){o(wh(i))}},{id:n}=a;e(n)}),[]);const s=()=>m.createElement("div",{className:k2},"Your video is complete! This generator uses a different seed each time, which means that no two videos will ever be the same.",(()=>{if(e){const{image:t,video:a}=e;if(t&&a){const e=t.includes("https://storage.googleapis.com/kapwing/")?t.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"):t.replace("https://storage.googleapis.com/kapwing-useast1/","https://cdn-useast1.kapwing.com/"),o=a.includes("https://storage.googleapis.com/kapwing/")?a.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"):a.replace("https://storage.googleapis.com/kapwing-useast1/","https://cdn-useast1.kapwing.com/");return m.createElement("div",{className:O2},m.createElement("a",{href:e,className:D2,download:!0},"Download image"),m.createElement("a",{href:o,className:D2,download:!0},"Download video"))}}return null})(),m.createElement("p",null,"Want to try again?"," ",m.createElement(_e,{to:"/ai-video-generator"},"Create another video"),".")),l=()=>{if(e){const{image:t,prompt:a}=e;if(t){const e=t.includes("https://storage.googleapis.com/kapwing/")?t.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"):t.replace("https://storage.googleapis.com/kapwing-useast1/","https://cdn-useast1.kapwing.com/");return m.createElement("div",{className:R2},m.createElement("img",{alt:a,src:e,className:S2,width:"300",height:"300"}))}return m.createElement("div",{className:R2},m.createElement("div",{className:I2},m.createElement(bk,null)))}return null};return m.createElement("div",{className:v2},m.createElement("div",{className:w2},e?(()=>{if(e){const{prompt:t,failed:a}=e,o=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");return a?m.createElement("div",{className:b2},m.createElement("div",{className:T2},o(t)),m.createElement("div",{className:L2},"Unfortunately, something went wrong and your video failed to process. This happens sometimes if the machines run out of memory.",m.createElement("p",null,"Want to try again?"," ",m.createElement(_e,{to:"/ai-video-generator"},"Create another video"),"."))):m.createElement("div",{className:b2},m.createElement("div",{className:T2},o(t)),l(),(()=>{if(!e)return null;const t=e.lastIteration||0;return 400===t?s():m.createElement(m.Fragment,null,m.createElement("div",{className:E2},m.createElement("span",{className:`${f2} ${t>=50&&y2}`}),m.createElement("span",{className:`${f2} ${t>=100&&y2}`}),m.createElement("span",{className:`${f2} ${t>=150&&y2}`}),m.createElement("span",{className:`${f2} ${t>=200&&y2}`}),m.createElement("span",{className:`${f2} ${t>=250&&y2}`}),m.createElement("span",{className:`${f2} ${t>=300&&y2}`}),m.createElement("span",{className:`${f2} ${t>=350&&y2}`}),m.createElement("span",{className:`${f2} ${400===t&&y2}`})),m.createElement("div",{className:_2},"Generating ... ",Math.round(t/400*100),"% complete. Please be patient, it may take a minute or so to start generating, and some videos can take several minutes to complete. Feel free to check this page later for your completed video."))})())}return null})():null),m.createElement("div",{className:C2},m.createElement("div",{className:N2,onClick:()=>{r.push("/ai-video-generator")}},"Create a new video"),m.createElement("div",{className:P2},"Made with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com/"},"Kapwing")),m.createElement("div",{className:A2},"Share:",m.createElement("div",null,m.createElement(xe,{url:`https://www.kapwing.com/ai-video-generator/${a.id}`,title:"AI Video Generator - Kapwing",via:"kapwingapp",hashtags:["video","ai"],className:x2},m.createElement(Pe,{size:40,round:!0})),m.createElement(Ne,{url:`https://www.kapwing.com/ai-video-generator/${a.id}`,quote:"AI Video Generator - Kapwing",className:x2},m.createElement(Ae,{size:40,round:!0}))))))},M2=[{id:"611b75ea123d8b19d9eb6a5d",query:"sunrise over the ocean",image:"https://i.imgur.com/i0YNyJB.png"},{id:"611b76aa123d8b19d9eb6a5e",query:"tree in the forest",image:"https://i.imgur.com/rOKXEai.png"},{id:"611b76f7123d8b19d9eb6a5f",query:"sunflower",image:"https://i.imgur.com/Qf5EyWO.png"},{id:"611b7803123d8b19d9eb6a60",query:"birds and the bees",image:"https://i.imgur.com/XSK5Emh.png"},{id:"611b780f123d8b19d9eb6a61",query:"paradise",image:"https://i.imgur.com/NzMXsWV.png"},{id:"611abc56123d8b19d9eb6a5a",query:"two mountains",image:"https://i.imgur.com/xWGnvsf.png"},{id:"6116dfe96b24ef3834260b7c",query:"polar bear at the beach",image:"https://i.imgur.com/JRPqdIr.png"},{id:"611aea07123d8b19d9eb6a5c",query:"racecar",image:"https://i.imgur.com/ESoKKW3.png"},{id:"611aa66f123d8b19d9eb6a54",query:"baby playing tennis",image:"https://i.imgur.com/5hoOez5.png"},{id:"61188d9172480f7efe599500",query:"dolphin eating chocolate",image:"https://i.imgur.com/YWxZblp.png"},{id:"611aae92123d8b19d9eb6a58",query:"golf course",image:"https://i.imgur.com/0dNUXRK.png"},{id:"611ab99b123d8b19d9eb6a59",query:"artificial intelligence",image:"https://i.imgur.com/RrRJr5x.png"},{id:"611ae367c949a22f93b8ffaa",query:"leprechaun",image:"https://i.imgur.com/O362iP4.png"},{id:"611ae6f6c949a22f93b8ffab",query:"unicorn",image:"https://i.imgur.com/KYAzQpB.png"},{id:"611ae81bc949a22f93b8ffac",query:"barber shop",image:"https://i.imgur.com/oowk98s.png"},{id:"611ae92c123d8b19d9eb6a5b",query:"house on a prairie",image:"https://i.imgur.com/wbTGxfy.png"}],F2="AiVideoGeneratorHome-module_container_5UYij",B2="AiVideoGeneratorHome-module_header_e2VEN",W2="AiVideoGeneratorHome-module_headerText_hARWA",V2="AiVideoGeneratorHome-module_subheader_-Vefp",j2="AiVideoGeneratorHome-module_form_VRm-7",H2="AiVideoGeneratorHome-module_input_OIXc4",G2="AiVideoGeneratorHome-module_goButton_mW2mp",$2="AiVideoGeneratorHome-module_gallery_vnsoa",K2="AiVideoGeneratorHome-module_galleryHeader_TxExx",Y2="AiVideoGeneratorHome-module_galleryItemsContainer_tvwT3",z2="AiVideoGeneratorHome-module_galleryItem_kXGij",q2="AiVideoGeneratorHome-module_galleryItemQuery_X4AYB",J2="AiVideoGeneratorHome-module_galleryItemImage_APlK8",X2="AiVideoGeneratorHome-module_moreInfo_GWisF",Q2="AiVideoGeneratorHome-module_moreInfoHeader_-l3zz",Z2="AiVideoGeneratorHome-module_moreInfoBody_JFhg1",e3="AiVideoGeneratorHome-module_shareFooter_nHEOA",t3="AiVideoGeneratorHome-module_shareText_A--Hc",a3="AiVideoGeneratorHome-module_shareButton_5pULg",o3="AiVideoGeneratorHome-module_modalBackground_-0Nxx",n3="AiVideoGeneratorHome-module_modalWrapper_z791P",r3="AiVideoGeneratorHome-module_modalHeader_Ho2yZ",i3="AiVideoGeneratorHome-module_modalDescription_YSLah",s3="AiVideoGeneratorHome-module_returnHome_s4xR3",l3=()=>{const[e,t]=n.exports.useState(!1),[a,o]=n.exports.useState(""),[r,s]=n.exports.useState(!1),l=i.exports.useDispatch();return m.createElement(m.Fragment,null,r?m.createElement(m.Fragment,null,m.createElement("div",{className:o3,onClick:()=>s(!1)}),m.createElement("div",{className:n3},m.createElement("div",{className:r3},"Thank you for trying the AI Video Generator!"),m.createElement("div",{className:i3},m.createElement("p",null,"The AI Video generator was a fun experiment made by the Kapwing team to try to auto generate videos from a text prompt using VQGAN. While the generator was online, thousands of videos were generated bringing access to AI to many people around the world."),m.createElement("p",null,"Unfortunately, we made the difficult decision to take the generator offline in October of 2021. We wrote a little bit about our experience building this product which can be read in our"," ",m.createElement("a",{href:"https://www.kapwing.com/blog/our-ai-art-generator-isnt-being-used-to-generate-art/",target:"_blank",rel:"noopener noreferrer"},"blog post here"),"."),m.createElement("p",null,"Please feel free to browse the blog post or the generator page to see many of the awesome examples of videos that have been generated."),m.createElement("div",{className:s3,onClick:()=>s(!1)},"Return Back")))):null,m.createElement("div",{className:F2},m.createElement("div",{className:B2},m.createElement("div",{className:W2},"What happens when artificial intelligence tries to make a video?"),m.createElement("div",{className:V2},"This AI video generator creates a video based off any text. Each video is completely unique. This generator is made by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),", based off code by"," ",m.createElement("a",{href:"https://twitter.com/hillelogram",target:"_blank",rel:"noopener noreferrer"},"Hillel Wayne")," ","and"," ",m.createElement("a",{href:"https://twitter.com/RiversHaveWings",target:"_blank",rel:"noopener noreferrer"},"Katherine Crowson"),". Type any text to try it out!"),m.createElement("div",{className:j2},m.createElement("form",{onSubmit:e=>{e.preventDefault(),(async()=>{if(t(!0),!a)return l(wh("Enter some text to try out the generator!")),void t(!1);s(!0),t(!1)})()}},m.createElement("input",{disabled:e,id:"gan-query",onChange:e=>(e=>{""!==e&&null!=e||o("");const t=e.toLowerCase();/^[0-9a-z\s]+$/.test(t)&&o(t)})(e.target.value),type:"text",value:a,placeholder:"Sunrise over the ocean...",className:H2}),e?m.createElement("button",{disabled:!0,type:"submit",className:G2},"Loading ..."):m.createElement("button",{type:"submit",className:G2},"Go")))),m.createElement("div",{className:$2},m.createElement("div",{className:K2},"Gallery"),m.createElement("div",{className:Y2},M2.map((e=>{const{query:t,image:a,id:o}=e;return m.createElement("div",{key:o,className:z2},m.createElement("div",null,m.createElement("img",{src:a,className:J2,alt:t})),m.createElement("div",{className:q2},t))})))),m.createElement("div",{className:X2},m.createElement("div",{className:Q2},"More Info"),m.createElement("div",{className:Z2},m.createElement("p",null,"This video generator powered by artificial intelligence takes text and turns it into a 200px x 200px video that visualizes your description."),m.createElement("p",null,"This online version of the generator is roughly based off of the"," ",m.createElement("a",{href:"https://is.gd/artmachine"},"Colab Notebook")," written by"," ",m.createElement("a",{href:"https://www.hillelwayne.com/"},"Hillel Wayne"),"."),m.createElement("p",null,"The original technique was first surfaced in"," ",m.createElement("a",{href:"https://colab.research.google.com/drive/15UwYDsnNeldJFHJ9NdgYBYeo6xPmSelP"},"this notebook")," ","by ",m.createElement("a",{href:"https://github.com/crowsonkb"},"Katherine Crowson")," ","and involves creating images using VQGAN, a generative adversarial network, and CLIP, a neural network centered around visual learning recently released by"," ",m.createElement("a",{href:"https://openai.com/blog/clip/"},"Open AI"),"."),m.createElement("p",null,"Because the GAN uses a unique seed with each run, no two videos will ever be the same even for the same text input. Having trouble thinking of something to generate? Try a simple, natural scene first and then choose whatever you like after."),m.createElement("p",null,"Have an awesome video to add to the gallery? Please"," ",m.createElement("a",{href:"/contact-us"},"contact us")," or tweet at @kapwingapp to let us know!"))),m.createElement("div",{className:e3},m.createElement(xe,{url:"https://www.kapwing.com/ai-video-generator",title:"AI Video Generator - Kapwing",via:"kapwingapp",hashtags:["video","ai"],className:a3},m.createElement(Pe,{size:40,round:!0})),m.createElement(Ne,{url:"https://www.kapwing.com/ai-video-generator",quote:"AI Video Generator - Kapwing",className:a3},m.createElement(Ae,{size:40,round:!0})),m.createElement("div",{className:t3},"Created with love by the team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")))),m.createElement(HC,null))},c3=()=>{const e="Create AI videos with this simplified generator that creates AI art using VQGAN and CLIP. Input your text and get a video back in just a few minutes.";return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"AI Video Generator — Kapwing"),m.createElement("meta",{name:"description",content:e}),m.createElement("meta",{name:"keywords",content:"ai video generator, VQGAN, CLIP, artificial intelligence"}),m.createElement("meta",{property:"og:title",content:"AI Video Generator — Kapwing"}),m.createElement("meta",{property:"og:description",content:e}),m.createElement("meta",{property:"og:image",content:"https://i.imgur.com/nNYtN77.png"}),m.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/nNYtN77.png"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/ai-video-generator"})),m.createElement($e,null,m.createElement(Ke,{path:"/ai-video-generator/:id",component:U2}),m.createElement(Ke,{path:"/ai-video-generator",exact:!0,component:l3})))},d3="LogoRedesigns-module_wrapper_5Er59",u3="LogoRedesigns-module_container_8iWJM",m3="LogoRedesigns-module_content_4IcCx",p3="LogoRedesigns-module_headerImage_UsZ8C",h3="LogoRedesigns-module_date_RkkN1",g3="LogoRedesigns-module_header_mF84A",f3="LogoRedesigns-module_firstP_5Ls7w",y3="LogoRedesigns-module_p_pnYqE",E3=()=>{const e="A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out, we've recreated six iconic logos in six essential art styles.";return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Logo Redesigns — Kapwing"),m.createElement("meta",{name:"description",content:e}),m.createElement("meta",{name:"keywords",content:"logo redesign, graphic design, art styles, logo styles"}),m.createElement("meta",{property:"og:title",content:"Logo Redesigns — Kapwing"}),m.createElement("meta",{property:"og:description",content:e}),m.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),m.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/logo-redesigns"})),m.createElement(yD,null),m.createElement("div",{className:d3},m.createElement("div",{className:u3},m.createElement("div",{className:m3},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Header_6-Famous-Logos-Designed-In-6-Graphic-Design-Styles.a38085c9.png",alt:"Trading in Trademarks",className:p3}),m.createElement("div",{className:h3},"16 January 2022"),m.createElement("h1",{className:g3},"Six Famous Logos Designed in Six Graphic Design Styles"),m.createElement("p",{className:f3},"A brand's logo has a lot of heavy lifting to do. The logo should hint at the product type and ooze the brand's spirit. It should be stylish yet timeless. And it should do all this without looking quite like"," ",m.createElement("a",{href:"https://www.creativebloq.com/features/8-famous-logos-that-look-unbelievably-similar",target:"_blank",rel:"noopener noreferrer"},"anything else"),"."),m.createElement("p",{className:y3},"Yet a logo needs to be light as a feather. If the consumer needs to think about it, it's dead in the water. A logo should be eloquent, effortless, effervescent."),m.createElement("p",{className:y3},"When a graphic designer begins a new logo, they balance the need for originality against the need for instant recognition. Rather than choosing a graphic design style, they should wield a"," ",m.createElement("a",{href:"https://99designs.co.uk/blog/logo-branding/famous-logos/",target:"_blank",rel:"noopener noreferrer"},"deep knowledge")," ","of the looks that have gone before and understand the connotations of those styles today."),m.createElement("p",{className:y3},"A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out — and provide a graphic design style primer — the team at"," ",m.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),", has recreated ",m.createElement("strong",null,"six iconic logos")," in these"," ",m.createElement("strong",null,"six essential styles"),":"," "),m.createElement("ul",null,m.createElement("li",null,m.createElement("strong",null,"Art nouveau.")," An elegant, sinuous, romantic style from the turn of the 20th century."),m.createElement("li",null,m.createElement("strong",null,"Bauhaus.")," An avant-garde design school that favored functionalism, geometrics, and space."),m.createElement("li",null,m.createElement("strong",null,"Psychedelic.")," Acid-colored patterns and stream-of-conscious lines that have bedazzled beholders since the 1960s."),m.createElement("li",null,m.createElement("strong",null,"Pop art.")," Kitsch, comic-style pop culture references channeling 1950s Americana through Andy Warhol's eyes."),m.createElement("li",null,m.createElement("strong",null,"Retro '80s.")," The grids, vector curves, clipart, and blocky fonts of 1980s computer graphics sprinkled with that weird '80s sense of glamor."),m.createElement("li",null,m.createElement("strong",null,"3D design.")," Playful renders popping out of the screen with more or less fidelity to realism.")),m.createElement("p",{className:y3},"Scroll on for a closer look at each brand logo."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{alt:"Famous Logos Redesigned",src:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png"})),m.createElement("h2",{id:"Apple"},"Apple"),m.createElement("p",{className:y3},"The apple: so simple, you don't even need typography. There are many theories for that bite, though. It could reference Alan Turing, the gay war hero who invented \"",m.createElement("a",{href:"https://www.newscientist.com/people/alan-turing/",target:"_blank",rel:"noreferrer noopener"},"the computer"),'" and who ate an apple laced with poison after the feds chemically castrated him. Or it could reference the forbidden knowledge of actually opening up a Mac to see how it works. However, designer Touraj Saberivand'," ",m.createElement("a",{href:"https://inkbotdesign.com/apple-logo-design/",target:"_blank",rel:"noreferrer noopener"},"explains"),': "to make it look more like an apple and not some other round fruit, I did what one does with an apple. I took a bite out of it."'),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Apple Logo"})),m.createElement("p",{className:y3},"Our art nouveau take on the Apple logo is not far from the brand's original 1976 artwork — a woodblock print of an apple gravitating towards Isaac Newton's head with the words “Apple Computer Co.” wrapped around it. But the Bauhaus version most clearly articulates Steve Jobs' vision: clear, artistic —"," ",m.createElement("a",{href:"https://www.forbes.com/sites/stevedenning/2011/11/17/the-lost-interview-steve-jobs-tells-us-what-really-matters",target:"_blank",rel:"noreferrer noopener"},"a tool to amplify your abilities"),"."),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Apple-compressed-animation.a2530daa.gif",alt:"Apple animation"}),m.createElement("h2",{id:"McDonald's"},"McDonald's"),m.createElement("p",{className:y3},"It's hard to imagine McDonald's without the golden arches. But when it was just the McDonald brothers in their shack with a fryer, they favored a jaunty comic script atop their then-mascot, the troubling burger chef,"," ",m.createElement("a",{href:"https://www.creativebloq.com/logo-design/mcdonalds-logo-short-11135325",target:"_blank",rel:"noreferrer noopener"},"Speedee"),". Troubling because Speedee was both a burger and a chef."," "),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",alt:"McDonald's Logo"})),m.createElement("p",{className:y3},"The ghost of Speedee haunts the rock 'n roll quiffed burger boy of our 1950s pop art style McD's logo. But the versions that retain prominent arches demonstrate the power of a simple motif to conjure a brand's aftertaste in your mouth. McDonald's is going through a big"," ",m.createElement("a",{href:"https://www.vox.com/22736636/mcdonalds-design-aesthetic-look-buildings",target:"_blank",rel:"noreferrer noopener"},"identity crisis")," ","lately, not least"," ",m.createElement("a",{href:"https://www.mashed.com/680053/the-hilarious-reason-mcdonalds-just-changed-its-twitter-handle/",target:"_blank",rel:"noreferrer noopener"},"rebranding its Twitter handle")," ","in the style of South Korean boy band phenomenon BTS. Can the arches bear the strain?"),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/McDonalds-compressed-animation.f2ecf0b5.gif",alt:"McDonald's animation"}),m.createElement("h2",{id:"Instagram"},"Instagram"),m.createElement("p",{className:y3},"Cole Rise threw the old Instagram logo together in under 45 minutes. Deadline met, he refined it over the next few months. The polished version represented the app for five years. Rise's 2010 design followed the"," ",m.createElement("a",{href:"https://blog.hubspot.com/website/skeuomorphism",target:"_blank",rel:"noreferrer noopener"},"skeuomorphic")," ","design trend of the day, making the logo look like an actual Instamatic camera (actually a Bell & Howell)."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Instagram Logo"})),m.createElement("p",{className:y3},"When Instagram decided it was time to simplify and"," ",m.createElement("a",{href:"https://www.interaction-design.org/literature/topics/flat-design",target:"_blank",rel:"noreferrer noopener"},'"flatten"')," ","its logo like everyone else, they asked every staff member to draw Rise's logo from memory. “That gave us a sense of what was burned in,”"," ",m.createElement("a",{href:"https://www.fastcompany.com/3059740/an-exclusive-look-at-instagrams-new-app-icon",target:"_blank",rel:"noreferrer noopener"},"said Ian Spalter"),", head of design. Our re-styled versions demonstrate just how hot the square-and-concentric-circles brand burns."),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Instagram-compressed-animation.75de683f.gif",alt:"Instagram animation"}),m.createElement("h2",{id:"Google"},"Google"),m.createElement("p",{className:y3},"The Google brand has thrived on minimalism even as the company explores ever more diverse avenues (its next move is"," ",m.createElement("a",{href:"https://www.nytimes.com/2021/04/30/technology/google-back-to-office-workers.html",target:"_blank",rel:"noreferrer noopener"},"“Ikea meets Lego”"),"). The uncluttered search page and no-frills logo are as much an element of Google's early success as its algorithms. But the original logo featured an exclamation mark and a"," ",m.createElement("a",{href:"https://sweeney.agency/shedding-some-light-on-the-drop-shadow/",target:"_blank",rel:"noreferrer noopener"},"drop shadow")," ","that'll make you cry. Not so much 'simple' as 'basic.'"),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Google Logo"})),m.createElement("p",{className:y3},"The simplicity of the post-exclamation, post-drop shadow logo has allowed for infinite variations via the regularly-changing"," ",m.createElement("a",{href:"https://www.google.com/doodles/about",target:"_blank",rel:"noreferrer noopener"},"Google Doodle"),". So, while none of our redesigns look implausible, the two that are most evocative are those that imagine Google in a realistic alternative timeline: either the vaporwave look of our"," ",m.createElement("a",{href:"https://www.rediscoverthe80s.com/2020/02/what-the-internet-was-like-in-the-80s.html",target:"_blank",rel:"noreferrer noopener"},"dial-up era")," ","1980s logo or the augmented-reality bubbles of the 3D version."),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Google-compressed-animation.180e4c5b.gif",alt:"Google animation"}),m.createElement("h2",{id:"NASA"},"NASA"),m.createElement("p",{className:y3},"The NASA logo is pretty busy by today's standards, but when your main beholders are space aliens, it makes sense to communicate your purpose in full. The planet-shaped, star-studded, red aeronautics-themed dash logo has a mundane nickname among Earth-dwellers, even at NASA: the meatball."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",alt:"NASA Logo"})),m.createElement("p",{className:y3},"NASA already has a '1980s version' of its logo. Their"," ",m.createElement("a",{href:"https://www.nasa.gov/audience/forstudents/5-8/features/symbols-of-nasa.html",target:"_blank",rel:"noreferrer noopener"},"looping, red, text-only logo")," ","known as the 'worm' did most of the work between 1975 — 1992 (and recently made another comeback). So our 1980s version imagines the best of both worlds: a meatball in the decade that gave us the bubblegum heroics of ",m.createElement("i",null,"Explorers and Flight of the Navigator"),"."),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/NASA-compressed-animation.15def524.gif",alt:"NASA animation"}),m.createElement("h2",{id:"WWF"},"WWF"),m.createElement("p",{className:y3},"The choice of a panda for WWF’s icon is a masterstroke of clear thinking. The simplicity of a black and white design that works in silhouette; the precarity of the panda as symbolic of World Wildlife Fund’s efforts; and the cute factor that convinces supporters to part with their money. The panda design has prevailed almost unchanged since 1961 (thankfully the World Wrestling Federation didn’t choose a panda for its logo)."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",alt:"WWF Logo"})),m.createElement("p",{className:y3},"Our Bauhaus-style redesign of the WWF logo adds a splash of color while simplifying the form. And it maintains the cuteness without resorting to the child appeal of our 1980s version. Scientists say the power of cute can be used to ‘",m.createElement("a",{href:"https://www.ox.ac.uk/research/how-cute-things-hijack-our-brains-and-drive-behaviour",target:"_blank",rel:"noreferrer noopener"},"hijack our brains"),",’ which makes it a useful tool for marketing – but it’s essential not to"," ",m.createElement("a",{href:"https://99designs.co.uk/blog/creative-inspiration/cute-logos/",target:"_blank",rel:"noreferrer noopener"},"compromise")," ","the seriousness of your brand."),m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/WWF-compressed-animation.c7be7ece.gif",alt:"WWF animation"}),m.createElement("p",{className:y3},"When"," ",m.createElement("a",{href:"https://www.creativebloq.com/features/5-logos-by-famous-designers-and-why-they-work",target:"_blank",rel:"noreferrer noopener"},"Chupa Chups")," ","needed a logo, the boss asked his friend Salvador Dali to sketch one on an old newspaper that was lying around. Yet a logo needn't be high art. Right now, supermarket brands are giving"," ",m.createElement("a",{href:"https://www.designweek.co.uk/what-is-normcore-and-how-will-it-affect-design/",target:"_blank",rel:"noreferrer noopener"},"normcore")," ","its"," ",m.createElement("a",{href:"https://plato.stanford.edu/entries/postmodernism/",target:"_blank",rel:"noreferrer noopener"},"post-modernist")," ","moment, splashing their basic but powerful logos over nerdy knits to create"," ",m.createElement("a",{href:"https://www.theguardian.com/lifeandstyle/2021/dec/04/how-the-mundane-trend-is-bringing-some-christmas-sparkle-for-everyday-brands",target:"_blank",rel:"noreferrer noopener"},"highly coveted"),", semi-ironic streetwear. They may be ugly, but they carry a lot of emotional baggage."),m.createElement("p",{className:y3},"The lesson for logo designers? Draw inspiration from style movements but remain boldly true to the brand. It takes integrity and flair to create an icon that sears itself into the world's retinas."),m.createElement("hr",null),m.createElement("p",{className:y3},"Did you enjoy this collection of logo redesigns? Our team at Kapwing, an"," ",m.createElement("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener"},"online video editor"),", loves putting out amazing content related to visual design. Learn and read much more on our"," ",m.createElement("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener"},"resources section")," ","and"," ",m.createElement("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener"},"blog"),".")))),m.createElement(HC,null))},_3="TwitchStreamers-module_wrapper_NJGqb",v3="TwitchStreamers-module_container_M3p03",w3="TwitchStreamers-module_content_9kfTu",b3="TwitchStreamers-module_headerImage_K7nx9",S3="TwitchStreamers-module_date_pmO97",T3="TwitchStreamers-module_header_zbyx0",I3="TwitchStreamers-module_firstP_D1c2V",k3="TwitchStreamers-module_p_qY6qC",C3="TwitchStreamers-module_iframeContainer_jo6-0",N3="TwitchStreamers-module_iframe_pN7av",A3="TwitchStreamers-module_bannerImage_REcA4",x3="TwitchStreamers-module_longIframe_tzqyt",P3=()=>{const e="Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner, RanbooLive. Then, while you’re drying your tears, scroll on to see the rest of our comparisons.";return m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,"Which Twitch Streamers Earn the Most per Hour? — Kapwing"),m.createElement("meta",{name:"description",content:e}),m.createElement("meta",{name:"keywords",content:"twitch earnings, streamers income, twitch salary"}),m.createElement("meta",{property:"og:title",content:"Which Twitch Streamers Earn the Most per Hour? — Kapwing"}),m.createElement("meta",{property:"og:description",content:e}),m.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),m.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/how-much-twitch-streamers-make"})),m.createElement(yD,null),m.createElement("div",{className:_3},m.createElement("div",{className:v3},m.createElement("div",{className:w3},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/Header_Highest-Earning-Twitch-Streamers.86c050a1.png",alt:"Twitch Revenue Streams",className:b3}),m.createElement("div",{className:S3},"24 January 2022"),m.createElement("h1",{className:T3},"Which Twitch Streamers Earn the Most per Hour?"),m.createElement("p",{className:I3},"Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner,"," ",m.createElement("a",{href:"https://www.twitch.tv/ranboolive",target:"_blank",rel:"noopener noreferrer"},"RanbooLive"),". Then, while you’re drying your tears, scroll on to see the rest of our comparisons."),m.createElement("div",{className:C3},m.createElement("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/calculator/",scrolling:"no",className:N3})),m.createElement("p",{className:k3},"Twitch is Amazon’s hugely popular games streaming platform. It’s a closed universe where semi-anonymous teens become low-key celebrities off the back of their charm and gaming prowess. But curtain-twitchers saw how the platform rewards its personalities when hackers stole a bunch of ‘",m.createElement("a",{href:"https://blog.twitch.tv/en/2021/10/15/updates-on-the-twitch-security-incident/",target:"_blank",rel:"noopener noreferrer"},"creator payout data"),"’ from the site in October 2021."),m.createElement("p",{className:k3},"The leak seems to reveal that half of the streamer earnings on Twitch go to just"," ",m.createElement("a",{href:"https://techcrunch.com/2021/10/07/twitch-streamers-respond-after-huge-leak-of-creator-payout-data/",target:"_blank",rel:"noopener noreferrer"},"10% of the streamers"),". According to some creators, this indicates that Twitch is more invested in driving viewers to superstar channels than boosting discoverability for up-and-coming talent – including marginalized groups."),m.createElement("p",{className:k3},"But those outside of the story are dizzied by the mindboggling earnings of the top streamers compared to the hours they spend streaming. For example,"," ",m.createElement("a",{href:"https://www.twitch.tv/pokimane",target:"_blank",rel:"noopener noreferrer"},"pokimane")," ","spent 2,177 hours online in the 15 months leading to October 2020, earning $1.53m – which works out at $702.02 per hour. A teacher would need to work 29 hours for every pokimane hour to earn that much."),m.createElement("p",{className:k3},"Well, nobody said that celebrities are supposed to earn normal salaries. But, our team at"," ",m.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")," got curious about how these figures compare to more regular modes of employment. So, we figured out the effective hourly rates of Twitch’s 100 biggest earners and made some tools to help you visualize them."),m.createElement("h2",{id:"ranboolives-hourly-wage"},"RanbooLive has Twitch’s Highest ‘Hourly Wage’"),m.createElement("p",{className:k3},"When news of the Twitch leak dropped, Ranboo tweeted an image of some masking tape with the caption, “",m.createElement("a",{href:"https://twitter.com/ranboosaysstuff/status/1445763636849348609?lang=en",target:"_blank",rel:"noopener noreferrer"},"Dont worry everyone ill fix the leak."),"” With Twitch earnings of $2,401,021.84, he can afford a million rolls of tape if he even cares that folk know his income."),m.createElement("p",{className:k3},"Little else is known about the Minecraft-playing Twitch star, who wears a monochrome mask and shades to protect his privacy and cope with dysmorphia. However, he has teased a big reveal at 5 million followers (",m.createElement("a",{href:"https://twitter.com/Ranboosaysstuff/status/1465015825622962179",target:"_blank",rel:"noopener noreferrer"},"he’s just reached 4m"),"). Divided across his 1,001 hours of streaming, Ranboo earns $2,398.62/hour."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{alt:"Which Twitch Streamers Earn the Most per Hour?",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",className:A3})),m.createElement("p",{className:k3},"Twitch’s 10 highest earners earn an average of $1,477 per hour of streaming. Even when you even the earnings out across the top 50, you still get an average rate of $732/hour. The top 10 streamed for an average of 2,709 hours (1st Aug 2019 - 1st Oct 2020), while the top 50 worked an average of 3,719 hours."),m.createElement("p",{className:k3},"Twitch’s partner scheme offers"," ",m.createElement("a",{href:"https://www.businessinsider.com/twitch-raises-incentives-for-creators-2017-4?r=US&IR=T",target:"_blank",rel:"noopener noreferrer"},"varying")," ","splits on subscription earnings, depending on the popularity of the streamer. Some claim that highly popular streamers can negotiate this split, which may be how the highest earners capitalize on streaming for relatively few hours."),m.createElement("h2",{id:"it-takes-a-doctor-67-hours"},"RanbooLive has Twitch’s Highest ‘Hourly Wage’"),m.createElement("p",{className:k3},"Next, we figured out how RanbooLive’s effective hourly rate compares to that of more common American jobs. For example, a doctor earns $35.90/hour on average. They would need to work 67 hours to match what Ranboo earns from an hour of streaming. Looked at another way, in the time it takes Ranboo to earn $35.90, a doctor earns just 54 cents."),m.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",target:"_blank",rel:"noopener noreferrer"},m.createElement("img",{alt:"Hourly Pay of Twitch's Top Streamer vs. Common US Professions",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",className:A3})),m.createElement("p",{className:k3},"And that’s for a doctor. Waiting staff earn an average of $15/hour, so they’d need to work 160 hours to match Ranboo. Teachers – trusted with the future of our children and our culture – need to put in 99 hours at $24.34 to earn a Ranboo hour. The problem is not so much the freak earnings of Ranboo, but the low compensation to the mass of America’s workers,"," ",m.createElement("a",{href:"https://www.brookings.edu/blog/the-avenue/2019/11/21/low-wage-work-is-more-pervasive-than-you-think-and-there-arent-enough-good-jobs-to-go-around/",target:"_blank",rel:"noopener noreferrer"},"nearly half")," ","of whom earn less than it takes to achieve ‘economic security.’"),m.createElement("h2",{id:"the-boss-of-it-all"},"The Boss of It All"),m.createElement("p",{className:k3},"The highest earner in the Twitchosphere is the owner of its parent company, Amazon. But does anyone care what Jeff Bezos earns anymore? Like picturing the universe, imagining Bezos’ income is an tough task."),m.createElement("p",{className:k3},"Still, Amazon’s payroll remains of interest. Not just the company’s"," ",m.createElement("a",{href:"https://www.nytimes.com/2021/10/24/technology/amazon-employee-leave-errors.html",target:"_blank",rel:"noopener noreferrer"},"failure")," ","to honor even the low wages of its regular workers, but the distribution of wealth and opportunity across Twitch’s creator community. And what it means for the rest of us average Joe’s, who would love to earn $2k doing what we love for an hour or so…"),m.createElement("p",{className:k3},"For our full analysis of the leaked Twitch streamer earnings, check out the table below."),m.createElement("div",{className:C3},m.createElement("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/table/",scrolling:"yes",className:x3})),m.createElement("h2",{id:"methodology-&-sources"},"Methodology & Sources"),m.createElement("p",{className:k3},"We used data from the recent"," ",m.createElement("a",{href:"https://twitter.com/Sinoc229/status/1445639738707251200",target:"_blank",rel:"noopener noreferrer"},"Twitch data leak")," ","to discover the top 100 earning Twitch streamers. Then we used"," ",m.createElement("a",{href:"https://twitchtracker.com/xqcow/statistics",target:"_blank",rel:"noopener noreferrer"},"Twitch Tracker")," ","to find out how long each Twitch streamer spent streaming during the time period used for the leaked figures (August 2019 to October 2021). We took the earnings for each streamer and divided it by the number of hours streamed. The average earnings for UK and US professions came from"," ",m.createElement("a",{href:"https://uk.talent.com/",target:"_blank",rel:"noopener noreferrer"},"Talent.com"),"."),m.createElement("hr",null),m.createElement("p",{className:k3},"Did you enjoy this deep dive into the incomes of popular Twitch streamers? Our team at Kapwing, an"," ",m.createElement("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener"},"online video editor"),", loves creating content related to video and internet culture. Learn and read much more on our"," ",m.createElement("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener"},"resources section")," ","and"," ",m.createElement("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener"},"blog"),".")))),m.createElement(HC,null))},R3=({statusCode:e=301,to:t,...a})=>m.createElement(Ke,{render:({staticContext:o})=>(o&&Object.assign(o,{statusCode:e,to:t}),m.createElement(Qt,{to:t,...a}))}),O3=()=>{Wd();!function(e){amplitude.getInstance().setUserProperties({...e,maxExportDurationNonPro:420})}(Bd())},D3="TeamLinkInviteAccept-module_backgroundContainer_ncF5H",L3="TeamLinkInviteAccept-module_contentContainer_DtXl1",U3="TeamLinkInviteAccept-module_logoContainer_skM6n",M3="TeamLinkInviteAccept-module_logoHeader_edtB7",F3="TeamLinkInviteAccept-module_header_zJTEC",B3="TeamLinkInviteAccept-module_description_bgeDF",W3="TeamLinkInviteAccept-module_acceptButton_ocHBo",V3="TeamLinkInviteAccept-module_acceptLoading_dlxau",j3=ie((({history:e,match:t})=>{const a=i.exports.useDispatch(),o=cn((e=>e.currentUser)),[r,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!0),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(""),[g,f]=n.exports.useState(!0),[y,E]=n.exports.useState(!1),_=oe(),v="from-joining"===new URLSearchParams(_.search).get("redirect");n.exports.useEffect((function(){const n=t.params.id,{token:r,user:i}=o||{},{_id:s}=i||{};ap(`/api/v1/invites/teams/check-invite-link/${n}`,{params:{token:r,userId:s}}).then((async t=>{if(t.canAccess){a(dg(t.teamId));const o=await a(IS());e.push(`/folder/${o}`)}else u(t.name),h(t.inviterEmail),f(!1),a(hg(t.inviterEmail)),a(gg(t.teamId)),Jh(i,t.teamId,t.inviterEmail,"Copied Link")})).catch((e=>{console.error(e),c(!1),f(!1)}))}),[o,a,e,t.params.id]);const w=n.exports.useCallback((async()=>{const{user:n}=o||{},{email:r}=n||{};if(om(o)){E(!0);const{token:n,user:s}=o||{},{_id:l}=s||{},c={token:n,userId:l,teamId:t.params.id};try{const t=await op("/api/v1/teams/invite-link/accept",{body:c});if(t.teamId){await a(_g());const e=Bu(),o=await ap(`/api/v2/payment/teamCheckoutData?teamId=${t.teamId}`);e&&Xh(s,p,r,"Copied Link",e,ig(o.subscription)),a(dg(t.teamId))}else E(!1),a(wh("Join response errored."));const o=await a(IS());e.push(`/folder/${o}`)}catch(i){E(!1),a(wh("There was an issue joining the team, please try again."))}}else s(!0)}),[o,a,e,t.params.id,p]);n.exports.useEffect((function(){v&&!g&&w()}),[w,v,g]);return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement("div",{className:D3},m.createElement("div",{className:L3},g?m.createElement(bk,null):m.createElement("div",null,m.createElement("div",{className:U3},m.createElement("img",{alt:"Kapwing kitten logo",className:M3,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp"})),l?m.createElement(m.Fragment,null,m.createElement("div",{className:F3},"Join ",d," on Kapwing"),m.createElement("div",{className:B3},"By joining this workspace, you will be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together!"),m.createElement("div",{className:B3},om(o)?m.createElement(m.Fragment,null," ","By continuing, you will join this workspace with the account"," ",m.createElement("b",null,o.user.email),"."):m.createElement(m.Fragment,null," ","By continuing, you will sign in and become a member of this workspace.")),y?m.createElement("div",{className:V3},m.createElement(bk,null)):m.createElement("div",{className:W3,onClick:w,id:"join-button"},"Join Team"),r?m.createElement(MC,{hideSignIn:()=>{s(!1)},onSuccess:w,immediateRedirectPathname:`${_.pathname}?redirect=from-joining`}):null):m.createElement(m.Fragment,null,m.createElement("div",{className:F3},"Invite link is invalid"),m.createElement("div",{className:B3},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),m.createElement(_e,{to:"/"},m.createElement("div",{className:W3,"data-cy":"home-button"},"Go Home")))))),m.createElement(HC,null))})),H3="TeamEmailInviteAccept-module_backgroundContainer_Ioq8R",G3="TeamEmailInviteAccept-module_contentContainer_PEggh",$3="TeamEmailInviteAccept-module_logoContainer_T-4Qu",K3="TeamEmailInviteAccept-module_logoHeader_pHn-x",Y3="TeamEmailInviteAccept-module_header_ov2-8",z3="TeamEmailInviteAccept-module_description_15PWB",q3="TeamEmailInviteAccept-module_acceptButton_IsW6e",J3="TeamEmailInviteAccept-module_acceptLoading_rE3XC",X3=ie((({history:e,match:t})=>{const a=i.exports.useDispatch(),o=cn((e=>e.currentUser)),[r,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!0),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(""),[g,f]=n.exports.useState(!0),[y,E]=n.exports.useState(!1),_=oe(),v="from-joining"===new URLSearchParams(_.search).get("redirect");n.exports.useEffect((function(){if(y)return;const{inviteKey:n}=t.params,{token:r,user:i}=o||{},{_id:s}=i||{};ap("/api/v1/teams/invites/checkLink",{params:{token:r,userId:s,inviteKey:n}}).then((async t=>{if(t.alreadyInTeam){a(dg(t.teamId));const o=await a(IS());e.push(`/folder/${o}`)}else u(t.name),h(t.inviterEmail),f(!1),a(hg(t.inviterEmail)),a(gg(t.teamId)),Jh(i,t.teamId,t.inviterEmail,"Email Invite Link")})).catch((e=>{console.error(e),c(!1),f(!1)}))}),[o,a,e,y,t.params]);const w=n.exports.useCallback((async()=>{const{user:n}=o||{},{email:r}=n||{};if(om(o)){E(!0);const{token:n,user:s}=o||{},{_id:l}=s||{},c={token:n,userId:l,inviteKey:t.params.inviteKey};try{const t=await op("/api/v1/teams/invites/accept",{body:c});if(t.teamId){const e=await ap(`/api/v2/payment/teamCheckoutData?teamId=${t.teamId}`),o=Bu();o&&Xh(s,p,r,"Email Invite Link",o,ig(e.subscription)),a(dg(t.teamId))}else E(!1),a(wh("Join response errored."));const o=await a(IS());e.push(`/folder/${o}`)}catch(i){E(!1),a(wh("There was an issue joining the team, please try again."))}}else s(!0)}),[o,a,e,t.params.inviteKey,p]);n.exports.useEffect((function(){!v||g||y||(E(!0),w())}),[w,v,g,y]);return m.createElement(m.Fragment,null,m.createElement(yD,null),m.createElement("div",{className:H3},m.createElement("div",{className:G3},g?m.createElement(bk,null):m.createElement("div",null,m.createElement("div",{className:$3},m.createElement("img",{alt:"Kapwing kitten logo",className:K3,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp"})),l?m.createElement(m.Fragment,null,m.createElement("div",{className:Y3},"Join ",d," on Kapwing"),m.createElement("div",{className:z3},"By joining this workspace, you will be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together!"),m.createElement("div",{className:z3},om(o)?m.createElement(m.Fragment,null," ","By continuing, you will join this workspace with the account"," ",m.createElement("b",null,o.user.email),"."):m.createElement(m.Fragment,null," ","By continuing, you will sign in and become a member of this workspace.")),y?m.createElement("div",{className:J3},m.createElement(bk,null)):m.createElement("div",{className:q3,onClick:w},"Join Team"),r?m.createElement(MC,{hideSignIn:()=>{s(!1)},onSuccess:w,immediateRedirectPathname:`${_.pathname}?redirect=from-joining`}):null):m.createElement(m.Fragment,null,m.createElement("div",{className:Y3},"Invite link is invalid"),m.createElement("div",{className:z3},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),m.createElement(_e,{to:"/"},m.createElement("div",{className:q3},"Go Home")))))),m.createElement(HC,null))})),Q3="InstalledPWAHome-module_background_ya0I9",Z3="InstalledPWAHome-module_backgroundImage_SC592",e4="InstalledPWAHome-module_signInContainer_LEoHq",t4="InstalledPWAHome-module_signInLogoContainer_6PvKS",a4="InstalledPWAHome-module_signInLogo_8Xyag",o4="InstalledPWAHome-module_signInText_VotiI",n4="InstalledPWAHome-module_text_CQ2oc",r4=()=>m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/"})),m.createElement("div",{className:Q3},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/home/Frame%202.png",alt:"",className:Z3}),m.createElement("div",{className:e4},m.createElement("div",{className:t4},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:a4,alt:"Kapwing Logo"})," ","KAPWING"),m.createElement("div",{className:o4},m.createElement("div",{className:n4},"Trusted by millions of users, Kapwing makes content creation and video editing smart, accessible, and collaborative. Sign in below to continue to the official Play Store app.")),m.createElement(PC,null))));class i4 extends n.exports.Component{render(){const{currentUser:e,currentFolderId:t,showWarning:a}=this.props;return om(e)?t?m.createElement(Qt,{to:{pathname:`/folder/${t}`,state:this.props.location.state}}):m.createElement(Qt,{to:{pathname:"/home",state:this.props.location.state}}):"undefined"!=typeof window?["4000"].includes(window.location.port)?(a("You're developing locally on localhost:4000. In prod, this page would refresh and show the NextJS home page as you are not currently signed in. If you want to test this behavior, run 'yarn nginx' in the root directory and use port 3000."),m.createElement(Qt,{to:"/signin"})):(window.location.reload(),null):m.createElement(ik,null)}}const s4=ie(i.exports.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace})),(e=>he({showError:wh,showWarning:Sh},e)))(i4));function l4(e){return navigator.clipboard.writeText(e)}const c4="TeamInviteByLink-module_subHeader_jIVzr",d4="TeamInviteByLink-module_linkContainer_3FyBt",u4="TeamInviteByLink-module_copyButton_OtV6H",m4="TeamInviteByLink-module_inviteLink_qQL3C",p4=({onCopy:e,teamId:t})=>{const a=cn((e=>e.currentUser)),o=i.exports.useDispatch(),[r,s]=n.exports.useState(""),l=n.exports.useRef(null),c=()=>{const{hostname:e}=window.location;return`${"localhost"===e?"localhost:3000":`https://${e}`}/team/sharing/${r}`},d=async e=>{l4(e).then((()=>o(bh("Invite link added to clipboard.")))).catch((()=>o(wh("Copy failed"))))};return n.exports.useEffect((()=>{const{token:e,user:o}=a||{},{_id:n}=o||{};ap(`/api/v1/invites/teams/get-invite-link/${t}`,{params:{token:e,userId:n}}).then((e=>{s(e.inviteLink)}))}),[a,t]),m.createElement(m.Fragment,null,m.createElement("div",{className:c4},"Invite By Link"),m.createElement("div",{className:d4},m.createElement("div",{className:m4,onClick:()=>{var t,a,o;d((null==(t=l.current)?void 0:t.innerHTML)||"");const n=document.createRange();l.current&&n.selectNode(l.current),null==(a=window.getSelection())||a.removeAllRanges(),null==(o=window.getSelection())||o.addRange(n),e&&e()},id:"inviteLink",ref:l},c()),m.createElement("div",{className:u4,onClick:()=>{r&&d(c()),e&&e()}},"Copy Link")))},h4="TeamInviteByEmail-module_disabled_pPDa7",g4="TeamInviteByEmail-module_title_ABxvY",f4="TeamInviteByEmail-module_emaillControlsContainer_JKa7k",y4="TeamInviteByEmail-module_emailControl_0yxNM",E4="TeamInviteByEmail-module_addMoreButton_8TAiT",_4="TeamInviteByEmail-module_emailControlError_PIRxp",v4="TeamInviteByEmail-module_emailControlErrorMessage_PHHI-",w4=({name:e,placeholder:t,value:a,isValid:o=!0,readOnly:n=!1,readOnlyMessage:r="",errorMessage:i="Invalid email address added. Please double check the entered email",onChange:s})=>m.createElement("div",null,!o&&m.createElement("p",{className:v4},i),m.createElement("input",{className:(()=>{let e=y4;return o||(e=`${e} ${_4}`),e})(),type:"text",name:e,key:e,placeholder:t,value:n?`${a} - ${r}`:a,readOnly:n,onChange:s,autoComplete:"do-not-autocomplete","data-cy":"team-invite-member-email-input"})),b4=({emails:e,setEmails:t,emailsPlaceholder:a,validateInviteEmail:o,emailExists:r})=>{const i=e=>r&&r(e.email)?"User is already a member of this workspace.":"Invalid email address added. Please double check the entered email.";return n.exports.useEffect((function(){if(e.length<4){const a=Array(4-e.length).fill(void 0).map((()=>({email:""})));t([...e,...a])}}),[e,t]),m.createElement(m.Fragment,null,m.createElement("div",{className:g4},"Invite by email"),m.createElement("div",{className:f4,"data-testid":"email-fields-container"},e.map(((n,r)=>m.createElement(w4,{key:r,name:`invite-by-email-input-${r}`,placeholder:a,value:n.email,isValid:n.isValid,readOnly:n.invited,readOnlyMessage:"invite pending",onChange:({target:a})=>{const{value:i}=a;n.email=i,!1===n.isValid&&(n.isValid=!i||o(i)),e[r]=n,t([...e])},errorMessage:i(n)})))),m.createElement("div",null,m.createElement("button",{className:`${E4} ${e.filter((e=>e.email.trim())).length<e.length?h4:""}`,type:"button",onClick:()=>{t([...e,{email:"",isValid:!0}])},"data-testid":"invite-by-email-add-more-button"},"+ Add more")))},S4="Upload-module_screenReaderOnlyLabel_baMDH",T4="Upload-module_uploadContainer_MYAJF",I4="Upload-module_uploadTextContainer_kXzce",k4="Upload-module_uploadText_stEqd",C4="Upload-module_uploadLabel_yZj96",N4="Upload-module_uploadLabelHeader_e0noq",A4="Upload-module_uploadLabelSubheader_m-oZq",x4=({acceptedFileTypes:e,handleMultiFileUpload:t,multiple:a,uploadPrompt:o="Click to Upload",uploadSubPrompt:n="or drag and drop a file here",customStyles:r={}})=>{const i=[r.uploadContainer||T4],s=C4,l=[r.uploadLabelHeader||N4],c=[A4],d=`upload-button-input-${F.v4()}`;return m.createElement("div",{className:i.join(" "),"data-cy":"upload-square"},m.createElement("label",{htmlFor:d,className:s},m.createElement("span",{className:S4},o),m.createElement("input",{"data-testid":"create-new-team-upload-input",id:d,accept:e,onChange:e=>{var a;return t(null==(a=null==e?void 0:e.target)?void 0:a.files)},type:"file",multiple:a}),m.createElement("div",{className:I4},m.createElement("div",{className:k4},m.createElement("div",{className:l.join(" ")},o),n&&m.createElement("div",{className:c.join(" ")},n)))))},P4=({hide:e,initialStep:t,onFinish:a=(()=>{}),entryPoint:o,setPendingInvites:r})=>{var s,l;const c=i.exports.useDispatch(),{executeRecaptcha:d}=ue(),[u,p]=n.exports.useState(t||0),[h,g]=n.exports.useState(!1),{currentUser:f,selectedTeamId:y,recaptchaKeyV3:E,recaptchaKeyV2:_}=cn((e=>({currentUser:e.currentUser,workspaceId:e.workspaces.selectedWorkspace,allTeams:e.teams.allTeams,selectedTeamId:e.teams.selectedTeamId,recaptchaKeyV3:e.config.RECAPTCHA_V3_SITEKEY,recaptchaKeyV2:e.config.RECAPTCHA_V2_SITEKEY})),dn),v=Ru(),w=Bu(),b=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription})),S=null==(s=null==w?void 0:w.users)?void 0:s.length,T=e=>{var t;for(const a of null!=(t=null==w?void 0:w.users)?t:[])if(e===a.email)return!0;return!1},[I,k]=n.exports.useState(null!=(l=null==w?void 0:w.name)?l:""),[C,N]=n.exports.useState(null),[A,x]=n.exports.useState([]),[P,R]=n.exports.useState(!1),O=n.exports.useRef(),D=Ru(),L=async()=>{if(C&&w){fm("Added Workspace Logo",{Origin:o});await ab(C,y)&&c(_g())}},U=e=>{k(e.target.value)},M=async()=>{if(I!==(null==w?void 0:w.name))try{fm("Added Workspace Name",{Origin:o}),c(pg(y,I)),c(Sg(y,{name:I}))}catch($ae){wh("Couldn't update team name.")}},B=e=>Zg(e)&&!T(e),W=(null!=S?S:0)>1?0:1,V=e=>{p(e)},j=async()=>{const e=$[u];await e.onNext()&&u<W&&V(u+1)},H=()=>{const e=$[u];return!!e&&e.disableConfirmButton()},G=()=>{u>0&&V(u-1)},$=[{name:"Review your workspace details",header:"Review your workspace details",mainButtonText:"Next",onNext:async()=>(g(!0),L(),M(),c(bh("Workspace information saved.")),(async()=>{const{state:e}=io(),t=await og(e.teams.selectedTeamId||"");if(!t)return;fm("Begin Workspace Share",{"Number of Workspace Members":t.totalTeamMembers,"Brandkit is set up":t.isBrandkitSetup,"Team ID":e.teams.selectedTeamId})})(),g(!1),!0),disableConfirmButton:()=>!(null==w?void 0:w.name),render:()=>m.createElement("div",{className:UO.form},m.createElement("label",{className:UO.inputLabel,htmlFor:"new-team-name"},"Workspace Name (we recommend using your team or organization name)"),m.createElement("input",{id:"new-team-name",type:"text",className:UO.textInput,value:I||"",onChange:U,placeholder:null==w?void 0:w.name,autoFocus:!0,required:!0,"data-testid":"new-team-name-input"}),m.createElement("label",{className:UO.inputLabel,htmlFor:"upload-logo"},"Workspace Logo (we recommend using a company or brand logo)"),m.createElement("div",{className:UO.uploadLogoContainer},m.createElement("div",{className:UO.logoPreview,"data-testid":"create-new-team-logo-preview"},C?m.createElement(m.Fragment,null,m.createElement("div",{className:UO.removeLogo,onClick:()=>{N(null)}},m.createElement(Ee,null)),m.createElement("img",{src:URL.createObjectURL(C),alt:"Your team's logo"})):m.createElement(jO,{suggestedWidth:120,suggestedHeight:120,className:UO.logoPreview,team:w})),m.createElement(x4,{multiple:!1,acceptedFileTypes:"image/jpg,image/jpeg,image/png,image/heic,image/heif,image/svg+xml,image/webp",handleMultiFileUpload:e=>((e,t)=>{if(null==e?void 0:e.length){const a=Kk(e[0]);(null==a?void 0:a.includes("image"))?t(new File([e[0]],`team_assets/${null==w?void 0:w.name}-${F.v4()}-${e[0].name}`,{type:e[0].type})):c(wh(`Your file type ${a} is not supported. Please upload an image.`))}})(e,N),uploadPrompt:"Upload new logo",uploadSubPrompt:"",customStyles:{uploadLabelHeader:UO.uploadLabelHeader}})))},{name:"Invite Members",header:m.createElement("div",{className:UO.textOverflowEllipsis},"Add Members to: ",m.createElement("strong",null,null==w?void 0:w.name)),description:m.createElement(m.Fragment,null,m.createElement("div",null,"Workspace members will gain access to all workspace folders and will be able to access and utilize your Brand Kit. You can manage workspace members in your Workspace Settings."),D.isMultiUser&&!D.planData.isFree&&m.createElement(m.Fragment,null,m.createElement("br",null),m.createElement("div",null,"Note: You will be charged for each member who joins your workspace."," ",m.createElement("a",{href:"/help/subscription-faq/",target:"_blank",rel:"noopener noreferrer"},"Visit our FAQ")," ","to learn more about how the Team Plan is billed."))),mainButtonText:()=>A.filter((e=>!!e.email)).length>0?"Invite Members":"Done",async onNext(){var t;if(A.length>0){const n=A.map((e=>({...e,isValid:!e.email||B(e.email)})));if(n.some((e=>!e.isValid)))return x(n),!1;const i=n.filter((e=>e.email&&!e.invited)).map((e=>e.email));i.length&&(g(!0),await(async e=>{var t;if(e.length<=0)return;const{token:a,user:o}=f,{_id:n}=o;if(h)return void c(wh("Please wait for pending sent emails to load first."));if(!d)return void c(wh("Recaptcha has not been loaded. Please wait a few seconds and try again."));const i=await d("teamInvite"),s=null==(t=O.current)?void 0:t.getValue(),l={emails:e,token:a,userId:n,teamId:null==w?void 0:w._id,v3CaptchaToken:i,v2CaptchaToken:s,recaptchaKeyV3:E};if(window.Cypress){try{await op("/api/v1/teams/invites",{body:{emails:e,token:a,userId:n,teamId:"60c0e1e9caa8fa004e9df1f7",cypress:!0}})}catch($ae){console.error($ae)}c(bh("Invites were sent successfully"))}else try{const t=await op("/api/v1/teams/invites",{body:l});if(c(bh("Invites were sent successfully")),x(A.map((({email:t,isValid:a,invited:o})=>({email:t,isValid:a,invited:o?!!o:e.includes(t)})))),t.notifError&&(c(Sh("Invites created but there was an error sending the notifications")),console.error(`Error sending team invite notifications: ${t.notifError}`)),r){const{token:e,user:t}=f||{},{_id:a}=t||{},o={token:e,userId:a,teamId:null==w?void 0:w._id},n=await ap("/api/v1/teams/invites",{params:o});r(n.invites)}}catch($ae){cf($ae)&&R(!0);let{message:t}=$ae;t||(t="An error has occurred when sending invites!"),c(wh(t))}})(i),g(!1),w&&ag({teamId:w._id,inviterEmail:null==(t=null==f?void 0:f.user)?void 0:t.email,origin:o,shareType:"send email",planTier:v.planTier,paymentTerm:v.paymentTerm,subscriptionStatus:ig(b),legacyMembers:Hh(w).length})),o===eg.USER_ONBOARDING&&fm("Completed Onboarding Flow"),e(),a()}return!1},disableConfirmButton:()=>A.some((e=>!1===e.isValid)),disableBackButton:!0,render:()=>m.createElement(m.Fragment,null,P&&m.createElement(pe,{sitekey:_,ref:O}),m.createElement(p4,{teamId:y,onCopy:()=>{var e;w&&ag({teamId:w._id,inviterEmail:null==(e=null==f?void 0:f.user)?void 0:e.email,origin:o,shareType:"send email",planTier:v.planTier,paymentTerm:v.paymentTerm,subscriptionStatus:ig(b),legacyMembers:Hh(w).length})}}),m.createElement(b4,{emails:A,setEmails:x,emailsPlaceholder:"name@company.com",validateInviteEmail:B,emailExists:T}))}],K=()=>{const t=$[u];return m.createElement(m.Fragment,null,m.createElement("div",{className:UO.background,onClick:()=>{o===eg.USER_ONBOARDING&&vf(),e()}}),m.createElement("div",{"data-testid":"add-members-modal","data-cy":"add-members-modal",onDragEnter:e=>e.stopPropagation(),onDragOver:e=>e.stopPropagation(),onDrop:e=>e.stopPropagation()},m.createElement("div",{className:UO.contentContainer},m.createElement("div",{className:UO.mainContent},m.createElement("div",{className:UO.header},t.header,m.createElement("div",{className:UO.closeContainer,onClick:()=>{o===eg.USER_ONBOARDING&&vf(),e()},"data-testid":"add-members-modal-close"},m.createElement(Ee,null))),t.description,(()=>{const e=$[u];return e?e.render():null})()),m.createElement("div",{className:UO.buttonsContainer},m.createElement(ux,{disabled:H(),confirmFn:j,loadingMsg:h?"Loading...":void 0,confirmText:(()=>{const{mainButtonText:e}=t;return e instanceof Function?e():e})(),cancelText:"Back",cancelFn:u>0&&!t.disableBackButton?G:void 0})),H()&&t.disabledConfirmButtonMessage&&m.createElement("div",{className:UO.disabledConfirmButtonMessage},t.disabledConfirmButtonMessage))))},Y=document.querySelector(".app-container");return Y?ye.createPortal(K(),Y):K()},R4="CreateFolderModal-module_background_295bd",O4="CreateFolderModal-module_contentContainer_5KSAF",D4="CreateFolderModal-module_mainContent_Ui0LH",L4="CreateFolderModal-module_inputLabel_zks-r",U4="CreateFolderModal-module_header_Hjfkx",M4="CreateFolderModal-module_closeContainer_-R3ri",F4="CreateFolderModal-module_buttonsContainer_uUsA0",B4="CreateFolderModal-module_textInput_rYUva",W4="CreateFolderModal-module_form_VAeB5";class V4 extends n.exports.Component{constructor(e){super(e),t(this,"handleSubmit",(async()=>{const{folderType:e}=this.props,{newFolderName:t}=this.state,a=(await hb(t,e))._id;this.setState({newFolderId:a}),this.hide()})),t(this,"hide",(()=>{const{history:e,hide:t}=this.props,{newFolderId:a,sending:o}=this.state;o||(t(),a&&e.push(`/folder/${a}`))})),t(this,"handleNameChange",(e=>{this.setState({newFolderName:e.target.value})})),this.state={sending:!1,newFolderId:null,newFolderName:""}}innerContent(){const{sending:e}=this.state;return m.createElement("label",{className:L4},m.createElement("form",{onSubmit:e=>{e.preventDefault(),this.handleSubmit()},className:W4},m.createElement("input",{type:"text",className:B4,value:this.state.newFolderName||"",onChange:this.handleNameChange,placeholder:"Untitled Folder",readOnly:e,autoFocus:!0,"data-cy":"new-workspace-input"})))}render(){const{sending:e}=this.state;return m.createElement(m.Fragment,null,m.createElement("div",{className:R4,onClick:this.hide}),m.createElement("div",{className:O4},m.createElement("div",{className:D4,"data-testid":this.props.folderType===Io.personal?"workspace-create-folder-modal-personal":"workspace-create-folder-modal-team"},m.createElement("div",{className:U4},"Create a New Folder",m.createElement("div",{className:M4,onClick:this.hide},m.createElement(Ee,null))),this.innerContent()),m.createElement("div",{className:F4},m.createElement(ux,{confirmFn:this.handleSubmit,loadingMsg:e?"Loading...":void 0,confirmText:"Finish",cancelText:"Back",cancelFn:void 0}))))}}const j4=i.exports.connect((e=>({allWorkspaces:e.workspaces.allWorkspaces,currentUser:e.currentUser,selectedTeamId:e.teams.selectedTeamId}))),H4=ie(j4((({...e})=>{const t=".app-container",a=document.querySelector(t);return a?ye.createPortal(m.createElement(V4,{...e}),a):(console.error(`Expected ${t} to exist in the DOM`),m.createElement(V4,{...e}))}))),G4="WorkspaceSideBar-module_tooltip_QieiF",$4="WorkspaceSideBar-module_addNewFolderToolTip_iz2SR",K4="WorkspaceSideBar-module_folderHeaderToolTip_gMbh-",Y4="WorkspaceSideBar-module_scrollableContainer_lse77",z4="WorkspaceSideBar-module_sideBarContainer_tdEkP",q4="WorkspaceSideBar-module_sidenavSubitem_2J31m",J4="WorkspaceSideBar-module_sharedHeader_-4Bqy",X4="WorkspaceSideBar-module_selSidenavSubitem_qKRsu",Q4="WorkspaceSideBar-module_sideHeader_Oh4sm",Z4="WorkspaceSideBar-module_sideHeaderCopy_d7Yds",e5="WorkspaceSideBar-module_lightgray_kUExU",t5="WorkspaceSideBar-module_moreSideHeader_bJdTm",a5="WorkspaceSideBar-module_hideOnShortScreens_iqzf8",o5="WorkspaceSideBar-module_selectedHeader_6R-17",n5="WorkspaceSideBar-module_sharedHeaderText_RkyE-",r5="WorkspaceSideBar-module_svgContainer_Q1UeI",i5="WorkspaceSideBar-module_svgIcon_o0Xaj",s5="WorkspaceSideBar-module_svgFolderIcon_OU86G",l5="WorkspaceSideBar-module_sharedFolderSvg_EzcMC",c5="WorkspaceSideBar-module_svgAddFolderIcon_x1cDo",d5="WorkspaceSideBar-module_sideNavProfImage_wfGl0",u5="WorkspaceSideBar-module_teamName_K-ZmZ",m5="WorkspaceSideBar-module_divider_3WPKd",p5="WorkspaceSideBar-module_spacer_I1ve9",h5="WorkspaceSideBar-module_addNewFolderContainer_dpS3p",g5="WorkspaceSideBar-module_svgSparkle_NIeRn",f5="WorkspaceSideBar-module_svgSparkleBrandkit_t3EGw",y5="WorkspaceSideBar-module_upsellBlock_NarqZ",E5="WorkspaceSideBar-module_sidebarTeamOptionContainer_7oa5n",_5="WorkspaceSideBar-module_nameContainer_YCcKH",v5="SuggestedWorkspacesModal-module_sectionHeader_WJsLT",w5="SuggestedWorkspacesModal-module_container_9OMjZ",b5="SuggestedWorkspacesModal-module_headerContainer_ln0ep",S5="SuggestedWorkspacesModal-module_maxWidth80_dnaqd",T5="SuggestedWorkspacesModal-module_contentContainer_6mb1w",I5="SuggestedWorkspacesModal-module_teamName_v3IDk",k5="SuggestedWorkspacesModal-module_numberCount_brjkW",C5="SuggestedWorkspacesModal-module_teamContainer_D-e6v",N5="SuggestedWorkspacesModal-module_teamInfoContainer_cgiah",A5="SuggestedWorkspacesModal-module_teamNameContainer_-CcXn",x5="SuggestedWorkspacesModal-module_center_OEdRQ",P5="SuggestedWorkspacesModal-module_primaryButton_z8bm2",R5="SuggestedWorkspacesModal-module_secondaryButton_5iMey",O5="SuggestedWorkspacesModal-module_tertiaryButton_mDz6U",D5="SuggestedWorkspacesModal-module_paddingBottom_cNCS9",L5="SuggestedWorkspacesModal-module_profilePicture_0kb8H",U5="SuggestedWorkspacesModal-module_paddingRight_MV3lJ",M5="SuggestedWorkspacesModal-module_skipButton_QoaXY",F5="SuggestedWorkspacesModal-module_gray_yr72f",B5="SuggestedWorkspacesModal-module_blue_lfv04",W5=({team:e,buttonAction:t,isRequest:a})=>{const[o,r]=n.exports.useState("");n.exports.useEffect((function(){var t;if(a){switch(null==(t=e.settings)?void 0:t.discoverability){case Vr.AnyoneCanJoin:r("Join now");break;case Vr.InvitationOnly:break;case Vr.RequestToJoin:default:r("Ask to join")}}else r("Accept invite")}),[]);return m.createElement("div",{className:C5},m.createElement("div",{className:N5},m.createElement(jO,{className:L5,team:e,absoluteHeight:40,absoluteWidth:40})," ",m.createElement("div",{className:`${A5} ${e.numberOfUsers?"":x5}`},m.createElement("div",{className:I5},e.name),m.createElement("div",{className:k5},e.numberOfUsers?`${e.numberOfUsers} ${hu("Member","Members",e.numberOfUsers)}`:""))),m.createElement("div",{className:`${(()=>{switch(o){case"Ask to join":return R5;case"Request sent":return O5;default:return P5}})()}`,onClick:()=>{"Request sent"!==o&&(t(),"Ask to join"===o&&r("Request sent"))}},"Request sent"===o&&m.createElement(Zt,{className:U5}),o))},V5=({exitOverlay:e})=>{const t=i.exports.useDispatch(),{allInvites:a,suggestedTeams:o,currentUser:r,currentTeam:s,selectedTeamId:l,suggestedWorkspaces:c,onboardingSurveyUsage:d,allTeams:u}=cn((e=>{var t,a,o,n;return{allInvites:e.teams.allInvites,suggestedTeams:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.teams,currentUser:e.currentUser,currentTeam:Bu(e),selectedTeamId:e.teams.selectedTeamId,suggestedWorkspaces:e.workspaces.suggestedWorkspaces,onboardingSurveyUsage:null==(n=null==(o=null==(a=e.currentUser)?void 0:a.user.onboarding)?void 0:o.survey)?void 0:n.usage,allTeams:e.teams.allTeams}}),dn),[p,h]=n.exports.useState(!1);n.exports.useEffect((function(){o||ez()}),[]),n.exports.useEffect((()=>{(async()=>{try{t(wg())}catch($ae){console.error($ae);const a=$ae.message||"There was a problem fetching your invites. Please try again later.";t(wh(a))}})()}),[t]);const g=()=>{((e,t)=>{const{numAskToJoin:a,numOpenToJoin:o}=Tf(t);fm("Dismiss Suggested Workspaces",{Domain:t.teams[0]?t.teams[0].emailDomain:"","Number Invite Workspaces":e,"Number Suggested Workspaces - Ask to Join":a,"Number Suggested Workspaces - Open to Join":o})})(a?a.length:0,null!=c?c:{teams:[],isQualifiedLead:!1}),wf(),e()};return m.createElement(kx,{unsetCancelModal:()=>{g()},usePortal:!0,noScrollBar:!0,noPadding:!0,style:{maxWidth:730}},m.createElement("div",{className:w5},m.createElement("div",{className:b5},m.createElement("img",{alt:"suggested workspaces logo",src:"https://cdn-useast1.kapwing.com/static/IQ1-Group-550.webp"}),m.createElement("div",{className:S5},"Keep all your projects in the same place and easily collaborate with your team on videos and brand assets by working together in a team workspace.")),m.createElement("div",{className:T5},a.length>0&&m.createElement("div",{"data-testid":"sw-pending-invites-section",className:D5},m.createElement("div",{className:v5},"Pending invites:"),null==a?void 0:a.map((e=>m.createElement(W5,{key:e.team._id,team:e.team,buttonAction:()=>{(async e=>{var o;const{token:n,user:i}=r||{},{_id:s}=i||{},c={token:n,userId:s,inviteKey:e.inviteKey};try{const n=await op("/api/v1/teams/invites/accept",{body:c});if(n.teamId){const i=`${l}`;t(bh("Invite accepted.")),t(mg([...a].filter((t=>t._id!==e._id)))),await t(_g()),t(dg(n.teamId)),await YO(n.teamId);const s=Bu();s&&Xh(r.user,e.inviterEmail,r.email,"Suggested Workspaces Modal",s,void 0);const c=u.find((e=>e._id===i));uf()&&1===(null==(o=null==c?void 0:c.users)?void 0:o.length)&&t(Ig(i))}}catch(d){console.error(d),t(wh(`There was an issue joining the team, please try again: ${d}`))}})(e),t(ry(my.None))}})))),o&&o.length>0&&"School"!==d&&m.createElement("div",{"data-testid":"sw-suggested-teams-section"},m.createElement("div",{className:v5},"Suggested workspaces",o&&o[0]&&o[0].emailDomain?` for @${o[0].emailDomain}`:"",":"),null==o?void 0:o.map((e=>m.createElement(W5,{key:e._id,team:e,buttonAction:()=>{var a,o,n;(null==(a=e.settings)?void 0:a.discoverability)!==Vr.RequestToJoin&&(null==(o=e.settings)?void 0:o.discoverability)||((async e=>{h(!0),await $h(e,r)})(e._id),Cf(kf.Onboarding,e._id,r)),(null==(n=e.settings)?void 0:n.discoverability)===Vr.AnyoneCanJoin&&((async e=>{try{if(!(await op(`/api/v2/teams/${e}/join`)).success)throw new Error;t(ry(my.None)),uf()&&1===(null==s?void 0:s.users.length)&&await t(Ig(l)),t(bh("Successfully joined team.")),t(_g()),t(dg(e)),await YO(e)}catch(a){t(wh("Something went wrong with joining the team, please try again later."))}})(e._id),t(ry(my.None)))},isRequest:!0})))),p?m.createElement("span",{className:`${M5} ${B5}`,onClick:()=>g()},"Continue ",">"):m.createElement("span",{className:`${M5} ${F5}`,onClick:()=>g()},"Skip for now ",">"))))},j5={personal:"Only you have access to these folders. Projects in these folders are private unless you share them.",team:"All workspace members have access to these folders.",shared:"Folders and projects others have shared with you will appear here."},H5=()=>m.createElement("svg",{className:l5,xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 24 24",width:"1em"},m.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),m.createElement("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10zm-5-5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-4 4h8v-1c0-1.33-2.67-2-4-2s-4 .67-4 2v1z"})),G5=()=>{var e,t;const a=G$(au.BRANDKIT);return m.createElement("div",{className:(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.href)?void 0:t.includes("/brandkit"))?X4:q4,onClick:()=>Ml("/brandkit"),"data-cy":"brandkit-button"},m.createElement(ta,{className:s5}),"Brand Kit"," ",!a&&m.createElement(fO,{className:f5}))},$5=({allWorkspaces:e,currentFolderId:t,openCreateFolderModal:a,sectionTitle:o,selectedTeamId:n,onMouseEnterHeader:r,onMouseLeaveHeader:i})=>{const s=Qw(e,n),l=Pu(),c=G$(au.CHANGE_PRIVACY);return m.createElement(m.Fragment,null,m.createElement("div",{className:Q4},m.createElement("span",{onMouseEnter:e=>r(e),onMouseLeave:i,"data-testid":"section-workspace-folders"},o),m.createElement("div",{onClick:()=>{c?a(Io.team):hO((()=>{}),{action:ou.CREATE_NEW_FOLDER,team:l})()},"data-cy":"new-workspace-button","data-testid":"workspace-new-folder-button-team",className:G4},m.createElement("div",{className:h5},m.createElement(aa,{className:c5}),!c&&m.createElement(fO,{className:g5})),m.createElement("span",{className:$4,"data-testid":"workspace-new-folder-tooltip-team"},"Create a new workspace folder"))),s.map((e=>{var a;return m.createElement(Y5,{id:e._id,name:e.name,currentFolderId:t,key:e._id,icon:l&&(null==(a=l.users)?void 0:a.length)>1?m.createElement(H5,null):m.createElement(oa,{className:s5})})})))},K5=({currentFolderId:e,openCreateFolderModal:t,onMouseEnterHeader:a,onMouseLeaveHeader:o,personalFolders:n,sectionTitle:r})=>{const i=G$(au.CREATE_NEW_FOLDER),s=Pu(),l=n.length>0;return m.createElement(m.Fragment,null,m.createElement("div",{className:`${Q4} ${l?"":e5}`},m.createElement("span",{onMouseEnter:e=>a(e),onMouseLeave:o},r),m.createElement("div",{onClick:()=>{i?t(Io.personal):hO((()=>{}),{action:ou.CREATE_NEW_FOLDER,team:s})()},"data-cy":"new-workspace-button-personal","data-testid":"workspace-new-folder-button-personal",className:G4},m.createElement("div",{className:h5},m.createElement(aa,{className:c5}),!i&&m.createElement(fO,{className:g5})),m.createElement("span",{className:$4,"data-testid":"workspace-new-folder-tooltip-personal"},"Create a new personal folder"))),!l&&m.createElement("div",{className:Z4},"Create your own private folder with projects only accessible to you unless you share them."),n.map((t=>m.createElement(Y5,{id:t._id,name:t.name,currentFolderId:e,key:t._id,icon:m.createElement(oa,{className:s5})}))))},Y5=({id:e,name:t,currentFolderId:a,icon:o})=>{var n,r;return m.createElement("div",{className:e===a&&(null==(r=null==(n=null==window?void 0:window.location)?void 0:n.href)?void 0:r.includes("/folder"))?X4:q4,onClick:()=>qO(e),"data-cy":"workspace-sidebar-link"},m.createElement("div",{className:r5},o),m.createElement("div",null,t))},z5=i.exports.connect((e=>({allWorkspaces:e.workspaces.allWorkspaces,currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,profile:e.currentUser.user,selectedTeamId:e.teams.selectedTeamId,workspaces:e.workspaces,allInvites:e.teams.allInvites})),(e=>he({setMenu:Mf},e))),q5=ie(z5((({allWorkspaces:e,currentUser:t,currentFolderId:a,selectedTeamId:o,width:r})=>{var s;const l=n.exports.useRef(null),{workspaceIsInSelectionMode:c,allTeams:d,showOnboardingUpsell:u,usageType:p}=cn((e=>{var t,a;return{workspaceIsInSelectionMode:e.workspaces.selectionMode,allTeams:e.teams.allTeams,showOnboardingUpsell:e.workspaces.showOnboardingUpsell,usageType:null==(a=null==(t=e.currentUser.user.onboarding)?void 0:t.survey)?void 0:a.usage}}),dn),h=i.exports.useDispatch(),g=Fe(),f=Pu(),y=vO(),[E,_]=n.exports.useState(!1),[v,w]=n.exports.useState((null==(s=g.location.state)?void 0:s.redirectSource)===YF.TEAMS),[b,S]=n.exports.useState(Io.team),[T,I]=n.exports.useState(),k=n.exports.useRef(),[C,N]=n.exports.useState(!1),A=G$(au.CREATE_NEW_FOLDER);n.exports.useEffect((function(){if(!window.sessionStorage.getItem("TEAM_WORKSPACE_ACCESS_LOGGED")&&o&&"personal"!==o){const{paymentPlan:e,teamSubscription:t}=sg();zh(o,e.planTier,e.paymentTerm,ig(t),Hh(f).length)}})),n.exports.useEffect((()=>{var e,t;!a||(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.href)?void 0:t.includes("/team"))||"shared-with-me"!==a&&!XO(a)?N(!1):N(!0)}),[a,o]);const x=e=>{c||(_(!0),S(e))},P=()=>{w(!1)},R=(e,t)=>{var a,o,n;k.current&&clearTimeout(k.current);const r=(null==(n=null==(o=null==(a=e.target)?void 0:a.getBoundingClientRect)?void 0:o.call(a))?void 0:n.y)||0;k.current=window.setTimeout((()=>{I({headerYPos:r,headerType:t})}),350)},O=()=>{k.current&&clearTimeout(k.current),I(void 0)},D=Xw(e,o);return m.createElement("div",{className:z4,style:{width:r},"data-cy":"workspace-sidebar-container"},T&&m.createElement("div",{className:K4,style:{bottom:window.innerHeight-T.headerYPos+5}},j5[T.headerType]),f.stripeId&&m.createElement(Z$,{className:y5,entryPoint:tg.WORKSPACE_PAST_DUE_BANNER}),!A&&!(null==y?void 0:y.cancel_at_period_end)&&m.createElement("div",{className:y5},m.createElement(H$,{action:ou.SIDEBAR,topLeftImg:!0,testId:"workspace-sidebar-upsell-block"})),m.createElement("div",{className:Y4},m.createElement(_e,{to:`/team/${o}/members`},m.createElement("div",{className:window.location.href.includes("/members")?X4:q4},m.createElement(ra,{className:s5}),"Members")),m.createElement(G5,null),m.createElement(_e,{to:`/team/${o}/settings`,"data-cy":"team-settings-link","data-testid":"team-settings-link"},m.createElement("div",{className:window.location.href.includes("/team/")&&window.location.href.includes("/settings")?X4:q4},m.createElement(na,{className:s5}),"Settings")),m.createElement($5,{allWorkspaces:e,currentFolderId:a,selectedTeamId:o,sectionTitle:"Team Folders",openCreateFolderModal:x,selectionModeIsActive:c,onMouseEnterHeader:e=>R(e,"team"),onMouseLeaveHeader:O}),m.createElement(K5,{allTeams:d,currentFolderId:a,currentUser:t,onMouseEnterHeader:e=>R(e,"personal"),onMouseLeaveHeader:O,openCreateFolderModal:x,personalFolders:D,sectionTitle:"Private Folders",selectionModeIsActive:c})),m.createElement("div",{className:p5}),m.createElement("div",{"data-testid":"workspace-sidebar-divider",className:m5}),m.createElement("div",{className:`${J4} ${C?o5:""}`,"data-cy":"shared-with-me-nav",onClick:()=>JO("Sidebar")},m.createElement("div",{className:r5},m.createElement(ea,{className:i5})),m.createElement("div",{className:n5,onMouseEnter:e=>R(e,"shared"),onMouseLeave:O},"Shared with Me")),m.createElement("div",{className:a5},m.createElement("div",{className:`${Q4} ${t5}`},"More"),m.createElement("a",{href:"/templates","data-cy":"templates-sidebar-link"},m.createElement("div",{className:q4},m.createElement("div",{className:r5},m.createElement(ia,{className:i5})),"Templates")),m.createElement("a",{href:"/tools","data-cy":"templates-sidebar-link"},m.createElement("div",{className:q4},m.createElement("div",{className:r5},m.createElement(sa,{className:i5})),"Tools"))),m.createElement("div",{className:a5},m.createElement("a",{href:"/pricing","data-cy":"pricing-sidebar-link"},m.createElement("div",{className:q4},m.createElement("div",{className:r5},m.createElement(la,{className:i5})),"Pricing")),m.createElement("a",{href:"https://www.kapwing.com/resources"},m.createElement("div",{className:q4},m.createElement("div",{className:r5},m.createElement(ca,{className:i5})),"Resources"))),E&&m.createElement(H4,{hide:()=>{var e;_(!1),null==(e=null==l?void 0:l.current)||e.scrollTo(0,0)},folderType:b}),v&&m.createElement(P4,{hide:()=>{P()},initialStep:1,entryPoint:eg.SIDEBAR}),u===my.SuggestedWorkspaces&&m.createElement(V5,{exitOverlay:()=>{h(ry(p))}}),(u===my.Work||u===my.PersonalProjects)&&m.createElement(P4,{hide:()=>{P(),hO((()=>{}),{action:ou.ONBOARDING_SURVEY,team:f})(),h(ry(my.None))},initialStep:0,onFinish:()=>{hO((()=>{}),{action:ou.ONBOARDING_SURVEY,team:f})(),h(ry(my.None))},entryPoint:eg.USER_ONBOARDING}))}))),J5=e=>{const t=cn((e=>e.currentUser)),a=mJ(),o=Pu(),n=sm(t),r=e||o;return r._id===(null==a?void 0:a._id)&&n&&r.planTier!==jd.FREE},X5="PlanPill-module_pillWrapper_ZbfW3",Q5="PlanPill-module_planPillWrapper_h9j4J",Z5="PlanPill-module_largePill_fUWec",e9={freePlanContainer:"paymentPlan-module_freePlanContainer_0zgbl",basicPlanContainer:"paymentPlan-module_basicPlanContainer_tQnEP",proPlanContainer:"paymentPlan-module_proPlanContainer_g1vaU",teamPlanContainer:"paymentPlan-module_teamPlanContainer_SPsPO",eduPlanContainer:"paymentPlan-module_eduPlanContainer_OynnD",legacyContainer:"paymentPlan-module_legacyContainer_vZNMq",freeBackground:"paymentPlan-module_freeBackground_XFm70",basicBackground:"paymentPlan-module_basicBackground_wDB3e",proBackground:"paymentPlan-module_proBackground_51Vv3",teamBackground:"paymentPlan-module_teamBackground_JZOd8",eduBackground:"paymentPlan-module_eduBackground_4w2KL"},t9=({isLegacy:e,showLegacy:t,overrideTeam:a,large:o,planTier:n})=>{const r=Pu();let i=Ru(a?{team:a}:void 0);n&&(i=Iu(n));const s=a||r,l=J5(s);if(e)return a9();const c=[Q5,e9[`${l?"edu":i.planTierClassName}PlanContainer`]];return o&&c.push(Z5),m.createElement("div",{className:X5},m.createElement("div",{className:c.join(" ")},t&&(null==(d=null==s?void 0:s.users)?void 0:d.some((e=>e.isLegacy)))?`Legacy ${i.displayPlanTier} Plan`:l?"Edu Plan":`${i.displayPlanTier} Plan`));var d},a9=()=>m.createElement("div",{className:X5},m.createElement("div",{className:`${Q5} ${e9.legacyContainer}`},"Legacy")),o9="WorkspaceNotifications-module_iconContainer_l0Qao",n9="WorkspaceNotifications-module_bellIcon_tBeeA",r9="WorkspaceNotifications-module_alertCircle_6kM8K",i9="WorkspaceNotifications-module_notifContainer_bnFNU",s9="WorkspaceNotifications-module_mobileNotifContainer_TKKI0",l9="WorkspaceNotifications-module_notifHeader_rUAuJ",c9="WorkspaceNotifications-module_settingsGear_j9nXA",d9="WorkspaceNotifications-module_notifListContainer_WJ5Au",u9="WorkspaceNotifications-module_notification_fQI3Z",m9="WorkspaceNotifications-module_iconAndMessageConatiner_RY-6x",p9="WorkspaceNotifications-module_notifIconContainer_SUWHu",h9="WorkspaceNotifications-module_unreadNotifCircle_OqM3R",g9="WorkspaceNotifications-module_notifIcon_q0SUX",f9="WorkspaceNotifications-module_exportSuccessIcon_cf4XZ",y9="WorkspaceNotifications-module_exportFailureIcon_nNUC1",E9="WorkspaceNotifications-module_notifMessageContainer_P2wmh",_9="WorkspaceNotifications-module_exportMessage_R2W70",v9="WorkspaceNotifications-module_notifName_L0lrL",w9="WorkspaceNotifications-module_notifLink_RGLcK",b9="WorkspaceNotifications-module_notifTimeStamp_lmFtg",S9="WorkspaceNotifications-module_emptyNotifContainer_J-gL4",T9="WorkspaceNotifications-module_emptyIconContainer_tXhcm",I9="WorkspaceNotifications-module_emptyNotifIcon_zDL4t",k9="WorkspaceNotifications-module_emptyNotifMessage_lqrnK",C9=({openAccountSettings:e})=>{const t=Fe(),a=i.exports.useDispatch(),o=ed(),r=cn((e=>e.notifications.notifications)),[s,l]=n.exports.useState(!1),c=n.exports.useRef([]),d=n.exports.useRef(null),u=n.exports.useRef(null);n.exports.useEffect((function(){const e=e=>{var t,a;(null==(t=d.current)?void 0:t.contains(e.target))||(null==(a=u.current)?void 0:a.contains(e.target))||l(!1)};return s?(document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}):()=>{}}),[s]);const p=n.exports.useCallback((()=>{c.current.length&&(a(cT(c.current)),c.current=[])}),[a]);n.exports.useEffect((()=>{(async()=>{var e;if(s){const a=null==(e=null==r?void 0:r.filter((e=>e.state!==Nr.read)))?void 0:e.map((e=>e._id));if(null==a?void 0:a.length)try{await Zm("api/v1/notifsRead",{body:{notifIds:JSON.stringify(a)}})&&a.forEach((e=>c.current.push(e.toString())))}catch(t){console.error(t)}}else p()})()}),[a,r,s,p]);const h=(null==r?void 0:r.filter((e=>e.state!==Nr.read)).length)||0;return m.createElement(m.Fragment,null,m.createElement("div",{className:o9,ref:u,onClick:()=>{s||fm("Notifications Opened",{unreadNotifs:h,readNotifs:r?r.length-h:0}),l(!s)},"data-testid":"ws-header-notifs-icon"},!!h&&m.createElement("div",{className:r9},h),m.createElement(Mt,{className:n9,size:18})),s&&m.createElement("div",{className:`${i9} ${o?s9:""}`,ref:d},m.createElement("div",{className:l9},m.createElement("div",null,"Notifications"),m.createElement("div",null,m.createElement(da,{className:c9,size:20,onClick:e}))),(null==r?void 0:r.length)?m.createElement("div",{className:d9},null==r?void 0:r.map((e=>m.createElement("div",{className:u9,key:e._id.toString(),onClick:()=>{p();const o={notificationType:e.info.type};if(e.info.type===Cr.Invite&&(o.inviteType=e.info.inviteType),fm("Notification Clicked",o),e.info.type===Cr.Invite&&e.info.inviteType===Ar.project){const t=`${window.location.protocol}//${bQ()}${e.info.link} `;window.location.href=t}else e.info.type===Cr.Request?(a(dg(e.info.teamId)),t.push(`/team/${e.info.teamId}`)):e.info.type===Cr.Welcome?YO(e.info.teamId):e.info.type===Cr.Joined?t.push(e.info.teamSettingsPath):t.push(e.info.link)}},(e=>{let t,a;const o=e.createdAt?`${Ph(new Date(e.createdAt),"moments")} ago`:null;if(e.info.type===Cr.Export)e.info.success?(a=m.createElement("span",{className:_9},"Your export"," ",m.createElement("span",{className:w9},e.info.projectName)," is finished"),t=m.createElement("div",{className:f9},m.createElement("span",null,"🎉"))):(a=m.createElement("span",{className:_9},"Your project"," ",m.createElement("span",{className:w9},e.info.projectName)," ","failed to export"),t=m.createElement("div",{className:y9},m.createElement("span",null,"🙁")));else if(e.info.type===Cr.Comment){const{commenterName:o,projectName:n,commenterIcon:r,commentReply:i}=e.info;a=m.createElement(m.Fragment,null,m.createElement("span",{className:v9},o)," ",m.createElement("br",null),m.createElement("span",null,i?"replied to your comment on ":"commented on "),m.createElement("span",{className:w9},n)),t=m.createElement(jO,{user:{name:o,picture:r,pending:!1},className:g9})}else if(e.info.type===Cr.Invite){const{inviterName:o,inviterIcon:n,inviteType:r,sharedName:i}=e.info;a=m.createElement(m.Fragment,null,m.createElement("span",{className:v9},o),m.createElement("br",null),"invited you to ",r," ",m.createElement("span",{className:w9},i)),t=m.createElement(jO,{user:{name:o,picture:n,pending:!1},className:g9})}else if(e.info.type===Cr.Request){const{requestType:o,requesterName:n,requesterIcon:r,sharedName:i}=e.info;a=m.createElement(m.Fragment,null,m.createElement("span",{className:v9},n),m.createElement("br",null),"requested to join your ",o," ",m.createElement("span",{className:w9},i)),t=m.createElement(jO,{user:{name:n||"",picture:r,pending:!1},className:g9})}else if(e.info.type===Cr.Joined){const{info:{email:t,joinedFullName:o,teamName:n}}=e;a=m.createElement(m.Fragment,null," ",m.createElement("span",{className:v9},o,"(",t,")"),m.createElement("br",null)," joined ",m.createElement("span",{className:w9},n)," ")}else if(e.info.type===Cr.Welcome){const{info:{teamName:t}}=e;a=m.createElement(m.Fragment,null," ",m.createElement("span",{className:v9},"Welcome to your new team:"),m.createElement("span",{className:w9},t)," ")}return m.createElement(m.Fragment,null,m.createElement("div",{className:m9},m.createElement("div",{className:p9},e.state!==Nr.read&&m.createElement("div",{className:h9}),t),m.createElement("div",{className:E9},a)),m.createElement("div",{className:b9},m.createElement("span",null,o)))})(e))))):m.createElement("div",{className:S9},m.createElement("div",{className:T9},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/s5N-empty-notifs.svg",alt:"empty inbox icon",className:I9})),m.createElement("div",{className:k9},"No notifications yet!"))))},N9="WorkspaceHeader-module_textOverflowEllipsis_eHQzX",A9="WorkspaceHeader-module_currentWorkspaceInfo_nUtay",x9="WorkspaceHeader-module_workspaceName_sWcam",P9="WorkspaceHeader-module_profileImage_SRIjq",R9="WorkspaceHeader-module_profileImageWithEmail_5GxPc",O9="WorkspaceHeader-module_menuIcon_azxw-",D9="WorkspaceHeader-module_menu_C9Hhq",L9="WorkspaceHeader-module_headerLinkText_js9U8",U9="WorkspaceHeader-module_headerActiveLinkText_Y9uvw",M9="WorkspaceHeader-module_headerBarEmpty_9huxh",F9="WorkspaceHeader-module_impersonating_v4SUA",B9="WorkspaceHeader-module_headerRight_Tntbn",W9="WorkspaceHeader-module_headerLeft_D4PsW",V9="WorkspaceHeader-module_menuLogoImage_AnaRY",j9="WorkspaceHeader-module_headerBarLogoText_Krr1R",H9="WorkspaceHeader-module_signedInContainer_Fx3ej",G9="WorkspaceHeader-module_accountName_YIPKI",$9="WorkspaceHeader-module_accountNameWithEmail_dg3Mz",K9="WorkspaceHeader-module_email_TnGZ8",Y9="WorkspaceHeader-module_accountLink_Q6V69",z9="WorkspaceHeader-module_badges_G8a5R",q9="WorkspaceHeader-module_pill_NUIqh",J9="WorkspaceHeader-module_mobilePills_im3Gc",X9="WorkspaceHeader-module_workspaceThumbnail_eWp7l",Q9="WorkspaceHeader-module_members_fp3yC",Z9="WorkspaceHeader-module_membersInfo_TYFHJ",e7="WorkspaceHeader-module_facePile_572DB",t7="WorkspaceHeader-module_face_qcN5H",a7="WorkspaceHeader-module_inviteMembersButton_-CS4o",o7="WorkspaceHeader-module_plusIcon_qqRFT",n7=({users:e,url:t})=>{var a;const o=e.slice(0,5),n=null!=(a=e.length)?a:0;return m.createElement(_e,{to:t},m.createElement("div",{className:Z9},m.createElement("div",{className:e7,"data-testid":"facepile-container"},null==o?void 0:o.map((e=>m.createElement(jO,{user:e,className:t7,key:e._id})))),m.createElement("div",{"data-testid":"facepile-additional"},n>5?"+"+(n-5):"")))},r7=({openAccountSettings:e})=>{const{currentUser:t,currentFolderId:a,selectedTeamId:o}=cn((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,selectedTeamId:e.teams.selectedTeamId})),dn),[r,i]=n.exports.useState(!1),[s,l]=n.exports.useState(!1),c=ed(),d=n.exports.useRef(null),u=Fe(),p=oe(),h=Ru(),g=Pu(),f=(()=>{const e=Zc("(max-width: 980px)"),t=ed(),[a,o]=n.exports.useState(e&&!t);return n.exports.useEffect((()=>{const n=e&&!t;n!==a&&o(n)}),[a,e,t]),a})();n.exports.useEffect((()=>{i(!1)}),[p]);const y=e=>{var t;const a=e.target;d&&d.current&&(null==(t=d.current)?void 0:t.contains(a))||i(!1)};n.exports.useEffect((()=>(document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)})),[]);const E=()=>om(t)?a?`/folder/${a}`:"/home":"/",_=e=>{e.stopPropagation(),h.planTier===jd.FREE&&hO((()=>null),{action:ou.HEADER})(),u.push({pathname:`/team/${g._id}/billing`})},v=M9+(Xg(t)?` ${F9}`:"");return m.createElement("div",{className:v},m.createElement("div",{className:W9},c?m.createElement(m.Fragment,null,m.createElement(_e,{to:E(),"data-testid":"ws-header-mobile-home-link"},m.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",alt:"Kapwing Logo",className:V9,"data-cy":"header-logo",height:20})),r?m.createElement(Ee,{"data-cy":"mobile-nav-menu-toggle",className:O9,onClick:()=>{i(!r)}}):m.createElement(We,{"data-cy":"mobile-nav-menu-toggle",className:O9,onClick:()=>{i(!r)}}),r?m.createElement("div",{className:D9,ref:d},m.createElement(_e,{className:j9,to:E()},"KAPWING"),m.createElement(m.Fragment,null,m.createElement(HO,null,om(t)?m.createElement(Be,{className:L9,activeClassName:U9,to:E(),"data-cy":"workspace-nav-link"},"Workspace"):null),m.createElement("a",{className:L9,href:"/tools","data-cy":"tools-nav-link"},"Tools"),m.createElement("a",{className:L9,href:"/templates","data-cy":"templates-nav-link"},"Templates"),m.createElement("a",{className:L9,href:"/pricing","data-cy":"pricing-nav-link"},"Pricing"),m.createElement("a",{className:L9,target:"_self",href:"https://www.kapwing.com/resources"},"Resources"),m.createElement("a",{className:L9,href:"/teams","data-cy":"teams-nav-link"},"Teams"))):null):m.createElement("div",{className:A9,"data-testid":"ws-header-left"},m.createElement("div",{onClick:()=>YO(g._id),"data-testid":"team-workspace-logo"},m.createElement(jO,{team:g,className:X9})),m.createElement("div",{className:x9,"data-cy":"team-workspace-name","data-testid":"team-workspace-name",onClick:()=>YO(g._id)},m.createElement("span",{className:N9},null==g?void 0:g.name)),m.createElement("div",{className:z9},m.createElement("div",{"data-cy":"upgrade-label-header",className:q9,onClick:_,"data-testid":"ws-header-plan-pill-container"},m.createElement(t9,null)),m.createElement(FO,{className:q9,entryPoint:tg.WORKSPACE_HEADER}),h.showUpgrades&&m.createElement("div",{"data-testid":"ws-header-upgrade-container"},m.createElement(_O,null))))),m.createElement(HO,null,m.createElement("div",{className:B9},m.createElement("div",{className:Q9},(null==g?void 0:g.users.length)&&m.createElement(n7,{users:g.users,url:`/team/${o}/members`}),!sm(t)&&m.createElement(W$,{buttonText:f?"":"Invite Members",icon:m.createElement("div",{className:o7},f?m.createElement(ma,null):m.createElement(ua,null)),onClick:()=>{h.isMultiUser&&!Uu(h.planTier,g)?l(!0):hO((()=>null),{action:ou.INVITE_MEMBERS})()},className:a7,testId:"ws-header-invite-members-button"})),c&&m.createElement("div",{className:J9,"data-testid":"ws-header-mobile-pills"},m.createElement("div",{className:q9},m.createElement(t9,null)),m.createElement(FO,{className:q9,entryPoint:tg.WORKSPACE_HEADER}),h.showUpgrades&&m.createElement("div",{className:q9},m.createElement(_O,null))),m.createElement(C9,{openAccountSettings:e}),(()=>{const a=dm(t),o=um(t);return m.createElement("div",{className:H9,"data-testid":"ws-header-signin-container"},m.createElement("div",{className:L9,"data-cy":"account-nav-link","data-testid":"ws-header-account-link",onClick:()=>{null==e||e()}},m.createElement("div",{className:Y9},!c&&m.createElement("div",null,m.createElement("div",{className:o?$9:G9,"data-testid":"ws-header-name-container"},a||"My Account"),!c&&o&&m.createElement("div",{className:K9,"data-testid":"ws-header-email-container"},o)),m.createElement("div",null,m.createElement(jO,{suggestedWidth:300,suggestedHeight:300,className:o?R9:P9})))))})()),s&&m.createElement(P4,{hide:()=>{l(!1)},initialStep:1,entryPoint:eg.WORKSPACE_HEADER})))},i7="PaymentHistory-module_row_JKZ4J",s7="PaymentHistory-module_chargeName_MyvpK",l7="PaymentHistory-module_chargeAmount_aJXSA",c7="PaymentHistory-module_chargeReceipt_PPP-m",d7="PaymentHistory-module_chargeDate_-M4nE",u7="PaymentHistory-module_content_lYb2M",m7="PaymentHistory-module_loadingContainer_AN9O-",p7="PaymentHistory-module_loader_uX5fT",h7=e=>{const{charges:t,loadingBilling:a,stripeId:o,getPaymentHistory:r}=e,[i,s]=n.exports.useState(!!t);n.exports.useEffect((()=>{o&&!i&&(s(!0),r())}),[i,r,s,o]);return a||!i?m.createElement("div",{className:m7},"Loading billing history ... ",m.createElement("div",{className:p7})):t&&t.length?m.createElement("div",null,t.map((e=>m.createElement("div",{className:i7,key:e.id},m.createElement("div",{className:s7},e.description),m.createElement("div",{className:d7},Mh(e.created)),m.createElement("div",{className:l7},(e.amount/100).toLocaleString("en-US",{style:"currency",currency:"USD"})),m.createElement("div",{className:c7},e.receipt_url&&m.createElement("a",{href:e.receipt_url,target:"_blank",rel:"noopener noreferrer"},"View receipt")))))):m.createElement("div",null,m.createElement("div",{className:u7},"No payments to show. If you purchased a plan for your workspace, your transaction history will show up here."))};function g7(e){return ap("/api/v2/customer",{params:{teamId:e}})}async function f7(e){const{dispatch:t}=io(),a=await ap("/api/v2/payment/charges",{params:{teamId:e}});return!a.success&&a.stripeDevEnvError?(t(Sh("<Dev only message>: You are trying to view a Stripe subscription that was not purchased in the same environment you are currently using. To see live subscriptions, please view this page on kapwing.com. To see test card subscriptions, please view this page on kapwing-dev.com.")),console.warn("Could not fetch Stripe subscription from live/test mode. If viewing a live subscription, please go to kapwing.com. If trying to view a subscription purchased with a test card, go to kapwing-dev.com."),[]):a}const y7="ChooseTeamModal-module_teamRow_A5je1",E7="ChooseTeamModal-module_flexWrapper_XC-qp",_7="ChooseTeamModal-module_teamRowName_eP6WV",v7="ChooseTeamModal-module_teamName_46eme",w7="ChooseTeamModal-module_workspaceThumbnail_5hNAl",b7=({team:e,planTier:t,onClick:a,buttonText:o="Upgrade"})=>{const n=t&&Eu(t),r=n&&n.isMultiUser,i=t&&!r&&e.users.length>1;return m.createElement("div",{className:y7},m.createElement(jO,{team:e,className:w7}),m.createElement("div",{className:E7},m.createElement("div",null,m.createElement("div",{className:_7},m.createElement("div",{className:v7},e.name),m.createElement(t9,{overrideTeam:e})),m.createElement("div",null,e.users.length," ",hu("Member","Members",e.users.length))),a&&m.createElement(ZR,{overrideColor:"inverse",onClick:a,disabled:i},o)))},S7="PlanDetails-module_sectionHeader_AYWxs",T7="PlanDetails-module_genericButtonBlue_xUblM",I7="PlanDetails-module_planInfo_nFws0",k7="PlanDetails-module_planInfoTop_166rm",C7="PlanDetails-module_pastDueHeader_t8yH4",N7="PlanDetails-module_inlineButton_2pXsI",A7="PlanDetails-module_pastDueContainer_-xHU1",x7="PlanDetails-module_planDetails_VRx9V",P7="PlanDetails-module_teamPlanContainer_pm-XT",R7="PlanDetails-module_freePlanContainer_-QwQu",O7="PlanDetails-module_freePlanName_zUBRw",D7="PlanDetails-module_splitPlanSection_FAZs3",L7="PlanDetails-module_splitPlanSectionDetails_Bjf1k",U7="PlanDetails-module_planPillRow_h7uAS",M7="PlanDetails-module_changeTerm_W4cIt",F7="PlanDetails-module_termSave_7G29o",B7="PlanDetails-module_planItem_taxlJ",W7="PlanDetails-module_bottomButtonWrapper_1Mgl-",V7="PlanDetails-module_updateInvoiceButton_66BZK",j7="PlanDetails-module_reactivateTeamPlan_6tAYY",H7="PlanDetails-module_reactivatingTeamPlan_rjxSz",G7=e=>{const{team:t,stripeId:a,loadingPlan:o,openBillingDetails:r,openChangePaymentTerm:s,openUpdatePaymentOverlay:l,onRefresh:c,fromAccountSettings:d,isAdmin:u}=e,p=i.exports.useDispatch(),h=Fe(),g=cn((e=>e.currentUser)),[f,y]=n.exports.useState(!1),E=cn((e=>e.teams.allTeams.filter((e=>e.stripeId&&e.stripeId===a))),((e,t)=>e.join("")===t.join(""))),_=Pu(),v=E.length&&d?E[0]:_,w=Ru(v?{team:v}:void 0),b=!!v&&Uu(w.planTier,v),S=vO(a,v._id),T=(null==S?void 0:S.current_period_start)&&C(1e3*S.current_period_start).format("ddd, MMM D, YYYY"),I=S&&C(1e3*S.current_period_end).format("ddd, MMM D, YYYY"),k=S&&C(1e3*S.current_period_end).format("ddd, MMM D, YYYY"),N=cn((e=>e.teams.allTeams)),A=Fu(N,g.user.stripeId),x=d||g.user.stripeId===(null==S?void 0:S.customer),P=J5(),R=async()=>{var e,a,o,n;if(S&&!f){y(!0);try{await p((o=S.id,n=v._id,async(e,t)=>{const{currentUser:a,teams:r}=t(),{token:i,user:s}=a||{},l=null==r?void 0:r.allTeams.find((e=>e._id===n)),c=null==l?void 0:l.stripeId,d={subscriptionId:o,stripeId:c,token:i,userId:s._id,teamId:n},u=await op("/api/v2/payment/reactivateTeamSubscription",{body:d});return e(up(n,!0)),u})),c();const r="month"===(null==(e=null==S?void 0:S.plan)?void 0:e.interval)?Vd.MONTHLY:Vd.ANNUALLY,i=(null==(a=null==S?void 0:S.plan)?void 0:a.nickname)||jd.PRO;wm({couponId:null,isAnonUpgrade:!1,paymentTerm:r,planTier:i,paymentProcessor:"Stripe",checkoutType:ru.REGULAR,upgradeSource:ou.REACTIVATE_LICENSE,extraAmplitudeEventProperties:{},currentPlan:i,upgradePlan:w.planTier,teamId:v._id,quantity:t?t.users.length:1}),p(bh("Your subscription has been reactivated, but you will not be charged until the renewal date."))}catch(r){p(wh(r.message))}y(!1)}},O=()=>{s()},D=()=>w.paymentTerm!==Vd.NO_TERM&&u?Uu(w.planTier,t)?null:w.paymentTerm===Vd.MONTHLY||Mu(v,g.user.stripeId)?m.createElement("div",{className:M7},(()=>{Mu(v,g.user.stripeId)||w.paymentTerm===Vd.MONTHLY||console.error("Team payment plan should not show upgradeTerm if monthly subscription");const e=Eu(w.planTier),t=e.getBasePrice().annually,a=e.getBasePrice().monthly;return m.createElement("div",{className:F7},"Save $",a-t/12,m.createElement("span",null,w.isMultiUser?m.createElement(m.Fragment,null," per member"):"")," per month!")})(),m.createElement(W$,{onClick:O,buttonText:"Switch To Annual",className:T7})):null:null,L=()=>S?S.cancel_at_period_end?m.createElement("span",null,"Your workspace plan has been cancelled and you will no longer be charged. You will still have access to premium features on Kapwing until"," ",k,"."," "):m.createElement("span",null,"You are subscribed to a"," ",m.createElement("span",null,x?"Legacy ":" "),d?S.plan.nickname:w.displayPlanTier," ","plan that bills once a ",null==S?void 0:S.plan.interval,". Your next bill of $",S.plan.amount*S.quantity/100," will be charged on ",I,"."):null,U=()=>S?L():b?m.createElement(m.Fragment,null,P?m.createElement("div",{className:B7},"You have a ",w.displayPlanTier," Plan to Kapwing through the Kapwing for Edu program."):m.createElement("div",{className:B7},"This workspace is subscribed to a ",w.displayPlanTier," ","Plan that bills at $0. This workspace was upgraded to the"," ",w.displayPlanTier," Plan to ensure a smooth transition for your workspace to our new subscription model. You will not be billed for this workspace plan and will retain access to all premium features in this workspace."),w.isMultiUser&&m.createElement("div",{className:B7},"Note: This workspace also contains legacy team members. Legacy team members have been granted full access to this workspace and can use all premium features in this workspace free of charge. You are not currently being billed for these members. Once removed, legacy team members cannot be added back for free.")):m.createElement("span",null,"No active plan information was found for this workspace"),M=()=>{if(null==S?void 0:S.cancel_at_period_end)return null;const e=()=>m.createElement("div",{className:V7,key:"cancel-plan-button","data-cy":"cancel-plan-button","data-testid":"cancel-plan-button",onClick:()=>{mr(lr.CANCEL_PLAN,{stripeId:a,teamId:d?void 0:v._id}),v&&S&&((e,t,a,o,n=!1)=>{fm("Initiated Cancellation",{"Current Plan":pu(e.planTier),"Subscription Status":t||"None","Monthly/Annual":e.paymentTerm,"Team ID":n?"None":e._id,"Number of Workspace Members":e.users.length,"Quantity Legacy Members":Hh(e).length,"Is Legacy Account Based Subscription":!!a&&e.stripeId===a,"Quantity Impacted Workspaces":o,"Is Paying":e.paymentTerm!==Vd.NO_TERM})})(v,ig(S),g.user.stripeId,A.length,d)}},"Cancel Subscription"),t=[];return x&&!d&&!b&&S?t.push(m.createElement("div",{className:V7,"data-cy":"update-account-button","data-testid":"update-account-button",key:"update-account-button",onClick:e=>{null==h||h.push({pathname:`/team/${v._id}`,state:{openModal:vk.account}}),e.stopPropagation()}},"Open Account Settings")):(S&&a&&u&&(t.push(m.createElement("div",{"data-cy":"update-payment-button","data-testid":"update-payment-button",className:V7,key:"update-payment-button",onClick:l},"Update Payment Method")),!d&&u&&t.push(m.createElement("div",{"data-cy":"update-invoice-button","data-testid":"update-invoice-button",className:V7,key:"update-invoice-button",onClick:()=>r()},"Update Invoice Details"))),(S&&a&&u||b)&&t.push(e())),t.length?m.createElement("div",{className:W7},t):void 0};return d&&!a?null:m.createElement(m.Fragment,null,m.createElement("div",{className:S7,"data-testid":"team-settings-plan"},"Plan"),o?m.createElement("div",null,"Loading plan information ..."):(()=>{if(!d&&w.planTier===jd.FREE)return m.createElement("div",{className:R7},m.createElement("div",{className:k7},m.createElement("div",{className:O7},"Free Plan"),m.createElement("div",null,m.createElement(j$,{action:ou.SETTINGS,onPaywallSuccess:()=>null}))),m.createElement("div",{className:x7},"You're currently using Kapwing's free plan. Upgrade this workspace to one of our paid plans to access all of Kapwing's premium features including removing all watermarks, larger uploads, private content, faster processing, and much more. Learn more about all plans on our"," ",m.createElement("a",{href:"/pricing",target:"_blank"},"pricing page"),"."));const e=(null==S?void 0:S.status)===Mr.PAST_DUE;return m.createElement("div",{className:P7},m.createElement("div",{className:x7},m.createElement("div",{className:D7},m.createElement("div",{className:L7},(!!E.length||P)&&m.createElement("div",{className:U7},m.createElement("div",null,m.createElement(t9,{overrideTeam:v,large:!0})),D()),m.createElement("div",{className:B7},m.createElement("b",null,"Your Plan"),": ",d&&1!==E.length?null==S?void 0:S.plan.nickname:P?"Edu Plan":w.getTitle()),!!S&&m.createElement(m.Fragment,null,m.createElement("div",{className:B7},m.createElement("b",null,"Last billed on"),": ",m.createElement("span",null,T||"n/a")),m.createElement("div",{className:B7},m.createElement("b",null,"Next bill"),": ",I)))),m.createElement("div",{className:I7},U()),d&&!!E.length&&m.createElement("div",{className:I7},m.createElement("div",{className:B7},m.createElement("div",null,m.createElement("strong",null,"Your"," ",d?null==S?void 0:S.plan.nickname:w.displayPlanTier," ","subscription is associated with ",E.length," workspace paid ",hu("plan","plans",E.length),":")),E.map((e=>m.createElement(b7,{key:e._id,team:e}))))),(null==S?void 0:S.cancel_at_period_end)&&m.createElement("div",{className:I7},(()=>{const e=d?E:[v];return m.createElement(m.Fragment,null,m.createElement("div",{className:B7},hu("This","These",e.length)," ",hu("workspace","workspaces",e.length)," will",m.createElement("span",null,e.length>1?"also":"")," lose access to premium features on ",m.createElement("strong",null,k,".")),m.createElement("button",{type:"button",className:f?H7:j7,onClick:()=>R()},f?"Reactivating ...":"Reactivate Plan"))})()),e?m.createElement("div",{className:A7},m.createElement("span",{className:C7},"Past Due"),"Premium features are currently active",m.createElement("span",null,d?"":" in this workspace"),", but your current subscription invoice is past due. Please"," ",m.createElement("span",{className:N7,onClick:l},"update your payment details"," ")," ","to avoid losing access."):null,m.createElement("div",{className:I7},M())))})())},$7="AccountSettings-module_container_5VbXV",K7="AccountSettings-module_pageHeader_VXSX1",Y7="AccountSettings-module_sectionHeader_OwDPi",z7="AccountSettings-module_sectionContent_by-VJ",q7="AccountSettings-module_subItem_bahuF",J7="AccountSettings-module_deleteAccountLink_Mb-r9",X7=r((e=>{var t;return null==(t=e.teams.activeBrandkit)?void 0:t.projectId}),(e=>e.studio.projectId),((e,t)=>t===e)),Q7=r((e=>{var t;return null==(t=e.teams.activeBrandkit)?void 0:t.teamId}),(e=>e.teams.selectedTeamId),((e,t)=>e===t));r((e=>e.teams.allTeams),(e=>e.teams.selectedTeamId),((e,t)=>e.find((e=>e._id===t))));const Z7=e=>{const{allTeams:t}=e.teams;return t.some((e=>{var t;return(null==(t=e.users)?void 0:t.length)>1}))};r((e=>{const{allTeams:t,selectedTeamId:a}=e.teams;return t.find((e=>e._id===a))}),(e=>e.currentUser.user),((e,t)=>{var a;return null==(a=null==e?void 0:e.users)?void 0:a.find((e=>e.userId===t._id))}));const e6="NotificationSettings-module_notificationsTable_ec0zC",t6="NotificationSettings-module_helpIcon_0BYJn",a6="NotificationSettings-module_exportTooltip_rnuUR",o6="NotificationSettings-module_disabledHeader_3PTr7",n6="NotificationSettings-module_disabledOption_nvRXx",r6="NotificationSettings-module_switch_3MQ3k",i6="NotificationSettings-module_slider_h8jlO",s6=({checked:e,onSwitch:t,disabled:a})=>{const o=n.exports.useRef(!1);return m.createElement("label",{className:`${r6} ${a?n6:""}`},m.createElement("input",{type:"checkbox",checked:e,onChange:async a=>{a.preventDefault(),o.current||(o.current=!0,await t(!e),o.current=!1)},disabled:a}),m.createElement("span",{className:i6}))},l6=()=>{var e,t,a,o,r,i,s,l;const c=cn((e=>e.currentUser.user)),d=cn(Z7),u=!!(null==c?void 0:c.email),[p,h]=n.exports.useState(!1);return m.createElement("table",{className:e6},m.createElement("thead",null,m.createElement("tr",null,m.createElement("th",null,"Notifications"),m.createElement("th",null,"IN APP"),m.createElement("th",{className:u?"":o6},"EMAIL"))),m.createElement("tbody",null,m.createElement("tr",null,m.createElement("td",null,"Comment notifications"),m.createElement("td",null,m.createElement(s6,{checked:!(null==(e=c.optOutNotifs)?void 0:e.includes(Cr.Comment)),onSwitch:e=>Mg(Cr.Comment,e,kr.InApp)})),m.createElement("td",null,m.createElement(s6,{checked:u&&!(null==(t=c.optOutEmails)?void 0:t.includes(Cr.Comment)),onSwitch:e=>Mg(Cr.Comment,e,kr.Email),disabled:!u}))),m.createElement("tr",null,m.createElement("td",null,"Export finishes"," ",m.createElement(pa,{size:16,className:t6,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)}),p&&m.createElement("div",{className:a6},"Notifications will only be sent out if project export fails or takes longer than 60 seconds to complete.")),m.createElement("td",null,m.createElement(s6,{checked:!(null==(a=c.optOutNotifs)?void 0:a.includes(Cr.Export)),onSwitch:e=>Mg(Cr.Export,e,kr.InApp)})),m.createElement("td",null,m.createElement(s6,{checked:u&&!(null==(o=c.optOutEmails)?void 0:o.includes(Cr.Export)),onSwitch:e=>Mg(Cr.Export,e,kr.Email),disabled:!u}))),m.createElement("tr",null,m.createElement("td",null,"Team Member Joined"),m.createElement("td",null,m.createElement(s6,{checked:!(null==(r=c.optOutNotifs)?void 0:r.includes(Cr.Joined)),onSwitch:e=>Mg(Cr.Joined,e,kr.InApp)})),m.createElement("td",null,m.createElement(s6,{checked:u&&!(null==(i=c.optOutEmails)?void 0:i.includes(Cr.Joined)),onSwitch:e=>Mg(Cr.Joined,e,kr.Email),disabled:!u}))),d&&m.createElement("tr",null,m.createElement("td",null,"Product updates"),m.createElement("td",null),m.createElement("td",null,m.createElement(s6,{checked:u&&!(null==(s=c.optOutEmails)?void 0:s.includes(Cr.Scheduled)),onSwitch:e=>Mg(Cr.Scheduled,e,kr.Email),disabled:!u}))),m.createElement("tr",null,m.createElement("td",null,"Request notifications"),m.createElement("td",null),m.createElement("td",null,m.createElement(s6,{checked:u&&!(null==(l=c.optOutEmails)?void 0:l.includes(Cr.Request)),onSwitch:e=>Mg(Cr.Request,e,kr.Email),disabled:!u})))))},c6="EditableProfilePictureEditor-module_wrapper_kc-FQ",d6="EditableProfilePictureEditor-module_editor_VdqAy",u6="EditableProfilePictureEditor-module_frameTop_svxIJ",m6="EditableProfilePictureEditor-module_frameBottom_u6Gbr",p6="EditableProfilePictureEditor-module_windowRow_Cm6Et",h6="EditableProfilePictureEditor-module_frameLeft_rmRpu",g6="EditableProfilePictureEditor-module_frameRight_Iye8W",f6="EditableProfilePictureEditor-module_image_t3MN-",y6="EditableProfilePictureEditor-module_squareWindow_MV-Jm",E6="EditableProfilePictureEditor-module_controlsWrapper_-0jdE",_6="EditableProfilePictureEditor-module_controlsHeader_s9AgJ",v6="EditableProfilePictureEditor-module_controls_TyiHq",w6="EditableProfilePictureEditor-module_zoom_xHKPt",b6="EditableProfilePictureEditor-module_position_6cBLJ",S6="EditableProfilePictureEditor-module_label_NGo2n",T6="EditableProfilePictureEditor-module_button_G0nuo",I6="EditableProfilePictureEditor-module_arrow_3-yIm",k6="EditableProfilePictureEditor-module_footer_qC1qN",C6="EditableProfilePictureEditor-module_submit_9y1ps",N6="EditableProfilePictureEditor-module_uploading_eaAOr",A6="EditableProfilePictureEditor-module_cancel_70r8X",x6=({inputFile:e,image:t,cancel:a})=>{const[o,r]=n.exports.useState({width:0,height:0,top:0,left:0}),[s,l]=n.exports.useState(0),[c,d]=n.exports.useState(!1),{token:u}=cn((e=>e.currentUser)),p=i.exports.useDispatch(),h=n.exports.useRef(null);n.exports.useEffect((()=>{const e=new Image;e.onload=()=>{r({...g(e.width,e.height)})},e.src=t}),[t]);const g=(e,t)=>{let a=200,o=200;e>t?a=Math.round(200*e/t):e<t&&(o=Math.round(200*t/e));let n=50,r=180;if(h&&h.current){const e=h.current.offsetWidth;n=(h.current.offsetHeight-o)/2,r=(e-a)/2}return{width:a,height:o,top:n,left:r}},f=()=>{let e=560,t=300;h&&h.current&&(e=h.current.offsetWidth,t=h.current.offsetHeight);const a=(e-200)/2,o=(t-200)/2;return{leftSide:a,rightSide:a+200,topSide:o,bottomSide:o+200}};return m.createElement("div",{className:c6},m.createElement("div",{className:d6,ref:h},m.createElement("img",{src:t,className:f6,alt:"New Profile Pic",style:{...o}}),m.createElement("div",{className:u6}),m.createElement("div",{className:p6},m.createElement("div",{className:h6}),m.createElement("div",{className:y6}),m.createElement("div",{className:g6})),m.createElement("div",{className:m6})),m.createElement("div",{className:E6},m.createElement("div",{className:_6},"Use the controls below to adjust your new profile image:"),m.createElement("div",{className:v6},m.createElement("div",{className:w6},m.createElement("div",{className:S6},"Zoom:"),m.createElement("div",{className:T6,onClick:()=>{const{width:e,height:t,top:a,left:n}=o,i=e+10,s=Math.round(t/e*i);r({width:i,height:s,top:a-(s-t)/2,left:n-5})}},m.createElement(ha,null)," Zoom In"),m.createElement("div",{className:T6,onClick:()=>{const{width:e,height:t,top:a,left:n}=o,i=e-10,s=Math.round(t/e*i),l=a-(s-t)/2,c=n+5,{leftSide:d,rightSide:u,topSide:m,bottomSide:p}=f();c>d||c+i<u||l>m||l+s<p||r({width:i,height:s,top:l,left:c})}},m.createElement(ga,null)," Zoom Out")),m.createElement("div",{className:b6},m.createElement("div",{className:S6},"Position:"),m.createElement("div",{className:T6,onClick:()=>{const{top:e}=o;let t=e+10;const{topSide:a}=f();t>a&&(t=a),r((e=>({...e,top:t})))}},m.createElement(fa,{className:I6})),m.createElement("div",{className:T6,onClick:()=>{const{top:e,height:t}=o;let a=e-10;const{bottomSide:n}=f();a+t<n&&(a=n-t),r((e=>({...e,top:a})))}},m.createElement(ya,{className:I6})),m.createElement("div",{className:T6,onClick:()=>{const{left:e}=o;let t=e+10;const{leftSide:a}=f();t>a&&(t=a),r((e=>({...e,left:t})))}},m.createElement(Ea,{className:I6})),m.createElement("div",{className:T6,onClick:()=>{const{left:e,width:t}=o;let a=e-10;const{rightSide:n}=f();a+t<n&&(a=n-t),r((e=>({...e,left:a})))}},m.createElement(_a,{className:I6}))))),m.createElement("div",{className:k6},m.createElement("div",{className:A6,onClick:a},"Cancel"),c?m.createElement("div",{className:N6},"Uploading ... ",s,"%"):m.createElement("div",{className:C6,onClick:async()=>{try{d(!0);const n=(e,t,a)=>fetch(e).then((e=>e.arrayBuffer())).then((e=>new File([e],t,{type:a}))),r=await n(t,e.name,e.type),i=new FormData;let s;if(i.append("file",r),h&&h.current){const{left:e,top:t,width:a,height:n}=o,r=h.current.offsetWidth,i=h.current.offsetHeight;s={relativeLeftCrop:(r-200)/2-e,relativeTopCrop:(i-200)/2-t,relativeWidth:a,relativeHeight:n}}i.append("cropInfo",JSON.stringify(s));const c=new XMLHttpRequest;await new Promise(((e,t)=>{c.upload.onprogress=e=>{e.lengthComputable&&l(Math.floor(e.loaded/e.total*100))},c.addEventListener("loadend",(()=>{l(0);const t=JSON.parse(c.response);e(t)})),c.onreadystatechange=()=>{4===c.readyState&&200!==c.status&&(d(!1),t(new Error(c.responseText)))},c.open("POST","/api/v1/users/uploadProfilePicture",!0),c.setRequestHeader("x-access-token",u),c.send(i)}))&&(p(bh("Upload complete!")),d(!1),a(),Og(),fm("User Update",{property:"picture"}))}catch($ae){p(wh($ae)),d(!1)}}},"Upload Image")))},P6="EditableProfilePictureOverlay-module_container_vKLx-",R6="EditableProfilePictureOverlay-module_header_OKDhI",O6="EditableProfilePictureOverlay-module_uploader_d4k3-",D6="EditableProfilePictureOverlay-module_icon_2zLZD",L6="EditableProfilePictureOverlay-module_filePickerButton_fOdAn",U6="EditableProfilePictureOverlay-module_filePickerInput_69zY6",M6="EditableProfilePictureOverlay-module_buttonSubheader_-IIDX",F6=({closeModal:e})=>{const[t,a]=n.exports.useState(null),[o,r]=n.exports.useState(""),i=async e=>{if(e&&e.target&&e.target.files&&e.target.files.length){const t=e.target.files[0];a(t);const o=new FileReader;o.onload=e=>{if(e&&e.target&&e.target.result){const t=e.target.result;r(t)}},o.readAsDataURL(t)}};return m.createElement(kx,{overlayContainerSmall:!0,usePortal:!0,unsetCancelModal:e},m.createElement("div",{className:P6},m.createElement("div",{className:R6},"Choose a new profile picture"),o?m.createElement(x6,{inputFile:t,image:o,cancel:e}):m.createElement("div",{className:O6},m.createElement("button",{type:"button",className:L6},m.createElement("div",null,m.createElement(va,{className:D6})," Select an image"),m.createElement("div",{className:M6},"JPG, PNG, WEBP, GIF supported")),m.createElement("input",{type:"file",onChange:i,className:U6,accept:"image/jpeg, image/png, image/webp, image/gif"}))))},B6="EditableProfilePicture-module_container_JTyhj",W6="EditableProfilePicture-module_containerOverlay_ufXRZ",V6="EditableProfilePicture-module_profileImage_lfy1f",j6=()=>{const[e,t]=n.exports.useState(!1);return m.createElement("div",null,m.createElement("div",{className:B6,onClick:()=>{t(!0)}},m.createElement(jO,{suggestedWidth:300,suggestedHeight:300,className:V6}),m.createElement("div",{className:W6},m.createElement(wa,null))),e?m.createElement(F6,{closeModal:()=>{t(!1)}}):null)},H6="ProfileInformation-module_accountText_JBrMd",G6="ProfileInformation-module_editIcon_Oxj9B",$6="ProfileInformation-module_editableText_NLNEW",K6="ProfileInformation-module_hovered_hFRfr",Y6="ProfileInformation-module_email_sJf09",z6="ProfileInformation-module_fullName_Tfelb",q6="ProfileInformation-module_overlayAltButton_dg4ti",J6="ProfileInformation-module_overlayControls_u5d4b",X6="ProfileInformation-module_overlayDescription_sbyXu",Q6="ProfileInformation-module_overlayForm_Q0nuV",Z6="ProfileInformation-module_overlayHeader_OBbE5",e8="ProfileInformation-module_overlayInput_xFGJ4",t8="ProfileInformation-module_overlayLabel_rQqSs",a8="ProfileInformation-module_overlaySubmitButton_cjsiM",o8="ProfileInformation-module_profileInformationContainer_Ml01l",n8="ProfileInformation-module_signOutButton_cp5LP",r8=({closeOverlay:e})=>{const t=i.exports.useDispatch(),[a,o]=n.exports.useState(!1),[r,s]=n.exports.useState(!1),[l,c]=n.exports.useState(""),[d,u]=n.exports.useState(""),[p,h]=n.exports.useState(!1),{executeRecaptcha:g}=ue(),f=cn((e=>e.currentUser)),y=cn((e=>e.config.RECAPTCHA_V3_SITEKEY)),E=cn((e=>e.config.RECAPTCHA_V2_SITEKEY)),_=n.exports.useRef(null);return m.createElement(kx,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0},m.createElement("div",null,m.createElement("div",{className:Z6},"Update Your Email"),m.createElement("div",{className:X6},a?"Please enter the confirmation code we sent to your email to confirm you want to transfer account ownership to this address. If you did not receive your code, please check your spam folder.":"Use this form to change your account email address. Your email address is used to login to your account. You will be prompted to enter a confirmation code."),m.createElement("form",{className:Q6},a?m.createElement("label",{htmlFor:"code-input",className:t8},"Code:",m.createElement("input",{placeholder:"Code",className:e8,value:l,onChange:e=>{return t=e.target.value,void c(t.toUpperCase());var t},id:"code-input"})):m.createElement("label",{htmlFor:"email-input",className:t8},"Email:",m.createElement("input",{placeholder:"YourNewEmail@example.com",className:e8,value:d,onChange:e=>u(e.target.value),id:"email-input"})),!a&&p&&m.createElement("div",{style:{marginBottom:"10px"}},m.createElement(pe,{sitekey:E,ref:_})),m.createElement("div",{className:J6},m.createElement("button",{type:"submit",onClick:async n=>{var r;n.preventDefault();const{token:i,user:c}=f,{_id:u}=c||{};if(a){try{s(!0),await op("/api/v1/users/updateProfile/email/validateCode",{body:{token:i,userId:u,email:d,code:l},parseJSON:!1}),Og(),t(bh("Your email has been updated and you can now sign in with your new email.")),fm("User Update",{property:"email"}),e()}catch(m){t(wh(m))}s(!1)}else if(Zg(d)){try{if(!g)throw new Error("Recaptcha loading ... please try again in a few seconds.");const e=await g("updateEmail"),t=null==(r=_.current)?void 0:r.getValue();s(!0),await op("/api/v1/users/email/signin",{body:{email:d,v3CaptchaToken:e,v2CaptchaToken:t,recaptchaKeyV3:y}}),o(!0)}catch(m){t(wh(m)),cf(m)&&h(!0)}s(!1)}else t(wh("Please input a valid email address."))},className:a8},r?"Loading...":a?"Submit confirmation code":"Change Email"),!r&&a&&m.createElement("button",{type:"button",onClick:e,className:q6},"Never mind")))))},i8=({closeOverlay:e,firstName:t,lastName:a})=>{const o=i.exports.useDispatch(),[r,s]=n.exports.useState(t||""),[l,c]=n.exports.useState(a||""),[d,u]=n.exports.useState(!1);return m.createElement(kx,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0},m.createElement("div",null,m.createElement("div",{className:Z6},"Update Your Name"),m.createElement("div",{className:X6},"Use this form to update the name on your profile."),m.createElement("form",{className:Q6},m.createElement("label",{htmlFor:"first-name-input",className:t8},"First Name",m.createElement("input",{placeholder:"First name",className:e8,value:r,onChange:e=>s(e.target.value),id:"first-name-input"})),m.createElement("label",{htmlFor:"last-name-input",className:t8},"Last Name",m.createElement("input",{placeholder:"Last name",className:e8,value:l,onChange:e=>c(e.target.value),id:"last-name-input"})),m.createElement("div",{className:J6},m.createElement("button",{type:"submit",onClick:async t=>{if(t.preventDefault(),!d){u(!0);try{await async function(e,t){const{state:a}=io(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{};await op("/api/v1/users/updateProfile/fullName",{body:{token:o,userId:r,firstName:e,lastName:t},parseJSON:!1}),await Og()}(r,l),fm("User Update",{property:"name"}),o(bh("Your name has been updated.")),e()}catch(a){o(wh(a))}u(!1)}},className:a8},d?"Loading...":"Set new account name"),!d&&m.createElement("button",{type:"button",onClick:e,className:q6},"Never mind")))))},s8=({className:e,children:t,editValue:a,alt:o})=>{const[r,i]=n.exports.useState(!1);return m.createElement("div",{className:r?`${e} ${$6} ${K6}`:`${e} ${$6}`,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onClick:a},t||o,m.createElement(wa,{className:G6}))},l8=({currentUser:e,email:t})=>{const a=i.exports.useDispatch(),o=Fe(),[r,s]=n.exports.useState(!1),[l,c]=n.exports.useState(!1);return m.createElement("div",{className:o8},l&&m.createElement(i8,{closeOverlay:()=>c(!1),firstName:e.user.firstName,lastName:e.user.lastName}),r&&m.createElement(r8,{closeOverlay:()=>s(!1)}),m.createElement(j6,null),m.createElement("div",{className:H6},m.createElement(s8,{alt:"Add Your Name",className:z6,editValue:()=>c(!0)},cm(e)),m.createElement(s8,{alt:"Add Email Address",className:Y6,editValue:()=>s(!0)},t),m.createElement($I,null)),m.createElement("div",{onClick:()=>{a(Wm()),wk(),window&&window.google&&window.google.accounts.id.disableAutoSelect(),o.push("/")},className:n8,"data-cy":"sign-out-button"},"Sign Out"))},c8=()=>{const{currentUser:e,workspaces:t,currentFolderId:a,allTeams:o}=cn((e=>{const t=e.teams.selectedTeamId,a=e.teams.allTeams.find((e=>e._id===t));return{currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,allTeams:e.teams.allTeams,currentTeam:a}}),i.exports.shallowEqual),r=Fe(),s=i.exports.useDispatch(),l=vO(e.user.stripeId);n.exports.useState();const[c,d]=n.exports.useState(!0),[u,p]=n.exports.useState([]);n.exports.useEffect((function(){!t.allWorkspaces.length&&a&&s(IS())}),[a,s,t.allWorkspaces.length]),n.exports.useEffect((()=>{om(e)||r.push(`/folder/${a}`)}),[e,a,r]);const h=n.exports.useCallback((async()=>{try{const e=await async function(){const{dispatch:e}=io(),t=await ap("/api/v2/payment/legacyCharges");return!t.success&&t.stripeDevEnvError?(e(Sh("<Dev only message>: You are trying to view a Stripe subscription that was not purchased in the same environment you are currently using. To see live subscriptions, please view this page on kapwing.com. To see test card subscriptions, please view this page on kapwing-dev.com.")),console.warn("Could not fetch Stripe subscription from live/test mode. If viewing a live subscription, please go to kapwing.com. If trying to view a subscription purchased with a test card, go to kapwing-dev.com."),[]):t}();p(e.charges),d(!1)}catch(e){console.error(e),s(wh("There was an error getting your charges."))}}),[s]);n.exports.useEffect((()=>{h()}),[h]);const{user:g}=e||{},f=(null==g?void 0:g.email)||"Signed in with Facebook",y=Fu(o,g.stripeId);return m.createElement("div",{className:$7},m.createElement("div",{className:K7,"data-testid":"account-settings-header"},"Account Settings"),m.createElement(l8,{currentUser:e,email:f}),(!!y.length||g.stripeId&&l)&&(l&&g.stripeId?m.createElement(m.Fragment,null,m.createElement(G7,{loadingPlan:!1,stripeId:g.stripeId,openBillingDetails:()=>null,openChangePaymentTerm:()=>null,openUpdatePaymentOverlay:()=>null,onRefresh:()=>null,fromAccountSettings:!0}),m.createElement("div",{className:Y7},"Billing"),m.createElement(h7,{charges:u,loadingBilling:c,getPaymentHistory:h})):null),m.createElement(l6,null),m.createElement("div",{className:Y7},"Delete Account"),m.createElement("div",{className:z7},m.createElement("div",{className:q7},m.createElement("button",{className:J7,type:"button","data-cy":"delete-account-link",onClick:()=>mr(lr.PREDELETE_ACCOUNT,{stripeId:g.stripeId})},"Delete account and all associated data stored in Kapwing."))))},d8=({closeAccountSettings:e})=>m.createElement(kx,{usePortal:!0,unsetCancelModal:e},m.createElement(c8,null));const u8="DeleteAccountDialog-module_disabled_4xGKa",m8="DeleteAccountDialog-module_description_Ribr-",p8="DeleteAccountDialog-module_buttonsContainer_g-4V6",h8="DeleteAccountDialog-module_primaryButton_9jXzj",g8="DeleteAccountDialog-module_secondaryAction_067Qv",f8="DeleteAccountDialog-module_loading_WMwqn",y8="DeleteAccountDialog-module_checkBoxContainer_OGqPY",E8="DeleteAccountDialog-module_checkBox_8ZfOY",_8="DeleteAccountDialog-module_checkBoxText_B6PNC",v8="DeleteAccountDialog-module_italicBold_I-A-q",w8=()=>{const e=i.exports.useDispatch(),t=Fe(),[a,o]=n.exports.useState(!1),[r,s]=n.exports.useState(!0);n.exports.useEffect((function(){pr("Delete Account")}),[]);return m.createElement(m.Fragment,null,m.createElement("div",{className:m8},m.createElement("p",null,"Deleting your account will delete"," ",m.createElement("b",null,"all private workspaces and content")," associated with your account — all links and embeds to existing content will no longer work. Shared workspaces will still exist for you and others who have access."),m.createElement("p",null,"To get help with your subscription or account, contact us at",m.createElement("a",{href:"mailto:help@kapwing.com"}," help@kapwing.com")," before deleting your data."),m.createElement("div",{className:y8},m.createElement("input",{type:"checkbox",className:E8,onClick:()=>s(!r)}),m.createElement("div",{className:_8},"I acknowledge that I will no longer receive support regarding my projects, workspaces, or subscription from Kapwing's customer support team. After deleting, I will not be eligible for any refund for past purchases or remaining subscription time.")),m.createElement("p",{className:v8},"This action cannot be undone. You will be signed out once your account deletion is complete. All data will be erased from Kapwing's database.")),m.createElement("div",{className:p8},a?m.createElement("div",{className:f8},"Deleting..."):m.createElement(m.Fragment,null,m.createElement("div",{className:`${h8} ${r?u8:""}`,onClick:r?void 0:async()=>{o(!0);try{await e(((e,t)=>{const{user:a}=t().currentUser||{},{_id:o}=a||{};return tp("/api/v1/account",{params:{userId:o},parseJSON:!1})})),e(bh("Your account has been successfully deleted and you have been signed out of Kapwing. Sign in again to create a new account."))}catch($ae){console.error($ae),e(wh(`There were errors when deleting your account. Not all of your content may be deleted. ${$ae.message}`))}finally{e(Wm()),t.push("/"),Ob.remove("state")}}},"Delete Account"),m.createElement("div",{onClick:()=>ur(),className:g8},"Never mind"))))},b8=()=>cn((e=>e.teams.allTeams)),S8=()=>{const e=cn((e=>e.hubModal.teamId)),t=cn((e=>e.hubModal.stripeId)),a=(()=>{const e=cn((e=>e.currentUser.user));return null==e?void 0:e.stripeId})(),o=(e=>{const t=b8();return e?t.filter((t=>t.stripeId&&t.planTier&&Eu(t.planTier).isPaid&&t.stripeId===e)):[]})(t),n=b8().filter((e=>e.stripeId||e.paymentTerm!==Vd.NO_TERM)),r=b8(),i=o.filter((e=>e.stripeId===t)),s=1===i.length?i[0]:void 0,l=vO(t);return{modalTeamId:e,stripeIdToCancel:t,tiedTeams:o,allTeams:r,legacyStripeId:a,activeTeams:n,teamToCancel:s,subscriptionToCancel:t?l:void 0}},T8="PreDeleteAccountDialog-module_contentContainer_RIx30",I8="PreDeleteAccountDialog-module_buttonsContainer_6VC68",k8="PreDeleteAccountDialog-module_secondaryButton_v4EVd",C8="PreDeleteAccountDialog-module_primaryButton_ck3ZJ",N8="PreDeleteAccountDialog-module_cancelContainer_F7hB-",A8=()=>{const{legacyStripeId:e,activeTeams:t,allTeams:a}=S8();n.exports.useEffect((function(){pr("Are you trying to cancel your subscription?")}),[]);const o=i.exports.useDispatch();return n.exports.useEffect((()=>{for(const e of t)o(up(e._id))}),[o,t]),n.exports.useEffect((function(){a.length&&!t.length&&mr(lr.DELETE_ACCOUNT)}),[a.length,t.length]),m.createElement(m.Fragment,null,m.createElement("div",{className:T8},"Instead of deleting your account, you can cancel your subscription and keep using Kapwing's free plan. After cancelling your subscription, you will no longer be charged.",m.createElement("br",null),m.createElement("br",null),"Deleting your account will delete"," ",m.createElement("b",null,"all private workspaces and content")," associated with your account — all links and embeds to existing content will no longer work. Shared workspaces will still exist for you and others who have access."),m.createElement("div",{className:I8},m.createElement("button",{type:"button",className:k8,onClick:()=>mr(lr.DELETE_ACCOUNT)},"Continue to Delete All Data"),m.createElement("div",{className:N8},m.createElement("button",{type:"button",className:k8,onClick:()=>mr(lr.CANCEL_PLAN,{stripeId:e})},"Cancel my subscription"),m.createElement("button",{type:"button",className:C8,onClick:ur},"Never mind"))))},x8="CancellationOverlay-module_description_4dW8i",P8="CancellationOverlay-module_buttonsContainer_h3XYe",R8="CancellationOverlay-module_primaryButton_nEann",O8="CancellationOverlay-module_secondaryAction_TveRS",D8="CancellationOverlay-module_cancelContainer_CWcTm",L8="CancellationOverlay-module_cancelling_n9V6u",U8=({team:e,onSubmit:t,submitting:a})=>{n.exports.useEffect((function(){pr("Are you sure you want to cancel your subscription?")}),[]);const o=cn((e=>e.hubModal.stripeId)),r=vO(o||(null==e?void 0:e.stripeId)),i=Ru({team:e}),s=e?i:Iu(jd.PRO),l=!!e&&Uu(i.planTier,e),c=l;return r||l?m.createElement("div",null,r?m.createElement(m.Fragment,null,m.createElement("div",{className:x8},"After cancelling, you will no longer be billed. You will still have access to ",s.displayPlanTier," features"," ",e?`in ${e.name}`:""," until the end of your current billing period on"," ",C(1e3*r.current_period_end).format("ddd, MMM D, YYYY"),"."),m.createElement("div",{className:x8},"After that,"," ",m.createElement("span",null,e?e.name:"any associated workspaces")," will be on the Free plan. Projects in Free workspaces are deleted 3 months after creation. Any projects created more than 3 months ago will be deleted after"," ",C(1e3*r.current_period_end).format("ddd, MMM D, YYYY")),m.createElement("div",{className:x8},"Cancelling does not provide a refund for the remainder of the paid period.")):m.createElement(m.Fragment,null,m.createElement("div",{className:x8},"On cancellation, you will lose access to"," ",s.displayPlanTier," features"," ",e?`in ${e.name}`:""," immediately."),m.createElement("div",{className:x8},"After that,"," ",m.createElement("span",null,e?e.name:"any associated workspaces")," will be on the Free plan. Projects in Free workspaces are deleted 3 months after creation. Any projects created more than 3 months ago will be deleted after today:"," ",C(new Date).format("ddd, MMM D, YYYY"))),m.createElement("div",{className:D8},m.createElement("div",{className:P8},a?m.createElement("div",{className:L8},"Cancelling... Please Wait"):m.createElement(m.Fragment,null,m.createElement("div",{className:R8,onClick:()=>{t(c)}},"Cancel subscription"),m.createElement("div",{onClick:ur,className:O8},"Never mind"))))):m.createElement("div",null,"Loading...")},M8="CancellationPresurvey-module_sectionHeader_J8gTh",F8="CancellationPresurvey-module_contentContainer_UdSwi",B8="CancellationPresurvey-module_leftColumn_95aLh",W8="CancellationPresurvey-module_rightColumn_djPXO",V8="CancellationPresurvey-module_leftColumnContent_obA7a",j8="CancellationPresurvey-module_feature_EZtlN",H8="CancellationPresurvey-module_icon_sCL5s",G8="CancellationPresurvey-module_subcontent_HOnAk",$8="CancellationPresurvey-module_bold_lSkQJ",K8="CancellationPresurvey-module_boldRed_2BwIS",Y8="CancellationPresurvey-module_planContainer_yOWwM",z8="CancellationPresurvey-module_planHeader_HhAXX",q8="CancellationPresurvey-module_planSubheader_50Zb9",J8="CancellationPresurvey-module_planIcon_FMg9C",X8="CancellationPresurvey-module_featureContent_NdH-R",Q8="CancellationPresurvey-module_bulletPoint_Jd-SM",Z8="CancellationPresurvey-module_disclaimerContainer_x-3HB",eee="CancellationPresurvey-module_disclaimerContent_vRRSm",tee="CancellationPresurvey-module_cancelButton_65Xmb",aee="CancellationPresurvey-module_continueButton_bC8dT",oee="CancellationPresurvey-module_teamRowContainer_c48yW",nee="CancellationPresurvey-module_teamRow_gPChi",ree="CancellationPresurvey-module_outerButtonWrapper_nwiiN",iee="CancellationPresurvey-module_innerButtonWrapper_M80Sd",see=({setSeenPresurvey:e})=>{const{tiedTeams:t,subscriptionToCancel:a,teamToCancel:o}=S8(),r=i.exports.useDispatch(),s=cn((e=>e.currentUser.user)),l=Eu(jd.FREE),c=Ru({team:o||t[0]}),d=!!o&&Uu(c.planTier,o),u=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription}));return n.exports.useEffect((function(){pr("Review your cancellation changes "+((null==o?void 0:o.name)?`for ${o.name}`:"")),!a&&(null==o?void 0:o.name)&&r(up(o._id,!0))}),[null==o?void 0:o.name,null==o?void 0:o._id,r,a]),a&&a.customer||d?m.createElement("div",{className:F8},m.createElement("div",{className:B8},m.createElement("div",{className:M8},"You'll lose access to these ",c.displayPlanTier," features:"),m.createElement("div",{className:V8},c.planData.cancelReasons.map(((e,t)=>m.createElement("div",{className:j8,key:e},m.createElement(Ee,{className:H8}),e,0===t&&m.createElement("div",{className:G8},"Free workspaces can only store projects for 1 month."," ",m.createElement("span",{className:K8},"Any projects that were created more than 30 days ago will be deleted once your subscription ends."))))))),m.createElement("div",{className:W8},m.createElement("div",{className:M8},"You're switching to:"),m.createElement("div",{className:Y8},m.createElement("div",{className:z8},l.displayPlan),m.createElement("div",{className:q8},m.createElement(ba,{className:J8})," You'll see these new limits if you downgrade to ",l.displayTier,":"),m.createElement("div",null,l.planData.cancelReasons.map((e=>m.createElement("div",{className:X8,key:e},m.createElement("span",{className:Q8},"•"),e))))),m.createElement("div",{className:Z8},a?m.createElement("div",{className:eee},"After cancelling, you will no longer be billed. You will still have access to ",c.displayPlanTier," features on Kapwing until the end of your current billing period on",m.createElement("span",{className:$8}," ",new Date(1e3*a.current_period_end).toLocaleDateString()),"."):m.createElement("div",{className:eee},"After cancelling, you will lose access to"," ",c.displayPlanTier," features on Kapwing immediately. This change cannot be undone."),m.createElement("div",{className:eee},"If there is something you're unsatisfied with or there's any way we can keep you as a subscriber, please contact us at",m.createElement("a",{href:"mailto: help@kapwing.com"}," help@kapwing.com"),". Please note, cancelling does not provide a refund for the remainder of the paid period.")),m.createElement("button",{type:"button",className:tee,onClick:()=>ur()},"Never mind"),m.createElement("button",{type:"button",className:aee,onClick:()=>{e(!0),o&&u&&ng(o,ig(u),s.stripeId,t.length)}},"Continue to Cancel"))):m.createElement("div",{className:F8},"Loading...")},lee="CancellationSurvey-module_buttonsContainer_CVBAj",cee="CancellationSurvey-module_primaryButton_TRgLy",dee="CancellationSurvey-module_primaryButtonDisabled_3PUiy",uee="CancellationSurvey-module_optionButton_WhSdL",mee="CancellationSurvey-module_textField_6r4sh",pee="CancellationSurvey-module_commentsLabel_xD-dg",hee=({setSeenSurvey:e,team:t})=>{const[a,o]=n.exports.useState(""),[r,i]=n.exports.useState(""),s=cn((e=>e.currentUser)),l=Ru({team:t}),c=t?l:Iu(jd.PRO),d=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription})),u=cn((e=>e.teams.allTeams)),p=Fu(u,s.user.stripeId);n.exports.useEffect((function(){pr("Before you go, please tell us how we can improve",`Tell us why you're cancelling your ${c.displayPlanTier} subscription`)}),[c.displayPlanTier]);const h=id({[cee]:!0,[dee]:!a.length});return m.createElement("form",{onSubmit:o=>{o.preventDefault(),t&&d?fm("Downgraded Workspace Survey",{Reason:a,Feedback:r,Email:um(s),Name:cm(s),"Current Plan":pu(c.planTier),"Subscription Status":ig(d),"Monthly/Annual":t.paymentTerm,"Team ID":t._id,Quantity:t.users.length,"Quantity Legacy Members":Hh(t).length,"Is Legacy Account Based Subscription":!!s.user.stripeId&&t.stripeId===s.user.stripeId,"Quantity Impacted Workspaces":p.length}):s.user.stripeId&&p.length&&fm("Downgraded Account Survey",{Reason:a,Feedback:r,Email:um(s),Name:cm(s),"Current Plan":pu(c.planTier),"Subscription Status":ig(d),"Monthly/Annual":p[0].paymentTerm,"Team ID":p[0]._id,Quantity:p[0].users.length,"Quantity Legacy Members":Hh(p[0]).length,"Is Legacy Account Based Subscription":!!s.user.stripeId&&p[0].stripeId===s.user.stripeId,"Quantity Impacted Workspaces":p.length}),e(!0)}},gee.map((e=>{const{id:t,value:n,label:r}=e;return m.createElement("div",{className:uee,key:`surveyReason-${t}`},m.createElement("input",{id:`surveyReason-${t}`,type:"radio",name:"reason",value:n,onChange:()=>o(n),checked:a===n}),m.createElement("label",{htmlFor:`surveyReason-${t}`},r))})),a&&m.createElement("label",{htmlFor:"reasonFeedback"},m.createElement("div",{className:pee},"Comments"),m.createElement("textarea",{id:"reasonFeedback",className:mee,placeholder:fee[a],onChange:e=>i(e.target.value)})),m.createElement("div",{className:lee},m.createElement("button",{type:"submit",className:h,disabled:!a.length},"Submit")))},gee=[{id:"tooExpensive",value:"too expensive",label:"Kapwing is too expensive for me."},{id:"didntWork",value:"didn't work",label:"I ran into an issue / Kapwing is broken."},{id:"noNeed",value:"no need",label:"I don't need Kapwing anymore."},{id:"switched",value:"switched",label:"I switched to a different tool."},{id:"other",value:"other",label:"Other"}],fee={"didn't work":"What problems did you run into that made you decide to cancel?","no need":"Is there anything we could do that would convince you to stay?",switched:"What tool are you going to use instead?",other:"What made you decide to cancel?","too expensive":"What is a price point that would convince you to stay?"},yee=({team:e})=>{var t,a,o;return m.createElement("div",{key:e._id,className:E5,"data-id":e._id},m.createElement("div",null,m.createElement(jO,{suggestedHeight:350,suggestedWidth:350,className:d5,team:e})),m.createElement("div",{className:_5},m.createElement("div",null,m.createElement("div",{className:u5,"data-testid":"team-name","data-cy":"dropdown-team-name"},e.name),m.createElement("div",null,(null==(t=e.users)?void 0:t.length)&&`${null==(a=e.users)?void 0:a.length} Member${(null==(o=e.users)?void 0:o.length)>1?"s":""}`))),m.createElement("div",null,m.createElement(t9,{overrideTeam:e})))},Eee=({setSeen:e})=>{const t=cn((e=>e.hubModal.stripeId)),a=cn((e=>e.teams.allTeams)),o=a.filter((e=>e.stripeId&&e.planTier&&Eu(e.planTier).isPaid&&e.stripeId===t)),r=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription})),i=cn((e=>e.currentUser.user)),s=Bu(),l=Fu(a,i.stripeId);return n.exports.useEffect((function(){pr(`This Legacy Subscription is Tied to ${o.length} Workspace ${hu("Plan","Plans",o.length)}`,"These workspaces will downgrade to the free plan after you cancel")}),[o.length]),m.createElement(m.Fragment,null,m.createElement("div",{className:oee},o.map((e=>m.createElement("div",{className:nee,key:e._id},m.createElement(yee,{team:e}))))),m.createElement("div",{className:ree},m.createElement("div",{className:iee},m.createElement("button",{type:"button",className:tee,onClick:()=>ur()},"Never mind"),m.createElement("button",{type:"button",className:aee,onClick:()=>{e(!0),s&&r&&ng(s,ig(r),i.stripeId,l.length)}},"Continue to Cancel"))))},_ee={},vee=()=>{var e;const{activeTeams:t,stripeIdToCancel:a}=S8(),o=1===t.length?null==(e=t[0])?void 0:e.stripeId:void 0;return n.exports.useEffect((()=>{pr("Which subscription would you like to cancel?"),!a&&o&&mr(lr.CANCEL_PLAN,{stripeId:o})}),[o,a]),m.createElement("div",{className:_ee.teamRowContainer},t.map((e=>m.createElement("div",{key:null==e?void 0:e._id,className:_ee.teamRow},m.createElement(b7,{team:e,buttonText:`Cancel ${Eu(e.planTier).displayPlan}`,onClick:()=>mr(lr.CANCEL_PLAN,{stripeId:e.stripeId})})))))},wee=()=>{const{stripeIdToCancel:e,legacyStripeId:t,tiedTeams:a}=S8(),o=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription})),r=cn((e=>e.currentUser.user)),[s,l]=n.exports.useState(),[c,d]=n.exports.useState();n.exports.useEffect((()=>{a.length&&t&&l(!0),a.length||t||d(!1)}),[a.length,t]);const[u,p]=n.exports.useState(!1),[h,g]=n.exports.useState(!1),f=i.exports.useDispatch();return!s&&t?m.createElement(Eee,{setSeen:l}):e?c?c&&!u?m.createElement(hee,{setSeenSurvey:p}):m.createElement(U8,{onSubmit:async()=>{if(e){g(!0);try{await f((l=e,async(e,t)=>{const{currentUser:a,teams:o}=t(),{token:n,user:r}=a||{},{_id:i}=r||{},s=await op("/api/v2/payment/cancelPlan",{body:{token:n,userId:i,stripeId:l},parseJSON:!1});return e(dp(!0)),o.allTeams.filter((e=>e.stripeId===l)).forEach((t=>e(up(t._id,!0)))),s})),await f(_g()),f(bh("Your subscription has been cancelled and you will no longer be billed")),a.length&&(t=a[0],n=ig(o),i=r.stripeId,s=a.length,fm("Downgrade Account",{"Current Plan":pu(t.planTier),"Subscription Status":n||"None","Monthly/Annual":t.paymentTerm,"Team ID":t._id,"Number of Workspace Members":t.users.length,"Quantity Legacy Members":Hh(t).length,"Is Legacy Account Based Subscription":!!i&&t.stripeId===i,"Quantity Impacted Workspaces":s,"Is Paying":t.paymentTerm!==Vd.NO_TERM}))}catch($ae){throw console.error($ae),Error("Something went wrong, your card was not charged. Please try again later.")}var t,n,i,s,l;g(!1),ur()}else console.error("Trying to submit account cancellation without stripeId")},submitting:h}):m.createElement(see,{setSeenPresurvey:d}):m.createElement(vee,null)},bee="HubModal-module_modalContainer_BHASn",See="HubModal-module_headerContainer_uJFmM",Tee="HubModal-module_header_9rzmP",Iee="HubModal-module_subheader_1jKUj",kee="HubModal-module_contentContainer_MPZ1v",Cee="HubModal-module_singleButtonContainer_Zv3pX",Nee=({teams:e,setToCancelTeam:t})=>{const a=cn((e=>e.currentUser));return n.exports.useEffect((function(){pr("Which subscription would you like to cancel?")}),[]),m.createElement(m.Fragment,null,m.createElement("div",{className:kee},e.filter((e=>!a.user.stripeId||e.stripeId!==a.user.stripeId)).map((e=>m.createElement(b7,{key:e._id,team:e,buttonText:`Cancel ${Eu(e.planTier).displayPlan}`,onClick:()=>t(e)})))),m.createElement("div",{className:Cee},m.createElement("div",null,m.createElement(ZR,{onClick:ur},"Never mind"))))},Aee=()=>{const{modalTeamId:e,activeTeams:t,tiedTeams:a}=S8(),o=cn((e=>e.teams.allTeams)),r=cn((e=>{var t;return null==(t=e.checkoutStore[e.teams.selectedTeamId])?void 0:t.subscription})),s=cn((e=>e.currentUser.user));let l;e?l=o.find((t=>t._id===e)):1===t.length&&([l]=t);const[c,d]=n.exports.useState(l),[u,p]=n.exports.useState(!1),[h,g]=n.exports.useState(!1),[f,y]=n.exports.useState(!1),E=i.exports.useDispatch();n.exports.useEffect((()=>{c||1!==t.length||d(t[0]),c||t.filter((e=>!s.stripeId||e.stripeId!==s.stripeId)).length||d(t[0])}),[t,c,s.stripeId]),n.exports.useEffect((()=>{for(const e of o)E(up(e._id))}),[E,o]);return c?!u&&c?m.createElement(see,{setSeenPresurvey:p}):u&&!h?m.createElement(hee,{team:c,setSeenSurvey:g}):m.createElement(U8,{team:c,onSubmit:async(e=!1)=>{if(y(!0),c){try{await E(function(e,t=!1){return async(a,o)=>{const{currentUser:n}=o(),{token:r,user:i}=n||{},{_id:s}=i||{},l=await op("/api/v2/payment/cancelPlan",{body:{token:r,userId:s,teamId:e,downgradeImmediately:t},parseJSON:!1});return a(up(e,!0)),l}}(c._id,e)),await E(_g()),E(bh("Your subscription has been cancelled and you will no longer be billed")),r&&(t=c,o=ig(r),n=s.stripeId,i=a.length,fm("Downgrade Workspace",{"Current Plan":pu(t.planTier),"Subscription Status":o||"None","Monthly/Annual":t.paymentTerm,"Team ID":t._id,"Number of Workspace Members":t.users.length,"Quantity Legacy Members":Hh(t).length,"Is Legacy Account Based Subscription":!!n&&t.stripeId===n,"Quantity Impacted Workspaces":i,"Is Paying":t.paymentTerm!==Vd.NO_TERM}))}catch($ae){throw Error("Something went wrong, your card was not charged. Please try again later.")}var t,o,n,i;y(!1),ur()}},submitting:f}):m.createElement(Nee,{teams:t,setToCancelTeam:d})},xee=()=>{const e=cn((e=>e.hubModal)),t=cn((e=>e.hubModal.title)),a=cn((e=>e.hubModal.subtitle)),o=cn((e=>{var t;return null==(t=e.checkoutStore.REDUX_LEGACY_ID)?void 0:t.subscription}));n.exports.useEffect((function(){e.showModal===lr.PREDELETE_ACCOUNT&&o&&mr(lr.DELETE_ACCOUNT)}),[e.showModal,o]);const r=(()=>{switch(e.showModal){case lr.CANCEL_PLAN:return e.teamId?m.createElement(Aee,null):m.createElement(wee,null);case lr.PREDELETE_ACCOUNT:return m.createElement(A8,null);case lr.DELETE_ACCOUNT:return m.createElement(w8,null)}return m.createElement("div",null)})();return m.createElement(kx,{unsetCancelModal:ur,usePortal:!0},m.createElement("div",{className:bee,"data-cy":"hub-modal-overlay"},m.createElement("div",{className:See},m.createElement("div",{className:Tee},t),a&&m.createElement("div",{className:Iee},a)),m.createElement("div",null,r)))},Pee="Hub-module_hubContainer_1nL2t",Ree="Hub-module_sidebarSpacer_MjYqb",Oee="FloatingLinkMenu-module_tooltip_IZcex",Dee="FloatingLinkMenu-module_tooltipVisible_jzgc-",Lee="FloatingLinkMenu-module_linkMenu_PYIwP",Uee="FloatingLinkMenu-module_linkSection_bDsk3",Mee="FloatingLinkMenu-module_openButton_kD83u",Fee=()=>{const[e,t]=n.exports.useState(!1),[a,o]=n.exports.useState(!1),r=ao(),i=Ru(),s=[[{name:"Tools",href:"/tools",target:"_self"},{name:"Templates",href:"/templates",target:"_self"},{name:"Help Center",href:"https://www.kapwing.com/help"},{name:"Resources",href:"https://www.kapwing.com/resources"},{name:"Kapwing Youtube",href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1"},{name:"Blog",href:"https://www.kapwing.com/blog"},{name:"Release Notes",href:"https://www.kapwing.com/help/tag/release-notes/"},{name:"Contact Us",href:"/contact-us"}],[{name:"Careers",href:"/careers"},{name:"Partnerships",href:"/partnerships"},{name:"Creators Fund",href:"/creators-fund"},{name:"Affiliates",href:"/partnerships"}],[{name:"Refund Policy",href:"/policies/refund"},{name:"Privacy Policy",href:"/policies/privacy"},{name:"Terms of Service",href:"/policies/terms-of-service"}]],l=n.exports.useRef(null),c=n.exports.useCallback((e=>{const{target:a}=e;l.current&&a instanceof Node&&l.current.contains(a)||t(!1)}),[]);n.exports.useEffect((()=>e?(document.addEventListener("mouseup",c),()=>document.removeEventListener("mouseup",c)):()=>{}),[c,e]);const d=(e,t)=>{const{name:a,href:o,target:n="_blank"}=e;return m.createElement("a",{key:t,target:n,rel:"noreferrer",href:o},a)},u=m.createElement("div",{className:Lee},!i.planData.isFree&&m.createElement("div",{className:Uee},m.createElement("div",{onClick:()=>{o(!0),t(!1)}},"Report a Problem")),s.map(((e,t)=>m.createElement("div",{className:Uee,key:t},e.map(d)))),m.createElement("span",null,"© ",(new Date).getFullYear()," Kapwing. Release ","v2023.02.22.2","—",r,".")),p=m.createElement("div",{className:Dee},"Help and Resources"),h=m.createElement("button",{className:`${Mee} ${Oee}`,type:"button",onClick:()=>{t(!e)}},e?m.createElement(Sa,null):m.createElement(Ta,null),!e&&p);return m.createElement("div",{ref:l},a&&m.createElement(DZ,{hide:()=>o(!1),fromWorkspace:!0}),e&&u,h)};const Bee="WorkspaceSelector-module_disabled_-SJyl",Wee="WorkspaceSelector-module_wrapper_ENg9C",Vee="WorkspaceSelector-module_infoTooltip_fIEjw",jee="WorkspaceSelector-module_swTeamName_qFVs1",Hee="WorkspaceSelector-module_teamName_-uFrR",Gee="WorkspaceSelector-module_suggestedWorkspaceHeader_1EKFq",$ee="WorkspaceSelector-module_workspaceContainer_iaAYC",Kee="WorkspaceSelector-module_tooltip_jDT3i",Yee="WorkspaceSelector-module_container_kqx6F",zee="WorkspaceSelector-module_mobileDropdown_dMJmz",qee="WorkspaceSelector-module_mobileDropdownItems_QvnIw",Jee="WorkspaceSelector-module_mobileInvites_rXrNz",Xee="WorkspaceSelector-module_workspaceContainerMobile_cV6Kk",Qee="WorkspaceSelector-module_selected_1d40c",Zee="WorkspaceSelector-module_workspaceInviteContainerMobile_gPofT",ete="WorkspaceSelector-module_workspaceThumbnail_ipcXR",tte="WorkspaceSelector-module_currentWorkspaceInfo_k6moa",ate="WorkspaceSelector-module_iconChevronDown_Gn47T",ote="WorkspaceSelector-module_iconPersonAdd_MJQsj",nte="WorkspaceSelector-module_inviteButton_bQWAy",rte="WorkspaceSelector-module_profilePicture_QnIVa",ite="WorkspaceSelector-module_suggestedWorkspaceThumbnail_RNZ5z",ste="WorkspaceSelector-module_lightBulb_4bqgq",lte="WorkspaceSelector-module_workspaceInviteContainer_-3ils",cte="WorkspaceSelector-module_hidden_8DpEZ",dte="WorkspaceSelector-module_newBadge_Vs97P",ute="WorkspaceSelector-module_suggestedWorkspaceTooltip_LTQNb",mte="WorkspaceSelector-module_swTeamsContainer_NutOy",pte="WorkspaceSelector-module_smallProfilePicture_oAoal",hte="WorkspaceSelector-module_smallBadge_5K7jS",gte="WorkspaceSelector-module_workspaceInvite_Kh4dP",fte="WorkspaceSelector-module_actionsContainer_8JtZ5",yte="WorkspaceSelector-module_suggestedWorkspaceButton_gun9k",Ete="WorkspaceSelector-module_checkmark_V2cEV",_te="WorkspaceSelector-module_accept_7jVQs",vte="WorkspaceSelector-module_deleteSuggestionButton_v5kkl",wte="WorkspaceSelector-module_delete_BmSU7",bte="WorkspaceSelector-module_themeSwitch_M7rVw",Ste=({invite:e,close:t,tooltipPosition:a={x:0,y:0}})=>{const o=i.exports.useDispatch(),{team:r}=e,s=ed();return n.exports.useEffect((()=>(s||document.addEventListener("click",t),()=>{s||document.removeEventListener("click",t)}))),m.createElement("div",{className:s?"":Vee,style:{left:a.x,top:a.y},onClick:e=>{s||e.stopPropagation()},"data-testid":"invite-actions"},!s&&m.createElement("div",{className:Hee},r.name),m.createElement("div",{className:fte},m.createElement(W$,{testId:"invite-join-button",buttonText:"Join",className:_te,onClick:async()=>{await o(function(e){return async()=>{const{dispatch:t,state:a}=io(),{currentUser:o,teams:n}=a,{allInvites:r}=n,{token:i,user:s}=o||{},{_id:l}=s||{},{email:c}=s||{},d={token:i,userId:l,inviteKey:e.inviteKey};try{const a=await op("/api/v1/teams/invites/accept",{body:d});if(a.teamId){t(dg(a.teamId)),t(bh("Invite accepted.")),t(mg([...r].filter((t=>t._id!==e._id)))),await t(_g());const o=Bu();if(o){const e=await ap(`/api/v2/payment/teamCheckoutData?teamId=${o._id}`);Xh(s,a.inviterEmail,c,"Workspace Dropdown",o,ig(e.subscription))}}}catch(u){t(wh("There was an issue joining the team, please try again."))}}}(e)),YO(e.team._id)}}),m.createElement(W$,{buttonText:"Delete",className:wte,onClick:()=>{o(function(e){return async()=>{const{dispatch:t,state:a}=io(),{teams:o}=a,{allInvites:n}=o,r={inviteId:e._id};try{await tp("/api/v1/teams/invites",{body:r,parseJSON:!1}),t(mg([...n].filter((t=>t._id!==e._id))))}catch($ae){console.error($ae)}}}(e))}})))},Tte=({invite:e})=>{const[t,a]=n.exports.useState(!1),{team:o}=e,r=ed(),[i,s]=n.exports.useState({x:0,y:0}),l=()=>m.createElement("div",{className:dte},"NEW!");return r?m.createElement("div",{className:Zee},m.createElement("div",{className:Xee},m.createElement("div",{className:gte},l(),m.createElement(jO,{team:o,className:ete})),m.createElement("div",{className:Hee},o.name)),!t&&m.createElement(Ste,{invite:e,close:()=>{a(!1)}})):m.createElement("div",{className:lte,onMouseEnter:e=>{const t=e.currentTarget.getBoundingClientRect(),{x:a}=t,o=t.height/2+t.top;s({x:a+38,y:o})}},t&&m.createElement(Ste,{invite:e,close:()=>{a(!1)},tooltipPosition:i}),m.createElement("div",{className:`${Kee} ${t?cte:""}`,style:{left:i.x,top:i.y},"data-testid":"invite-tooltip"},"Click to see workspace invitation"),l(),m.createElement("div",{className:gte,"data-testid":"workspace-selector-invite-thumbnail",onClick:()=>{a(!t)}},m.createElement(jO,{team:o,className:ete})))},Ite=({allTeams:e,allInvites:t,close:a,renderWorkspace:o})=>(n.exports.useEffect((()=>(document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}))),m.createElement("div",{onClick:e=>e.stopPropagation(),className:zee},m.createElement("div",{className:qee},m.createElement("div",{className:Jee},null==t?void 0:t.map((e=>m.createElement(Tte,{invite:e,key:e._id})))),null==e?void 0:e.map((e=>o(e)))))),kte=({suggestedWorkspaces:e,close:t,tooltipPosition:a={x:0,y:0}})=>{const{currentUser:o,teamEmailDomain:r}=cn((e=>{var t,a;return{currentUser:e.currentUser,teamEmailDomain:null==(a=null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.teams[0])?void 0:a.emailDomain}}),dn),s=i.exports.useDispatch(),l=ed(),[c,d]=n.exports.useState([]),u=n.exports.useRef(null);n.exports.useEffect((function(){(async()=>{const e=await ap(`/api/v1/requests/userId/${o.user._id}`);d(e.requests.map((e=>e.teamId)))})()}),[]);const p=async t=>{try{const a=e.teams.filter((e=>e._id!==t));s(iy({isQualifiedLead:e.isQualifiedLead,teams:a})),await op("/api/v2/teams/deleteSuggestion",{body:{teamId:t}})}catch($ae){console.error($ae)}},h=async t=>{await $h(t,o),Cf(kf.Sidebar,t,o),(()=>{var a;const o=null==e?void 0:e.teams.map((e=>(e._id===t&&(e.requestSent=!0),e)));s(iy({teams:null!=o?o:[],isQualifiedLead:null!=(a=null==e?void 0:e.isQualifiedLead)&&a}))})(),d((e=>[...e,t])),setTimeout((()=>{p(t)}),3e3)},g=e=>{var a;switch(null==(a=e.settings)?void 0:a.discoverability){case Vr.AnyoneCanJoin:return()=>(async e=>{try{if(!(await op(`/api/v2/teams/${e}/join`)).success)throw new Error;s(bh("Successfully joined team.")),s(_g()),s(dg(e)),await YO(e),await p(e),t()}catch(a){s(wh("Something went wrong with joining the team, please try again later."))}})(e._id);case Vr.RequestToJoin:default:return()=>h(e._id)}},f=e=>{var t;if(e.requestSent||c.includes(e._id))return m.createElement("div",null,m.createElement(Zt,{className:Ete}),"Request Sent");switch(null==(t=e.settings)?void 0:t.discoverability){case Vr.AnyoneCanJoin:return"Join";case Vr.RequestToJoin:default:return"Ask to Join"}},y=e=>e.requestSent||c.includes(e._id)?Bee:yte;n.exports.useEffect((()=>(l||document.addEventListener("click",t),()=>{l||document.removeEventListener("click",t)})),[]);return m.createElement("div",{className:l?"":Vee,style:{left:a.x,top:u.current?a.y-u.current.clientHeight/2<0?a.y+(u.current.clientHeight/2-20):a.y+u.current.clientHeight/2>window.innerHeight?a.y-(u.current.clientHeight/2-20):a.y:a.y},onClick:e=>{l||e.stopPropagation()},ref:u},m.createElement("div",{className:ute},m.createElement("div",{className:Gee},"Suggested Workspaces ",r?`for ${r}`:""),e.teams.map((e=>m.createElement("div",{className:mte,key:e._id},m.createElement(jO,{team:e,className:pte}),m.createElement("div",{className:jee},e.name),m.createElement("div",{className:fte},m.createElement(W$,{buttonText:f(e),className:y(e),onClick:g(e)}),!e.requestSent&&m.createElement(W$,{icon:m.createElement(Ca,null),className:vte,onClick:()=>p(e._id)})))))))},Cte=({suggestedWorkspaces:e})=>{const{currentUser:t,allTeams:a,pendingInvites:o,isQualifiedLead:r}=cn((e=>{var t;return{currentUser:e.currentUser.user,allTeams:e.teams.allTeams,pendingInvites:e.teams.allInvites,isQualifiedLead:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedLead}}),dn),[i,s]=n.exports.useState(!1),l=ed(),[c,d]=n.exports.useState({x:0,y:0}),u=t.upsells;n.exports.useEffect((function(){const t=null==e?void 0:e.teams.map((e=>e._id));a.some((e=>null==t?void 0:t.includes(e._id)))&&ez()}),[a,null==e?void 0:e.teams]);return!(null==e?void 0:e.isQualifiedLead)||l?null:m.createElement("div",{className:lte},m.createElement("div",{className:ite,onMouseEnter:e=>{const t=e.currentTarget.getBoundingClientRect(),{x:a}=t,o=t.height/2+t.top;d({x:a+38,y:o})},onClick:()=>{(null==u?void 0:u.suggestedWorkspacesSidebar)||(()=>{const e=new Date;jg({...u,suggestedWorkspacesSidebar:{dateShown:e}}),Og()})(),i?s(!1):(If({numPendingInvites:o?o.length:0,suggestedWorkspaces:e,entryPoint:kf.Sidebar,isQualifiedLead:r}),s(!0))}},m.createElement("div",{className:`${Kee} ${i?cte:""}`,style:{left:c.x+10,top:c.y}},"Click to see Suggested Workspaces"),m.createElement(ca,{className:ste}),(null==u?void 0:u.suggestedWorkspacesSidebar)?null:m.createElement("div",{className:`${dte} ${hte}`},null==e?void 0:e.teams.length)),i&&m.createElement(kte,{suggestedWorkspaces:e,close:()=>s(!1),tooltipPosition:c}))},Nte=()=>{const e=ed(),t=i.exports.useDispatch(),{allTeams:a,allInvites:o,currentTeamId:r,notifications:s,suggestedWorkspaces:l}=cn((e=>({currentTeamId:e.teams.selectedTeamId,allTeams:e.teams.allTeams,allInvites:e.teams.allInvites,notifications:e.notifications.notifications,suggestedWorkspaces:e.workspaces.suggestedWorkspaces})),dn),c=Ru(),d=pO(),[u,p]=n.exports.useState(void 0),h=Yh(r),[g,f]=n.exports.useState(!1),[y,E]=n.exports.useState(!1),_=n.exports.useRef(!1),[v,w]=n.exports.useState({x:0,y:0});n.exports.useEffect((()=>{(async()=>{try{t(wg())}catch($ae){console.error($ae);const a=$ae.message||"There was a problem fetching your invites. Please try again later.";t(wh(a))}})()}),[t,s]),n.exports.useEffect((function(){ez()}),[]);const b=async e=>{if(!_.current){_.current=!0;try{await YO(e)}catch($ae){console.error($ae)}finally{_.current=!1}}},S=t=>{const a=t._id===r;return e?m.createElement("div",{onClick:async()=>{b(t._id),f(!1)},className:`${Xee} ${a?Qee:""}`,key:t._id},m.createElement("div",{className:`${ete} ${a?Qee:""}`},m.createElement(jO,{team:t,className:rte})),m.createElement("div",{className:Hee},t.name)):m.createElement("div",{className:$ee,key:t._id},m.createElement("div",{onClick:async()=>{b(t._id)},className:`${ete} ${a?Qee:""}`,onMouseEnter:e=>{const a=e.currentTarget.getBoundingClientRect(),{x:o}=a,n=a.height/2+a.top;p(t),w({x:o+38,y:n})},"data-testid":"workspace-selector-workspace-thumbnail"},m.createElement(jO,{team:t,className:rte})))},T=()=>{c.isMultiUser?E(!0):d((()=>null),{action:ou.INVITE_MEMBERS})()};return m.createElement(m.Fragment,null,y&&m.createElement(P4,{hide:()=>{E(!1)},initialStep:1,entryPoint:eg.WORKSPACE_HEADER}),e?m.createElement("div",{className:Wee,"data-cy":"workspace-selector","data-testid":"workspace-selector"},m.createElement("div",{className:Yee},m.createElement("div",{className:tte,onClick:()=>{f(!g)}},m.createElement("div",{className:ete},m.createElement(jO,{team:h,className:rte})),m.createElement("div",{className:Hee,"data-cy":"team-workspace-name"},null==h?void 0:h.name),m.createElement("div",{className:ate},g?m.createElement(Ia,null):m.createElement(ka,null))),m.createElement(W$,{icon:m.createElement("div",{className:ote,onClick:T},m.createElement(ma,null)),className:nte})),g&&e&&m.createElement(Ite,{allInvites:null!=o?o:[],allTeams:null!=a?a:[],renderWorkspace:S,close:()=>f(!1)})):m.createElement("div",{className:Wee,"data-cy":"workspace-selector","data-testid":"workspace-selector"},m.createElement("div",{className:Yee},null==o?void 0:o.map((e=>m.createElement(Tte,{invite:e,key:e._id}))),null==a?void 0:a.map((e=>S(e))),(null==l?void 0:l.isQualifiedLead)&&l.teams.length>0&&m.createElement(Cte,{suggestedWorkspaces:l}),u?m.createElement("div",{className:Vee,style:{left:v.x,top:v.y},"data-testid":"workspace-tooltip"},m.createElement("div",null,m.createElement(t9,{overrideTeam:u})),m.createElement("div",{className:Hee},u.name),m.createElement("div",null,"-"),m.createElement("div",null,null==(I=u.users)?void 0:I.length," Member",(null==(k=u.users)?void 0:k.length)>1&&m.createElement("span",null,"s"))):null),m.createElement("div",{className:bte},m.createElement($I,{vertical:!0,darkColorsOnly:!0}))));var I,k},Ate=()=>{const{currentUser:e,currentFolderId:t,allFolders:a,teamId:o,showSuccessToast:r}=cn((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,allFolders:e.workspaces.allWorkspaces,teamId:e.teams.selectedTeamId,showSuccessToast:e.toasts.showSuccess})),dn),s=me(),l=i.exports.useDispatch(),c=Fe(),d=oe(),u=ed(),p=cn((e=>e.hubModal.showModal)),[h,g]=n.exports.useState({}),[f,y]=n.exports.useState(""),[E,_]=n.exports.useState(!1),[v,w]=n.exports.useState(!1),[b,S]=n.exports.useState(!0),[T,I]=n.exports.useState(!1),[k,C]=n.exports.useState("");n.exports.useEffect((function(){om(e)?N():(c.push(`/signin?next=${d.pathname}${d.search}`),l(wh("You must be signed in to view this page.")))}),[]),n.exports.useEffect((function(){const e=new URLSearchParams(d.search);if(e.has(Ho.ScheduledMarketingEmail)){fm("Visit From Marketing Email",{"Template Id":e.get(Ho.ScheduledMarketingEmail)||void 0})}}),[d.search]);const N=n.exports.useCallback((async()=>{var e;const a=s.params.teamId||!1,o=!a&&(null!=(e=s.params.id)?e:t);await l(_g());const n=await l(IS(o,a));["/brandkit","/team/request"].includes(s.url)||s.url.includes("/team/")||c.push({pathname:`/folder/${n}`,state:c.location.state}),S(!1),l(Eg())}),[l,c,s.url]);n.exports.useEffect((function(){return()=>{r&&l({type:"HIDE_SUCCESS"})}}),[l,r]),n.exports.useEffect((()=>{I(!1)}),[o]),n.exports.useEffect((function(){var e;(null==(e=d.state)?void 0:e.openModal)===vk.account&&w(!0)}),[d.state]),n.exports.useEffect((()=>{!async function(){var t;if(a.length<2)return void C(o);if(T||!o)return;I(!0);const{token:n,user:r}=e,i={token:n,userId:null==r?void 0:r._id,teamId:o};let s,l=!0;for(;l;){let e;try{e=await ap("/api/v1/workspaces/loadVideos",{params:i})}catch($ae){break}const a=e||[],o={};if(s=null==(t=a.slice(-1)[0])?void 0:t._id,i.lastId=s,a){a.forEach((e=>{o[e.workspaceId]?o[e.workspaceId].push(e):o[e.workspaceId]=[e]}));for(const e of Object.keys(o)){if(e===f)continue;const t=o[e];P(t,e)}i.lastId||(l=!1)}else l=!1}C(o)}()}),[o,a,e]);n.exports.useEffect((()=>{(async(e,t)=>{var a,o;if(!e)return;_(!1);let n=!0;for(t.lastId="";n;){let i;try{"shared-with-me"===e?(i=await ap("/api/v1/sharedProjects",{params:t}),_(!0)):(i=await ap("/api/v1/home",{params:t}),_(!0))}catch($ae){r=$ae,console.error(r),fm("Failed to load workspace",{message:qI(r),status:r instanceof Qm?r.status:void 0});break}const s=i.projects,c=null==(a=i.workspace)?void 0:a._id,{brandkitTemplates:d}=i;c!==f&&y(c),d&&l(yg(d)),s?(P(s,e),t.lastId=null==(o=s.slice(-1)[0])?void 0:o["shared-with-me"===c?"sharedId":"_id"],(!t.lastId||s.length<50)&&(n=!1)):n=!1,e!==f&&(n=!1)}var r})(f,{...h})}),[f]),n.exports.useEffect((()=>{k&&function(e){if(_f.has(e))return;_f.add(e);const{workspaces:t,projects:a}=io().state,{allWorkspaces:o}=t,n=new Set(o.filter((t=>t.teamId===e)).map((e=>e._id))),r=Object.keys(a.projectIdsByFolderId).filter((e=>n.has(e))).reduce(((e,t)=>e+Object.keys(t).length),0),i=n.size;fm("All Workspace Folders Loaded",{"Workspace ID":e,"Number of Projects":r,"Number of Folders":i})}(k)}),[k]);const A=n.exports.useCallback((async()=>{if(["/folder","/folder/"].includes(s.url))t?c.push(`/folder/${t}`):D();else if("/folder/:id"===s.path&&s.params.id){const e=s.params.id;if(e!==t&&!["invite","create"].includes(e))if(nb(e))l(Af(e));else{const t=await JY(e);if(t)YO(t.teamId,e),l(Af(e));else{l(wh(`There was an error with navigating to folder ${e}.`));const t=ub();l(Af(t)),c.push(`/folder/${t}`)}}}else["/shared-with-me","/shared-with-me/"].includes(s.url)&&"shared-with-me"!==t&&l(Af("shared-with-me"))}),[s.url]);n.exports.useEffect((()=>{A()}),[A,s.url]);const x=(e,t)=>{g(t),y(e)},P=(e,t)=>{l(mT({projects:e,folderId:t}))},R=n.exports.useCallback((async e=>{if(!e)return;const t=(await ap("/api/v1/home",{params:e})).projects||[];if(!t)return;const{workspaceId:a}=e;l(mT({projects:t,folderId:a.toString()}))}),[l]),O=n.exports.useCallback((()=>m.createElement(mk,{fetchNewProjects:R,startFetchingProjects:x,initialProjectsLoaded:E})),[R,E]),D=n.exports.useCallback((async()=>{let t;S(!0);try{t=await l(IS("",o))}catch($ae){console.error($ae)}return t?(S(!1),c.push(`/folder/${t}`)):(l(wh("There was an error loading your folders.")),l(dg("")),om(e)?c.push("/home"):c.push("/signin"))}),[l,c,e,o]);return om(e)?b?m.createElement(ik,null):m.createElement(m.Fragment,null,p&&m.createElement(xee,null),m.createElement(gD,null),!u&&m.createElement(Nte,null),m.createElement(q5,{width:282,openAccountSettings:()=>w(!0)}),m.createElement(Fee,null),m.createElement(r7,{openAccountSettings:()=>w(!0)}),m.createElement("div",{className:Pee},u&&m.createElement(Nte,null),m.createElement("div",{className:Ree}),v&&m.createElement(d8,{closeAccountSettings:()=>{w(!1),window.history.replaceState({},document.title)}}),m.createElement($e,null,m.createElement(Ke,{exact:!0,path:"/brandkit",component:pk}),m.createElement(Ke,{exact:!0,path:"/folder/:id",render:O}),m.createElement(Ke,{exact:!0,path:"/folder/:id/rename",render:O}),m.createElement(Ke,{exact:!0,path:"/folder/create",render:O}),m.createElement(Ke,{exact:!0,path:"/folder/:id/create",render:O}),m.createElement(Ke,{exact:!0,path:"/shared-with-me",render:O}),m.createElement(Ke,{path:"/team/:id",component:ck}),m.createElement(Ke,{path:"/settings",component:dk}),m.createElement(Ke,{path:"/settings/folder/cancel",component:dk})))):m.createElement(Qt,{to:"/signin"})},xte=()=>{const e=cn((e=>{var t;return null==(t=e.currentUser.user)?void 0:t._id})),t=i.exports.useDispatch(),a=n.exports.useRef(null);return n.exports.useEffect((function(){const o=(()=>{const{token:e}=io().state.currentUser;return e})();if(o){const n=new Na(`${function(){let e;e=Za?Za.replace("http","ws"):`wss://notifications.${zm()||Km().includes("dev")?"kapwing-dev":"kapwing"}.com`;return`${e}/websocket`}()}?token=${o}&userId=${e}`,[],{maxReconnectionDelay:7e3});let r;n.addEventListener("open",(e=>{console.info("notifications websocket open",e),r=window.setInterval((()=>{n.send('{"keepAlive":"heartbeat"}')}),1e4)})),n.addEventListener("message",(e=>{const a=JSON.parse(e.data);console.info("new websocket message",a),a.userNotifs&&t(sT(a.userNotifs)),a.newNotifs&&t(lT(a.newNotifs))})),n.addEventListener("error",(e=>{console.error("Error connecting to notifications websocket",e),window.clearInterval(r)})),n.addEventListener("close",(e=>{console.info("websocket closed",e),window.clearInterval(r)})),a.current=n}return()=>{var e;null==(e=a.current)||e.close()}}),[t,e]),null},Pte="ExamplesAdmin-module_container_OMUJg",Rte="ExamplesAdmin-module_thumbnailContainer_yYdpH",Ote="ExamplesAdmin-module_thumbnail_1AR1M",Dte="ExamplesAdmin-module_header_S1iUl";class Lte extends n.exports.Component{constructor(e){super(e),t(this,"getTemplateChildren",(()=>{const{currentTemplate:e,getTemplateChildren:t}=this.props;t(e._id).then((e=>{this.setState({children:e,loading:!1})})).catch((e=>{console.error(e.message),this.setState({loading:!1})}))})),this.state={children:[],loading:!0}}componentDidMount(){this.getTemplateChildren()}renderChildren(){const{children:e}=this.state;return e.length?m.createElement(m.Fragment,null,e.map((e=>{const t=N_(e);return m.createElement(_e,{className:Rte,key:e._id,to:`/videos/${e._id}`},m.createElement("img",{src:t,className:Ote,alt:"Thumbnail",loading:"lazy"}))}))):m.createElement("div",null,"No children found.")}render(){const{loading:e}=this.state;return m.createElement("div",{className:Pte},m.createElement("div",{className:Dte},"Content created with this template:"),m.createElement("div",null,"Click to view the content. Use the admin actions on the content page to add the selected video to this template's examples."),m.createElement("span",null,e?"Loading children...":this.renderChildren()))}}const Ute=ie(i.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,currentTemplate:e.currentTemplate})),(e=>he({getTemplateChildren:_B,showSuccess:bh},e)))(Lte)),Mte="TemplateActions-module_container_PvTei",Fte="TemplateActions-module_header_uhiup",Bte="TemplateActions-module_actions_RMikg",Wte="TemplateActions-module_button_xLXlv",Vte="TemplateActions-module_monospace_5pLR3",jte=ie(i.exports.connect((e=>({currentTemplate:e.currentTemplate})),(e=>he({deleteTemplate:bB,showSuccess:bh,showError:wh},e)))((e=>{const{currentTemplate:t}=e;return m.createElement("div",{className:Mte},m.createElement("div",{className:Fte},"Template admin actions"),m.createElement("div",null,"This section is visible only to admin accounts. The current template ID is:"," ",m.createElement("span",{className:Vte},'ObjectId("',t._id,'")')),m.createElement("div",{className:Bte},m.createElement("div",{className:Wte,onClick:()=>{const{history:t}=e;t.push("/admin/templates/update")}},"Edit template"),m.createElement("div",{className:Wte,onClick:()=>{const{deleteTemplate:t,showError:a,showSuccess:o,history:n,currentTemplate:r}=e;window.confirm(`Are you sure you want to delete ${r.title}?`)&&t(r).then((e=>{o("Template deleted!"),n.push("/admin/templates")})).catch((e=>{a("An error occurred while deleting template.")}))}},"Delete template"),m.createElement("div",{className:Wte,onClick:t=>{const{history:a,currentTemplate:o}=e,n=`/videos/${o.video_id}`;a.push(n)}},"View video asset"),m.createElement("div",{className:Wte,onClick:()=>{const{history:t}=e;t.push("/admin/templates")}},"Back to all templates")),m.createElement(Ute,null))})));var Hte=(e=>(e.LANDING_PAGE_GET_STARTED="LANDING_PAGE_GET_STARTED",e.PASTE_LINK="PASTE_LINK",e.UPLOAD_FILES="UPLOAD_FILES",e.EDIT_THIS_TEMPLATE="EDIT_THIS_TEMPLATE",e.WORKSPACE="WORKSPACE",e.HOME_PAGE="HOME_PAGE",e))(Hte||{});const Gte=({entry:e,template:t,defaultOrigin:a=""})=>{const{dispatch:o}=io();setTimeout((()=>{switch(e){case"PASTE_LINK":lH({callToAction:pm.PasteALink});break;case"UPLOAD_FILES":lH({callToAction:pm.UploadFiles});break;case"WORKSPACE":lH({callToAction:pm.NewContentWorkspace});break;case"EDIT_THIS_TEMPLATE":o(TB("explore")),lH({callToAction:pm.EditThisTemplate,template:t});break;case"HOME_PAGE":case"LANDING_PAGE_GET_STARTED":o(l_(a)),lH({callToAction:pm.GetStarted,originOverride:a})}o(Iy())})),o(ol())};async function $te(e){if("templates"===e.origin)return;const{dispatch:t,state:a}=io();if(!rJ(a))return;const o=Object.keys(e.thisProjectCMLFiles||{});0!==o.length&&(await async function(e){return await op("/api/v1/cloudMediaLibrary/myMedia/addFiles",{body:{cmlFileIds:e}})}(o),t(ah(o)))}function Kte(e=!1){const{dispatch:t,state:{currentUser:a,projectName:o,studio:n},history:r}=io();t(_S(!0));const i=!n._id;t(Sl("http")),t(f$({currentUser:a,publish:!1,auto:e,createLocation:`studio-save-${e}`})).then((s=>{if(t(Tl("http")),Lf(s.projectId,{name:o},a),t(_S(!1)),i&&$te(n),jl()){if(!e||i){const e=r.location.pathname;Bl(e)}else t(ES(!1));s&&Yte(s._id)}})).catch((e=>{console.error(e),t(wh(e.message))})).finally((()=>{t(_S(!1))}))}async function Yte(e=null){const{dispatch:t,state:{studio:a}}=io(),{scenes:o,draft:n}=a;try{if(n&&e&&!function(e){for(const t of e)for(const e of t.layers)if(e.uploadPending&&"pastedLink"===e.source)return!0;return!1}(o)){const[o,n]=await aH(a,Ds.Thumbnail),r=Vk(o,n);LG([r],{eventHandlers:{handleFinish:a=>{t(E$(a.url));const o={image_url:a.url};e&&v$(e,o)}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromMediaLibrary:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Save"}})}}catch(r){r.noRemoveBgUrl||t(wh(r))}}const zte="AdminLongTailAnalytics-module_container_8q1rk",qte="AdminLongTailAnalytics-module_adminLabel_Mspap",Jte="AdminLongTailAnalytics-module_analyticsRow_Faemz",Xte="AdminLongTailAnalytics-module_box_kteIn",Qte="AdminLongTailAnalytics-module_metricName_RigA8",Zte="AdminLongTailAnalytics-module_metricValue_I-nX5";class eae extends n.exports.Component{constructor(e){super(e),this.state={loaded:!1,error:void 0}}async componentDidMount(){var e;const{currentUser:t}=this.props;if(!im(t))return;let a=new URLSearchParams(window.location.search).get("path");a||(a=window.location.pathname);const{token:o}=t,n={token:o,userId:null==(e=null==t?void 0:t.user)?void 0:e._id,path:a};try{const e=await ap("/api/v1/admin/longTailAnalytics",{params:n});this.setState({...e,loaded:!0})}catch($ae){this.setState({error:$ae.message,loaded:!0})}}render(){const{currentUser:e}=this.props,{loaded:t,pageViews:a,bounceRate:o,avgTimeOnPage:n,error:r}=this.state;return im(e)&&t?m.createElement("div",{className:zte},m.createElement("span",{className:qte},"Page Analytics - Last 7 Days (Only Admins See This)"),r&&m.createElement("span",null,r),!r&&m.createElement("div",{className:Jte},m.createElement("div",{className:Xte},m.createElement("span",{className:Qte},"Page Views"),m.createElement("span",{className:Zte},a)),m.createElement("div",{className:Xte},m.createElement("span",{className:Qte},"Bounce Rate"),m.createElement("span",{className:Zte},o&&o.toFixed(2),"%")),m.createElement("div",{className:Xte},m.createElement("span",{className:Qte},"Average Time on Page"),m.createElement("span",{className:Zte},n&&n.toFixed(2)," seconds")))):null}}const tae=ie(i.exports.connect((e=>({currentUser:e.currentUser})))(eae)),aae=Object.freeze(Object.defineProperty({__proto__:null,default:tae},Symbol.toStringTag,{value:"Module"})),oae="LetterLinks-module_letterLinksContainer_QwlZ6",nae="LetterLinks-module_letterLinksHeader_N5w6H",rae="LetterLinks-module_letterLink_MD-Ac",iae="LetterLinks-module_selectedLetterLink_ETw7G",sae="LetterLinks-module_more_IoQTr",lae="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),cae=({className:e,keyword:t,routePrefix:a})=>{const{letter:o}=jt();let n="";return o&&(n=o.toUpperCase()),m.createElement("div",{className:`${oae} ${e||""}`},m.createElement("div",{className:nae},"Browse ",t," starting with:"),lae.map((e=>m.createElement("div",{className:n===e?iae:rae,key:e,"data-cy":"letter-link"},m.createElement(_e,{to:`/${a}/directory/${e}`},e)))),m.createElement("div",{className:"MORE"===n?iae:rae,key:o},m.createElement(_e,{to:`/${a}/directory/more`,className:sae},"*")),m.createElement("div",{className:rae,key:"all"},m.createElement(_e,{to:`/${a}`,className:sae},"All ",t)))},dae="ExploreTemplate-module_splash_NuUxD",uae="ExploreTemplate-module_subtext_sgdJk",mae="ExploreTemplate-module_makeItSubtext_zveaE",pae="ExploreTemplate-module_wrapper_HwPsJ",hae="ExploreTemplate-module_container_5quob",gae="ExploreTemplate-module_infoContainer_qWYEA",fae="ExploreTemplate-module_contentContainer_KEVeX",yae="ExploreTemplate-module_video_ImBWU",Eae="ExploreTemplate-module_image_3pgvL",_ae="ExploreTemplate-module_mobileButton_uDFmq",vae="ExploreTemplate-module_desktopButton_DHIl1",wae="ExploreTemplate-module_buttonText_-5p0O",bae="ExploreTemplate-module_browseContainer_y97Be",Sae="ExploreTemplate-module_keywordHeader_5M1P9",Tae="ExploreTemplate-module_keywords_scFRn",Iae="ExploreTemplate-module_keyword_IasdR",kae="ExploreTemplate-module_infoRow_YXndy",Cae="ExploreTemplate-module_bullet_0k1ZV",Nae="ExploreTemplate-module_genericDescription_cZeSt",Aae="ExploreTemplate-module_row_TZTsE",xae="ExploreTemplate-module_icon_SNoVK";class Pae extends n.exports.Component{constructor(e){super(e),t(this,"loadImage",(e=>{const t=e.getAttribute("src"),a=e.getAttribute("data-src");if(a){if(t===a)return;e.setAttribute("src",e.getAttribute("data-src")),e.onload=()=>{e.removeAttribute("data-src")}}})),t(this,"updateCurrentTemplate",(()=>{const{showError:e,fetchTemplate:t,match:a,history:o}=this.props,{params:n}=a,{slug:r}=n;this.setState({loading:!0}),t(r).then((e=>{this.setState({loading:!1}),this.loadTemplateFonts(e)})).catch((t=>{e(t.message),o.replace("/explore"),this.setState({loading:!1})}))})),t(this,"loadTemplateFonts",(e=>{var t;if(null==(t=null==e?void 0:e.video)?void 0:t.layers){const t=[];for(const a of e.video.layers)"text"===a.type&&a.fontFamily&&t.push(a.fontFamily);t.length>0&&ZN(t)}})),t(this,"goToEditor",(async()=>{const{history:e,isSingleMedia:t,setTemplateSource:a,showError:o,slug:n,title:r,video_id:i}=this.props;if(Gte(Hte.EDIT_THIS_TEMPLATE),this.setState({loadingTemplate:!0}),i)a("explore"),e.push(`/editor/videos/${i}`);else if(t){const{resetStudio:e,addLayers:t,singleMedia:o}=this.props,{url:n}=o;e();const r=await lV(n,{source:"upload"});a("explore"),t({layer:[r]}),$l()}else o("The template could not be loaded. Please try again later."),this.setState({loadingTemplate:!1})})),t(this,"isMp4",(e=>{if("string"!=typeof e)return!0;try{return new URL(e).pathname.endsWith(".mp4")}catch($ae){return e.endsWith(".mp4")}})),this.state={loading:!1,loadingTemplate:!1},this.image=m.createRef()}componentDidMount(){const{setParentId:e,currentTemplate:t,match:a}=this.props,{params:o}=a,{slug:n}=o;(null==t?void 0:t._id)&&e(t._id),(E(t)||t.slug!==n)&&this.updateCurrentTemplate();const r=this.image.current;r&&this.loadImage(r)}componentDidUpdate(e){const{_id:t,setParentId:a}=this.props;e._id!==t&&a(t);const o=this.image.current;o&&this.loadImage(o)}renderMedia(){const{title:e,thumbnail:t}=this.props,a=k_(this.props,"image_url"),o=k_(this.props,"video_url")||a,n=!this.isMp4(o);let r=a,i=480,s=480;if(!E(t)){const{url:e,width:a,height:o}=t;r=e,a>=o?s=Math.round(o*i/a):i=Math.round(a*s/o)}return n?m.createElement("img",{src:r,"data-src":a,alt:e,className:Eae,ref:this.image,width:i,height:s}):m.createElement("video",{className:yae,controls:!0,src:o,playsInline:!0,preload:"auto",poster:a,autoPlay:!0,muted:!0,width:i,height:s})}renderKeywords(){const{keywords:e,description:t}=this.props;if(t)return null;if(e&&e.length){const t=e.split(", ");return m.createElement("div",{className:Tae},m.createElement("span",{className:Sae},"Keywords:"),t.map((e=>m.createElement("span",{className:Iae,key:e},`${e} `))))}return null}renderGenericDescription(){return m.createElement("div",{className:Nae},m.createElement("div",{className:Aae},m.createElement("div",{className:xae},m.createElement(Aa,null)),m.createElement("div",null,"100% customizable online")),m.createElement("div",{className:Aae},m.createElement("div",{className:xae},m.createElement(xa,null)),m.createElement("div",null,"No watermarks (just sign in!)")),m.createElement("div",{className:Aae},m.createElement("div",{className:xae},m.createElement(Pa,null)),m.createElement("div",null,"Fast and powerful")),m.createElement("div",{className:Aae},m.createElement("div",{className:xae},m.createElement(Ra,null)),m.createElement("div",null,"Edit and download from any device")),m.createElement("div",{className:Aae},m.createElement("div",{className:xae},m.createElement(Oa,null)),m.createElement("div",null,"Add video, audio, and images")))}renderContent(){const{title:e,description:t,currentUser:a,height:o,width:n}=this.props,{loadingTemplate:r}=this.state,i=k_(this.props,"video_url");let s=!0;return i&&i.endsWith("mp4")&&(s=!1),m.createElement(m.Fragment,null,m.createElement("div",{className:pae,"data-cy":"explore-template-container"},m.createElement("div",{className:hae},m.createElement("div",{className:gae},m.createElement("h1",{className:dae},e),m.createElement("div",{onClick:this.goToEditor,className:fae},this.renderMedia()),r?m.createElement("button",{type:"button",className:_ae,disabled:!0},"Loading ..."):m.createElement("button",{type:"button",className:_ae,"data-cy":"edit-template-button-mobile",onClick:this.goToEditor},m.createElement("div",{className:wae},"Edit This Template"),m.createElement(Da,{className:"collage-chevron",size:18})),m.createElement("div",null,m.createElement("div",{className:kae},o&&n&&m.createElement(m.Fragment,null,m.createElement("div",null,Math.round(n),"px × ",Math.round(o),"px"),m.createElement("div",{className:Cae},"•")),m.createElement("div",null,s?"Image Template":"Video Template")),t?m.createElement("h3",{className:uae,dangerouslySetInnerHTML:{__html:t}}):this.renderGenericDescription(),m.createElement("button",{type:"button",className:vae,"data-cy":"edit-template-button-desktop",disabled:r,onClick:this.goToEditor},r?"Loading...":m.createElement(m.Fragment,null,m.createElement("div",{className:wae},"Edit This Template"),m.createElement(Da,{className:"collage-chevron",size:18}))),m.createElement("div",{className:mae},"Click above to edit this template directly in your browser. Easily remix this template with your own text, images, and videos."),this.renderKeywords())))),m.createElement("div",{className:bae},m.createElement(cae,{keyword:"templates",routePrefix:"explore"})),m.createElement(HO,null,m.createElement(tae,null),im(a)&&m.createElement(jte,null)))}render(){const{loading:e}=this.state,{title:t,description:a,keywords:o,currentTemplate:n}=this.props,{match:r}=this.props,{params:i}=r,{slug:s}=i;if(E(n)||n.slug!==s)return m.createElement(ik,null);const l=k_(this.props,"image_url");let c=a;return c||(c=`Use this customizable ${t} page as a starting point for your content. Create and edit this template for free in just a few clicks. Find and discover new content on Kapwing.`),m.createElement(m.Fragment,null,m.createElement(Ce,null,m.createElement("title",null,t),m.createElement("meta",{name:"description",content:c}),m.createElement("meta",{name:"keywords",content:o}),m.createElement("meta",{property:"og:title",content:t}),m.createElement("meta",{property:"og:description",content:c}),m.createElement("meta",{property:"og:image",content:l}),m.createElement("meta",{property:"twitter:image",content:l}),m.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/explore/${s}`})),m.createElement(yD,null),e?m.createElement(ik,null):this.renderContent(),m.createElement(HC,null))}}const Rae=ie(i.exports.connect((e=>{var t,a,o,n,r,i,s,l,c,d,u,m,p,h,g;return{currentUser:e.currentUser,currentTemplate:e.currentTemplate,_id:null==(t=e.currentTemplate)?void 0:t._id,description:null==(a=e.currentTemplate)?void 0:a.description,keywords:null==(o=e.currentTemplate)?void 0:o.keywords,og_description:null==(n=e.currentTemplate)?void 0:n.og_description,image_url:null==(r=e.currentTemplate)?void 0:r.image_url,title:null==(i=e.currentTemplate)?void 0:i.title,video_id:null==(s=e.currentTemplate)?void 0:s.video_id,video_url:null==(l=e.currentTemplate)?void 0:l.video_url,video:null==(c=e.currentTemplate)?void 0:c.video,slug:null==(d=e.currentTemplate)?void 0:d.slug,height:null==(u=e.currentTemplate)?void 0:u.height,width:null==(m=e.currentTemplate)?void 0:m.width,thumbnail:null==(p=e.currentTemplate)?void 0:p.thumbnail,isSingleMedia:null==(h=e.currentTemplate)?void 0:h.isSingleMedia,singleMedia:null==(g=e.currentTemplate)?void 0:g.singleMedia}}),(e=>he({addLayers:Xi,fetchTemplate:pB,setEditorPath:zJ,setParentId:dB,setTemplateSource:TB,resetStudio:uS,showError:wh},e)))(Pae)),Oae={style:{verticalAlign:"middle"}};class Dae extends n.exports.Component{constructor(e){super(e),t(this,"refreshCurrentUser"),t(this,"getCustomPageRedirects",(()=>{const e=[];return mX.forEach((t=>{if(t.redirect)if("string"==typeof t.redirect)e.push(m.createElement(R3,{key:t.redirect,from:t.redirect,exact:!0,to:t.url}));else if(Array.isArray(t.redirect))for(const a of t.redirect)e.push(m.createElement(R3,{key:a,from:a,exact:!0,to:t.url}))})),e})),t(this,"renderSwitch",(()=>{const{hostDomain:e}=this.props;return m.createElement($e,null,mm()&&!this.props.currentUser.token&&m.createElement(R3,{exact:!0,from:"/",to:"/pwaHome"}),this.props.currentUser.token&&m.createElement(R3,{exact:!0,from:"/pwaHome",to:"/"}),m.createElement(Ke,{exact:!0,path:"/",component:s4}),m.createElement(Ke,{exact:!0,path:"/pwaHome",component:r4}),m.createElement(R3,{exact:!0,from:"/join",to:"/"}),m.createElement(R3,{exact:!0,from:"/join/:code",to:"/"}),m.createElement(Ke,{path:"/admin",component:fk}),m.createElement(Ke,{path:"/videos/:id/debug",component:_k}),m.createElement(Ke,{path:"/videos/:id/snapshots",exact:!0,component:R0}),m.createElement(Ke,{path:"/videos/:id/snapshots/:snapshot_id/debug",render:()=>m.createElement(_k,{snapshot:!0})}),m.createElement(Ke,{exact:!0,path:"/videos/:id/comment/:commentId",render:()=>m.createElement(X1,{hostDomain:e})}),m.createElement(Ke,{exact:!0,path:"/videos/:id",render:()=>m.createElement(X1,{hostDomain:e})}),m.createElement(R3,{from:"/cartoonify/:id",to:"/videos/:id"}),m.createElement(R3,{from:"/workspace/:subpath",to:"/folder/:subpath"}),m.createElement(R3,{from:"/workspace",to:"/home"}),m.createElement(Ke,{exact:!0,path:"/home",component:Ate}),m.createElement(Ke,{exact:!0,path:"/brandkit",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder/:id",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder/:id/rename",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder/create",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder/:id/create",component:Ate}),m.createElement(Ke,{exact:!0,path:"/folder/sharing/:id",component:m0}),m.createElement(Ke,{exact:!0,path:"/shared-with-me",component:Ate}),m.createElement(R3,{from:"/my/videos",to:"/home"}),m.createElement(R3,{from:"/my/account",to:{pathname:"/home",state:{openModal:vk.account}}}),m.createElement(Qt,{exact:!0,path:"/settings/account",to:{pathname:"/home",state:{openModal:vk.account}}}),m.createElement(Qt,{exact:!0,path:"/settings/account/change",to:{pathname:"/home",state:{openModal:vk.accountChange}}}),m.createElement(R3,{from:"/my",to:"/home"}),m.createElement(Ke,{path:"/settings",component:Ate}),m.createElement(Ke,{path:"/settings/folder/cancel",component:Ate}),m.createElement(Ke,{exact:!0,path:"/invite/:id",component:u0}),m.createElement(Ke,{exact:!0,path:"/team/sharing/:id",component:j3}),m.createElement(Ke,{exact:!0,path:"/team/invite/:inviteKey",component:X3}),m.createElement(Ke,{path:"/defaultTeamFolder/:teamId",component:Ate}),m.createElement(Ke,{path:"/team/:teamId",component:Ate}),this.getCustomPageRedirects(),mX.map((e=>m.createElement(Ke,{key:e.url,path:e.url,exact:!0,component:e.component}))),m.createElement(R3,{from:"/editor",exact:!0,to:"/"}),m.createElement(R3,{from:"/editor/trimmer",to:"/tools/trim-video"}),m.createElement(R3,{from:"/editor/subtitles",to:"/subtitles"}),m.createElement(R3,{from:"/editor/add-audio-to-video",to:"/tools/add-audio"}),m.createElement(R3,{from:"/editor/convert",to:"/tools/convert"}),m.createElement(R3,{from:"/editor/video-speed",to:"/tools/resize"}),m.createElement(R3,{from:"/editor/audio-trimmer",to:"/tools/trim-audio"}),m.createElement(R3,{from:"/editor/resize",to:"/tools/resize"}),m.createElement(Ke,{path:"/editor/videos/:id",component:uk}),m.createElement(Ke,{path:"/editor/memes",component:hk}),m.createElement(Ke,{path:"/editor/watermarker",component:hk}),m.createElement(Ke,{path:"/editor/confirm",component:hk}),m.createElement(Ke,{path:"/editor/adjust",component:hk}),m.createElement(Ke,{path:"/editor/loop-video",component:hk}),m.createElement(Ke,{path:"/editor/filters",component:hk}),m.createElement(Ke,{path:"/editor/mute-video",component:hk}),m.createElement(Ke,{path:"/editor/image-to-video",component:hk}),m.createElement(Ke,{path:"/editor/add-text",component:hk}),m.createElement(Ke,{path:"/editor/rotate",component:hk}),m.createElement(Ke,{path:"/editor/volume-adjust",component:hk}),m.createElement(Ke,{path:"/editor/stop-motion",component:hk}),m.createElement(Ke,{path:"/editor/reverse",component:hk}),m.createElement(R3,{from:"/:id?/studio/editor/layer/:layerId",to:"/:id?/studio/editor"}),m.createElement(Ke,{path:"/:id?/studio/editor/sharing",component:gk}),m.createElement(Ke,{path:"/:id?/studio/editor/comment/:commentId",component:gk}),m.createElement(Ke,{path:"/:id?/studio/editor/",component:gk}),m.createElement(Ke,{path:"/explore/:slug",component:Rae}),m.createElement(R3,{from:"/exploreall",exact:!0,to:"/explore"}),m.createElement(R3,{from:"/explore-all",to:"/explore"}),m.createElement(R3,{from:"/explore/directory",exact:!0,to:"/explore"}),m.createElement(R3,{statusCode:404,from:"/browse",to:"/404"}),m.createElement(R3,{statusCode:404,from:"/posts",to:"/404"}),m.createElement(R3,{from:"/maker",exact:!0,to:"/video-maker"}),m.createElement(R3,{exact:!0,from:"/maker/editor",to:"/studio/editor/scenes"}),m.createElement(R3,{from:"/maker",to:"/video-maker"}),m.createElement(Ke,{path:"/startup-demo-videos",exact:!0,component:rB}),m.createElement(Ke,{path:"/startup-demo-videos/:id",component:oB}),m.createElement(Ke,{path:"/rick-roller",component:hM}),m.createElement(Ke,{path:"/logo-redesigns",component:E3}),m.createElement(Ke,{path:"/how-much-twitch-streamers-make",component:P3}),m.createElement(Ke,{path:"/new-tab-stretches",component:nM}),m.createElement(Ke,{path:"/museum-of-websites",exact:!0,component:aL}),m.createElement(Ke,{path:"/museum-of-websites/:id",component:rL}),m.createElement(Ke,{path:"/evolution-of-products",exact:!0,component:aL}),m.createElement(Ke,{path:"/evolution-of-products/:id",component:rL}),m.createElement(Ke,{path:"/mobile-mockup",component:aU}),m.createElement(Ke,{path:"/cartoonify",exact:!0,component:rA}),m.createElement(Ke,{path:"/motion",component:WU}),m.createElement(Ke,{path:"/sidedoor",component:VF}),m.createElement(Ke,{path:"/404-illustrations",component:ML}),m.createElement(Ke,{path:"/ai-video-generator",component:c3}),m.createElement(Ke,{path:"/sonoma-county-fire-map",component:hL}),m.createElement(Ke,{path:"/sound-effects",component:eB}),m.createElement(Ke,{path:"/off-site/long-tail-analytics",component:yk}),m.createElement(Ke,{path:"/edu/login",component:BD}),m.createElement(Ke,{path:"/edu/signup",component:HD}),m.createElement(Ke,{path:"/edu/admin-signup",component:GD}),m.createElement(Ke,{path:"/signin-redirect/",component:mM}),m.createElement(Ke,{path:"/signin/onetap",component:VU}),m.createElement(Ke,{path:"/signin",component:zF}),m.createElement(R3,{from:"/sign-in",to:"/sigin"}),m.createElement(Ke,{path:"/checkout",component:PD}),m.createElement(R3,{from:"/gif-meme-generator",to:"/"}),m.createElement(R3,{from:"/editor/montage",to:"/maker/editor"}),m.createElement(R3,{from:"/create/editor",to:"/studio/editor"}),m.createElement(R3,{from:"/:id?/editor/subtitles",to:"/:id?/studio/editor"}),m.createElement(R3,{from:"/2020-election-meme-templates",to:"/explore/2020-new-york-times-election-needle-meme-template"}),m.createElement(R3,{from:"/blade-runner-generator",to:"/explore"}),m.createElement(R3,{from:"/tools/resources/video-editor-for-youtube/",to:"https://www.kapwing.com/resources/video-editor-for-youtube/"}),m.createElement(Ke,{path:"/health",render:()=>"Success"}),m.createElement(Ke,{path:"/404",render:({staticContext:e})=>(e&&(e.statusCode=404),m.createElement(uM,null))}),m.createElement(Ke,{render:({staticContext:e})=>(e&&(e.statusCode=404),m.createElement(uM,null))}))}));const{config:a}=e;e.setConfig(a),this.refreshCurrentUser=u(Og,3e3,{leading:!0,trailing:!1})}componentDidMount(){const{showError:e,setKapwingInit:t,currentUser:a,currentTeam:o,resetCumulativeDurationLimit:n,resetTranscribeUsage:r}=this.props;if(t(),"undefined"!=typeof window&&(this.refreshCurrentUser().catch((t=>e(`Failed to refresh user profile. ${t.message}.`))),O3()),om(a)){Du({team:o},au.TRANSCRIBE)||((()=>{var e;const t=Bu();if(!(null==t?void 0:t.limits))return!1;const a=Fh(new Date(null==(e=t.limits)?void 0:e.lastUpdatedCumulativeDuration));return Fh(new Date)>a})()&&n(),Gh()&&r())}}componentDidUpdate(e){const{location:t}=this.props,{location:a}=e;t.pathname!==a.pathname&&this.onRouteChanged(a),"/pricing"!==t.pathname&&window.fcWidget&&window.fcWidget.hide()}onRouteChanged(e){const{location:t}=this.props,{pathname:a}=t,{pathname:o}=e;a.includes("/studio/editor")&&o.includes("/studio/editor")||this.refreshCurrentUser()}renderApp(){const{showSignIn:e}=this.props,t=Bu(),a="Kapwing — The collaborative video editor for modern teams",o="Kapwing is a collaborative, online content creation platform that you can use to edit video and create content. Join over 10 million modern creators who trust Kapwing to create, edit, and grow their content on every channel.",n="https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp";return m.createElement("div",{className:id({"app-container":!0,"col-resize":this.props.isResizingMediabar})},m.createElement(Ce,null,m.createElement("title",null,a),m.createElement("meta",{name:"description",content:o}),m.createElement("meta",{name:"keywords",content:"video editor, meme maker, video resizer, gif editor, video subtitles"}),m.createElement("meta",{property:"og:title",content:a}),m.createElement("meta",{property:"og:description",content:o}),m.createElement("meta",{property:"og:image",content:n}),m.createElement("meta",{property:"og:image:url",content:n}),m.createElement("meta",{property:"twitter:image",content:n}),m.createElement("meta",{property:"og:type",content:"website"}),m.createElement("meta",{property:"og:image:width",content:"1200"}),m.createElement("meta",{property:"og:image:height",content:"630"}),m.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),m.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/"})),m.createElement(qD,null),m.createElement(cB,null),m.createElement(a0,null),m.createElement(XL,null),m.createElement(uO,null),this.renderSwitch(),m.createElement(HO,null,e&&m.createElement(MC,{hideSignIn:aw}),t&&m.createElement(g2,null),m.createElement(Ek,null),m.createElement(xte,null),m.createElement("div",{style:{display:"none",position:"absolute",zIndex:-1}},m.createElement("canvas",{id:"canvas-scratchpad"}),m.createElement("div",{id:"scene-list-premount"}))))}render(){const{location:e}=this.props;return new URLSearchParams(e.search).get("isTWA")&&Ob.set("isTWA","true"),m.createElement(La.Provider,{value:Oae},m.createElement(QI,null,m.createElement(oc,null,this.renderApp())))}}const Lae=ie(i.exports.connect((e=>({showSignIn:e.studioLocal.showSignIn,currentUser:e.currentUser,isResizingMediabar:e.studioLocal.isResizingMediaBar,currentTeam:Bu(e)})),(e=>he({setConfig:O0,showError:wh,setKapwingInit:gS,updateLayer:ds,resetCumulativeDurationLimit:Ag,resetTranscribeUsage:Pg},e)))(Dae)),Uae=Ua((e=>{const{config:t,store:a}=e,{STRIPE_PUBLIC_KEY:o}=t;n.exports.useEffect((()=>{const e=document.createElement("script");e.src="https://connect.facebook.net/en_US/sdk.js",e.async=!0,setTimeout((()=>{document.body&&document.body.appendChild(e)}),3e3)}),[]);const r=Ma(o);return m.createElement(i.exports.Provider,{store:a},m.createElement(Fa,{reCaptchaKey:t.RECAPTCHA_V3_SITEKEY,useRecaptchaNet:!0,scriptProps:{async:!0,defer:!0}},m.createElement(xI,null,m.createElement(DI,null,m.createElement(Ba,{stripe:r},m.createElement(Wa,{backend:Va,options:{enableMouseEvents:!0}},m.createElement(kI,null),m.createElement(ja,{history:no},m.createElement(zI,{refreshOnError:!0},m.createElement(GI,null,m.createElement(Lae,{config:t}))))))))))}));const Mae=["AbortError","FetchStatusError"],Fae=["The play() request was interrupted by a call to pause()","The element has no supported source","The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission","The operation is not supported.","Network request failed"];const Bae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Wae(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&t&&t.onUpdate&&t.onUpdate(e)})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const{domain:Vae}=document,jae=Vae.startsWith("localhost"),Hae={CLOUD_FUNCTIONS_PREFIX:"",COMMIT:"87bc34b7",FACEBOOK_APP_ID:"713985848677391",FRESH_CHAT_TOKEN:"6c78e084-ae7a-4b7b-8968-358ae3123d5b",GIPHY_SEARCH_KEY:"rfMjRmVqUkVPENBuewLHtXp6kXPjSBvq",GOOGLE_ANALYTICS_CODE:"UA-100629017-1",GOOGLE_PLUGINS_CLIENT_ID:"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com",GOOGLE_PLUGINS_KEY:"AIzaSyDi2438fC9BfPQygJUdixA3nq_NjihWTTQ",PAYPAL_CLIENT_ID:"ATpujmTF5jlQkGjb2cxW-cqabZzW5aPOyUhHCgiqRnDCMJR0PBuT3Hiz1MRlBpSAiCdPmSKDOzZfX71q",PAYPAL_MONTHLY_PLAN:"P-7M0707473Y698515YL25POSA",PAYPAL_YEARLY_PLAN:"P-1Y863133GV1165308L3B4QAY",RECAPTCHA_V2_SITEKEY:"6LciWYwhAAAAAP9IBiJn1FoBRXISf74l3U6TvAL8",RECAPTCHA_V3_SITEKEY:"6LciWYwhAAAAAP9IBiJn1FoBRXISf74l3U6TvAL8",SENTRY_ENV:"production",STRIPE_PUBLIC_KEY:"pk_live_2sDMAtDohnudYHgRDvCSQelo",UNSPLASH_KEY:"GzIAtsrV-zOLLJXWiLhxxd_2hcWz1JCHsIXWAYJ5rE0"};(Vae.endsWith(".kapwing-dev.com")||Vae.startsWith("kapwing-dev")&&Vae.endsWith(".herokuapp.com")||jae&&["3000","4000","5000"].includes(window.location.port)||Vae.startsWith("192.")||Vae.startsWith("10.0.")||Vae.startsWith("10.1."))&&(Object.assign(Hae,{FACEBOOK_APP_ID:"2545197755522838",PAYPAL_CLIENT_ID:"ASFO5f-tT3sCvQTEyy3xsgvkgsESBNOxypAtrQ9nV9StFVEeNntRnpUC-oq8wBRodKRARO0fkxw_2ALM",PAYPAL_MONTHLY_PLAN:"P-1HB10053MC1801913L26DZEQ",PAYPAL_YEARLY_PLAN:"P-9FJ14294SG852114PL3DRKYI",RECAPTCHA_V2_SITEKEY:"6LdpYicdAAAAALsID-RPNNp91_n_4otjuyj-CG6U",RECAPTCHA_V3_SITEKEY:"6Leu-AgdAAAAADasOHy2VJPi1xbcAnWrI8mE8t0d",STRIPE_PUBLIC_KEY:"pk_test_7MMbY1maBR111EJDSqeWIhHR"}),window.Cypress||(Hae.CLOUD_FUNCTIONS_PREFIX="dev_"));try{!function(){if(window.SENTRY_ENV="production",Ha({enabled:!eo&&!window.Cypress,beforeSend:(e,t)=>{var a,o,n,r;if(null==(a=t.originalException)?void 0:a.__SKIP_SENTRY)return null;if(null==(o=e.extra)?void 0:o.__FORCE_SAMPLE)return e;const i=t.originalException&&"object"==typeof t.originalException&&"message"in t.originalException?null==(n=t.originalException)?void 0:n.message:"",s=t.originalException&&"object"==typeof t.originalException&&"name"in t.originalException?null==(r=t.originalException)?void 0:r.name:"";if(Mae.includes(s))return null;for(const l of Fae)if(i.includes(l))return null;return e},dsn:"https://a5bf03f4085d4c9eae3716d84c1869c4@sentry.io/267538",environment:"production",autoSessionTracking:!0,integrations:[new Ga,new $a({routingInstrumentation:Ka(no)})],release:"v2023.02.22.2",normalizeDepth:7,maxBreadcrumbs:10}),"undefined"!=typeof window){let e=null;TI.subscribe((()=>{var t;const a=TI.getState(),{teams:o}=a,n=Ou({team:(null==o?void 0:o.selectedTeamId)?null==(t=null==o?void 0:o.allTeams)?void 0:t.find((e=>e._id===o.selectedTeamId)):void 0}),{_id:r}=a.currentUser.user||{},i=!!r&&n.planTier===jd.PRO;i!==e&&(Ya("pro",i),e=i)}))}}()}catch(Kae){console.error(Kae)}Vae.startsWith("localhost")||window.Cypress||!Hae.SENTRY_ENV||console.log("%cLooking for a creative challenge? Come work at Kapwing - we're hiring. kapwing.com/careers","font-weight: bold; font-size: 16px; color: #0083e2;"),window.releaseVersion="v2023.02.22.2",window.commitHash=ao(),o.initialize(Hae.GOOGLE_ANALYTICS_CODE),o.pageview(window.location.pathname),TI.subscribe(S((()=>{wk()}),3e3)),yt.extend(za),yt.extend(qa),yt.extend(Ja);const Gae=ye.hydrate;"undefined"==typeof window||no||window.location.replace("/404"),window.Buffer=Xa.Buffer,Gae(m.createElement(Uae,{config:Hae,store:TI}),document.getElementById("root")),window.Cypress||"localhost"===window.location.hostname?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})):function(e){if("serviceWorker"in navigator){if(new URL("/",window.location.href).origin!==window.location.origin)return;const t=()=>{const t="/service-worker.js";Bae?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((a=>{const o=a.headers.get("content-type");404===a.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):Wae(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Wae(t,e)};window.addEventListener("load",t)}}({onUpdate:async e=>{console.info("New service worker will update on page refresh."),e&&e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"})}});export{uy as $,eb as A,vO as B,Zw as C,Yh as D,mq as E,bg as F,dg as G,zO as H,eg as I,MO as J,m2 as K,bk as L,ux as M,W$ as N,kx as O,jO as P,pg as Q,Sg as R,Ig as S,p4 as T,x4 as U,rg as V,ig as W,Tg as X,_g as Y,Og as Z,ab as _,UO as a,xS as a$,Ru as a0,Qh as a1,ap as a2,Ro as a3,sm as a4,P4 as a5,Ng as a6,Vr as a7,Uu as a8,hO as a9,hq as aA,pO as aB,fO as aC,Io as aD,Xo as aE,JO as aF,Uo as aG,Qw as aH,Xw as aI,hb as aJ,Af as aK,lb as aL,ib as aM,ZO as aN,cb as aO,db as aP,Bh as aQ,Lo as aR,im as aS,om as aT,ob as aU,rb as aV,IS as aW,pb as aX,vk as aY,Ob as aZ,ik as a_,hu as aa,tp as ab,kg as ac,np as ad,lg as ae,ed as af,wO as ag,df as ah,Eu as ai,zR as aj,id as ak,pu as al,Iu as am,up as an,qR as ao,ZR as ap,MA as aq,sA as ar,f7 as as,RO as at,tg as au,G7 as av,Mu as aw,h7 as ax,Zh as ay,Hh as az,ag as b,XO as b$,wS as b0,FJ as b1,BJ as b2,bS as b3,b0 as b4,ez as b5,sn as b6,ln as b7,wg as b8,Um as b9,Xg as bA,ju as bB,Lf as bC,Ou as bD,yu as bE,Oh as bF,ly as bG,rS as bH,Mh as bI,qO as bJ,Lh as bK,Nf as bL,ey as bM,ty as bN,mb as bO,ub as bP,nb as bQ,sb as bR,Gte as bS,Hte as bT,ny as bU,Dh as bV,vo as bW,_o as bX,bf as bY,xh as bZ,Ah as b_,ry as ba,my as bb,If as bc,kf as bd,wf as be,sy as bf,cy as bg,jg as bh,k_ as bi,pf as bj,tu as bk,rm as bl,j$ as bm,Ln as bn,xo as bo,Du as bp,Bu as bq,YR as br,Om as bs,SQ as bt,l4 as bu,dy as bv,gJ as bw,oN as bx,xf as by,aQ as bz,jd as c,Nc as c$,ff as c0,T0 as c1,uS as c2,vN as c3,Mf as c4,Uf as c5,Ff as c6,Wf as c7,Xf as c8,Df as c9,MP as cA,ds as cB,IE as cC,DP as cD,LP as cE,qg as cF,tr as cG,yv as cH,nR as cI,oP as cJ,nP as cK,dP as cL,sP as cM,Kr as cN,RP as cO,yP as cP,kR as cQ,$b as cR,uP as cS,bP as cT,ev as cU,rP as cV,Ld as cW,jn as cX,sR as cY,ZE as cZ,Ec as c_,Rf as ca,zf as cb,Yf as cc,Of as cd,Pf as ce,mT as cf,pT as cg,xg as ch,ei as ci,wP as cj,mP as ck,yR as cl,Iw as cm,Hn as cn,ij as co,wG as cp,mn as cq,Vv as cr,yd as cs,vd as ct,ic as cu,fq as cv,vG as cw,io as cx,Is as cy,xr as cz,Vd as d,Ml as d$,ss as d0,is as d1,ls as d2,_s as d3,pG as d4,xi as d5,PG as d6,vl as d7,rs as d8,mu as d9,pV as dA,Co as dB,ZW as dC,KV as dD,$V as dE,HV as dF,po as dG,mo as dH,Q7 as dI,Eg as dJ,R3 as dK,H$ as dL,Eh as dM,by as dN,Ey as dO,eV as dP,Nd as dQ,Ao as dR,mh as dS,oh as dT,eN as dU,uh as dV,ah as dW,zW as dX,Jw as dY,fT as dZ,yT as d_,Oo as da,Eo as db,Uh as dc,Sy as dd,gy as de,S0 as df,fg as dg,yg as dh,v$ as di,vC as dj,LG as dk,zH as dl,oA as dm,$H as dn,vr as dp,yr as dq,pq as dr,ko as ds,QN as dt,qC as du,Bb as dv,zC as dw,Wb as dx,nn as dy,Cs as dz,b4 as e,u$ as e$,si as e0,Sn as e1,lV as e2,Em as e3,Pd as e4,cV as e5,YC as e6,LN as e7,dV as e8,Yl as e9,pS as eA,gR as eB,vh as eC,Od as eD,GV as eE,tN as eF,Os as eG,$p as eH,Kp as eI,n$ as eJ,o$ as eK,Zp as eL,sh as eM,Qv as eN,As as eO,bW as eP,SW as eQ,f$ as eR,i$ as eS,s$ as eT,nN as eU,Rh as eV,c$ as eW,d$ as eX,wN as eY,p$ as eZ,m$ as e_,ip as ea,Oc as eb,hR as ec,ud as ed,RI as ee,lC as ef,Dg as eg,$l as eh,TI as ei,Qi as ej,gh as ek,Yc as el,Jd as em,LI as en,_l as eo,iK as ep,XS as eq,bn as er,Ii as es,rl as et,AN as eu,t2 as ev,WG as ew,Rn as ex,sV as ey,lR as ez,tb as f,$d as f$,h$ as f0,bq as f1,nd as f2,yo as f3,iq as f4,rq as f5,Nk as f6,nq as f7,ml as f8,eP as f9,p_ as fA,X7 as fB,lh as fC,eh as fD,rJ as fE,ul as fF,KC as fG,Jy as fH,Zy as fI,Hy as fJ,Ry as fK,lw as fL,yw as fM,bd as fN,ji as fO,Vi as fP,Bi as fQ,BO as fR,WO as fS,Do as fT,Kn as fU,zd as fV,Zd as fW,IW as fX,TW as fY,mV as fZ,Yd as f_,aE as fa,oE as fb,AJ as fc,CJ as fd,Bl as fe,On as ff,oi as fg,jo as fh,Mo as fi,Wo as fj,Fo as fk,Bo as fl,Vo as fm,Go as fn,aS as fo,Hb as fp,fG as fq,DR as fr,OR as fs,Uy as ft,uR as fu,Wn as fv,Ay as fw,xy as fx,ky as fy,Cy as fz,YO as g,Xc as g$,Kd as g0,eu as g1,Wu as g2,qE as g3,Ny as g4,zE as g5,Ty as g6,PC as g7,Qm as g8,Zj as g9,A_ as gA,GW as gB,ho as gC,go as gD,Vl as gE,vW as gF,wW as gG,km as gH,ql as gI,nc as gJ,Bv as gK,jv as gL,dc as gM,Uv as gN,Xl as gO,Un as gP,Eb as gQ,Gv as gR,Ej as gS,cc as gT,Yv as gU,mc as gV,pc as gW,sc as gX,Mv as gY,WJ as gZ,KW as g_,v_ as ga,ow as gb,nw as gc,qj as gd,Vk as ge,Cd as gf,yi as gg,Zi as gh,Qk as gi,RR as gj,nv as gk,gv as gl,H_ as gm,Pr as gn,md as go,rc as gp,Wv as gq,Jv as gr,fn as gs,zv as gt,vn as gu,hv as gv,Dn as gw,UP as gx,S_ as gy,zl as gz,op as h,Wc as h$,dW as h0,xn as h1,s_ as h2,wj as h3,uC as h4,Rs as h5,KS as h6,Jg as h7,$S as h8,Gs as h9,RH as hA,Ls as hB,Fc as hC,Bc as hD,Mc as hE,Uc as hF,Gc as hG,AH as hH,NH as hI,zr as hJ,lG as hK,sG as hL,EG as hM,Lv as hN,Hl as hO,EH as hP,fH as hQ,Vs as hR,es as hS,as as hT,os as hU,ts as hV,Aj as hW,T_ as hX,Ew as hY,XE as hZ,Rc as h_,ad as ha,yq as hb,hs as hc,gc as hd,PH as he,yn as hf,_n as hg,oS as hh,t_ as hi,vw as hj,Jc as hk,OH as hl,n_ as hm,wH as hn,wd as ho,CH as hp,Lr as hq,qH as hr,ZH as hs,nf as ht,_H as hu,o_ as hv,Fs as hw,vH as hx,bH as hy,xH as hz,ug as i,xm as i$,kc as i0,bc as i1,$r as i2,Ij as i3,Nj as i4,JE as i5,KE as i6,QE as i7,YE as i8,EP as i9,ym as iA,Pi as iB,hP as iC,cv as iD,qi as iE,Ur as iF,Or as iG,OP as iH,xP as iI,Th as iJ,FL as iK,Ih as iL,jr as iM,gP as iN,Js as iO,pP as iP,aP as iQ,il as iR,fv as iS,ms as iT,aR as iU,Z_ as iV,QP as iW,qP as iX,tR as iY,jP as iZ,eR as i_,vP as ia,_P as ib,Xu as ic,Ql as id,tl as ie,QW as ig,XW as ih,En as ii,Yr as ij,_j as ik,vj as il,Bn as im,Jr as io,pv as ip,zi as iq,iR as ir,Ss as is,bw as it,pR as iu,El as iv,er as iw,yl as ix,bs as iy,SG as iz,wh as j,iV as j$,JK as j0,$s as j1,ll as j2,Ks as j3,iP as j4,CP as j5,nj as j6,lj as j7,am as j8,kP as j9,Fn as jA,XD as jB,kl as jC,Yn as jD,mi as jE,Ti as jF,NP as jG,TP as jH,IP as jI,Qs as jJ,Fg as jK,bo as jL,Jo as jM,m_ as jN,un as jO,WE as jP,kw as jQ,Vb as jR,$v as jS,i_ as jT,r_ as jU,iz as jV,Sd as jW,Py as jX,Hz as jY,bm as jZ,tV as j_,zV as ja,SP as jb,Ys as jc,fP as jd,_m as je,sl as jf,cP as jg,Ku as jh,mG as ji,mE as jj,pE as jk,li as jl,ci as jm,Gz as jn,lP as jo,ws as jp,Ai as jq,Zs as jr,ki as js,vs as jt,Xs as ju,a_ as jv,el as jw,Hs as jx,sr as jy,ir as jz,Kk as k,lc as k$,mS as k0,Xi as k1,gl as k2,dl as k3,hl as k4,XC as k5,JC as k6,jj as k7,gN as k8,Zv as k9,lS as kA,Ug as kB,zc as kC,wi as kD,MR as kE,ks as kF,od as kG,_G as kH,cR as kI,lq as kJ,cq as kK,Yb as kL,xG as kM,wl as kN,bl as kO,tS as kP,dq as kQ,_w as kR,wR as kS,Wl as kT,xc as kU,Tc as kV,Xr as kW,q_ as kX,qK as kY,Kl as kZ,sw as k_,gV as ka,wk as kb,sS as kc,iS as kd,g_ as ke,y_ as kf,fN as kg,yN as kh,$o as ki,Xk as kj,$W as kk,Dl as kl,jW as km,VW as kn,FG as ko,oV as kp,BG as kq,Gl as kr,oC as ks,fh as kt,Rd as ku,Wk as kv,dw as kw,QC as kx,cs as ky,uH as kz,fm as l,xR as l$,WP as l0,VP as l1,FP as l2,jc as l3,Hc as l4,Vc as l5,BP as l6,Cj as l7,cj as l8,XV as l9,dR as lA,gw as lB,jE as lC,Hg as lD,Wg as lE,$P as lF,KP as lG,rR as lH,YP as lI,z_ as lJ,lv as lK,X_ as lL,XP as lM,JP as lN,Tw as lO,cw as lP,Nw as lQ,qd as lR,Nz as lS,ti as lT,Kb as lU,HP as lV,ZP as lW,u_ as lX,Eq as lY,UR as lZ,zu as l_,Cl as la,OV as lb,f_ as lc,yH as ld,Sc as le,Cc as lf,fw as lg,GE as lh,CG as li,qb as lj,Jb as lk,ER as ll,rn as lm,SE as ln,$n as lo,bi as lp,bG as lq,Vz as lr,$z as ls,jz as lt,mw as lu,hw as lv,uw as lw,pw as lx,LR as ly,Wi as lz,bh as m,tE as m$,TR as m0,NR as m1,AR as m2,yG as m3,kG as m4,DG as m5,Qr as m6,sd as m7,Sw as m8,$c as m9,DT as mA,tA as mB,dG as mC,cG as mD,XH as mE,QH as mF,ew as mG,Li as mH,Di as mI,Mi as mJ,Ui as mK,Fi as mL,Qd as mM,qu as mN,kv as mO,Cv as mP,js as mQ,tw as mR,Qc as mS,Iv as mT,Tv as mU,Oi as mV,Xy as mW,$E as mX,Qy as mY,Ky as mZ,qy as m_,fc as ma,iW as mb,rW as mc,Sv as md,bv as me,J_ as mf,eG as mg,aG as mh,Zf as mi,Qf as mj,tG as mk,nG as ml,By as mm,WH as mn,GH as mo,ZN as mp,HH as mq,wv as mr,wo as ms,bj as mt,Sj as mu,PR as mv,Lm as mw,vv as mx,RT as my,OT as mz,Sh as n,TB as n$,Gy as n0,jy as n1,$y as n2,Wy as n3,Vy as n4,zy as n5,Ri as n6,zI as n7,pN as n8,mN as n9,GC as nA,sq as nB,Vg as nC,Nn as nD,An as nE,_h as nF,rG as nG,eA as nH,iw as nI,dd as nJ,cd as nK,FR as nL,Dr as nM,uG as nN,Es as nO,RG as nP,Gb as nQ,lm as nR,mB as nS,Cn as nT,kn as nU,In as nV,Tn as nW,fB as nX,yB as nY,tn as nZ,Vu as n_,So as na,dS as nb,uN as nc,lN as nd,hN as ne,XT as nf,kV as ng,Wr as nh,Fr as ni,rj as nj,LV as nk,Br as nl,em as nm,ov as nn,oj as no,vy as np,wy as nq,rw as nr,HE as ns,qS as nt,zS as nu,yV as nv,aH as nw,Ds as nx,Fl as ny,dJ as nz,cf as o,AW as o$,ao as o0,Pl as o1,to as o2,Av as o3,pl as o4,Ul as o5,TV as o6,UV as o7,h_ as o8,ZV as o9,rE as oA,iE as oB,Pg as oC,MC as oD,lE as oE,fV as oF,GR as oG,$R as oH,KR as oI,Yy as oJ,Vn as oK,Nl as oL,Gi as oM,Hi as oN,Al as oO,$i as oP,Ki as oQ,zY as oR,xs as oS,qW as oT,qs as oU,al as oV,Cm as oW,rh as oX,nh as oY,xW as oZ,PW as o_,DV as oa,VR as ob,HR as oc,jR as od,QV as oe,zo as of,qo as og,IV as oh,ej as oi,uj as oj,gj as ok,Rl as ol,CV as om,sj as on,Xd as oo,Rg as op,Mb as oq,cg as or,RV as os,Xb as ot,YV as ou,Gh as ov,Yu as ow,td as ox,sE as oy,nE as oz,Pu as p,Yg as p$,Qu as p0,ZY as p1,Ch as p2,Qo as p3,rd as p4,fC as p5,hV as p6,uJ as p7,xk as p8,ps as p9,ww as pA,Rb as pB,Ab as pC,xb as pD,Tp as pE,wb as pF,Ws as pG,hS as pH,TS as pI,YH as pJ,fp as pK,hE as pL,PS as pM,OS as pN,RS as pO,sg as pP,qh as pQ,vS as pR,Ym as pS,of as pT,Ip as pU,nS as pV,YK as pW,Gg as pX,NS as pY,AS as pZ,Kg as p_,Pn as pa,Ps as pb,zs as pc,zb as pd,jb as pe,AG as pf,IG as pg,EN as ph,Dy as pi,Ly as pj,My as pk,Fy as pl,eE as pm,Ts as pn,yh as po,dh as pp,Bs as pq,rN as pr,zJ as ps,y$ as pt,oG as pu,cS as pv,cA as pw,kh as px,bJ as py,DZ as pz,G$ as q,rD as q$,sf as q0,xp as q1,To as q2,$g as q3,Kte as q4,d_ as q5,Sl as q6,Tl as q7,Zo as q8,fo as q9,Ac as qA,TT as qB,IT as qC,_T as qD,CT as qE,ST as qF,cI as qG,uI as qH,mI as qI,vT as qJ,AT as qK,xT as qL,PT as qM,N_ as qN,Ph as qO,lD as qP,EB as qQ,_B as qR,vB as qS,SB as qT,pB as qU,wB as qV,t9 as qW,nm as qX,g7 as qY,cD as qZ,sD as q_,rz as qa,EC as qb,Ub as qc,en as qd,Yte as qe,xl as qf,JV as qg,tj as qh,wq as qi,Si as qj,wT as qk,ET as ql,dI as qm,sI as qn,lI as qo,GT as qp,rI as qq,oI as qr,$T as qs,ZT as qt,QT as qu,aA as qv,bT as qw,JH as qx,kT as qy,KH as qz,au as r,aD as r0,tD as r1,eD as r2,no as r3,Wh as r4,Vh as r5,jh as r6,oD as r7,nD as r8,iD as r9,Zu as ra,rp as rb,yD as rc,HC as rd,_$ as re,ZQ as rf,kS as rg,HW as rh,YW as ri,JW as rj,Q_ as rk,gq as rl,dn as s,Po as t,cn as u,Zg as v,cO as w,ou as x,Cg as y,iJ as z};
//# sourceMappingURL=index.66e11a28.js.map
